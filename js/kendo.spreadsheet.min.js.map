{"version":3,"sources":["kendo.spreadsheet.js"],"names":["f","define","kendo","UndoRedoStack","Observable","extend","init","options","fn","call","this","clear","events","push","command","stack","slice","currentCommandIndex","undo","canUndo","trigger","redo","canRedo","length","deepExtend","util","amd","a1","a2","a3","defined","value","UNDEFINED","round","precision","power","pow","math","p","limitValue","min","max","rad","degrees","DEG_TO_RAD","deg","radians","isNumber","val","isNaN","valueOrDefault","defaultValue","sqr","objectKey","object","key","parts","sort","join","hashKey","str","i","hash","charCodeAt","hashObject","arrayLimits","arr","MAX_NUM","MIN_NUM","arrayMin","arrayMax","sparseArrayMin","sparseArrayLimits","sparseArrayMax","n","isFinite","undefined","last","array","append","first","second","apply","renderTemplate","text","template","useWithBlock","paramName","renderAttr","name","renderAllAttr","attrs","output","renderStyle","renderSize","size","renderPos","pos","result","toHyphens","split","isTransparent","color","arabicToRoman","literals","1","10","100","2","20","200","3","30","300","4","40","400","5","50","500","6","60","600","7","70","700","8","80","800","9","90","900","1000","values","roman","shift","romanToArabic","r","digits","prev","v","toLowerCase","x","l","c","d","m","charAt","memoize","cache","Object","create","id","arguments","ucs2decode","string","extra","counter","ucs2encode","map","String","fromCharCode","mergeSort","a","cmp","merge","b","ai","bi","left","right","Math","floor","isUnicodeLetter","ch","RX_UNICODE_LETTER","test","window","PI","Number","MAX_VALUE","now","Date","getTime","drawing","dataviz","RegExp","$","zeroSize","width","height","baseline","measureText","style","measureBox","TextMetrics","current","measure","loadFonts","fonts","callback","promises","document","font","load","e","logToConsole","Promise","all","then","doc","Class","LRUCache","_size","_length","_map","put","lru","entry","_head","_tail","newer","older","get","defaultMeasureBox","_cache","_initOptions","baselineMarkerSize","box","styleKey","cacheKey","cachedResult","baselineMarker","_baselineMarker","cloneNode","appendChild","body","offsetWidth","offsetHeight","offsetTop","parentNode","removeChild","jQuery","CODE","out","UCS2","code","parse","data","callbacks","readChar","index","croak","msg","Error","readWhile","pred","readAsciiWhile","STRING","skipWhitespace","isWhitespace","eat","save","skip","isDigit","isHexDigit","isNameStart","isName","xmlComment","END_COMMENT","xmlTag","QUESTION_MARK","xmlDecl","START_COMMENT","xmlName","xmlAttrs","END_SHORT_TAG","GREATER_THAN","xmlContent","pop","END_TAG","START_CDATA","END_CDATA","LESS_THAN","AMPERSAND","xmlEntity","xmlString","quote","QUOTE","APOSTROPHE","SHARP","LOWERCASE_X","UPPERCASE_X","parseInt","ENTITIES","SEMICOLON","END_DECLARATION","$tag","EQUAL","what","thing","arg1","arg2","is","selector","j","exit","EXIT","tmp","amp","lt","gt","quot","apos","nbsp","parseXML","ex","encodeBase64","input","chr1","chr2","chr3","enc1","enc2","enc3","enc4","encodeUTF8","KEY_STR","inArray","ObserversMixin","observers","_observers","addObserver","element","removeObserver","splice","methodName","event","observer","idx","_suspended","optionsChange","geometryChange","suspend","resume","_observerField","field","mixins","copyToClipboard","html","textarea","createElement","addClass","appendTo","focus","select","execCommand","remove","Command","TargetValueCommand","PropertyChangeCommand","ApplyFilterCommand","DeleteCommand","AddCommand","NameCommand","support","browser","msie","version","spreadsheet","_workbook","workbook","_property","property","_state","range","_setRange","_range","exec","setState","getState","state","_forEachCell","ref","_ref","forEach","sheet","toRangeRef","bind","_target","target","_value","ColumnWidthCommand","columnWidth","RowHeightCommand","rowHeight","HyperlinkCommand","_link","link","_prevLink","_hasSetValue","GridLinesChangeCommand","showGridLines","prototype","skipHiddenCells","enable","ClearContentCommand","clearContent","EditCommand","rejectState","validationState","title","message","reason","type","wrap","_adjustRowHeight","_getValidationState","calc","ParseError","TextWrapCommand","forEachRow","topLeft","row","_rowHeight","AdjustDecimalsCommand","_decimals","decimals","formatting","batch","forEachCell","col","cell","format","adjustDecimals","BorderChangeCommand","_type","border","_style","noBorders","borderLeft","borderTop","borderRight","borderBottom","allBorders","leftBorder","leftColumn","rightBorder","rightColumn","topBorder","topRow","bottomBorder","bottomRow","outsideBorders","insideBorders","insideHorizontalBorders","insideVerticalBorders","MergeCellCommand","activate","activeCell","unmerge","cells","horizontally","vertically","forEachColumn","FreezePanesCommand","_topLeft","panes","frozenColumns","frozenRows","rows","columns","unfreeze","PasteCommand","_clipboard","clipboard","_event","activeSheet","pasteRef","status","preventDefault","canPaste","selection","paste","menuInvoked","pasteOnMerged","overflow","pasteOnDisabled","AdjustRowHeightCommand","rowIndex","ToolbarPasteCommand","_view","CopyCommand","noop","canCopy","copy","multiSelection","ToolbarCopyCommand","CutCommand","cut","AutoFillCommand","origin","_origin","fillFrom","Range","FillError","ToolbarCutCommand","FilterCommand","filter","hasFilter","intersectingMerged","SortCommand","column","ascending","expandRange","_sheetRef","clearFilter","filterRule","exists","valueFilter","ValueFilter","customFilter","CustomFilter","eq","ClearFilterCommand","HideLineCommand","axis","setAxisState","getAxisState","axisManager","hideSelectedRows","hideSelectedColumns","UnHideLineCommand","unhideSelectedRows","unhideSelectedColumns","DeleteRowCommand","deleteSelectedRows","DeleteColumnCommand","deleteSelectedColumns","AddColumnCommand","addColumnLeft","addColumnRight","AddRowCommand","canAddRow","addRowAbove","addRowBelow","EditValidationCommand","validation","OpenCommand","cannotUndo","file","match","fromFile","SaveAsCommand","fileName","extension","saveAsExcel","saveAsPDF","pdf","_name","nameDefinition","recalc","DefineNameCommand","defineName","DeleteNameCommand","undefineName","classNames","FormulaBar","wrapper","ui","Widget","formulaInput","FormulaInput","destroy","isOpenParen","isCloseParen","isMatchingParen","close","open","touches","begin","end","knownFunction","runtime","FUNCS","isEqualToken","tok1","tok2","ns","keys","styles","KEY_NAMES","PRIVATE_FORMULA_CHECK","listWrapper","27","37","39","35","36","32","attr","css","autoScale","on","scale","_highlightedRefs","_staticTokens","_formulaSource","_formulaList","_popup","_tooltip","_keydown","_keyup","_blur","_input","_focus","_paste","filterOperator","scalePadding","minLength","enableEditing","toggleClass","removeAttr","getPos","lookup","lookupNode","loop","node","nodeType","firstChild","nextSibling","nodeValue","div","sel","getSelection","focusNode","focusOffset","anchorNode","anchorOffset","collapsed","setPos","differ","startOffset","endOffset","startContainer","endContainer","len","el","currentRange","eiv","createRange","setStart","setEnd","getRangeAt","removeAllRanges","addRange","home","toUpperCase","formulaSource","DataSource","list","StaticList","insertAfter","autoBind","selectable","change","_formulaListChange","dataSource","dataValueField","activeToken","completion","ctx","tokenCtx","_tokenContext","_mute","token","replace","nextToken","_replaceAt","popup","Popup","anchor","clearTimeout","_focusId","_isFormula","keyCode","_navigated","_move","_keyDownTimeout","setTimeout","_syntaxHighlight","view","visible","focusFirst","_focusTimeout","ev","clipboardData","getData","originalEvent","substr","DOWN","focusNext","UP","focusPrev","focusLast","ENTER","TAB","PAGEUP","PAGEDOWN","tokens","tok","point","tokenize","_sync","_editorToSync","isActive","_textContainer","computedStyles","getComputedStyles","position","visibility","whiteSpace","top","_span","_cellTooltip","tooltip","toggleTooltip","show","toggle","_activeElement","operator","hide","rectangle","resize","canInsertRef","isKeyboardAction","_canInsertRef","afterPoint","canReplace","canInsertBetween","strictMode","refAtPoint","simplify","newValue","rest","syncWith","iehandler","self","eventName","handler","off","txt","innerText","mozilla","highlightedRefs","refClasses","Pane","series","refIndex","parens","active","cls","colorClass","unshift","reverse","htmlEncode","substring","_setStaticTokens","insertNewline","eof","Mac","isAlphaNum","keyName","EventListener","13","38","33","34","46","113","navigator","platform","indexOf","handlers","_handlers","_observer","keyDownProxy","keyDown","mouseProxy","mouse","threshold","_pressLocation","documentElement","handleEvent","rightClick","dx","dy","distance","which","button","pageX","y","pageY","sqrt","catchAllHandler","eventKey","mod","metaKey","ctrlKey","altKey","shiftKey","passThrough","skew","level","temp","insert","NilNode","RangeTreeNode","start","diff","heir","intersecting","ranges","intersects","tree","root","RangeTree","RangeList","Iterator","SparseRangeList","findrange","clone","firstRange","lastRange","rangeValue","rangeStart","rangeEnd","expandedValues","rangeIndex","sortedIndices","valueComparer","indices","comparer","sourceStart","sourceEnd","targetStart","iterator","unique","at","lastRangeStart","ValueRange","toExcelFormat","Property","JsonProperty","ValueProperty","set","dst","JSON","stringify","formats","validations","dateToNumber","culture","calendar","patterns","PropertyBag","specs","sortable","serializable","depends","cellCount","properties","lists","spec","fromJSON","si","iterators","forEachProperty","ALL_PROPERTIES","columnName","colIndex","letter","displaySheet","displayRef","rel","aa","Ref","NULL","NameRef","CellRef","RangeRef","UnionRef","hasSheet","_hasSheet","setSheet","absolute","relative","adjust","toString","print","obj","intersect","isCell","toRow","toColumn","rangeAt","nextRangeIndex","previousRangeIndex","reference","refs1","refs2","r1","r2","bottomRight","single","refs","concat","replaceAt","forEachColumnIndex","forEachAxisIndex","forEachRowIndex","sorted","method","valid","renameSheet","oldSheetName","newSheetName","display","ret","trow","tcol","abs","arow","acol","forRow","delta","tl","br","endSheet","normalize","_containsRange","_containsCell","contains","Array","that","some","_intersectRange","a_left","a_top","a_right","a_bottom","b_left","b_top","b_right","b_bottom","c1","c2","rr1","rc1","rr2","rc2","changes","relTL","relBR","collapse","toCell","startRow","endRow","startCol","endCol","union","topLeftRow","topLeftCol","bottomRightRow","bottomRightCol","modified","num","limit","bottom","move","cols","tr","u","reduce","empty","theRef","newRefs","NULLREF","SHEETREF","Infinity","FIRSTREF","AutoFillCalculator","grid","_grid","rectIsVertical","startRect","endRect","autoFillDest","cursor","quadrant","pivot","opposite","cornerResult","expanding","bottomLeft","topRight","lower","further","EdgeNavigator","SheetNavigator","rangeGetter","prevLeft","prevVisible","nextRight","nextVisible","nextLeft","prevRight","boundary","_sheet","_columns","autoFillCalculator","colEdge","columnRange","rowEdge","_rows","rowRange","_viewPortHeight","unionWithMerged","leftCol","rightCol","selectionIncludesMergedCells","_mergedCells","setSelectionValue","selectAll","mode","addToExisting","refForMode","rowRef","colRef","startSelection","startAutoFill","completeSelection","selectForContextMenu","modifySelection","action","scrollInto","newSelection","direction","determineDirection","viewPortHeight","originalSelection","currentOriginalSelectionRange","prevPage","nextPage","firstVisible","lastVisible","updateCurrentSelectionRange","moveActiveCell","originalActiveCell","navigateInSelection","currentNavigationRange","selTopLeft","selBottomRight","done","nextNavigationRange","previousNavigationRange","shouldSkip","singleCellSelection","extendSelection","resizeAutoFill","isMerged","forEachMergedCell","merged","hint","preview","props","_autoFillOrigin","dest","punch","_previewFillFrom","updateAutoFill","currentSelectionRange","leftMode","rightMode","topMode","bottomMode","originalSelect","selectionRangeIndex","subset","bottomCol","AxisManager","forEachSelectedColumn","layout","forEachSelectedRow","includesHiddenColumns","includesHidden","includesHiddenRows","selectionIncludesHiddenColumns","selectionIncludesHiddenRows","deleteColumn","deleteRow","hasRight","hasLeft","hideColumn","_count","isHiddenColumn","hasBottom","hasTop","hideRow","isHiddenRow","unhideColumn","unhideRow","insertColumn","rowCount","canInsertRow","insertRow","newState","mergedCells","foreign","origRef","setStateData","stripStyle","borderObject","cellState","getComputedStyle","borders","fontSize","background","underline","italic","bold","textAlign","verticalAlign","parseHTML","table","find","each","td","ci","ri","rowspan","colspan","blankCell","after","address","parseTSV","Clipboard","_content","_externalContent","_internalContent","iframe","className","_uid","guid","intersectsMerged","plain","destination","originActiveCell","rowDelta","colDelta","triggerChange","external","isExternal","_isInternal","contentWindow","write","internalHTML","internalPlain","partition","predicate","looksLikeANumber","getTextHeight","font-size","word-break","white-space","PROPERTIES","complement","skipHiddenRows","skipHiddenCols","add","_normalize","_set","noTrigger","_get","_resizedRef","_border","_collapsedBorder","collapsedBorderTop","collapsedBorderRight","collapsedBorderBottom","collapsedBorderLeft","formula","t1","t2","existingFormat","compile","editorChange","isInEditMode","numberToDate","_","__","toJSON","_validation","_merge","mergedRef","vi","_properties","setProp","line","propName","propValue","clearAll","contentsOnly","formatOnly","clearFormat","isSortable","_sortBy","isFilterable","clearFilters","_filterBy","_filter","propertyName","dr","dc","maxHeight","cellRange","totalWidth","hasValue","flag","draw","CalcError","argmax","compileArgumentChecks","functionName","args","comp","allowError","isArray","arrayArgs","resolve","cond","force","canBeArrayArg","hasArrayArgs","typeCheck","forced","haveForced","forceNum","err","main","Function","roundFloatErrors","maybeRoundFloatErrors","withErrorHandling","makeSyncFunction","check","doit","xargs","Matrix","arrays","makeAsyncFunction","count","makeCallback","defineFunction","func","log","console","kendoSpreadsheetArgs","argsAsync","dateToJulianDays","julianDaysToDate","jd","year","month","date","day","ord","ORDINAL_ADD_DAYS","isLeapYear","yr","daysInYear","daysInMonth","mo","DAYS_IN_MONTH","unpackDate","serial","BASE_DATE","packDate","unpackTime","ms","hours","minutes","seconds","frac","MS_IN_DAY","MS_IN_HOUR","MS_IN_MIN","milliseconds","serialToDate","t","packTime","hh","mm","ss","dateToSerial","time","getHours","getMinutes","getSeconds","getMilliseconds","getFullYear","getMonth","getDate","parseDate","binaryCompare","exports","Context","Formula","NUMBER_OR_ZERO","ARGS_NUMERIC","ARGS_ANYVALUE","parent","resolveCells","_resolve","error","asMatrix","onFormula","fetch","context","pending","formulas","getRefCells","cellValues","getRefData","fetchName","nameValue","ValidationFormulaContext","fname","bool","h","isRange","hiddenInfo","includeEmpty","eachRow","eachCol","mapRow","mapCol","transpose","unit","multiply","s","va","vb","adds","sign","determinant","C","L","k","inverse","imax","augment","printer","absrefs","onReady","forceRefs","lcsheet","parentContext","reset","affectedSheet","operation","formulaRow","formulaCol","formulaSheet","formulaMoves","newFormulaRow","newFormulaCol","co","th","comatrix","thmatrix","elmatrix","defineAlias","alias","orig","kendoSpreadsheetAliases","compileValidation","validationHandler","parsedFromDate","parsedToDate","from","dataType","fromIsListValue","TRANSPOSE_FORMAT","DATE_FORMAT","fromIsDateValue","parseFormula","to","toIsDateValue","validationComparers","custom","comparerType","valueToCompare","toValue","to_value","allowNulls","from_value","_getListData","Validation","showButton","tooltipMessageTemplate","tooltipTitleTemplate","messageTemplate","titleTemplate","_formatMessages","fromFormula","toFormula","_setMessages","tooltipTitle","tooltipMessage","cube","_getOptions","compareValue","compareFormat","getValue","calculateFromCallBack","greaterThan","lessThan","between","equalTo","notEqualTo","greaterThanOrEqualTo","lessThanOrEqualTo","notBetween","Selection","Sheet","_activeCell","currentOriginalNavigationRange","expanded","changeActiveCell","_reinit","columnCount","headerHeight","headerWidth","Axis","_frozenRows","_frozenColumns","_suspendChanges","_showGridLines","_gridLinesColor","Grid","_sorter","Sorter","_viewSelection","_editSelection","_formulaSelections","_selectionState","_inEdit","_navigator","_axisManager","_sheetName","accessor","_field","suspendChanges","setDataSource","dataSourceBinder","SheetDataSourceBinder","columnIndex","unhide","hidden","_copyRange","sourceRangeRef","targetRef","nextRefTopLeft","nextRefBottomRight","nextIndex","nextBottomIndex","targetIndex","_adjustReferences","_sheets","_forFormulas","_forValidations","adjustNames","nextRef","isEnabledRow","isEnabledColumn","gridLinesColor","numRows","numColumns","parseReference","forEachFilterHeader","columnRef","startCellIndex","endCellIndex","startResizing","initialPosition","_initialPosition","_resizeInProgress","_autoFillInProgress","_autoFillDest","_autoFillPunch","_autoFillHint","_autoFillDirection","autoFillRef","autoFillPunch","autoFillInProgress","resizingInProgress","completeResizing","hintPosition","handlePosition","resizeHintPosition","resizeHandlePosition","_resizeHandlePosition","location","_resizeHintPosition","removeResizeHandle","positionResizeHandle","_selectionInProgress","operatingRange","selectionInProgress","expandedRef","selectionState","isAxis","trim","trims","activeCellSelection","selectedHeaders","allCols","allRows","maxRow","maxCol","rowSelection","colSelection","rowState","colState","isInEdit","_setFormulaSelections","_viewActiveCell","json","positions","viewSelection","hyperlinks","parseColor","toCss","_sort","activeCellRef","_compileFormula","_compileValidation","Filter","_refreshFilter","_refresh","cellRefIndex","resetFormulas","resetValidations","next","revalidate","cellRef","_copyValuesInRange","suspended","sortBy","prepare","matches","filterColumn","filterRef","_clearFilter","ALL_REASONS","currentRef","outerWidth","DOT","EMPTYCHAR","sheetsBarClassNames","SheetsBar","_outerWidth","sheetsBarWrapper","sheetsBarSheetsWrapper","sheetsBarActive","sheetsBarInactive","sheetsBarAdd","sheetsBarRemove","sheetsBarItems","sheetsBarEditor","sheetsBarScrollable","sheetsBarNext","sheetsBarPrev","sheetsBarKItem","sheetsBarKActive","sheetsBarKTextbox","sheetsBarKLink","sheetsBarKIcon","sheetsBarKFontIcon","sheetsBarKButton","sheetsBarKButtonBare","sheetsBarKArrowW","sheetsBarKArrowE","sheetsBarKReset","sheetsBarKIconX","sheetsBarKSprite","sheetsBarKIconPlus","sheetsBarHintWrapper","sheetsBarKResetItems","_tree","dom","Tree","render","_addButton","_createSheetsWrapper","_toggleScrollEvents","_createSortable","_sortable","_onSheetReorderStart","_onSheetReorderEnd","_onSheetRemove","_onSheetSelect","_createEditor","_onAddSelect","scrollable","_editor","_renderSheets","_selectedIndex","_onEditorKeydown","_onEditorBlur","_destroyEditor","canceled","_onSheetRename","renderSheets","sheets","selectedIndex","wrapperOffsetWidth","sheetsGroupScrollWidth","sheetsWrapper","scrollPrevButton","scrollNextButton","gapWidth","addButton","addButtonWidth","scrollPrevButtonWidth","sheetsGroup","scrollNextButtonRight","_isRtl","isRtl","_renderHtml","_scrollableAllowed","_sheetsWrapper","children","_sheetsGroup","marginLeft","scrollWidth","ceil","parseFloat","_scrollableModeActive","_nowScrollingSheets","marginRight","_toggleScrollButtons","ul","scrollLeft","_scrollSheetsByDelta","renderScrollButtons","isSelectedSheet","elementContent","deleteIcon","sheetElements","maxlength","baseButtonClass","childrenElements","Sortable","container","animation","ignore","draggable","closest","oldIndex","newIndex","removedSheetName","selectedSheetText","_scrollSheetsToItem","isAddButton","sheetIndex","item","currentScrollOffset","itemWidth","itemOffset","sheetsGroupWidth","sheetsGroupPadding","itemPosition","finish","animate","scrLeft","getcol","getrow","noThrow","stream","OUT","TokenStream","addReference","allowEOF","peek","parseExpression","commas","maybeBinary","maybeIntersect","parseAtom","parseSymbol","upper","TRUE","FALSE","parseFuncall","fixReference","exp","parseArray","op","maybePercent","my_prec","his_prec","OPERATORS","ast","parseNameDefinition","def","defAST","nameRef","makeFormula","makePrinter","prec","withParens","needParens","parenthesize","arg","makeClosure","toCPS","cps","cpsRef","cpsAtom","cpsUnary","cpsBinary","cpsFunc","cpsLambda","cpsMatrix","cpsNameRef","makeContinuation","cpsIf","thenK","gensym","elseK","vars","cpsAnd","cpsOr","cont","elements","isMatrix","GENSYM","js","jsArray","FORMULA_CACHE","identity","readNext","ahead","refRange3D","refCell3D","refSheetRange","refSheetCell","refRange","refCell","funcall","isFirst","forEditor","fixCell","g","space","addPos","RawTokenStream","InputStream","startToken","endToken","isIdStart","isId","isOpChar","isPunc","readNumber","has_dot","number","symbol","getRC","negative","readSymbol","lookingAt","readString","readEscaped","readSheetName","readOperator","readPunc","EOF","forward","escaped","rx","getNumberRegexp","comma","dot","NUMBER_FORMAT_RX","repeat","FORMAT_PARSERS","registerFormatParser","ops","numberFormat","currency","rxnum","rxcur","suffix","has_currency","readExcel","deferred","reader","FileReader","onload","zip","JSZip","readWorkbook","readAsArrayBuffer","xl","progress","loading","strings","readStrings","relationships","readRelationships","theme","readTheme","byType","readStyles","items","enter","tag","relId","dim","SEL_SHEET","byId","sheetDimensions","SEL_VIEW","activeTab","integer","localSheetId","SEL_DEFINED_NAME","vbProcedure","Deferred","notify","recalcSheets","loadSheets","ready","promise","insertSheet","queueSheet","readSheet","defaultColWidth","toColWidth","defaultRowHeight","toRowHeight","SEL_ROW","maximumDigitWidth","fraction","pts","formulaRange","nCols","prevCellRef","relsFile","styleIndex","stop","acRef","SEL_CELL","applyStyle","SEL_MERGE","SEL_COL","ht","SEL_SELECTION","SEL_PANE","xSplit","ySplit","SEL_SHEET_VIEW","SEL_HYPERLINK","leave","SEL_VALUE","SEL_STRING","SEL_FORMULA","setFormat","formatCode","setFill","setFont","fontFamily","setBorder","side","prop","BORDER_WIDTHS","shouldSet","applyName","xf","base","inlineStyles","xfId","namedStyles","fills","numFmts","DEFAULT_FORMATS","part","files","asUint8Array","SEL_SHARED_STRING","SEL_TEXT","entries","Id","Target","Type","getXf","addBool","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","getColor","themeColor","tint","rgb","toCSSColor","indexed","INDEXED_COLORS","colorScheme","toHSL","toCssRgba","fill","closed","SEL_NUM_FMT","SEL_FONT","SEL_FILL","patternType","SEL_BORDER","SEL_NAMED_STYLE","SEL_INLINE_STYLE","horizontal","vertical","wrapText","swap","scheme","SEL_SCHEME_SYSCLR","SEL_SCHEME_RGBCLR","none","thin","medium","dashed","dotted","thick","double","hair","mediumDashed","dashDot","mediumDashDot","dashDotDot","mediumDashDotDot","slantDashDot","0","11","12","14","15","16","17","18","19","21","22","45","47","48","49","_readSheet","_readStrings","_readStyles","_readTheme","_readWorkbook","sheetParamsFromJSON","or","Workbook","_sheetsSearchCache","undoRedoStack","_onUndoRedo","_context","FormulaContext","_validationContext","_names","unbind","_sheetChange","_sheetCommandRequest","_inputForRef","execute","commandOptions","editActiveCell","refresh","sheetByName","moveSheetToIndex","toIndex","fromIndex","sheetSelection","insertIndex","sheetName","getUniqueSheetName","sheetNameSuffix","sheetByIndex","forEachName","nameref","removeSheet","newSheet","_clearSheets","names","localName","reject","excel","ooxml","saveAs","dataURI","toDataURL","proxyURL","forceProxy","group","nameForRef","PDFMixin","_drawPDF","exportPDF","proxyTarget","fail","area","fsheet","frow","fcol","states","currentFormula","_formulaContextRefresh","toActionSelector","selectors","alphaNumRegExp","ACTIONS","ENTRY_ACTIONS","CONTAINER_EVENTS","CLIPBOARD_EVENTS","EDITOR_EVENTS","FORMULABAR_EVENTS","FORMULAINPUT_EVENTS","SELECTION_MODES","COMPOSITE_UNAVAILABLE_ACTION_SELECTORS","UNHIDE_ACTION_SELECTORS","ACTION_KEYS","SHIFT_ACTION_KEYS","ENTRY_ACTION_KEYS","Controller","up","down","ctrl+left","ctrl+right","ctrl+up","ctrl+down","ctrl+home","ctrl+end","pageup","pagedown","tab","shift+tab","shift+enter","delete","backspace","shift+:alphanum",":alphanum","ctrl+:alphanum","alt+ctrl+:alphanum",":edit","wheel","*+mousedown","contextmenu","*+mousedrag","*+mouseup","*+dblclick","mousemove","*+pageup","*+pagedown","mouseup","*+cut","*+paste","*+copy","esc","alt+enter","rowheader","columnheader","topcorner","autofill","clipboardElement","cellContextMenu","rowHeaderContextMenu","colHeaderContextMenu","scroller","tabstrip","sheetsbar","nameEditor","onNameEditorEnter","onNameEditorCancel","onNameEditorSelect","onNameEditorDelete","editor","onEditorChange","onEditorActivate","onEditorDeactivate","onEditorUpdate","onScroll","listener","_enableEditorEvents","onSheetBarSelect","onSheetBarReorder","onSheetBarRename","onSheetBarRemove","onContextMenuSelect","onCommandRequest","onDialogRequest","keyListener","barKeyListener","barElement","inputKeyListener","cellElement","_execute","closeHandler","editorClose","enableEditor","_lastCommandRequest","showError","openDialog","_activeTooltip","clientHeight","isEditorDisabled","onWheel","deltaX","deltaY","deltaMode","scrollWith","onAction","onPageUp","scrollDown","onPageDown","onEntryAction","shouldPrevent","disabled","rect","activeCellRectangle","onShiftAction","appendSelection","onMouseMove","objectAt","onMouseDown","pane","originFrame","onEditorEsc","openCustomEditor","_selectionMode","deactivate","openFilterMenu","onContextMenu","menu","isComposite","showUnhide","showUnmerge","prevent","constrainResize","resizeHandle","onMouseDrag","frame","startAutoScroll","selectToLocation","scrollTop","onMouseUp","stopAutoScroll","activeEditor","onDblClick","onCut","detach","clipBoardValue","onPaste","hasHTML","hasPlainText","DOMStringList","types","onCopy","scrollRight","offset","coordinates","cellLocation","lastKnownCellLocation","autoScroll","_autoScrollTarget","boundaries","scrollStep","finalLocation","viewObject","_scrollInterval","setInterval","clearInterval","filterMenu","createFilterMenu","openFor","onEditorBarFocus","onEditorCellFocus","resetEditorValue","onEditorBlur","isFiltered","onEditorAction","onEditorShiftAction","deactivateEditor","viewEditor","isEditorDeactivateBound","one","focusLastActive","enableClipboard","executeRequest","executeCommand","executeDialog","additionalOptions","pdfExport","excelExport","selectElementContents","selectNodeContents","cellBefore","trs","cellAbove","prevRow","cellBorder","asURL","drawCell","collection","hBorders","vBorders","showGrid","maybeLink","textDecoration","href","defaultBorder","shouldDrawCell","toHSV","backgroundColor","fontStyle","fontWeight","wordBreak","__dataType","paneClassNames","addCell","sibling","borderRightColor","borderBottomColor","borderLeftColor","borderTopColor","within","RESIZE_HANDLE_WIDTH","viewClassNames","HtmlTable","CELL_CONTEXT_MENU","ROW_HEADER_CONTEXT_MENU","COL_HEADER_CONTEXT_MENU","VIEW_CONTENTS","View","fixedContainer","editContainer","viewSize","cellEditor","barEditor","topCorner","filterHeadersWrapper","filterRange","filterButton","filterButtonActive","horizontalResize","verticalResize","icon","iconFilterDefault","sheetsBar","messages","errors","openUnsupported","shiftingNonblankCells","filterRangeContainingMerges","sortRangeContainingMerges","validationError","cannotModifyDisabled","tabs","_height","_width","addColumn","addRow","Node","toDomTree","ContextMenu","contextMenuConfig","scrollbar","_chrome","_dialogs","_formulaInput","clipboardContents","SheetEditor","_sheetsbar","showOn","clientWidth","isClipboardDeactivated","_resize","outerHeight","_outerHeight","tabstripHeight","formulaBarHeight","formulaBar","sheetsBarHeight","quickAccessAdjust","prependTo","NameEditor","toolbar","_tabstrip","content","TabStrip","dataTextField","dataContentField","toolbarOptions","_executeCommand","cellRectangle","_rectangle","boundingRectangle","isColumnResizer","handleWidth","_headerWidth","isRowResizer","_headerHeight","isFilterIcon","theGrid","frozen","filterIconRect","isAutoFill","isEditButton","ed","activeCellCustomEditor","selecting","paneAt","containingPane","refreshTools","totalHeight","_pane","_destroyFilterMenu","_filterMenu","FilterMenu","selectClipBoardContents","scrollIntoView","willScroll","scrollBoundaries","scrollBottom","_destroyDialog","edit","dialog","dialogs","dialogOptions","errorMessages","registered","sender","_filterMenuColumn","resizeDirection","renderResizeHint","renderClipboardContents","resizeHint","resizeHintVertical","resizeHintHandle","resizeHintMarker","selectionView","primaryMergedCells","secondaryMergedCells","rangeDimensions","mergedCell","vaxis","haxis","rowHeader","columnHeader","mergedCellsWrapper","selectionWrapper","autoFillWrapper","columnResizeHandle","rowResizeHandle","selectionHighlight","isVisible","paneClasses","_currentView","_currentRect","_selectedHeaders","renderData","renderSelection","renderAutoFill","renderEditorSelection","renderFilterHeaders","hasRowHeader","rowOffset","headerClassName","hasColumnHeader","columnOffset","renderResizeHandle","itemSelection","allHeaders","doLayout","forScreen","xCoords","borderColor","yCoords","hb","BUTTON_SIZE","BUTTON_OFFSET","Rectangle","filtered","classes","_addDiv","selections","activeCellClasses","selectionClasses","activeFormulaColor","_activeFormulaColor","_directionClasses","_addTable","cssClass","autoFillRectangle","toDiv","btn","activeFormulaSelection","colorClasses","cellClasses","mergedCellLeft","mergedCellTop","EDITORS","registerEditor","kendoCalendar","kendoPopup","getKendoCalendar","getKendoPopup","setOptions","Calendar","disableDates","kendoStaticList","getKendoStaticList","matrix","read","PaneGrid","sum","total","PaneAxis","rangeRef","headerSize","hasHeader","paneSegment","_viewSize","widthCompensation","heightCompensation","_hidden","scrollBarSize","pageSize","firstHidden","lastHidden","startIndex","endIndex","startSegment","endSegment","lastPage","_pixelValues","_axis","_start","quarter","sameYear","today","setFullYear","sameMonth","firstDayOfMonth","setMonth","sameWeek","firstWeek","secondWeek","dayOfWeek","constructor","_values","_dates","_blanks","blanks","dates","_logic","logic","criteria","_criteria","expression","Query","filterExpr","filters","_matches","criterionValue","criterionType","valueType","TopFilter","DynamicFilter","_predicate","_average","aboveAverage","belowAverage","tomorrow","addDays","isToday","yesterday","nextWeek","thisWeek","lastWeek","nextMonth","thisMonth","lastMonth","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear","yearToDate","cultures","months","_lists","ascendingComparer","descendingComparer","li","typeA","typeB","localeCompare","maybeColor","RX_COLORS","maybeCondition","RX_CONDITION","readFormat","maybeFraction","sep","decimal","decimalPart","am","pm","readSection","sections","haveConditional","sec","printSection","printToken","fmt","padLeft","adjusted","restart","compileFormatPart","checkComma","scaleCount","hasDate","hasTime","hasAmpm","percentCount","separeThousands","declen","intFormat","decFormat","condition","preamble","CACHE","TEXT","calendars","standard","days","namesAbbr","ampm","fraclen","toFixed","eltime","formatInt","iv","chf","formatDec","span","textAndColor","_cosh","_sinh","_tanh","_gcd","_lcm","forIFS","chunks","parseCriteria","COL","_avg","numbers","_var_sp","divisor","avg","_stdev_sp","_percentrank","exc","nlt","ngt","found","_covariance","ax","ay","_percentile","rank","_percentile_inc","_percentile_exc","fetchValuesForAggregate","opt_ignore_hidden_rows","opt_ignore_errors","opt_use_aggregates","fetchValues","_binom_dist","cumulative","_combinations","weeksInYear","_days_360","d1","d2","Hyperlink","numericPredicate","descending","ARGS_COUNTIFS","ARGS_SUMIFS","ARGS_SUMIF","ARGS_PERCENTRANK","_fact","AGGREGATE_FUNCS","RX_NON_PRINTABLE","cos","sin","atan","tan","mult","prod","coef","seen","m1","sumRange","nth","res","discard","bins","asc","variance","stddev","significance","fact","f1","f2","p1","p2","funcId","ignoreHidden","alpha","s2","approx","resultCol","areanum","colRange","resultRow","fw","sy","dow","wk","holidays","inc","random","rom","radix","minLen","dec","noCommas","newText","oldText","valueIfError","makeComparator","lc","compLT","compLTE","compGT","compGTE","compNE","compEQ","RXCACHE","ERF","S","an","f_abs","ERFC","GAMMALN","cof","ser","GAMMA","pi","BETALN","BETA","gamma_inc","g_series","g_contfrac","ap","gln","MAX_IT","EPS","FP_MIN","aj","bj","GAMMA_DIST","GAMMA_INV","M","ab","q","NORM_S_DIST","NORM_S_INV","plow","phigh","NORM_DIST","NORM_INV","betastd_pdf","betastd_cdf","beta_lentz","m2","del","qab","qap","qam","betastd_inv","BETADIST","BETA_DIST","cdf","BETA_INV","chisq_left","cds","chisq_right","chisq_left_inv","chisq_right_inv","chisq_test","obsv","expect","eij","expon","poisson","lnf","Fdist","Fdist_right","Finv_right","Finv","_mean","me","_var_sq","Ftest","arr1","arr2","n1","n2","va1","va2","fisher","fisherinv","e2","Tdist","Tdist_right","Tdist_2tail","Tdist_inv","Tdist_2tail_inv","Tdist_test","gr1","gr2","tail","t_st","df","md","v1","v2","u1","u2","q1","q2","confidence_t","confidence_norm","gauss","z","phi","lognorm_dist","lognorm_inv","prob","x_","p_","lw","slope","y_","mx","my","b1","b2","intercept","pearson","s1","s3","rsq","steyx","forecast","_mat_mean","Mat","_mat_devsq","mean","sq","linest","Y","X","konst","stats","Xt","B","line_1","Y1","y_y1","mp","SSreg","SSresid","line_5","R2","degfre","err_est","line_3","F_sta","line_4","SCP","line_2","logest","trend","W","growth","new_X","root_newton","guess","max_it","eps","f_d","FV","rate","nper","pmt","pv","h1","h2","PV","fv","PMT","NPER","RATE","xfd","IPMT","per","ipmt","PPMT","CUMPRINC","tn","ts","te","monthlyPayment","remainingBalanceAtStart","remainingBalanceAtEnd","CUMIPMT","cip","NPV","flows","npv","IRR","npv1","EFFECT","nominal_rate","npery","NOMINAL","effect_rate","XNPV","XIRR","ISPMT","DB","cost","salvage","life","period","db","DDB","factor","prior","dep","SLN","SYD","VDB","no_switch","_getGDA","gda","oldValue","interest","_interVDB","life1","term","remValue","intEnd","lia","vdb","nowLia","intStart","_edate","_daysBetween","basis","_borderCoupons","settlement","maturity","freq","sett","periods","_borderCoupons_fw","COUPDAYBS","frequency","COUPDAYS","settl","matur","COUPDAYSNC","COUPPCD","COUPNCD","COUPNUM","mat","ACCRINTM","issue","par","year_days","ACCRINT","_numCoupons","annual","brace","prev1","next1","nrc","accr","DISC","pr","redemption","INTRATE","investment","RECEIVED","discount","PRICE","yld","N","beg_settl","settl_end","beg_end","den","yf","PRICEDISC","dsm","COUPS_ARGS","ll","ac","withPreventDefault","BORDER_TYPES","BORDER_PALETTE_MESSAGES","ColorChooser","BorderPalette","borderPalette","customColor","cancel","_resetButton","_colorPalette","_customColorPalette","_customColorButton","resetButton","resetColor","customColorButton","colorPalette","flatColorPicker","_change","class","kendoColorPalette","palette","viewModel","kendoWindow","resizable","maximizable","modal","center","_hueSlider","kendoFlatColorPicker","observable","_borderTypePalette","_borderColorPalette","_click","colorChooser","buttons","_colorChange","currentTarget","ToolBar","MESSAGES","defaultTools","toolDefaults","SpreadsheetToolBar","DropDownTool","PopupTool","OverflowDialogButton","ColorPicker","ColorPickerButton","FONT_SIZES","DEFAULT_FONT_SIZE","FontSize","FontSizeButton","FONT_FAMILIES","DEFAULT_FONT_FAMILY","FontFamily","FontFamilyButton","defaultFormats","Format","FormatButton","BorderChangeTool","BorderChangeButton","AlignmentTool","AlignmentButton","MergeTool","MergeButton","FreezeTool","FreezeButton","Sort","SortButton","FilterButton","Open","alignment","alignmentButtons","justtifyLeft","justifyCenter","justifyRight","justifyFull","alignTop","alignMiddle","alignBottom","colorPicker","formatTypes","automatic","percent","financial","dateTime","duration","moreFormats","formatDecreaseDecimal","formatIncreaseDecimal","freeze","freezeButtons","freezePanes","freezeRows","freezeColumns","mergeButtons","mergeCells","mergeHorizontally","mergeVertically","quickAccess","exportAs","toggleGridlines","sortAsc","sortDesc","sortButtons","sortSheetAsc","sortSheetDesc","sortRangeAsc","sortRangeDesc","textColor","textWrap","hyperlink","iconClass","dialogName","togglable","separator","formatCells","_expandTools","tools","toolbarName","handleClick","_addSeparators","click","groups","before","expandTool","toolName","isPlainObject","spriteCssClass","typeDefaults","splitButton","showText","toolIcon","tool","attributes","menuButtons","commandType","checked","setToggle","update","_tools","isFunction","toArray","_getItem","instance","Item","dropDownList","kendoDropDownList","addUidAttr","addOverflowAttr","_open","data-command","data-property","listWidth","ddl","_listWidth","dataItem","popupName","registerComponent","ToolBarButton","_dialogName","OverflowButton","iconName","comboBox","kendoComboBox","_valueChange","clearButton","fontSizes","sizes","defaultSize","fontFamilies","defaultFont","_revertTitle","dataValuePrimitive","valueTemplate","sample","_borderPalette","_action","_commandPalette","removeClass","_title","_reset","_quickAccessButtons","toolbars","contentElements","_toolbar","quickAccessToolBar","hasOwnProperty","buttonTemplate","insertBefore","tabGroup","formattedValue","uniqueBy","basicErrorDialog","register","MessageDialog","messageId","ObservableObject","registry","SpreadsheetDialog","FormatCellsViewModel","FormatCellsDialog","ValidationErrorDialog","FontFamilyDialog","FontSizeDialog","BordersDialog","ColorPickerDialog","CustomColorDialog","AlignmentDialog","MergeDialog","FreezeDialog","ValidationViewModel","ValidationDialog","ExportAsDialog","UseKeyboardDialog","HyperlinkDialog","retry","revert","okText","formatCellsDialog","categories","fontFamilyDialog","fontSizeDialog","bordersDialog","alignmentDialog","mergeDialog","freezeDialog","validationDialog","hintMessage","hintTitle","any","comparers","comparerMessages","labels","onInvalidData","rejectInput","showWarning","showHint","ignoreBlank","showListButton","showCalendarButton","placeholders","typeTitle","typeMessage","exportAsDialog","fit","saveAsType","exportArea","paperSize","margins","orientation","guidelines","modifyMergedDialog","errorMessage","rangeDisabledDialog","incompatibleRangesDialog","noFillDirectionDialog","duplicateSheetNameDialog","overflowDialog","useKeyboardDialog","forCopy","forCut","forPaste","unsupportedSelectionDialog","linkDialog","url","removeLink","dialogClass","autoFocus","_dialog","_onDialogClose","_onDialogActivate","_onDialogDeactivate","useCategory","category","formatCurrency","currencies","allFormats","useFirstFormat","info","_currency","iso","convert","categoryFilter","pattern","abbr","defaultOptions","_generateFormats","calendarPatterns","currenciesFrom","numberFormats","dateFormats","currencyFilter","roleSelector","description","getter","_list","_colorPicker","ValidationCellsViewModel","criterion","setHintMessageTemplate","shouldBuild","buildMessages","hintTitleTemplate","hintMessageTemplate","setComparers","defaultHintTitle","text_comparers","defaultComparers","defaultHintMessage","isAny","showToForNumber","showTo","showToForDate","isDate","isText","isList","isCustom","showRemove","fromValidationObject","useCustomMessages","toValidationObject","errorTemplate","validatable","Validator","validateOnBlur","validate","fileFormats","author","subject","keywords","creator","fitWidth","areas","paperSizes","margin","landscape","hCenter","vCenter","model","stopPropagation","o","_normalizeColumns","_dataSource","_header","_boundRowsCount","_sheetChangeHandler","_sheetDeleteRowHandler","_sheetDeleteRow","_sheetInsertRowHandler","_sheetInsertRow","fields","getters","_skipRebind","record","valueIndex","colValueIndex","_changeHandler","getterIdx","distinctValues","query","itemVisible","anyVisibleChildren","hasVisibleChildren","HierarchicalDataSource","uncheckAll","hasChildren","flattenOperators","operators","FILTERMENU_MESSAGES","Details","templates","FilterMenuViewModel","FilterMenuController","details","detailsSummary","detailsContent","iconCollapse","iconExpand","iconSearch","textbox","filterByCondition","filterByValue","valuesTreeViewWrapper","actionButtons","_summary","_toggle","_icon","_container","fx","expand","sortAscending","sortDescending","search","addToCurrent","operatorNone","and","doesnotcontain","startswith","endswith","neq","gte","lte","binders","spreadsheetFilterValue","Binder","bindings","proxy","widget","binding","menuItem","valuesChange","valuesDataSource","lastIndexOf","appendToSearch","valueSelect","hasActiveSearch","filterValues","operatorChange","isNone","isString","valuesTree","filterType","topValue","filterForColumn","allFilters","columnFilters","_filterInit","_filterByCondition","_filterByValue","_actionButtons","valuesTreeView","_active","activeFilter","copyAnchorStyles","dir","kendoMenu","_appendTemplate","compiledTemplate","_detailToggle","not","isExpanded","activeContainer","hasClass","notEqual","oldRect","newRect","barInput","cellInput","_triggerUpdate","lastActive","activeElement","_rect","inputType","linearRegression","findSeries","findStep","forEachSeries","formatType","getType","lst","findStringList","stringLists","strl","ERR_INCOMPATIBLE","ERR_NO_DIRECTION","srcRange","src","srcIdx","destRange","CLASS_NAMES","transport","success","combo","ignoreCase","_on_listChange","noDataTemplate","getKendoComboBox","_on_keyDown","_on_focus","_deleteItem","_prevValue","distributeCoords","heights","pageHeight","curr","getMergedCells","primary","secondary","pageWidth","scaleFactor","boxWidth","boxHeight","rowHeights","colWidths","nonEmpty","relrow","relcol","rh","cw","emptyCells","orlast","normalOrder","drawLayout","addPage","page","endbottom","endright","Group","clip","Path","fromRect","geo","Rect","multiplyCopy","translate","transform","moveTo","lineTo","stroke","GUIDELINE_WIDTH","ncols","nrows","r2d2","drawText","vtrans","rect_left","rect_top","rect_width","rect_height","makeFontDef","lines","text_height","paraBreak","Text","htrans","text_width","path","lineBreak","eol","sub","paper","getPaperOptions","multiPage","geometry","NS","Spreadsheet","_controller","_autoRefresh","_bindWorkbookEvents","_resizeHandler","_workbookChange","_workbookCut","_workbookCopy","_workbookPaste","autoRefresh","blob","_workbookExcelExport","_workbookExcelImport","_initProgress","pb","kendoProgressBar","chunkCount","always","_workbookPdfExport","plugin"],"mappings":"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","file":"kendo.spreadsheet.min.js","sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function (f, define) {\n    define('util/undoredostack', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var UndoRedoStack = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.clear();\n            },\n            events: [\n                'undo',\n                'redo'\n            ],\n            push: function (command) {\n                this.stack = this.stack.slice(0, this.currentCommandIndex + 1);\n                this.currentCommandIndex = this.stack.push(command) - 1;\n            },\n            undo: function () {\n                if (this.canUndo()) {\n                    var command = this.stack[this.currentCommandIndex--];\n                    command.undo();\n                    this.trigger('undo', { command: command });\n                }\n            },\n            redo: function () {\n                if (this.canRedo()) {\n                    var command = this.stack[++this.currentCommandIndex];\n                    command.redo();\n                    this.trigger('redo', { command: command });\n                }\n            },\n            clear: function () {\n                this.stack = [];\n                this.currentCommandIndex = -1;\n            },\n            canUndo: function () {\n                return this.currentCommandIndex >= 0;\n            },\n            canRedo: function () {\n                return this.currentCommandIndex != this.stack.length - 1;\n            }\n        });\n        kendo.deepExtend(kendo, { util: { UndoRedoStack: UndoRedoStack } });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/main', ['kendo.core'], f);\n}(function () {\n    (function () {\n        var math = Math, kendo = window.kendo, deepExtend = kendo.deepExtend;\n        var DEG_TO_RAD = math.PI / 180, MAX_NUM = Number.MAX_VALUE, MIN_NUM = -Number.MAX_VALUE, UNDEFINED = 'undefined';\n        function defined(value) {\n            return typeof value !== UNDEFINED;\n        }\n        function round(value, precision) {\n            var power = pow(precision);\n            return math.round(value * power) / power;\n        }\n        function pow(p) {\n            if (p) {\n                return math.pow(10, p);\n            } else {\n                return 1;\n            }\n        }\n        function limitValue(value, min, max) {\n            return math.max(math.min(value, max), min);\n        }\n        function rad(degrees) {\n            return degrees * DEG_TO_RAD;\n        }\n        function deg(radians) {\n            return radians / DEG_TO_RAD;\n        }\n        function isNumber(val) {\n            return typeof val === 'number' && !isNaN(val);\n        }\n        function valueOrDefault(value, defaultValue) {\n            return defined(value) ? value : defaultValue;\n        }\n        function sqr(value) {\n            return value * value;\n        }\n        function objectKey(object) {\n            var parts = [];\n            for (var key in object) {\n                parts.push(key + object[key]);\n            }\n            return parts.sort().join('');\n        }\n        function hashKey(str) {\n            var hash = 2166136261;\n            for (var i = 0; i < str.length; ++i) {\n                hash += (hash << 1) + (hash << 4) + (hash << 7) + (hash << 8) + (hash << 24);\n                hash ^= str.charCodeAt(i);\n            }\n            return hash >>> 0;\n        }\n        function hashObject(object) {\n            return hashKey(objectKey(object));\n        }\n        var now = Date.now;\n        if (!now) {\n            now = function () {\n                return new Date().getTime();\n            };\n        }\n        function arrayLimits(arr) {\n            var length = arr.length, i, min = MAX_NUM, max = MIN_NUM;\n            for (i = 0; i < length; i++) {\n                max = math.max(max, arr[i]);\n                min = math.min(min, arr[i]);\n            }\n            return {\n                min: min,\n                max: max\n            };\n        }\n        function arrayMin(arr) {\n            return arrayLimits(arr).min;\n        }\n        function arrayMax(arr) {\n            return arrayLimits(arr).max;\n        }\n        function sparseArrayMin(arr) {\n            return sparseArrayLimits(arr).min;\n        }\n        function sparseArrayMax(arr) {\n            return sparseArrayLimits(arr).max;\n        }\n        function sparseArrayLimits(arr) {\n            var min = MAX_NUM, max = MIN_NUM;\n            for (var i = 0, length = arr.length; i < length; i++) {\n                var n = arr[i];\n                if (n !== null && isFinite(n)) {\n                    min = math.min(min, n);\n                    max = math.max(max, n);\n                }\n            }\n            return {\n                min: min === MAX_NUM ? undefined : min,\n                max: max === MIN_NUM ? undefined : max\n            };\n        }\n        function last(array) {\n            if (array) {\n                return array[array.length - 1];\n            }\n        }\n        function append(first, second) {\n            first.push.apply(first, second);\n            return first;\n        }\n        function renderTemplate(text) {\n            return kendo.template(text, {\n                useWithBlock: false,\n                paramName: 'd'\n            });\n        }\n        function renderAttr(name, value) {\n            return defined(value) && value !== null ? ' ' + name + '=\\'' + value + '\\' ' : '';\n        }\n        function renderAllAttr(attrs) {\n            var output = '';\n            for (var i = 0; i < attrs.length; i++) {\n                output += renderAttr(attrs[i][0], attrs[i][1]);\n            }\n            return output;\n        }\n        function renderStyle(attrs) {\n            var output = '';\n            for (var i = 0; i < attrs.length; i++) {\n                var value = attrs[i][1];\n                if (defined(value)) {\n                    output += attrs[i][0] + ':' + value + ';';\n                }\n            }\n            if (output !== '') {\n                return output;\n            }\n        }\n        function renderSize(size) {\n            if (typeof size !== 'string') {\n                size += 'px';\n            }\n            return size;\n        }\n        function renderPos(pos) {\n            var result = [];\n            if (pos) {\n                var parts = kendo.toHyphens(pos).split('-');\n                for (var i = 0; i < parts.length; i++) {\n                    result.push('k-pos-' + parts[i]);\n                }\n            }\n            return result.join(' ');\n        }\n        function isTransparent(color) {\n            return color === '' || color === null || color === 'none' || color === 'transparent' || !defined(color);\n        }\n        function arabicToRoman(n) {\n            var literals = {\n                1: 'i',\n                10: 'x',\n                100: 'c',\n                2: 'ii',\n                20: 'xx',\n                200: 'cc',\n                3: 'iii',\n                30: 'xxx',\n                300: 'ccc',\n                4: 'iv',\n                40: 'xl',\n                400: 'cd',\n                5: 'v',\n                50: 'l',\n                500: 'd',\n                6: 'vi',\n                60: 'lx',\n                600: 'dc',\n                7: 'vii',\n                70: 'lxx',\n                700: 'dcc',\n                8: 'viii',\n                80: 'lxxx',\n                800: 'dccc',\n                9: 'ix',\n                90: 'xc',\n                900: 'cm',\n                1000: 'm'\n            };\n            var values = [\n                1000,\n                900,\n                800,\n                700,\n                600,\n                500,\n                400,\n                300,\n                200,\n                100,\n                90,\n                80,\n                70,\n                60,\n                50,\n                40,\n                30,\n                20,\n                10,\n                9,\n                8,\n                7,\n                6,\n                5,\n                4,\n                3,\n                2,\n                1\n            ];\n            var roman = '';\n            while (n > 0) {\n                if (n < values[0]) {\n                    values.shift();\n                } else {\n                    roman += literals[values[0]];\n                    n -= values[0];\n                }\n            }\n            return roman;\n        }\n        function romanToArabic(r) {\n            r = r.toLowerCase();\n            var digits = {\n                i: 1,\n                v: 5,\n                x: 10,\n                l: 50,\n                c: 100,\n                d: 500,\n                m: 1000\n            };\n            var value = 0, prev = 0;\n            for (var i = 0; i < r.length; ++i) {\n                var v = digits[r.charAt(i)];\n                if (!v) {\n                    return null;\n                }\n                value += v;\n                if (v > prev) {\n                    value -= 2 * prev;\n                }\n                prev = v;\n            }\n            return value;\n        }\n        function memoize(f) {\n            var cache = Object.create(null);\n            return function () {\n                var id = '';\n                for (var i = arguments.length; --i >= 0;) {\n                    id += ':' + arguments[i];\n                }\n                return id in cache ? cache[id] : cache[id] = f.apply(this, arguments);\n            };\n        }\n        function ucs2decode(string) {\n            var output = [], counter = 0, length = string.length, value, extra;\n            while (counter < length) {\n                value = string.charCodeAt(counter++);\n                if (value >= 55296 && value <= 56319 && counter < length) {\n                    extra = string.charCodeAt(counter++);\n                    if ((extra & 64512) == 56320) {\n                        output.push(((value & 1023) << 10) + (extra & 1023) + 65536);\n                    } else {\n                        output.push(value);\n                        counter--;\n                    }\n                } else {\n                    output.push(value);\n                }\n            }\n            return output;\n        }\n        function ucs2encode(array) {\n            return array.map(function (value) {\n                var output = '';\n                if (value > 65535) {\n                    value -= 65536;\n                    output += String.fromCharCode(value >>> 10 & 1023 | 55296);\n                    value = 56320 | value & 1023;\n                }\n                output += String.fromCharCode(value);\n                return output;\n            }).join('');\n        }\n        function mergeSort(a, cmp) {\n            if (a.length < 2) {\n                return a.slice();\n            }\n            function merge(a, b) {\n                var r = [], ai = 0, bi = 0, i = 0;\n                while (ai < a.length && bi < b.length) {\n                    if (cmp(a[ai], b[bi]) <= 0) {\n                        r[i++] = a[ai++];\n                    } else {\n                        r[i++] = b[bi++];\n                    }\n                }\n                if (ai < a.length) {\n                    r.push.apply(r, a.slice(ai));\n                }\n                if (bi < b.length) {\n                    r.push.apply(r, b.slice(bi));\n                }\n                return r;\n            }\n            return function sort(a) {\n                if (a.length <= 1) {\n                    return a;\n                }\n                var m = Math.floor(a.length / 2);\n                var left = a.slice(0, m);\n                var right = a.slice(m);\n                left = sort(left);\n                right = sort(right);\n                return merge(left, right);\n            }(a);\n        }\n        function isUnicodeLetter(ch) {\n            return RX_UNICODE_LETTER.test(ch);\n        }\n        deepExtend(kendo, {\n            util: {\n                MAX_NUM: MAX_NUM,\n                MIN_NUM: MIN_NUM,\n                append: append,\n                arrayLimits: arrayLimits,\n                arrayMin: arrayMin,\n                arrayMax: arrayMax,\n                defined: defined,\n                deg: deg,\n                hashKey: hashKey,\n                hashObject: hashObject,\n                isNumber: isNumber,\n                isTransparent: isTransparent,\n                last: last,\n                limitValue: limitValue,\n                now: now,\n                objectKey: objectKey,\n                round: round,\n                rad: rad,\n                renderAttr: renderAttr,\n                renderAllAttr: renderAllAttr,\n                renderPos: renderPos,\n                renderSize: renderSize,\n                renderStyle: renderStyle,\n                renderTemplate: renderTemplate,\n                sparseArrayLimits: sparseArrayLimits,\n                sparseArrayMin: sparseArrayMin,\n                sparseArrayMax: sparseArrayMax,\n                sqr: sqr,\n                valueOrDefault: valueOrDefault,\n                romanToArabic: romanToArabic,\n                arabicToRoman: arabicToRoman,\n                memoize: memoize,\n                ucs2encode: ucs2encode,\n                ucs2decode: ucs2decode,\n                mergeSort: mergeSort,\n                isUnicodeLetter: isUnicodeLetter\n            }\n        });\n        kendo.drawing.util = kendo.util;\n        kendo.dataviz.util = kendo.util;\n        var RX_UNICODE_LETTER = new RegExp('[\\\\u0041-\\\\u005A\\\\u0061-\\\\u007A\\\\u00AA\\\\u00B5\\\\u00BA\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02C1\\\\u02C6-\\\\u02D1\\\\u02E0-\\\\u02E4\\\\u02EC\\\\u02EE\\\\u0370-\\\\u0374\\\\u0376\\\\u0377\\\\u037A-\\\\u037D\\\\u037F\\\\u0386\\\\u0388-\\\\u038A\\\\u038C\\\\u038E-\\\\u03A1\\\\u03A3-\\\\u03F5\\\\u03F7-\\\\u0481\\\\u048A-\\\\u052F\\\\u0531-\\\\u0556\\\\u0559\\\\u0561-\\\\u0587\\\\u05D0-\\\\u05EA\\\\u05F0-\\\\u05F2\\\\u0620-\\\\u064A\\\\u066E\\\\u066F\\\\u0671-\\\\u06D3\\\\u06D5\\\\u06E5\\\\u06E6\\\\u06EE\\\\u06EF\\\\u06FA-\\\\u06FC\\\\u06FF\\\\u0710\\\\u0712-\\\\u072F\\\\u074D-\\\\u07A5\\\\u07B1\\\\u07CA-\\\\u07EA\\\\u07F4\\\\u07F5\\\\u07FA\\\\u0800-\\\\u0815\\\\u081A\\\\u0824\\\\u0828\\\\u0840-\\\\u0858\\\\u08A0-\\\\u08B2\\\\u0904-\\\\u0939\\\\u093D\\\\u0950\\\\u0958-\\\\u0961\\\\u0971-\\\\u0980\\\\u0985-\\\\u098C\\\\u098F\\\\u0990\\\\u0993-\\\\u09A8\\\\u09AA-\\\\u09B0\\\\u09B2\\\\u09B6-\\\\u09B9\\\\u09BD\\\\u09CE\\\\u09DC\\\\u09DD\\\\u09DF-\\\\u09E1\\\\u09F0\\\\u09F1\\\\u0A05-\\\\u0A0A\\\\u0A0F\\\\u0A10\\\\u0A13-\\\\u0A28\\\\u0A2A-\\\\u0A30\\\\u0A32\\\\u0A33\\\\u0A35\\\\u0A36\\\\u0A38\\\\u0A39\\\\u0A59-\\\\u0A5C\\\\u0A5E\\\\u0A72-\\\\u0A74\\\\u0A85-\\\\u0A8D\\\\u0A8F-\\\\u0A91\\\\u0A93-\\\\u0AA8\\\\u0AAA-\\\\u0AB0\\\\u0AB2\\\\u0AB3\\\\u0AB5-\\\\u0AB9\\\\u0ABD\\\\u0AD0\\\\u0AE0\\\\u0AE1\\\\u0B05-\\\\u0B0C\\\\u0B0F\\\\u0B10\\\\u0B13-\\\\u0B28\\\\u0B2A-\\\\u0B30\\\\u0B32\\\\u0B33\\\\u0B35-\\\\u0B39\\\\u0B3D\\\\u0B5C\\\\u0B5D\\\\u0B5F-\\\\u0B61\\\\u0B71\\\\u0B83\\\\u0B85-\\\\u0B8A\\\\u0B8E-\\\\u0B90\\\\u0B92-\\\\u0B95\\\\u0B99\\\\u0B9A\\\\u0B9C\\\\u0B9E\\\\u0B9F\\\\u0BA3\\\\u0BA4\\\\u0BA8-\\\\u0BAA\\\\u0BAE-\\\\u0BB9\\\\u0BD0\\\\u0C05-\\\\u0C0C\\\\u0C0E-\\\\u0C10\\\\u0C12-\\\\u0C28\\\\u0C2A-\\\\u0C39\\\\u0C3D\\\\u0C58\\\\u0C59\\\\u0C60\\\\u0C61\\\\u0C85-\\\\u0C8C\\\\u0C8E-\\\\u0C90\\\\u0C92-\\\\u0CA8\\\\u0CAA-\\\\u0CB3\\\\u0CB5-\\\\u0CB9\\\\u0CBD\\\\u0CDE\\\\u0CE0\\\\u0CE1\\\\u0CF1\\\\u0CF2\\\\u0D05-\\\\u0D0C\\\\u0D0E-\\\\u0D10\\\\u0D12-\\\\u0D3A\\\\u0D3D\\\\u0D4E\\\\u0D60\\\\u0D61\\\\u0D7A-\\\\u0D7F\\\\u0D85-\\\\u0D96\\\\u0D9A-\\\\u0DB1\\\\u0DB3-\\\\u0DBB\\\\u0DBD\\\\u0DC0-\\\\u0DC6\\\\u0E01-\\\\u0E30\\\\u0E32\\\\u0E33\\\\u0E40-\\\\u0E46\\\\u0E81\\\\u0E82\\\\u0E84\\\\u0E87\\\\u0E88\\\\u0E8A\\\\u0E8D\\\\u0E94-\\\\u0E97\\\\u0E99-\\\\u0E9F\\\\u0EA1-\\\\u0EA3\\\\u0EA5\\\\u0EA7\\\\u0EAA\\\\u0EAB\\\\u0EAD-\\\\u0EB0\\\\u0EB2\\\\u0EB3\\\\u0EBD\\\\u0EC0-\\\\u0EC4\\\\u0EC6\\\\u0EDC-\\\\u0EDF\\\\u0F00\\\\u0F40-\\\\u0F47\\\\u0F49-\\\\u0F6C\\\\u0F88-\\\\u0F8C\\\\u1000-\\\\u102A\\\\u103F\\\\u1050-\\\\u1055\\\\u105A-\\\\u105D\\\\u1061\\\\u1065\\\\u1066\\\\u106E-\\\\u1070\\\\u1075-\\\\u1081\\\\u108E\\\\u10A0-\\\\u10C5\\\\u10C7\\\\u10CD\\\\u10D0-\\\\u10FA\\\\u10FC-\\\\u1248\\\\u124A-\\\\u124D\\\\u1250-\\\\u1256\\\\u1258\\\\u125A-\\\\u125D\\\\u1260-\\\\u1288\\\\u128A-\\\\u128D\\\\u1290-\\\\u12B0\\\\u12B2-\\\\u12B5\\\\u12B8-\\\\u12BE\\\\u12C0\\\\u12C2-\\\\u12C5\\\\u12C8-\\\\u12D6\\\\u12D8-\\\\u1310\\\\u1312-\\\\u1315\\\\u1318-\\\\u135A\\\\u1380-\\\\u138F\\\\u13A0-\\\\u13F4\\\\u1401-\\\\u166C\\\\u166F-\\\\u167F\\\\u1681-\\\\u169A\\\\u16A0-\\\\u16EA\\\\u16EE-\\\\u16F8\\\\u1700-\\\\u170C\\\\u170E-\\\\u1711\\\\u1720-\\\\u1731\\\\u1740-\\\\u1751\\\\u1760-\\\\u176C\\\\u176E-\\\\u1770\\\\u1780-\\\\u17B3\\\\u17D7\\\\u17DC\\\\u1820-\\\\u1877\\\\u1880-\\\\u18A8\\\\u18AA\\\\u18B0-\\\\u18F5\\\\u1900-\\\\u191E\\\\u1950-\\\\u196D\\\\u1970-\\\\u1974\\\\u1980-\\\\u19AB\\\\u19C1-\\\\u19C7\\\\u1A00-\\\\u1A16\\\\u1A20-\\\\u1A54\\\\u1AA7\\\\u1B05-\\\\u1B33\\\\u1B45-\\\\u1B4B\\\\u1B83-\\\\u1BA0\\\\u1BAE\\\\u1BAF\\\\u1BBA-\\\\u1BE5\\\\u1C00-\\\\u1C23\\\\u1C4D-\\\\u1C4F\\\\u1C5A-\\\\u1C7D\\\\u1CE9-\\\\u1CEC\\\\u1CEE-\\\\u1CF1\\\\u1CF5\\\\u1CF6\\\\u1D00-\\\\u1DBF\\\\u1E00-\\\\u1F15\\\\u1F18-\\\\u1F1D\\\\u1F20-\\\\u1F45\\\\u1F48-\\\\u1F4D\\\\u1F50-\\\\u1F57\\\\u1F59\\\\u1F5B\\\\u1F5D\\\\u1F5F-\\\\u1F7D\\\\u1F80-\\\\u1FB4\\\\u1FB6-\\\\u1FBC\\\\u1FBE\\\\u1FC2-\\\\u1FC4\\\\u1FC6-\\\\u1FCC\\\\u1FD0-\\\\u1FD3\\\\u1FD6-\\\\u1FDB\\\\u1FE0-\\\\u1FEC\\\\u1FF2-\\\\u1FF4\\\\u1FF6-\\\\u1FFC\\\\u2071\\\\u207F\\\\u2090-\\\\u209C\\\\u2102\\\\u2107\\\\u210A-\\\\u2113\\\\u2115\\\\u2119-\\\\u211D\\\\u2124\\\\u2126\\\\u2128\\\\u212A-\\\\u212D\\\\u212F-\\\\u2139\\\\u213C-\\\\u213F\\\\u2145-\\\\u2149\\\\u214E\\\\u2160-\\\\u2188\\\\u2C00-\\\\u2C2E\\\\u2C30-\\\\u2C5E\\\\u2C60-\\\\u2CE4\\\\u2CEB-\\\\u2CEE\\\\u2CF2\\\\u2CF3\\\\u2D00-\\\\u2D25\\\\u2D27\\\\u2D2D\\\\u2D30-\\\\u2D67\\\\u2D6F\\\\u2D80-\\\\u2D96\\\\u2DA0-\\\\u2DA6\\\\u2DA8-\\\\u2DAE\\\\u2DB0-\\\\u2DB6\\\\u2DB8-\\\\u2DBE\\\\u2DC0-\\\\u2DC6\\\\u2DC8-\\\\u2DCE\\\\u2DD0-\\\\u2DD6\\\\u2DD8-\\\\u2DDE\\\\u2E2F\\\\u3005-\\\\u3007\\\\u3021-\\\\u3029\\\\u3031-\\\\u3035\\\\u3038-\\\\u303C\\\\u3041-\\\\u3096\\\\u309D-\\\\u309F\\\\u30A1-\\\\u30FA\\\\u30FC-\\\\u30FF\\\\u3105-\\\\u312D\\\\u3131-\\\\u318E\\\\u31A0-\\\\u31BA\\\\u31F0-\\\\u31FF\\\\u3400-\\\\u4DB5\\\\u4E00-\\\\u9FCC\\\\uA000-\\\\uA48C\\\\uA4D0-\\\\uA4FD\\\\uA500-\\\\uA60C\\\\uA610-\\\\uA61F\\\\uA62A\\\\uA62B\\\\uA640-\\\\uA66E\\\\uA67F-\\\\uA69D\\\\uA6A0-\\\\uA6EF\\\\uA717-\\\\uA71F\\\\uA722-\\\\uA788\\\\uA78B-\\\\uA78E\\\\uA790-\\\\uA7AD\\\\uA7B0\\\\uA7B1\\\\uA7F7-\\\\uA801\\\\uA803-\\\\uA805\\\\uA807-\\\\uA80A\\\\uA80C-\\\\uA822\\\\uA840-\\\\uA873\\\\uA882-\\\\uA8B3\\\\uA8F2-\\\\uA8F7\\\\uA8FB\\\\uA90A-\\\\uA925\\\\uA930-\\\\uA946\\\\uA960-\\\\uA97C\\\\uA984-\\\\uA9B2\\\\uA9CF\\\\uA9E0-\\\\uA9E4\\\\uA9E6-\\\\uA9EF\\\\uA9FA-\\\\uA9FE\\\\uAA00-\\\\uAA28\\\\uAA40-\\\\uAA42\\\\uAA44-\\\\uAA4B\\\\uAA60-\\\\uAA76\\\\uAA7A\\\\uAA7E-\\\\uAAAF\\\\uAAB1\\\\uAAB5\\\\uAAB6\\\\uAAB9-\\\\uAABD\\\\uAAC0\\\\uAAC2\\\\uAADB-\\\\uAADD\\\\uAAE0-\\\\uAAEA\\\\uAAF2-\\\\uAAF4\\\\uAB01-\\\\uAB06\\\\uAB09-\\\\uAB0E\\\\uAB11-\\\\uAB16\\\\uAB20-\\\\uAB26\\\\uAB28-\\\\uAB2E\\\\uAB30-\\\\uAB5A\\\\uAB5C-\\\\uAB5F\\\\uAB64\\\\uAB65\\\\uABC0-\\\\uABE2\\\\uAC00-\\\\uD7A3\\\\uD7B0-\\\\uD7C6\\\\uD7CB-\\\\uD7FB\\\\uF900-\\\\uFA6D\\\\uFA70-\\\\uFAD9\\\\uFB00-\\\\uFB06\\\\uFB13-\\\\uFB17\\\\uFB1D\\\\uFB1F-\\\\uFB28\\\\uFB2A-\\\\uFB36\\\\uFB38-\\\\uFB3C\\\\uFB3E\\\\uFB40\\\\uFB41\\\\uFB43\\\\uFB44\\\\uFB46-\\\\uFBB1\\\\uFBD3-\\\\uFD3D\\\\uFD50-\\\\uFD8F\\\\uFD92-\\\\uFDC7\\\\uFDF0-\\\\uFDFB\\\\uFE70-\\\\uFE74\\\\uFE76-\\\\uFEFC\\\\uFF21-\\\\uFF3A\\\\uFF41-\\\\uFF5A\\\\uFF66-\\\\uFFBE\\\\uFFC2-\\\\uFFC7\\\\uFFCA-\\\\uFFCF\\\\uFFD2-\\\\uFFD7\\\\uFFDA-\\\\uFFDC]');\n    }());\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/text-metrics', [\n        'kendo.core',\n        'util/main'\n    ], f);\n}(function () {\n    (function ($) {\n        var doc = document, kendo = window.kendo, Class = kendo.Class, util = kendo.util, defined = util.defined;\n        var LRUCache = Class.extend({\n            init: function (size) {\n                this._size = size;\n                this._length = 0;\n                this._map = {};\n            },\n            put: function (key, value) {\n                var lru = this, map = lru._map, entry = {\n                        key: key,\n                        value: value\n                    };\n                map[key] = entry;\n                if (!lru._head) {\n                    lru._head = lru._tail = entry;\n                } else {\n                    lru._tail.newer = entry;\n                    entry.older = lru._tail;\n                    lru._tail = entry;\n                }\n                if (lru._length >= lru._size) {\n                    map[lru._head.key] = null;\n                    lru._head = lru._head.newer;\n                    lru._head.older = null;\n                } else {\n                    lru._length++;\n                }\n            },\n            get: function (key) {\n                var lru = this, entry = lru._map[key];\n                if (entry) {\n                    if (entry === lru._head && entry !== lru._tail) {\n                        lru._head = entry.newer;\n                        lru._head.older = null;\n                    }\n                    if (entry !== lru._tail) {\n                        if (entry.older) {\n                            entry.older.newer = entry.newer;\n                            entry.newer.older = entry.older;\n                        }\n                        entry.older = lru._tail;\n                        entry.newer = null;\n                        lru._tail.newer = entry;\n                        lru._tail = entry;\n                    }\n                    return entry.value;\n                }\n            }\n        });\n        var defaultMeasureBox = $('<div style=\\'position: absolute !important; top: -4000px !important; width: auto !important; height: auto !important;' + 'padding: 0 !important; margin: 0 !important; border: 0 !important;' + 'line-height: normal !important; visibility: hidden !important; white-space: nowrap!important;\\' />')[0];\n        function zeroSize() {\n            return {\n                width: 0,\n                height: 0,\n                baseline: 0\n            };\n        }\n        var TextMetrics = Class.extend({\n            init: function (options) {\n                this._cache = new LRUCache(1000);\n                this._initOptions(options);\n            },\n            options: { baselineMarkerSize: 1 },\n            measure: function (text, style, box) {\n                if (!text) {\n                    return zeroSize();\n                }\n                var styleKey = util.objectKey(style), cacheKey = util.hashKey(text + styleKey), cachedResult = this._cache.get(cacheKey);\n                if (cachedResult) {\n                    return cachedResult;\n                }\n                var size = zeroSize();\n                var measureBox = box ? box : defaultMeasureBox;\n                var baselineMarker = this._baselineMarker().cloneNode(false);\n                for (var key in style) {\n                    var value = style[key];\n                    if (defined(value)) {\n                        measureBox.style[key] = value;\n                    }\n                }\n                $(measureBox).text(text);\n                measureBox.appendChild(baselineMarker);\n                doc.body.appendChild(measureBox);\n                if ((text + '').length) {\n                    size.width = measureBox.offsetWidth - this.options.baselineMarkerSize;\n                    size.height = measureBox.offsetHeight;\n                    size.baseline = baselineMarker.offsetTop + this.options.baselineMarkerSize;\n                }\n                if (size.width > 0 && size.height > 0) {\n                    this._cache.put(cacheKey, size);\n                }\n                measureBox.parentNode.removeChild(measureBox);\n                return size;\n            },\n            _baselineMarker: function () {\n                return $('<div class=\\'k-baseline-marker\\' ' + 'style=\\'display: inline-block; vertical-align: baseline;' + 'width: ' + this.options.baselineMarkerSize + 'px; height: ' + this.options.baselineMarkerSize + 'px;' + 'overflow: hidden;\\' />')[0];\n            }\n        });\n        TextMetrics.current = new TextMetrics();\n        function measureText(text, style, measureBox) {\n            return TextMetrics.current.measure(text, style, measureBox);\n        }\n        function loadFonts(fonts, callback) {\n            var promises = [];\n            if (fonts.length > 0 && document.fonts) {\n                try {\n                    promises = fonts.map(function (font) {\n                        return document.fonts.load(font);\n                    });\n                } catch (e) {\n                    kendo.logToConsole(e);\n                }\n                Promise.all(promises).then(callback, callback);\n            } else {\n                callback();\n            }\n        }\n        kendo.util.TextMetrics = TextMetrics;\n        kendo.util.LRUCache = LRUCache;\n        kendo.util.loadFonts = loadFonts;\n        kendo.util.measureText = measureText;\n    }(window.kendo.jQuery));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/parse-xml', [\n        'kendo.core',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    var STRING = String.fromCharCode;\n    var ENTITIES = {\n        'amp': 38,\n        'lt': 60,\n        'gt': 62,\n        'quot': 34,\n        'apos': 39,\n        'nbsp': 160\n    };\n    function CODE(str) {\n        var out = [];\n        for (var i = 0; i < str.length; ++i) {\n            out.push(str.charCodeAt(i));\n        }\n        return out;\n    }\n    function UCS2(out, code) {\n        if (code > 65535) {\n            code -= 65536;\n            out.push(code >>> 10 & 1023 | 55296, 56320 | code & 1023);\n        } else {\n            out.push(code);\n        }\n    }\n    var START_CDATA = CODE('<![CDATA[');\n    var END_CDATA = CODE(']]>');\n    var END_COMMENT = CODE('-->');\n    var START_COMMENT = CODE('!--');\n    var END_SHORT_TAG = CODE('/>');\n    var END_TAG = CODE('</');\n    var END_DECLARATION = CODE('?>');\n    var QUESTION_MARK = CODE('?');\n    var LESS_THAN = CODE('<');\n    var GREATER_THAN = CODE('>');\n    var SEMICOLON = CODE(';');\n    var EQUAL = CODE('=');\n    var AMPERSAND = CODE('&');\n    var QUOTE = CODE('\"');\n    var APOSTROPHE = CODE('\\'');\n    var SHARP = CODE('#');\n    var LOWERCASE_X = CODE('x');\n    var UPPERCASE_X = CODE('X');\n    var EXIT = {};\n    function parse(data, callbacks) {\n        var index = 0;\n        var stack = [];\n        var object = {\n            is: function (selector) {\n                var i = stack.length, j = selector.length;\n                while (--i >= 0 && --j >= 0) {\n                    if (stack[i].$tag != selector[j] && selector[j] != '*') {\n                        return false;\n                    }\n                }\n                return j < 0 ? stack[stack.length - 1] : null;\n            },\n            exit: function () {\n                throw EXIT;\n            },\n            stack: stack\n        };\n        function readChar(body) {\n            var code = data[index++];\n            if (!(code & 240 ^ 240)) {\n                UCS2(body, (code & 3) << 18 | (data[index++] & 63) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 224 ^ 224)) {\n                UCS2(body, (code & 15) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 192 ^ 192)) {\n                UCS2(body, (code & 31) << 6 | data[index++] & 63);\n            } else {\n                body.push(code);\n            }\n        }\n        function croak(msg) {\n            throw new Error(msg + ', at ' + index);\n        }\n        function readWhile(pred) {\n            var a = [];\n            while (index < data.length && pred(data[index])) {\n                a.push(data[index++]);\n            }\n            return a;\n        }\n        function readAsciiWhile(pred) {\n            return STRING.apply(0, readWhile(pred));\n        }\n        function skipWhitespace() {\n            readWhile(isWhitespace);\n        }\n        function eat(a) {\n            var save = index;\n            for (var i = 0; i < a.length; ++i) {\n                if (data[index++] != a[i]) {\n                    index = save;\n                    return false;\n                }\n            }\n            return a;\n        }\n        function skip(code) {\n            if (!eat(code)) {\n                croak('Expecting ' + code.join(', '));\n            }\n        }\n        function isWhitespace(code) {\n            return code == 9 || code == 10 || code == 13 || code == 32;\n        }\n        function isDigit(code) {\n            return code >= 48 && code <= 57;\n        }\n        function isHexDigit(code) {\n            return code >= 48 && code <= 57 || (code |= 32) >= 97 && code <= 102;\n        }\n        function isNameStart(code) {\n            return code == 58 || code == 95 || (code |= 32) >= 97 && code <= 122;\n        }\n        function isName(code) {\n            return code == 45 || isDigit(code) || isNameStart(code);\n        }\n        function xmlComment() {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_COMMENT)) {\n                    return call('comment', STRING.apply(0, body));\n                }\n                readChar(body);\n            }\n        }\n        function xmlTag() {\n            var name, attrs;\n            if (eat(QUESTION_MARK)) {\n                xmlDecl();\n            } else if (eat(START_COMMENT)) {\n                xmlComment();\n            } else {\n                name = xmlName();\n                attrs = xmlAttrs(name);\n                stack.push(attrs);\n                if (eat(END_SHORT_TAG)) {\n                    call('enter', name, attrs, true);\n                } else {\n                    skip(GREATER_THAN);\n                    call('enter', name, attrs);\n                    xmlContent(name);\n                    if (name != xmlName()) {\n                        croak('Bad closing tag');\n                    }\n                    call('leave', name, attrs);\n                    skipWhitespace();\n                    skip(GREATER_THAN);\n                }\n                stack.pop();\n            }\n        }\n        function xmlContent(name) {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_TAG)) {\n                    return body.length && call('text', STRING.apply(0, body));\n                } else if (eat(START_CDATA)) {\n                    while (index < data.length && !eat(END_CDATA)) {\n                        readChar(body);\n                    }\n                } else if (eat(LESS_THAN)) {\n                    if (body.length) {\n                        call('text', STRING.apply(0, body));\n                    }\n                    xmlTag();\n                    body = [];\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unclosed tag ' + name);\n        }\n        function xmlName() {\n            if (!isNameStart(data[index])) {\n                croak('Expecting XML name');\n            }\n            return readAsciiWhile(isName);\n        }\n        function xmlString() {\n            var quote = eat(QUOTE) || eat(APOSTROPHE);\n            if (!quote) {\n                croak('Expecting string');\n            }\n            var body = [];\n            while (index < data.length) {\n                if (eat(quote)) {\n                    return STRING.apply(0, body);\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unfinished string');\n        }\n        function xmlEntity(body) {\n            var code;\n            if (eat(SHARP)) {\n                if (eat(LOWERCASE_X) || eat(UPPERCASE_X)) {\n                    code = parseInt(readAsciiWhile(isHexDigit), 16);\n                } else {\n                    code = parseInt(readAsciiWhile(isDigit), 10);\n                }\n                if (isNaN(code)) {\n                    croak('Bad numeric entity');\n                }\n            } else {\n                var name = xmlName();\n                code = ENTITIES[name];\n                if (code === undefined) {\n                    croak('Unknown entity ' + name);\n                }\n            }\n            UCS2(body, code);\n            skip(SEMICOLON);\n        }\n        function xmlDecl() {\n            call('decl', xmlName(), xmlAttrs());\n            skip(END_DECLARATION);\n        }\n        function xmlAttrs(name) {\n            var map = { $tag: name };\n            while (index < data.length) {\n                skipWhitespace();\n                var code = data[index];\n                if (code == 63 || code == 62 || code == 47) {\n                    break;\n                }\n                map[xmlName()] = (skip(EQUAL), xmlString());\n            }\n            return map;\n        }\n        function call(what, thing, arg1, arg2) {\n            var f = callbacks && callbacks[what];\n            if (f) {\n                f.call(object, thing, arg1, arg2);\n            }\n        }\n        var tmp = [];\n        readChar(tmp);\n        if (tmp[0] != 65279) {\n            index = 0;\n        }\n        while (index < data.length) {\n            skipWhitespace();\n            skip(LESS_THAN);\n            xmlTag();\n            skipWhitespace();\n        }\n    }\n    kendo.util.parseXML = function parseXML() {\n        try {\n            return parse.apply(this, arguments);\n        } catch (ex) {\n            if (ex !== EXIT) {\n                throw ex;\n            }\n        }\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/base64', ['util/main'], f);\n}(function () {\n    (function () {\n        var kendo = window.kendo, deepExtend = kendo.deepExtend, fromCharCode = String.fromCharCode;\n        var KEY_STR = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n        function encodeBase64(input) {\n            var output = '';\n            var chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n            var i = 0;\n            input = encodeUTF8(input);\n            while (i < input.length) {\n                chr1 = input.charCodeAt(i++);\n                chr2 = input.charCodeAt(i++);\n                chr3 = input.charCodeAt(i++);\n                enc1 = chr1 >> 2;\n                enc2 = (chr1 & 3) << 4 | chr2 >> 4;\n                enc3 = (chr2 & 15) << 2 | chr3 >> 6;\n                enc4 = chr3 & 63;\n                if (isNaN(chr2)) {\n                    enc3 = enc4 = 64;\n                } else if (isNaN(chr3)) {\n                    enc4 = 64;\n                }\n                output = output + KEY_STR.charAt(enc1) + KEY_STR.charAt(enc2) + KEY_STR.charAt(enc3) + KEY_STR.charAt(enc4);\n            }\n            return output;\n        }\n        function encodeUTF8(input) {\n            var output = '';\n            for (var i = 0; i < input.length; i++) {\n                var c = input.charCodeAt(i);\n                if (c < 128) {\n                    output += fromCharCode(c);\n                } else if (c < 2048) {\n                    output += fromCharCode(192 | c >>> 6);\n                    output += fromCharCode(128 | c & 63);\n                } else if (c < 65536) {\n                    output += fromCharCode(224 | c >>> 12);\n                    output += fromCharCode(128 | c >>> 6 & 63);\n                    output += fromCharCode(128 | c & 63);\n                }\n            }\n            return output;\n        }\n        deepExtend(kendo.util, {\n            encodeBase64: encodeBase64,\n            encodeUTF8: encodeUTF8\n        });\n    }());\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('mixins/observers', ['kendo.core'], f);\n}(function () {\n    (function ($) {\n        var math = Math, kendo = window.kendo, deepExtend = kendo.deepExtend, inArray = $.inArray;\n        var ObserversMixin = {\n            observers: function () {\n                this._observers = this._observers || [];\n                return this._observers;\n            },\n            addObserver: function (element) {\n                if (!this._observers) {\n                    this._observers = [element];\n                } else {\n                    this._observers.push(element);\n                }\n                return this;\n            },\n            removeObserver: function (element) {\n                var observers = this.observers();\n                var index = inArray(element, observers);\n                if (index != -1) {\n                    observers.splice(index, 1);\n                }\n                return this;\n            },\n            trigger: function (methodName, event) {\n                var observers = this._observers;\n                var observer;\n                var idx;\n                if (observers && !this._suspended) {\n                    for (idx = 0; idx < observers.length; idx++) {\n                        observer = observers[idx];\n                        if (observer[methodName]) {\n                            observer[methodName](event);\n                        }\n                    }\n                }\n                return this;\n            },\n            optionsChange: function (e) {\n                e = e || {};\n                e.element = this;\n                this.trigger('optionsChange', e);\n            },\n            geometryChange: function () {\n                this.trigger('geometryChange', { element: this });\n            },\n            suspend: function () {\n                this._suspended = (this._suspended || 0) + 1;\n                return this;\n            },\n            resume: function () {\n                this._suspended = math.max((this._suspended || 0) - 1, 0);\n                return this;\n            },\n            _observerField: function (field, value) {\n                if (this[field]) {\n                    this[field].removeObserver(this);\n                }\n                this[field] = value;\n                value.addObserver(this);\n            }\n        };\n        deepExtend(kendo, { mixins: { ObserversMixin: ObserversMixin } });\n    }(window.kendo.jQuery));\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/commands', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.window',\n        'kendo.list',\n        'kendo.tabstrip'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Command = kendo.spreadsheet.Command = kendo.Class.extend({\n            init: function (options) {\n                this.options = options;\n                this._workbook = options.workbook;\n                this._property = options && options.property;\n                this._state = {};\n            },\n            range: function (range) {\n                if (range !== undefined) {\n                    this._setRange(range);\n                }\n                return this._range;\n            },\n            _setRange: function (range) {\n                this._range = range;\n            },\n            redo: function () {\n                this.exec();\n            },\n            undo: function () {\n                this.setState(this._state);\n            },\n            getState: function () {\n                this._state = this.range().getState(this._property);\n            },\n            setState: function (state) {\n                this.range().setState(state);\n            },\n            _forEachCell: function (callback) {\n                var range = this.range();\n                var ref = range._ref;\n                ref.forEach(function (ref) {\n                    range.sheet().forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            }\n        });\n        var TargetValueCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._target = options.target;\n                this._value = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this.setState(this._value);\n            }\n        });\n        kendo.spreadsheet.ColumnWidthCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this.range().sheet().columnWidth(this._target);\n            },\n            setState: function (state) {\n                this.range().sheet().columnWidth(this._target, state);\n            }\n        });\n        kendo.spreadsheet.RowHeightCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this.range().sheet().rowHeight(this._target);\n            },\n            setState: function (state) {\n                this.range().sheet().rowHeight(this._target, state);\n            }\n        });\n        kendo.spreadsheet.HyperlinkCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._link = options.link;\n            },\n            exec: function () {\n                var range = this.range();\n                this._prevLink = range.link();\n                range.link(this._link);\n                if (range.value() == null) {\n                    this._hasSetValue = true;\n                    range.value(this._link);\n                }\n            },\n            undo: function () {\n                var range = this.range();\n                range.link(this._prevLink);\n                if (this._hasSetValue) {\n                    range.value(null);\n                }\n            }\n        });\n        kendo.spreadsheet.GridLinesChangeCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this._range.sheet().showGridLines();\n            },\n            setState: function (v) {\n                this._range.sheet().showGridLines(v);\n            }\n        });\n        var PropertyChangeCommand = kendo.spreadsheet.PropertyChangeCommand = Command.extend({\n            _setRange: function (range) {\n                Command.prototype._setRange.call(this, range.skipHiddenCells());\n            },\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                var range = this.range();\n                if (range.enable()) {\n                    this.getState();\n                    range[this._property](this._value);\n                }\n            }\n        });\n        kendo.spreadsheet.ClearContentCommand = Command.extend({\n            exec: function () {\n                this.getState();\n                this.range().clearContent();\n            }\n        });\n        kendo.spreadsheet.EditCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = options.property || 'input';\n                PropertyChangeCommand.fn.init.call(this, options);\n            },\n            rejectState: function (validationState) {\n                this.undo();\n                return {\n                    title: validationState.title,\n                    body: validationState.message,\n                    reason: 'error',\n                    type: 'validationError'\n                };\n            },\n            getState: function () {\n                this._state = this.range().getState();\n            },\n            exec: function () {\n                var range = this.range();\n                if (!range.enable()) {\n                    return {\n                        reason: 'error',\n                        type: 'rangeDisabled'\n                    };\n                }\n                var value = this._value;\n                this.getState();\n                if (this._property == 'value') {\n                    range.value(value);\n                    return;\n                }\n                try {\n                    range.link(null);\n                    if (value === '') {\n                        range.value(null);\n                    } else {\n                        range.input(value);\n                        if (/\\n/.test(range.value())) {\n                            range.wrap(true);\n                        }\n                    }\n                    range._adjustRowHeight();\n                    var validationState = range._getValidationState();\n                    if (validationState) {\n                        return this.rejectState(validationState);\n                    }\n                } catch (ex) {\n                    if (ex instanceof kendo.spreadsheet.calc.ParseError) {\n                        return {\n                            title: 'Error in formula',\n                            body: ex + '',\n                            reason: 'error'\n                        };\n                    } else {\n                        throw ex;\n                    }\n                }\n            }\n        });\n        kendo.spreadsheet.TextWrapCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = 'wrap';\n                PropertyChangeCommand.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            getState: function () {\n                var rowHeight = {};\n                this.range().forEachRow(function (range) {\n                    var index = range.topLeft().row;\n                    rowHeight[index] = range.sheet().rowHeight(index);\n                });\n                this._state = this.range().getState(this._property);\n                this._rowHeight = rowHeight;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                var rowHeight = this._rowHeight;\n                this.range().setState(this._state);\n                for (var row in rowHeight) {\n                    sheet.rowHeight(row, rowHeight[row]);\n                }\n            }\n        });\n        kendo.spreadsheet.AdjustDecimalsCommand = Command.extend({\n            init: function (options) {\n                this._decimals = options.value;\n                options.property = 'format';\n                Command.fn.init.call(this, options);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                var decimals = this._decimals;\n                var formatting = kendo.spreadsheet.formatting;\n                this.getState();\n                sheet.batch(function () {\n                    this.range().forEachCell(function (row, col, cell) {\n                        var format = cell.format;\n                        if (format || decimals > 0) {\n                            format = formatting.adjustDecimals(format || '#', decimals);\n                            sheet.range(row, col).format(format);\n                        }\n                    });\n                }.bind(this));\n            }\n        });\n        kendo.spreadsheet.BorderChangeCommand = Command.extend({\n            init: function (options) {\n                options.property = 'border';\n                Command.fn.init.call(this, options);\n                this._type = options.border;\n                this._style = options.style;\n            },\n            exec: function () {\n                this.getState();\n                this[this._type](this._style);\n            },\n            noBorders: function () {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderLeft(null).borderTop(null).borderRight(null).borderBottom(null);\n                }.bind(this), {});\n            },\n            allBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderLeft(style).borderTop(style).borderRight(style).borderBottom(style);\n                }.bind(this), {});\n            },\n            leftBorder: function (style) {\n                this.range().leftColumn().borderLeft(style);\n            },\n            rightBorder: function (style) {\n                this.range().rightColumn().borderRight(style);\n            },\n            topBorder: function (style) {\n                this.range().topRow().borderTop(style);\n            },\n            bottomBorder: function (style) {\n                this.range().bottomRow().borderBottom(style);\n            },\n            outsideBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.leftColumn().borderLeft(style);\n                    range.topRow().borderTop(style);\n                    range.rightColumn().borderRight(style);\n                    range.bottomRow().borderBottom(style);\n                }.bind(this), {});\n            },\n            insideBorders: function (style) {\n                this.range().sheet().batch(function () {\n                    this.allBorders(style);\n                    this.outsideBorders(null);\n                }.bind(this), {});\n            },\n            insideHorizontalBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderBottom(style);\n                    range.bottomRow().borderBottom(null);\n                }.bind(this), {});\n            },\n            insideVerticalBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderRight(style);\n                    range.rightColumn().borderRight(null);\n                }.bind(this), {});\n            }\n        });\n        kendo.spreadsheet.MergeCellCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this[this._type]();\n            },\n            activate: function (ref) {\n                this.range().sheet().activeCell(ref);\n            },\n            getState: function () {\n                this._state = this.range().getState();\n            },\n            undo: function () {\n                if (this._type !== 'unmerge') {\n                    this.range().unmerge();\n                    this.activate(this.range().topLeft());\n                }\n                this.range().setState(this._state);\n            },\n            cells: function () {\n                var range = this.range();\n                var ref = range._ref;\n                range.merge();\n                this.activate(ref);\n            },\n            horizontally: function () {\n                var ref = this.range().topRow()._ref;\n                this.range().forEachRow(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            vertically: function () {\n                var ref = this.range().leftColumn()._ref;\n                this.range().forEachColumn(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            unmerge: function () {\n                var range = this.range();\n                var ref = range._ref.topLeft;\n                range.unmerge();\n                this.activate(ref);\n            }\n        });\n        kendo.spreadsheet.FreezePanesCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this._topLeft = this.range().topLeft();\n                this[this._type]();\n            },\n            getState: function () {\n                this._state = this.range().sheet().getState();\n            },\n            undo: function () {\n                this.range().sheet().setState(this._state);\n            },\n            panes: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col).frozenRows(topLeft.row);\n            },\n            rows: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenRows(topLeft.row);\n            },\n            columns: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col);\n            },\n            unfreeze: function () {\n                var sheet = this.range().sheet();\n                sheet.frozenRows(0).frozenColumns(0);\n            }\n        });\n        kendo.spreadsheet.PasteCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n                this._event = options.event;\n            },\n            getState: function () {\n                this._range = this._workbook.activeSheet().range(this._clipboard.pasteRef());\n                this._state = this._range.getState();\n            },\n            exec: function () {\n                this.getState();\n                this._clipboard.parse();\n                var status = this._clipboard.canPaste();\n                if (!status.canPaste) {\n                    if (status.menuInvoked) {\n                        return {\n                            reason: 'error',\n                            type: 'useKeyboard'\n                        };\n                    }\n                    if (status.pasteOnMerged) {\n                        return {\n                            reason: 'error',\n                            type: 'modifyMerged'\n                        };\n                    }\n                    if (status.overflow) {\n                        return {\n                            reason: 'error',\n                            type: 'overflow'\n                        };\n                    }\n                    if (status.pasteOnDisabled) {\n                        this._event.preventDefault();\n                        return {\n                            reason: 'error',\n                            type: 'cannotModifyDisabled'\n                        };\n                    }\n                    return { reason: 'error' };\n                }\n                var range = this._workbook.activeSheet().selection();\n                var preventDefault = this._workbook.trigger('paste', { range: range });\n                if (preventDefault) {\n                    this._event.preventDefault();\n                } else {\n                    this._clipboard.paste();\n                    range._adjustRowHeight();\n                }\n            }\n        });\n        kendo.spreadsheet.AdjustRowHeightCommand = Command.extend({\n            exec: function () {\n                var options = this.options;\n                var sheet = this._workbook.activeSheet();\n                var range = options.range || sheet.range(options.rowIndex);\n                range._adjustRowHeight();\n            }\n        });\n        kendo.spreadsheet.ToolbarPasteCommand = Command.extend({\n            exec: function () {\n                if (kendo.support.clipboard.paste) {\n                    this._workbook._view.clipboard.focus().select();\n                    document.execCommand('paste');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.CopyCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n                this._event = options.event;\n            },\n            undo: $.noop,\n            exec: function () {\n                var status = this._clipboard.canCopy();\n                this._clipboard.menuInvoked = true;\n                if (!status.canCopy) {\n                    if (status.menuInvoked) {\n                        return {\n                            reason: 'error',\n                            type: 'useKeyboard'\n                        };\n                    } else if (status.multiSelection) {\n                        return {\n                            reason: 'error',\n                            type: 'unsupportedSelection'\n                        };\n                    }\n                    return;\n                }\n                var range = this._workbook.activeSheet().selection();\n                var preventDefault = this._workbook.trigger('copy', { range: range });\n                if (preventDefault) {\n                    this._event.preventDefault();\n                } else {\n                    this._clipboard.copy();\n                }\n            }\n        });\n        function copyToClipboard(html) {\n            var textarea = document.createElement('textarea');\n            $(textarea).addClass('k-spreadsheet-clipboard').val(html).appendTo(document.body).focus().select();\n            document.execCommand('copy');\n            $(textarea).remove();\n        }\n        kendo.spreadsheet.ToolbarCopyCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            undo: $.noop,\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    var clipboard = this._workbook._view.clipboard;\n                    copyToClipboard(clipboard.html());\n                    clipboard.trigger('copy');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.CutCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n                this._event = options.event;\n            },\n            exec: function () {\n                if (!(this.range().enable() && this._clipboard.canCopy())) {\n                    this._event.preventDefault();\n                    return {\n                        reason: 'error',\n                        type: 'cannotModifyDisabled'\n                    };\n                }\n                this.getState();\n                var range = this._workbook.activeSheet().selection();\n                var preventDefault = this._workbook.trigger('cut', { range: range });\n                if (preventDefault) {\n                    this._event.preventDefault();\n                    return;\n                }\n                this._clipboard.cut();\n            }\n        });\n        kendo.spreadsheet.AutoFillCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n            },\n            origin: function (origin) {\n                this._origin = origin;\n            },\n            exec: function () {\n                var range = this.range();\n                if (!range.enable()) {\n                    return {\n                        reason: 'error',\n                        type: 'rangeDisabled'\n                    };\n                }\n                this.getState();\n                try {\n                    range.fillFrom(this._origin);\n                } catch (ex) {\n                    if (ex instanceof kendo.spreadsheet.Range.FillError) {\n                        return {\n                            reason: 'error',\n                            type: ex.code\n                        };\n                    }\n                    throw ex;\n                }\n            }\n        });\n        kendo.spreadsheet.ToolbarCutCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    var clipboard = this._workbook._view.clipboard;\n                    copyToClipboard(clipboard.html());\n                    clipboard.trigger('cut');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.FilterCommand = Command.extend({\n            undo: function () {\n                this.range().filter(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                this._state = range.hasFilter();\n                if (range.hasFilter()) {\n                    range.filter(false);\n                } else if (!range.intersectingMerged().length) {\n                    range.filter(true);\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'filterRangeContainingMerges'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.SortCommand = Command.extend({\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                var sheet = range.sheet();\n                var activeCell = sheet.activeCell();\n                var col = this.options.sheet ? activeCell.topLeft.col : this.options.column || 0;\n                var ascending = this.options.value === 'asc' ? true : false;\n                this._state = sheet.getState();\n                if (this.options.sheet) {\n                    range = this.expandRange();\n                }\n                if (!range.intersectingMerged().length) {\n                    range.sort({\n                        column: col,\n                        ascending: ascending\n                    });\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'sortRangeContainingMerges'\n                    };\n                }\n            },\n            expandRange: function () {\n                var sheet = this.range().sheet();\n                return new kendo.spreadsheet.Range(sheet._sheetRef, sheet);\n            }\n        });\n        var ApplyFilterCommand = kendo.spreadsheet.ApplyFilterCommand = Command.extend({\n            column: function () {\n                return this.options.column || 0;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.clearFilter(this.column());\n                if (this._state.length) {\n                    this.range().filter(this._state);\n                }\n            },\n            getState: function () {\n                var sheet = this.range().sheet();\n                var current = sheet.filter();\n                if (current) {\n                    this._state = current.columns.filter(function (c) {\n                        return c.index == this.column();\n                    }.bind(this));\n                }\n            },\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                var current = range.sheet().filter();\n                var options;\n                var filterRule;\n                var exists = false;\n                if (this.options.valueFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.ValueFilter(this.options.valueFilter)\n                    };\n                } else if (this.options.customFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.CustomFilter(this.options.customFilter)\n                    };\n                }\n                this.getState();\n                if (current && current.ref.eq(range._ref) && current.columns.length) {\n                    current.columns.forEach(function (element) {\n                        if (element.index === column) {\n                            exists = true;\n                        }\n                    });\n                    options = current.columns.map(function (element) {\n                        return element.index === column ? filterRule : {\n                            column: element.index,\n                            filter: element.filter\n                        };\n                    });\n                    if (!exists) {\n                        options.push(filterRule);\n                    }\n                } else {\n                    options = filterRule;\n                }\n                range.filter(options);\n            }\n        });\n        kendo.spreadsheet.ClearFilterCommand = ApplyFilterCommand.extend({\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                this.getState();\n                range.clearFilter(column);\n            }\n        });\n        kendo.spreadsheet.HideLineCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this.axis = options.axis;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setAxisState(this._state);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().hideSelectedRows();\n                } else {\n                    sheet.axisManager().hideSelectedColumns();\n                }\n            }\n        });\n        kendo.spreadsheet.UnHideLineCommand = kendo.spreadsheet.HideLineCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().unhideSelectedRows();\n                } else {\n                    sheet.axisManager().unhideSelectedColumns();\n                }\n            }\n        });\n        var DeleteCommand = kendo.spreadsheet.DeleteCommand = Command.extend({\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.DeleteRowCommand = DeleteCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getState();\n                sheet.axisManager().deleteSelectedRows();\n            }\n        });\n        kendo.spreadsheet.DeleteColumnCommand = DeleteCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getState();\n                sheet.axisManager().deleteSelectedColumns();\n            }\n        });\n        var AddCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.AddColumnCommand = AddCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getState();\n                if (this._value === 'left') {\n                    sheet.axisManager().addColumnLeft();\n                } else {\n                    sheet.axisManager().addColumnRight();\n                }\n            }\n        });\n        kendo.spreadsheet.AddRowCommand = AddCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                if (!sheet.axisManager().canAddRow()) {\n                    return {\n                        reason: 'error',\n                        type: 'shiftingNonblankCells'\n                    };\n                }\n                this._state = sheet.getState();\n                if (this._value === 'above') {\n                    sheet.axisManager().addRowAbove();\n                } else {\n                    sheet.axisManager().addRowBelow();\n                }\n            }\n        });\n        kendo.spreadsheet.EditValidationCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                this.range().validation(this._value);\n            }\n        });\n        kendo.spreadsheet.OpenCommand = Command.extend({\n            cannotUndo: true,\n            exec: function () {\n                var file = this.options.file;\n                if (file.name.match(/.xlsx$/i) === null) {\n                    return {\n                        reason: 'error',\n                        type: 'openUnsupported'\n                    };\n                }\n                this.options.workbook.fromFile(this.options.file);\n            }\n        });\n        kendo.spreadsheet.SaveAsCommand = Command.extend({\n            exec: function () {\n                var fileName = this.options.name + this.options.extension;\n                if (this.options.extension === '.xlsx') {\n                    this.options.workbook.saveAsExcel({ fileName: fileName });\n                } else if (this.options.extension === '.pdf') {\n                    this.options.workbook.saveAsPDF($.extend(this.options.pdf, {\n                        workbook: this.options.workbook,\n                        fileName: fileName\n                    }));\n                }\n            }\n        });\n        var NameCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._name = options.name;\n                this._value = options.value;\n            },\n            getState: function () {\n                this._state = this._workbook.nameDefinition(this._name);\n            },\n            setState: function () {\n                this._workbook.nameDefinition(this._name, this._state);\n                this._workbook.trigger('change', { recalc: true });\n            }\n        });\n        kendo.spreadsheet.DefineNameCommand = NameCommand.extend({\n            exec: function () {\n                this.getState();\n                try {\n                    this._workbook.defineName(this._name, this._value);\n                    this._workbook.trigger('change', { recalc: true });\n                } catch (ex) {\n                    return {\n                        title: 'Error',\n                        body: ex + '',\n                        reason: 'error'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.DeleteNameCommand = NameCommand.extend({\n            exec: function () {\n                this.getState();\n                this._workbook.undefineName(this._name);\n                this._workbook.trigger('change', { recalc: true });\n            }\n        });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulabar', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var classNames = { wrapper: 'k-spreadsheet-formula-bar' };\n        var FormulaBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element.addClass(FormulaBar.classNames.wrapper);\n                this.formulaInput = new kendo.spreadsheet.FormulaInput($('<div/>').appendTo(element));\n            },\n            destroy: function () {\n                if (this.formulaInput) {\n                    this.formulaInput.destroy();\n                }\n                this.formulaInput = null;\n            }\n        });\n        kendo.spreadsheet.FormulaBar = FormulaBar;\n        $.extend(true, FormulaBar, { classNames: classNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulainput', ['kendo.core'], f);\n}(function () {\n    (function (kendo, window) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var ns = '.kendoFormulaInput';\n        var keys = kendo.keys;\n        var classNames = {\n            wrapper: 'k-spreadsheet-formula-input',\n            listWrapper: 'k-spreadsheet-formula-list'\n        };\n        var styles = [\n            'font-family',\n            'font-size',\n            'font-stretch',\n            'font-style',\n            'font-weight',\n            'letter-spacing',\n            'text-transform',\n            'line-height'\n        ];\n        var KEY_NAMES = {\n            27: 'esc',\n            37: 'left',\n            39: 'right',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar'\n        };\n        var PRIVATE_FORMULA_CHECK = /(^_|[^a-z0-9]$)/i;\n        var FormulaInput = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(FormulaInput.classNames.wrapper).attr('contenteditable', true).attr('spellcheck', false).css('white-space', 'pre');\n                if (this.options.autoScale) {\n                    element.on('input', this.scale.bind(this));\n                }\n                this._highlightedRefs = [];\n                this._staticTokens = [];\n                this._formulaSource();\n                this._formulaList();\n                this._popup();\n                this._tooltip();\n                element.on('keydown', this._keydown.bind(this)).on('keyup', this._keyup.bind(this)).on('blur', this._blur.bind(this)).on('input click', this._input.bind(this)).on('focus', this._focus.bind(this)).on('paste', this._paste.bind(this));\n            },\n            options: {\n                name: 'FormulaInput',\n                autoScale: false,\n                filterOperator: 'startswith',\n                scalePadding: 30,\n                minLength: 1\n            },\n            events: [\n                'keyup',\n                'focus'\n            ],\n            enable: function (enable) {\n                if (enable === undefined) {\n                    return this.element.attr('contenteditable') === 'true';\n                }\n                this.enableEditing(enable);\n                this.element.toggleClass('k-state-disabled', !enable);\n            },\n            enableEditing: function (enable) {\n                if (enable) {\n                    this.element.attr('contenteditable', enable);\n                } else {\n                    this.element.removeAttr('contenteditable');\n                }\n            },\n            getPos: function () {\n                var div = this.element[0];\n                var sel = window.getSelection();\n                var a = lookup(sel.focusNode, sel.focusOffset);\n                var b = lookup(sel.anchorNode, sel.anchorOffset);\n                if (a != null && b != null) {\n                    if (a > b) {\n                        var tmp = a;\n                        a = b;\n                        b = tmp;\n                    }\n                    return {\n                        begin: a,\n                        end: b,\n                        collapsed: a == b\n                    };\n                }\n                function lookup(lookupNode, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node === lookupNode) {\n                                throw pos;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            } else if (node.nodeType == 3) {\n                                pos += node.nodeValue.length;\n                            }\n                        }(div));\n                    } catch (index) {\n                        return index;\n                    }\n                }\n            },\n            setPos: function (begin, end) {\n                var eiv = this.element[0];\n                begin = lookup(eiv, begin);\n                if (end != null) {\n                    end = lookup(eiv, end);\n                } else {\n                    end = begin;\n                }\n                if (begin && end) {\n                    var range = document.createRange();\n                    range.setStart(begin.node, begin.pos);\n                    range.setEnd(end.node, end.pos);\n                    var sel = window.getSelection();\n                    var currentRange = sel.getRangeAt(0);\n                    if (differ(range, currentRange)) {\n                        sel.removeAllRanges();\n                        sel.addRange(range);\n                    }\n                }\n                function differ(a, b) {\n                    return a.startOffset != b.startOffset || a.endOffset != b.endOffset || a.startContainer != b.endContainer || a.endContainer != b.endContainer;\n                }\n                function lookup(node, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node.nodeType == 3) {\n                                var len = node.nodeValue.length;\n                                if (len >= pos) {\n                                    throw node;\n                                }\n                                pos -= len;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            }\n                        }(node));\n                    } catch (el) {\n                        return {\n                            node: el,\n                            pos: pos\n                        };\n                    }\n                }\n            },\n            end: function () {\n                this.setPos(this.length());\n            },\n            home: function () {\n                this.setPos(0);\n            },\n            length: function () {\n                return this.value().length;\n            },\n            _formulaSource: function () {\n                var result = [];\n                var value;\n                for (var key in kendo.spreadsheet.calc.runtime.FUNCS) {\n                    if (!PRIVATE_FORMULA_CHECK.test(key)) {\n                        value = key.toUpperCase();\n                        result.push({\n                            value: value,\n                            text: value\n                        });\n                    }\n                }\n                this.formulaSource = new kendo.data.DataSource({ data: result });\n            },\n            _formulaList: function () {\n                this.list = new kendo.ui.StaticList($('<ul />').addClass(FormulaInput.classNames.listWrapper).insertAfter(this.element), {\n                    autoBind: false,\n                    selectable: true,\n                    change: this._formulaListChange.bind(this),\n                    dataSource: this.formulaSource,\n                    dataValueField: 'value',\n                    template: '#:data.value#'\n                });\n                this.list.element.on('mousedown', function (e) {\n                    e.preventDefault();\n                });\n            },\n            _formulaListChange: function () {\n                var tokenCtx = this._tokenContext();\n                if (!tokenCtx || this._mute) {\n                    return;\n                }\n                var activeToken = tokenCtx.token;\n                var completion = this.list.value()[0];\n                var ctx = {\n                    replace: true,\n                    token: activeToken,\n                    end: activeToken.end\n                };\n                if (!tokenCtx.nextToken || tokenCtx.nextToken.value != '(') {\n                    completion += '(';\n                }\n                this._replaceAt(ctx, completion);\n                this.popup.close();\n            },\n            _popup: function () {\n                this.popup = new kendo.ui.Popup(this.list.element, { anchor: this.element });\n            },\n            _blur: function () {\n                this.popup.close();\n                clearTimeout(this._focusId);\n                this.trigger('blur');\n            },\n            _isFormula: function () {\n                return /^=/.test(this.value());\n            },\n            _keydown: function (e) {\n                var key = e.keyCode;\n                if (KEY_NAMES[key]) {\n                    this.popup.close();\n                    this._navigated = true;\n                } else if (this._move(key)) {\n                    this._navigated = true;\n                    e.preventDefault();\n                }\n                this._keyDownTimeout = setTimeout(this._syntaxHighlight.bind(this));\n            },\n            _keyup: function () {\n                var popup = this.popup;\n                var value;\n                if (this._isFormula() && !this._navigated) {\n                    value = ((this._tokenContext() || {}).token || {}).value;\n                    this.filter(value);\n                    if (!value || !this.formulaSource.view().length) {\n                        popup.close();\n                    } else {\n                        popup[popup.visible() ? 'position' : 'open']();\n                        this.list.focusFirst();\n                    }\n                }\n                this._navigated = false;\n                this._syntaxHighlight();\n                this.trigger('keyup');\n            },\n            _input: function () {\n                this._syntaxHighlight();\n            },\n            _focus: function () {\n                this._focusTimeout = setTimeout(this._syntaxHighlight.bind(this));\n                this.trigger('focus');\n            },\n            _paste: function (ev) {\n                ev.preventDefault();\n                var pos = this.getPos();\n                var text;\n                if (kendo.support.browser.msie) {\n                    text = window.clipboardData.getData('Text');\n                } else {\n                    text = ev.originalEvent.clipboardData.getData('text/plain');\n                }\n                var val = this.value();\n                val = val.substr(0, pos.begin) + text + val.substr(pos.end);\n                this.value(val);\n                this.setPos(pos.begin + text.length);\n                this.scale();\n            },\n            _move: function (key) {\n                var list = this.list;\n                var popup = this.popup;\n                if (popup.visible()) {\n                    if (key === keys.DOWN) {\n                        list.focusNext();\n                        if (!list.focus()) {\n                            list.focusFirst();\n                        }\n                        return true;\n                    }\n                    if (key === keys.UP) {\n                        list.focusPrev();\n                        if (!list.focus()) {\n                            list.focusLast();\n                        }\n                        return true;\n                    }\n                    if (key === keys.ENTER) {\n                        list.select(list.focus());\n                        popup.close();\n                        return true;\n                    }\n                    if (key === keys.TAB) {\n                        list.select(list.focus());\n                        popup.close();\n                        return true;\n                    }\n                    if (key === keys.PAGEUP) {\n                        list.focusFirst();\n                        return true;\n                    }\n                    if (key === keys.PAGEDOWN) {\n                        list.focusLast();\n                        return true;\n                    }\n                }\n                return key === keys.ENTER;\n            },\n            _tokenContext: function () {\n                var point = this.getPos();\n                var value = this.value();\n                if (!value || !point || !point.collapsed) {\n                    return null;\n                }\n                var tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                var tok;\n                for (var i = 0; i < tokens.length; ++i) {\n                    tok = tokens[i];\n                    if (touches(tok, point) && /^(?:str|sym|func)$/.test(tok.type)) {\n                        return {\n                            token: tok,\n                            nextToken: tokens[i + 1]\n                        };\n                    }\n                }\n                return null;\n            },\n            _sync: function () {\n                if (this._editorToSync && this.isActive()) {\n                    this._editorToSync.value(this.value());\n                }\n            },\n            _textContainer: function () {\n                var computedStyles = kendo.getComputedStyles(this.element[0], styles);\n                computedStyles.position = 'absolute';\n                computedStyles.visibility = 'hidden';\n                computedStyles.whiteSpace = 'pre';\n                computedStyles.top = -3333;\n                computedStyles.left = -3333;\n                this._span = $('<span style=\\'white-space: pre\\'/>').css(computedStyles).insertAfter(this.element);\n            },\n            _tooltip: function () {\n                this._cellTooltip = $('<div class=\"k-widget k-tooltip\" style=\"position:absolute; display:none\">A1</div>').insertAfter(this.element);\n            },\n            tooltip: function (value) {\n                this._cellTooltip.text(value);\n            },\n            toggleTooltip: function (show) {\n                this._cellTooltip.toggle(show);\n            },\n            isActive: function () {\n                return this.element[0] === kendo._activeElement();\n            },\n            filter: function (value) {\n                if (!value || value.length < this.options.minLength) {\n                    return;\n                }\n                this._mute = true;\n                this.list.select(-1);\n                this._mute = false;\n                this.formulaSource.filter({\n                    field: this.list.options.dataValueField,\n                    operator: this.options.filterOperator,\n                    value: value\n                });\n            },\n            hide: function () {\n                this.enableEditing(false);\n                this.element.hide();\n                this._cellTooltip.hide();\n            },\n            show: function () {\n                this.enableEditing(true);\n                this.element.show();\n            },\n            row: function () {\n                if (this.activeCell) {\n                    return this.activeCell.row;\n                }\n            },\n            col: function () {\n                if (this.activeCell) {\n                    return this.activeCell.col;\n                }\n            },\n            position: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.show();\n                this.element.css({\n                    'top': rectangle.top + 1 + 'px',\n                    'left': rectangle.left + 1 + 'px'\n                });\n                this._cellTooltip.css({\n                    'top': rectangle.top - this._cellTooltip.height() - 10 + 'px',\n                    'left': rectangle.left\n                });\n            },\n            resize: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.element.css({\n                    width: rectangle.width - 1,\n                    height: rectangle.height - 1\n                });\n            },\n            canInsertRef: function (isKeyboardAction) {\n                var result = this._canInsertRef(isKeyboardAction);\n                var token = result && result.token;\n                var idx;\n                if (token) {\n                    for (idx = 0; idx < this._staticTokens.length; idx++) {\n                        if (isEqualToken(token, this._staticTokens[idx])) {\n                            return null;\n                        }\n                    }\n                }\n                return result;\n            },\n            _canInsertRef: function (isKeyboardAction) {\n                if (this.popup.visible()) {\n                    return null;\n                }\n                var strictMode = isKeyboardAction;\n                var point = this.getPos();\n                var tokens, tok;\n                if (point && this._isFormula()) {\n                    if (point.begin === 0) {\n                        return null;\n                    }\n                    tokens = kendo.spreadsheet.calc.tokenize(this.value(), this.row(), this.col());\n                    for (var i = 0; i < tokens.length; ++i) {\n                        tok = tokens[i];\n                        if (touches(tok, point)) {\n                            return canReplace(tok);\n                        }\n                        if (afterPoint(tok)) {\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                    return canInsertBetween(tok, null);\n                }\n                return null;\n                function afterPoint(tok) {\n                    return tok.begin > point.begin;\n                }\n                function canReplace(tok) {\n                    if (tok) {\n                        if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                            return {\n                                replace: true,\n                                token: tok,\n                                end: tok.end\n                            };\n                        }\n                        if (/^(?:op|punc|startexp)$/.test(tok.type)) {\n                            if (tok.end == point.end) {\n                                return canInsertBetween(tok, tokens[i + 1]);\n                            }\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                }\n                function canInsertBetween(left, right) {\n                    if (left == null) {\n                        return null;\n                    }\n                    if (right == null) {\n                        if (/^(?:op|startexp)$/.test(left.type) || isOpenParen(left.value)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        return null;\n                    }\n                    if (strictMode) {\n                        if (left.type == 'op' && /^(?:punc|op)$/.test(right.type)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                    } else {\n                        if (left.type == 'startexp') {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:ref|op|punc)$/.test(left.type)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:punc|op)$/.test(left.type)) {\n                            return /^[,;({]$/.test(left.value) ? {\n                                token: left,\n                                end: point.end\n                            } : null;\n                        }\n                    }\n                    return false;\n                }\n            },\n            refAtPoint: function (ref) {\n                var x = this._canInsertRef();\n                if (x) {\n                    this._replaceAt(x, ref.simplify().toString());\n                }\n            },\n            _replaceAt: function (ctx, newValue) {\n                var value = this.value();\n                var tok = ctx.token;\n                var rest = value.substr(ctx.end);\n                value = value.substr(0, ctx.replace ? tok.begin : ctx.end) + newValue;\n                var point = value.length;\n                value += rest;\n                this._value(value);\n                this.setPos(point);\n                this.scale();\n                this._syntaxHighlight();\n                this._sync();\n            },\n            syncWith: function (formulaInput) {\n                var self = this;\n                var eventName = 'input' + ns;\n                var handler = self._sync.bind(self), iehandler;\n                if (kendo.support.browser.msie) {\n                    eventName = 'keydown' + ns;\n                    iehandler = function () {\n                        setTimeout(handler);\n                    };\n                }\n                self._editorToSync = formulaInput;\n                self.element.off(eventName).on(eventName, iehandler || handler);\n            },\n            scale: function () {\n                var element = this.element;\n                var width, height;\n                if (!this._span) {\n                    this._textContainer();\n                }\n                this._span.html(element.html());\n                width = this._span.width() + this.options.scalePadding;\n                height = this._span.height();\n                if (width > element.width()) {\n                    element.width(width);\n                }\n                if (height > element.height()) {\n                    element.height(height);\n                }\n            },\n            _value: function (value) {\n                this.element.text(value);\n            },\n            value: function (value) {\n                if (value === undefined) {\n                    var txt = this.element[0].innerText;\n                    if (kendo.support.browser.mozilla) {\n                        txt = txt.replace(/\\n$/, '');\n                    }\n                    return txt;\n                }\n                this._value(value);\n                this._syntaxHighlight();\n            },\n            highlightedRefs: function () {\n                return this._highlightedRefs.slice();\n            },\n            _syntaxHighlight: function () {\n                var pos = this.getPos();\n                var value = this.value();\n                var refClasses = kendo.spreadsheet.Pane.classNames.series;\n                var highlightedRefs = [];\n                var refIndex = 0;\n                var parens = [];\n                var tokens = [];\n                var activeToken;\n                if (pos && !pos.collapsed) {\n                    return;\n                }\n                if (!/^=/.test(value)) {\n                    if (this._staticTokens.length || this._highlightedRefs.length) {\n                        this._staticTokens = [];\n                        this._highlightedRefs = [];\n                        this.element.text(value);\n                    }\n                    if (this.popup) {\n                        this.popup.close();\n                    }\n                    return;\n                } else {\n                    tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                    tokens.forEach(function (tok) {\n                        tok.active = false;\n                        tok.cls = ['k-syntax-' + tok.type];\n                        if (tok.type == 'ref') {\n                            tok.colorClass = refClasses[refIndex++ % refClasses.length];\n                            tok.cls.push(tok.colorClass);\n                            highlightedRefs.push(tok);\n                        }\n                        if (pos && tok.type == 'punc') {\n                            if (isOpenParen(tok.value)) {\n                                parens.unshift(tok);\n                            } else if (isCloseParen(tok.value)) {\n                                var open = parens.shift();\n                                if (open) {\n                                    if (isMatchingParen(tok.value, open.value)) {\n                                        if (touches(tok, pos) || touches(open, pos)) {\n                                            tok.cls.push('k-syntax-paren-match');\n                                            open.cls.push('k-syntax-paren-match');\n                                        }\n                                    } else {\n                                        tok.cls.push('k-syntax-error');\n                                        open.cls.push('k-syntax-error');\n                                    }\n                                } else {\n                                    tok.cls.push('k-syntax-error');\n                                }\n                            }\n                        }\n                        if (pos && touches(tok, pos)) {\n                            tok.cls.push('k-syntax-at-point');\n                            tok.active = true;\n                            activeToken = tok;\n                        }\n                        if (tok.type == 'func' && !knownFunction(tok.value) && (!pos || !touches(tok, pos))) {\n                            tok.cls.push('k-syntax-error');\n                        }\n                    });\n                    tokens.reverse().forEach(function (tok) {\n                        var begin = tok.begin, end = tok.end;\n                        var text = kendo.htmlEncode(value.substring(begin, end));\n                        value = value.substr(0, begin) + '<span class=\\'' + tok.cls.join(' ') + '\\'>' + text + '</span>' + value.substr(end);\n                    });\n                    this.element.html(value);\n                }\n                if (pos) {\n                    this.setPos(pos.begin, pos.end);\n                }\n                if (activeToken && /^(?:startexp|op|punc)$/.test(activeToken.type)) {\n                    this._setStaticTokens(tokens);\n                }\n                this._highlightedRefs = highlightedRefs;\n            },\n            _setStaticTokens: function (tokens) {\n                var idx, tok;\n                this._staticTokens = [];\n                for (idx = 0; idx < tokens.length; idx++) {\n                    tok = tokens[idx];\n                    if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                        this._staticTokens.push(tok);\n                    }\n                }\n            },\n            destroy: function () {\n                this._editorToSync = null;\n                this.element.off(ns);\n                clearTimeout(this._focusTimeout);\n                clearTimeout(this._keyDownTimeout);\n                this._cellTooltip = null;\n                this._span = null;\n                this.popup.destroy();\n                this.popup = null;\n                Widget.fn.destroy.call(this);\n            },\n            insertNewline: function () {\n                var val = this.value();\n                var pos = this.getPos();\n                var eof = pos.end == val.length;\n                val = val.substr(0, pos.begin) + (eof ? '\\n\\n' : '\\n' + val.substr(pos.end));\n                this.value(val);\n                this.setPos(pos.begin + 1);\n            }\n        });\n        function isOpenParen(ch) {\n            return ch == '(' || ch == '[' || ch == '{';\n        }\n        function isCloseParen(ch) {\n            return ch == ')' || ch == ']' || ch == '}';\n        }\n        function isMatchingParen(close, open) {\n            return open == '(' ? close == ')' : open == '[' ? close == ']' : open == '{' ? close == '}' : false;\n        }\n        function touches(pos, target) {\n            return pos.begin <= target.begin && pos.end >= target.end;\n        }\n        function knownFunction(name) {\n            return kendo.spreadsheet.calc.runtime.FUNCS[name.toLowerCase()];\n        }\n        function isEqualToken(tok1, tok2) {\n            if (!tok1 || !tok2) {\n                return false;\n            }\n            if (tok1.type == 'ref' && tok2.type == 'ref') {\n                return tok1.ref.eq(tok2.ref);\n            } else {\n                return tok1.value === tok2.value;\n            }\n        }\n        kendo.spreadsheet.FormulaInput = FormulaInput;\n        $.extend(true, FormulaInput, { classNames: classNames });\n    }(kendo, window));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/eventlistener', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var KEY_NAMES = {\n            8: 'backspace',\n            9: 'tab',\n            13: 'enter',\n            27: 'esc',\n            37: 'left',\n            38: 'up',\n            39: 'right',\n            40: 'down',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar',\n            33: 'pageup',\n            34: 'pagedown',\n            46: 'delete',\n            113: ':edit'\n        };\n        var Mac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n        var isAlphaNum = function (keyCode) {\n            if (keyCode > 47 && keyCode < 58 || keyCode > 64 && keyCode < 91 || keyCode > 95 && keyCode < 112 || keyCode > 185 && keyCode < 193 || keyCode > 218 && keyCode < 223) {\n                return true;\n            }\n            return false;\n        };\n        var keyName = function (event) {\n            var keyCode = event.keyCode;\n            var name = KEY_NAMES[keyCode];\n            if (!name && isAlphaNum(keyCode)) {\n                name = ':alphanum';\n            }\n            if (!name && event.key && event.key.length == 1) {\n                name = ':alphanum';\n            }\n            return name;\n        };\n        var EventListener = kendo.Class.extend({\n            init: function (target, observer, handlers) {\n                this._handlers = {};\n                this.target = target;\n                this._observer = observer || window;\n                this.keyDownProxy = this.keyDown.bind(this);\n                this.mouseProxy = this.mouse.bind(this);\n                this.threshold = 5;\n                this._pressLocation = null;\n                target.on('keydown', this.keyDownProxy);\n                target.on('contextmenu mousedown cut copy paste scroll wheel click dblclick focus', this.mouseProxy);\n                $(document.documentElement).on('mousemove mouseup', this.mouseProxy);\n                if (handlers) {\n                    for (var key in handlers) {\n                        this.on(key, handlers[key]);\n                    }\n                }\n            },\n            keyDown: function (e) {\n                this.handleEvent(e, keyName(e.originalEvent));\n            },\n            mouse: function (e) {\n                var rightClick;\n                if (e.which) {\n                    rightClick = e.which == 3;\n                } else if (e.button) {\n                    rightClick = e.button == 2;\n                }\n                var type = e.type;\n                if (type === 'mousedown') {\n                    if (rightClick) {\n                        type = 'rightmousedown';\n                    } else {\n                        this._pressLocation = {\n                            x: e.pageX,\n                            y: e.pageY\n                        };\n                    }\n                }\n                if (type === 'mouseup') {\n                    if (!rightClick) {\n                        this._pressLocation = null;\n                    }\n                }\n                if (type === 'mousemove' && this._pressLocation) {\n                    var dx = this._pressLocation.x - e.pageX;\n                    var dy = this._pressLocation.y - e.pageY;\n                    var distance = Math.sqrt(dx * dx + dy * dy);\n                    if (distance > this.threshold) {\n                        type = 'mousedrag';\n                    }\n                }\n                this.handleEvent(e, type);\n            },\n            handleEvent: function (e, name) {\n                var eventKey = '';\n                e.mod = Mac ? e.metaKey : e.ctrlKey && !e.altKey;\n                if (e.altKey) {\n                    eventKey += 'alt+';\n                }\n                if (e.shiftKey) {\n                    eventKey += 'shift+';\n                }\n                if (e.ctrlKey) {\n                    eventKey += 'ctrl+';\n                }\n                eventKey += name;\n                var catchAllHandler = this._handlers['*+' + name];\n                if (catchAllHandler) {\n                    catchAllHandler.call(this._observer, e, eventKey);\n                }\n                var handler = this._handlers[eventKey];\n                if (handler) {\n                    handler.call(this._observer, e, eventKey);\n                }\n            },\n            on: function (event, callback) {\n                var handlers = this._handlers;\n                if (typeof callback === 'string') {\n                    callback = this._observer[callback];\n                }\n                if (typeof event === 'string') {\n                    event = event.split(',');\n                }\n                event.forEach(function (e) {\n                    handlers[e] = callback;\n                });\n            },\n            destroy: function () {\n                this.target.off('keydown', this.keyDownProxy);\n                this.target.off('keydown', this.mouseProxy);\n                $(document.documentElement).off('mousemove mouseup', this.mouseProxy);\n            }\n        });\n        kendo.spreadsheet.EventListener = EventListener;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/rangelist', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeTreeNode = kendo.Class.extend({\n            init: function Node(level, value, left, right) {\n                this.level = level;\n                this.value = value;\n                this.left = left;\n                this.right = right;\n            }\n        });\n        var NilNode = new function NIL() {\n            this.left = this;\n            this.right = this;\n            this.level = 0;\n        }();\n        function passThrough(value) {\n            return value;\n        }\n        function skew(node) {\n            if (node.left.level === node.level) {\n                var temp = node;\n                node = node.left;\n                temp.left = node.right;\n                node.right = temp;\n            }\n            return node;\n        }\n        function split(node) {\n            if (node.right.right.level === node.level) {\n                var temp = node;\n                node = node.right;\n                temp.right = node.left;\n                node.left = temp;\n                node.level += 1;\n            }\n            return node;\n        }\n        function insert(node, value) {\n            if (node === NilNode) {\n                return new RangeTreeNode(1, value, NilNode, NilNode);\n            } else if (node.value.start - value.start > 0) {\n                node.left = insert(node.left, value);\n            } else {\n                node.right = insert(node.right, value);\n            }\n            return split(skew(node));\n        }\n        function remove(node, value) {\n            if (node === NilNode) {\n                return node;\n            }\n            var diff = node.value.start - value.start;\n            if (diff === 0) {\n                if (node.left !== NilNode && node.right !== NilNode) {\n                    var heir = node.left;\n                    while (heir.right !== NilNode) {\n                        heir = heir.right;\n                    }\n                    node.value = heir.value;\n                    node.left = remove(node.left, node.value);\n                } else if (node.left === NilNode) {\n                    node = node.right;\n                } else {\n                    node = node.left;\n                }\n            } else if (diff > 0) {\n                node.left = remove(node.left, value);\n            } else {\n                node.right = remove(node.right, value);\n            }\n            if (node.left.level < node.level - 1 || node.right.level < node.level - 1) {\n                node.level -= 1;\n                if (node.right.level > node.level) {\n                    node.right.level = node.level;\n                }\n                node = skew(node);\n                node.right = skew(node.right);\n                node.right.right = skew(node.right.right);\n                node = split(node);\n                node.right = split(node.right);\n            }\n            return node;\n        }\n        var Range = kendo.Class.extend({\n            init: function Value(start, end, value) {\n                this.start = start;\n                this.end = end;\n                this.value = value;\n            },\n            intersects: function (range) {\n                return range.start <= this.end && range.end >= this.start;\n            }\n        });\n        var RangeTree = kendo.Class.extend({\n            init: function () {\n                this.root = NilNode;\n            },\n            insert: function (value) {\n                this.root = insert(this.root, value);\n            },\n            remove: function (value) {\n                this.root = remove(this.root, value);\n            },\n            findrange: function (value) {\n                var node = this.root;\n                while (node != NilNode) {\n                    if (value < node.value.start) {\n                        node = node.left;\n                    } else if (value > node.value.end) {\n                        node = node.right;\n                    } else {\n                        return node.value;\n                    }\n                }\n                return null;\n            },\n            values: function () {\n                var result = [];\n                values(this.root, result);\n                return result;\n            },\n            intersecting: function (start, end) {\n                var ranges = [];\n                intersecting(this.root, new Range(start, end), ranges);\n                return ranges;\n            },\n            map: function (callback) {\n                var tree = new RangeTree();\n                map(tree, this.root, callback);\n                return tree;\n            },\n            clone: function () {\n                return this.map(passThrough);\n            },\n            first: function () {\n                var first = this.root;\n                while (first.left != NilNode) {\n                    first = first.left;\n                }\n                return first;\n            },\n            last: function () {\n                var last = this.root;\n                while (last.right != NilNode) {\n                    last = last.right;\n                }\n                return last;\n            }\n        });\n        function values(node, result) {\n            if (node === NilNode) {\n                return;\n            }\n            values(node.left, result);\n            result.push(node.value);\n            values(node.right, result);\n        }\n        function intersecting(node, range, ranges) {\n            if (node === NilNode) {\n                return;\n            }\n            var value = node.value;\n            if (range.start < value.start) {\n                intersecting(node.left, range, ranges);\n            }\n            if (value.intersects(range)) {\n                ranges.push(value);\n            }\n            if (range.end > value.end) {\n                intersecting(node.right, range, ranges);\n            }\n        }\n        function map(tree, root, callback) {\n            if (root === NilNode) {\n                return;\n            }\n            map(tree, root.left, callback);\n            tree.insert(callback(root.value));\n            map(tree, root.right, callback);\n        }\n        var RangeList = kendo.Class.extend({\n            init: function (start, end, value) {\n                if (end === undefined) {\n                    this.tree = start;\n                } else {\n                    this.tree = new RangeTree();\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            values: function () {\n                return this.tree.values();\n            },\n            map: function (callback) {\n                return new RangeList(this.tree.map(callback));\n            },\n            intersecting: function (start, end) {\n                return this.tree.intersecting(start, end);\n            },\n            first: function () {\n                return this.tree.first().value;\n            },\n            last: function () {\n                return this.tree.last().value;\n            },\n            insert: function (start, end, value) {\n                return this.tree.insert(new Range(start, end, value));\n            },\n            value: function (start, end, value) {\n                if (value === undefined) {\n                    if (end === undefined) {\n                        end = start;\n                    }\n                    return this.intersecting(start, end)[0].value;\n                }\n                var ranges = this.tree.intersecting(start - 1, end + 1);\n                if (ranges.length) {\n                    var firstRange = ranges[0], lastRange = ranges[ranges.length - 1];\n                    if (firstRange.end < start) {\n                        if (firstRange.value === value) {\n                            start = firstRange.start;\n                        } else {\n                            ranges.shift();\n                        }\n                    }\n                    if (lastRange.start > end) {\n                        if (lastRange.value === value) {\n                            end = lastRange.end;\n                        } else {\n                            ranges.pop();\n                        }\n                    }\n                    for (var i = 0, length = ranges.length; i < length; i++) {\n                        var range = ranges[i];\n                        var rangeValue = range.value;\n                        var rangeStart = range.start;\n                        var rangeEnd = range.end;\n                        this.tree.remove(range);\n                        if (rangeStart < start) {\n                            if (rangeValue !== value) {\n                                this.insert(rangeStart, start - 1, rangeValue);\n                            } else {\n                                start = rangeStart;\n                            }\n                        }\n                        if (rangeEnd > end) {\n                            if (rangeValue !== value) {\n                                this.insert(end + 1, rangeEnd, rangeValue);\n                            } else {\n                                end = rangeEnd;\n                            }\n                        }\n                    }\n                }\n                this.insert(start, end, value);\n            },\n            expandedValues: function (start, end) {\n                var ranges = this.intersecting(start, end);\n                var result = [];\n                var rangeIndex = 0;\n                for (var i = start; i <= end; i++) {\n                    if (ranges[rangeIndex].end < i) {\n                        rangeIndex++;\n                    }\n                    result.push({\n                        index: i - start,\n                        value: ranges[rangeIndex].value\n                    });\n                }\n                return result;\n            },\n            sortedIndices: function (start, end, valueComparer, indices) {\n                var result = this.expandedValues(start, end);\n                var comparer = function (a, b) {\n                    if (a.value === b.value) {\n                        return a.index - b.index;\n                    }\n                    return valueComparer(a.value, b.value);\n                };\n                if (indices) {\n                    comparer = function (a, b) {\n                        var x = indices[a.index];\n                        var y = indices[b.index];\n                        if (x.value === y.value) {\n                            return valueComparer(a.value, b.value);\n                        }\n                        return a.index - b.index;\n                    };\n                }\n                result.sort(comparer);\n                return result;\n            },\n            sort: function (start, end, indices) {\n                if (this.intersecting(start, end).length === 1) {\n                    return;\n                }\n                var values = this.expandedValues(start, end);\n                for (var i = 0, len = indices.length; i < len; i++) {\n                    this.value(i + start, i + start, values[indices[i].index].value);\n                }\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                var values = this.intersecting(sourceStart, sourceEnd);\n                var start = targetStart;\n                var end;\n                for (var i = 0, len = values.length; i < len; i++) {\n                    var rangeStart = values[i].start;\n                    if (rangeStart < sourceStart) {\n                        rangeStart = sourceStart;\n                    }\n                    var rangeEnd = values[i].end;\n                    if (rangeEnd > sourceEnd) {\n                        rangeEnd = sourceEnd;\n                    }\n                    end = start + (rangeEnd - rangeStart);\n                    this.value(start, end, values[i].value);\n                    start = ++end;\n                }\n            },\n            iterator: function (start, end) {\n                return new Iterator(start, end, this.intersecting(start, end));\n            },\n            getState: function () {\n                return this.tree.clone();\n            },\n            setState: function (state) {\n                this.tree = state;\n            }\n        });\n        var Iterator = kendo.Class.extend({\n            init: function (start, end, ranges) {\n                this.start = start;\n                this.end = end;\n                this.index = 0;\n                this.ranges = ranges;\n            },\n            unique: function () {\n                return this.ranges.map(function (range) {\n                    return range.value;\n                });\n            },\n            at: function (index) {\n                while (this.ranges[this.index].end < index) {\n                    this.index++;\n                }\n                return this.ranges[this.index].value;\n            },\n            forEach: function (callback) {\n                for (var i = this.start; i <= this.end; i++) {\n                    callback(this.at(i), i);\n                }\n                this.index = 0;\n            }\n        });\n        var SparseRangeList = RangeList.extend({\n            init: function (start, end, value) {\n                this.tree = new RangeTree();\n                this.range = new Range(start, end, value);\n            },\n            intersecting: function (start, end) {\n                var ranges = this.tree.intersecting(start, end);\n                var result = [];\n                var range;\n                if (!ranges.length) {\n                    return [this.range];\n                }\n                for (var i = 0, len = ranges.length; i < len; i++) {\n                    range = ranges[i];\n                    if (range.start > start) {\n                        result.push(new Range(start, range.start - 1, this.range.value));\n                    }\n                    result.push(range);\n                    start = range.end + 1;\n                }\n                if (range.end < end) {\n                    result.push(new Range(range.end + 1, end, this.range.value));\n                }\n                return result;\n            },\n            insert: function (start, end, value) {\n                if (value !== this.range.value) {\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            lastRangeStart: function () {\n                var node = this.tree.root;\n                if (node === NilNode) {\n                    return this.range.start;\n                }\n                while (node.right !== NilNode) {\n                    node = node.right;\n                }\n                return node.value.end + 1;\n            }\n        });\n        kendo.spreadsheet.RangeTree = RangeTree;\n        kendo.spreadsheet.RangeList = RangeList;\n        kendo.spreadsheet.SparseRangeList = SparseRangeList;\n        kendo.spreadsheet.ValueRange = Range;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/propertybag', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Property = kendo.Class.extend({\n            init: function (list) {\n                this.list = list;\n            },\n            get: function (index) {\n                return this.parse(this.list.value(index, index));\n            },\n            set: function (start, end, value) {\n                if (value === undefined) {\n                    value = end;\n                    end = start;\n                }\n                this.list.value(start, end, value);\n            },\n            parse: function (value) {\n                return value;\n            },\n            copy: function (start, end, dst) {\n                this.list.copy(start, end, dst);\n            },\n            iterator: function (start, end) {\n                return this.list.iterator(start, end);\n            }\n        });\n        var JsonProperty = Property.extend({\n            set: function (start, end, value) {\n                this.list.value(start, end, JSON.stringify(value));\n            },\n            parse: function (value) {\n                return JSON.parse(value);\n            }\n        });\n        var ValueProperty = Property.extend({\n            init: function (values, formats, validations) {\n                Property.prototype.init.call(this, values);\n                this.validations = validations;\n                this.formats = formats;\n            },\n            set: function (start, end, value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                    this.formats.value(start, end, toExcelFormat(kendo.culture().calendar.patterns.d));\n                }\n                this.list.value(start, end, value);\n            }\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        kendo.spreadsheet.PropertyBag = kendo.Class.extend({\n            specs: [\n                {\n                    property: ValueProperty,\n                    name: 'value',\n                    value: null,\n                    sortable: true,\n                    serializable: true,\n                    depends: 'format'\n                },\n                {\n                    property: Property,\n                    name: 'format',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'formula',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'background',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderBottom',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderRight',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderLeft',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderTop',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'color',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontFamily',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'underline',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontSize',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'italic',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'bold',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'textAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'verticalAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'wrap',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'validation',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'enable',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'link',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'editor',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                }\n            ],\n            init: function (cellCount) {\n                this.properties = {};\n                this.lists = {};\n                this.specs.forEach(function (spec) {\n                    this.lists[spec.name] = new kendo.spreadsheet.SparseRangeList(0, cellCount, spec.value);\n                }, this);\n                this.specs.forEach(function (spec) {\n                    this.properties[spec.name] = new spec.property(this.lists[spec.name], this.lists[spec.depends]);\n                }, this);\n            },\n            getState: function () {\n                var state = {};\n                this.specs.forEach(function (spec) {\n                    state[spec.name] = this.lists[spec.name].getState();\n                }, this);\n                return state;\n            },\n            setState: function (state) {\n                this.specs.forEach(function (spec) {\n                    this.lists[spec.name].setState(state[spec.name]);\n                }, this);\n            },\n            get: function (name, index) {\n                if (index === undefined) {\n                    return this.lists[name];\n                }\n                return this.properties[name].get(index);\n            },\n            set: function (name, start, end, value) {\n                this.properties[name].set(start, end, value);\n            },\n            fromJSON: function (index, value) {\n                for (var si = 0; si < this.specs.length; si++) {\n                    var spec = this.specs[si];\n                    if (spec.serializable) {\n                        if (value[spec.name] !== undefined) {\n                            this.set(spec.name, index, index, value[spec.name], false);\n                        }\n                    }\n                }\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                this.specs.forEach(function (spec) {\n                    this.properties[spec.name].copy(sourceStart, sourceEnd, targetStart);\n                }, this);\n            },\n            iterator: function (name, start, end) {\n                return this.properties[name].iterator(start, end);\n            },\n            sortable: function () {\n                return this.specs.filter(function (spec) {\n                    return spec.sortable;\n                }).map(function (spec) {\n                    return this.lists[spec.name];\n                }, this);\n            },\n            iterators: function (start, end) {\n                var specs = this.specs.filter(function (spec) {\n                    return spec.serializable;\n                });\n                return specs.map(function (spec) {\n                    var iterator = this.iterator(spec.name, start, end);\n                    return {\n                        name: spec.name,\n                        value: spec.value,\n                        at: function (index) {\n                            return spec.property.fn.parse(iterator.at(index));\n                        }\n                    };\n                }, this);\n            },\n            forEach: function (start, end, callback) {\n                var iterators = this.iterators(start, end);\n                for (var index = start; index <= end; index++) {\n                    var values = {};\n                    for (var i = 0; i < iterators.length; i++) {\n                        var iterator = iterators[i];\n                        var value = iterator.at(index);\n                        if (value !== iterator.value) {\n                            values[iterator.name] = value;\n                        }\n                    }\n                    callback(values);\n                }\n            },\n            forEachProperty: function (callback) {\n                for (var name in this.properties) {\n                    callback(this.properties[name]);\n                }\n            }\n        });\n        kendo.spreadsheet.ALL_PROPERTIES = $.map(kendo.spreadsheet.PropertyBag.prototype.specs, function (spec) {\n            return spec.name;\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/references', ['kendo.core'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var Class = kendo.Class;\n    function columnName(colIndex) {\n        var letter = Math.floor(colIndex / 26) - 1;\n        return (letter >= 0 ? columnName(letter) : '') + String.fromCharCode(65 + colIndex % 26);\n    }\n    function displaySheet(sheet) {\n        if (/^[a-z0-9_]*$/i.test(sheet)) {\n            return sheet;\n        }\n        return '\\'' + sheet.replace(/\\x27/g, '\\\\\\'') + '\\'';\n    }\n    function displayRef(sheet, row, col, rel) {\n        var aa = '';\n        ++row;\n        if (!isFinite(row)) {\n            row = '';\n        } else if (rel != null && !(rel & 2)) {\n            row = '$' + row;\n        }\n        if (!isFinite(col)) {\n            col = '';\n        } else {\n            aa = columnName(col);\n            if (rel != null && !(rel & 1)) {\n                aa = '$' + aa;\n            }\n        }\n        if (sheet) {\n            return displaySheet(sheet) + '!' + aa + row;\n        } else {\n            return aa + row;\n        }\n    }\n    var Ref = Class.extend({\n        type: 'ref',\n        sheet: '',\n        clone: function () {\n            return this;\n        },\n        hasSheet: function () {\n            return this._hasSheet;\n        },\n        simplify: function () {\n            return this;\n        },\n        setSheet: function (sheet, hasSheet) {\n            this.sheet = sheet;\n            if (hasSheet != null) {\n                this._hasSheet = hasSheet;\n            }\n            return this;\n        },\n        absolute: function () {\n            return this;\n        },\n        relative: function () {\n            return this;\n        },\n        adjust: function () {\n            return this;\n        },\n        toString: function () {\n            return this.relative(0, 0, 3, 3).print(0, 0);\n        },\n        forEach: function (callback, obj) {\n            callback.call(obj, this);\n        },\n        map: function (callback, obj) {\n            return callback.call(obj, this);\n        },\n        intersects: function (ref) {\n            return this.intersect(ref) !== NULL;\n        },\n        isCell: function () {\n            return false;\n        },\n        toRow: function () {\n            return this;\n        },\n        toColumn: function () {\n            return this;\n        },\n        first: function () {\n            return this;\n        },\n        lastRange: function () {\n            return this;\n        },\n        size: function () {\n            return 1;\n        },\n        rangeAt: function () {\n            return this;\n        },\n        nextRangeIndex: function () {\n            return 0;\n        },\n        previousRangeIndex: function () {\n            return 0;\n        },\n        eq: function (reference) {\n            var r1 = this;\n            var r2 = reference;\n            if (r1 === NULL || r2 === NULL) {\n                return r1 === r2;\n            }\n            if (r2 instanceof CellRef || r2 instanceof RangeRef && !(r1 instanceof CellRef)) {\n                r1 = reference;\n                r2 = this;\n            }\n            if (r1 instanceof CellRef) {\n                r2 = r2.simplify();\n                return r2 instanceof CellRef && r1.row == r2.row && r1.col == r2.col && r1.sheet == r2.sheet;\n            } else if (r1 instanceof RangeRef) {\n                if (r2 instanceof RangeRef) {\n                    return r2.topLeft.eq(r1.topLeft) && r2.bottomRight.eq(r1.bottomRight);\n                }\n                if (r2 instanceof UnionRef) {\n                    return r2.single() && r1.eq(r2.refs[0]);\n                }\n            } else if (r1 instanceof UnionRef && r2 instanceof UnionRef) {\n                var refs1 = r1.refs;\n                var refs2 = r2.refs;\n                if (refs1.length != refs2.length) {\n                    return false;\n                }\n                for (var i = 0, len = refs1.length; i < len; i++) {\n                    if (!refs1[i].eq(refs2[i])) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n            return r1 === r2;\n        },\n        concat: function (ref) {\n            return new UnionRef([\n                this,\n                ref\n            ]);\n        },\n        replaceAt: function (index, ref) {\n            return ref;\n        },\n        forEachColumnIndex: function (callback) {\n            this.forEachAxisIndex('col', callback);\n        },\n        forEachRowIndex: function (callback) {\n            this.forEachAxisIndex('row', callback);\n        },\n        forEachAxisIndex: function (axis, callback) {\n            var sorted = [];\n            var method = axis === 'row' ? 'forEachRow' : 'forEachColumn';\n            this[method](function (ref) {\n                var index = ref.first()[axis];\n                if (sorted.indexOf(index) === -1) {\n                    sorted.push(index);\n                }\n            });\n            sorted.sort(function (a, b) {\n                return a > b ? 1 : a < b ? -1 : 0;\n            }).forEach(callback);\n        },\n        valid: function () {\n            return false;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            if (this.sheet && this.sheet.toLowerCase() == oldSheetName.toLowerCase()) {\n                this.sheet = newSheetName;\n                return true;\n            }\n        }\n    });\n    Ref.display = displayRef;\n    var NULL = new (Ref.extend({\n        init: function NullRef() {\n        },\n        print: function () {\n            return '#NULL!';\n        },\n        eq: function (ref) {\n            return ref === this;\n        },\n        forEach: function () {\n        }\n    }))();\n    var NameRef = Ref.extend({\n        ref: 'name',\n        init: function NameRef(name) {\n            this.name = name;\n        },\n        clone: function () {\n            return new NameRef(this.name).setSheet(this.sheet, this.hasSheet());\n        },\n        print: function () {\n            var ret = displaySheet(this.name);\n            if (this.hasSheet()) {\n                ret = displaySheet(this.sheet) + '!' + ret;\n            }\n            return ret;\n        }\n    });\n    var CellRef = Ref.extend({\n        ref: 'cell',\n        init: function CellRef(row, col, rel) {\n            this.row = row;\n            this.col = col;\n            this.rel = rel || 0;\n        },\n        clone: function () {\n            return new CellRef(this.row, this.col, this.rel).setSheet(this.sheet, this.hasSheet());\n        },\n        intersect: function (ref) {\n            if (ref instanceof CellRef) {\n                if (this.eq(ref)) {\n                    return this;\n                } else {\n                    return NULL;\n                }\n            }\n            return ref.intersect(this);\n        },\n        print: function (trow, tcol, mod) {\n            var col = this.col, row = this.row, rel = this.rel, abs;\n            if (trow == null && rel) {\n                var sheet = this.hasSheet() ? displaySheet(this.sheet) + '!' : '';\n                if (isFinite(col)) {\n                    col = rel & 1 ? 'C[' + col + ']' : 'C' + (col + 1);\n                } else {\n                    col = '';\n                }\n                if (isFinite(row)) {\n                    row = rel & 2 ? 'R[' + row + ']' : 'R' + (row + 1);\n                } else {\n                    row = '';\n                }\n                return sheet + row + col;\n            } else {\n                abs = this.absolute(trow, tcol);\n                if (mod) {\n                    row = abs.row % 1048576;\n                    col = abs.col % 16384;\n                    if (row < 0) {\n                        row += 1048576;\n                    }\n                    if (col < 0) {\n                        col += 16384;\n                    }\n                    return displayRef(this._hasSheet && this.sheet, row, col, rel);\n                }\n                return abs.valid() ? displayRef(this._hasSheet && this.sheet, abs.row, abs.col, rel) : '#REF!';\n            }\n        },\n        absolute: function (arow, acol) {\n            var ret = this.clone();\n            if (ret.rel & 3 === 0) {\n                return ret;\n            }\n            if (ret.rel & 1) {\n                ret.col = (ret.col + acol) % 16384;\n            }\n            if (ret.rel & 2) {\n                ret.row = (ret.row + arow) % 1048576;\n            }\n            ret.rel = 0;\n            return ret;\n        },\n        toRangeRef: function () {\n            return new RangeRef(this, this);\n        },\n        relative: function (arow, acol, rel) {\n            if (rel == null) {\n                rel = this.rel;\n            }\n            var row = rel & 2 ? this.row - arow : this.row;\n            var col = rel & 1 ? this.col - acol : this.col;\n            return new CellRef(row, col, rel).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            return 1;\n        },\n        width: function () {\n            return 1;\n        },\n        toString: function () {\n            return displayRef(null, this.row, this.col, 3);\n        },\n        isCell: function () {\n            return true;\n        },\n        leftColumn: function () {\n            return this;\n        },\n        rightColumn: function () {\n            return this;\n        },\n        topRow: function () {\n            return this;\n        },\n        bottomRow: function () {\n            return this;\n        },\n        forEachRow: function (callback) {\n            callback(this.toRangeRef());\n        },\n        forEachColumn: function (callback) {\n            callback(this.toRangeRef());\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var ref = this.absolute(row, col);\n            if (forRow) {\n                if (ref.row >= start) {\n                    if (delta < 0 && ref.row < start - delta) {\n                        return NULL;\n                    }\n                    ref.row += delta;\n                }\n            } else {\n                if (ref.col >= start) {\n                    if (delta < 0 && ref.col < start - delta) {\n                        return NULL;\n                    }\n                    ref.col += delta;\n                }\n            }\n            if (trow != null && tcol != null) {\n                ref = ref.relative(trow, tcol, this.rel);\n            }\n            return ref;\n        },\n        valid: function () {\n            if (this.rel) {\n                throw new Error('valid() called on relative reference');\n            }\n            var col = this.col, row = this.row;\n            return !(isFinite(col) && col < 0 || isFinite(row) && row < 0);\n        }\n    });\n    var RangeRef = Ref.extend({\n        ref: 'range',\n        init: function RangeRef(tl, br) {\n            if (tl._hasSheet && br._hasSheet && tl.sheet.toLowerCase() != br.sheet.toLowerCase()) {\n                this.endSheet = br.sheet;\n            }\n            this.topLeft = new CellRef(tl.row, tl.col, tl.rel);\n            this.bottomRight = new CellRef(br.row, br.col, br.rel);\n            this.normalize();\n        },\n        clone: function () {\n            return new RangeRef(this.topLeft.clone(), this.bottomRight.clone()).setSheet(this.sheet, this.hasSheet());\n        },\n        _containsRange: function (range) {\n            return this._containsCell(range.topLeft) && this._containsCell(range.bottomRight);\n        },\n        _containsCell: function (cell) {\n            return cell.sheet == this.sheet && cell.row >= this.topLeft.row && cell.col >= this.topLeft.col && cell.row <= this.bottomRight.row && cell.col <= this.bottomRight.col;\n        },\n        contains: function (ref) {\n            if (ref instanceof Array) {\n                var that = this;\n                return ref.some(function (_ref) {\n                    return that.contains(_ref);\n                });\n            }\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref);\n            }\n            if (ref instanceof RangeRef) {\n                return this._containsRange(ref);\n            }\n            return false;\n        },\n        _intersectRange: function (ref) {\n            if (this.sheet != ref.sheet) {\n                return NULL;\n            }\n            var a_left = this.topLeft.col;\n            var a_top = this.topLeft.row;\n            var a_right = this.bottomRight.col;\n            var a_bottom = this.bottomRight.row;\n            var b_left = ref.topLeft.col;\n            var b_top = ref.topLeft.row;\n            var b_right = ref.bottomRight.col;\n            var b_bottom = ref.bottomRight.row;\n            if (a_left <= b_right && b_left <= a_right && a_top <= b_bottom && b_top <= a_bottom) {\n                return new RangeRef(new CellRef(Math.max(a_top, b_top), Math.max(a_left, b_left)), new CellRef(Math.min(a_bottom, b_bottom), Math.min(a_right, b_right))).setSheet(this.sheet, this.hasSheet());\n            } else {\n                return NULL;\n            }\n        },\n        intersect: function (ref) {\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref) ? ref : NULL;\n            }\n            if (ref instanceof RangeRef) {\n                return this._intersectRange(ref).simplify();\n            }\n            if (ref instanceof UnionRef) {\n                return ref.intersect(this);\n            }\n            return NULL;\n        },\n        simplify: function () {\n            if (this.isCell()) {\n                return new CellRef(this.topLeft.row, this.topLeft.col, this.topLeft.rel).setSheet(this.sheet, this.hasSheet());\n            }\n            return this;\n        },\n        normalize: function () {\n            var a = this.topLeft, b = this.bottomRight;\n            var r1 = a.row, c1 = a.col, r2 = b.row, c2 = b.col;\n            var rr1 = a.rel & 2, rc1 = a.rel & 1;\n            var rr2 = b.rel & 2, rc2 = b.rel & 1;\n            var tmp, changes = false;\n            if (r1 > r2) {\n                changes = true;\n                tmp = r1;\n                r1 = r2;\n                r2 = tmp;\n                tmp = rr1;\n                rr1 = rr2;\n                rr2 = tmp;\n            }\n            if (c1 > c2) {\n                changes = true;\n                tmp = c1;\n                c1 = c2;\n                c2 = tmp;\n                tmp = rc1;\n                rc1 = rc2;\n                rc2 = tmp;\n            }\n            if (changes) {\n                this.topLeft = new CellRef(r1, c1, rc1 | rr1);\n                this.bottomRight = new CellRef(r2, c2, rc2 | rr2);\n            }\n            return this;\n        },\n        print: function (trow, tcol, mod) {\n            if (mod || this.absolute(trow, tcol).valid()) {\n                var ret = this.topLeft.print(trow, tcol, mod) + ':' + this.bottomRight.print(trow, tcol, mod);\n                if (this.hasSheet()) {\n                    ret = displaySheet(this.sheet) + (this.endSheet ? ':' + displaySheet(this.endSheet) : '') + '!' + ret;\n                }\n                return ret;\n            }\n            return '#REF!';\n        },\n        absolute: function (arow, acol) {\n            return new RangeRef(this.topLeft.absolute(arow, acol), this.bottomRight.absolute(arow, acol)).setSheet(this.sheet, this.hasSheet());\n        },\n        relative: function (arow, acol, relTL, relBR) {\n            if (relBR == null) {\n                relBR = relTL;\n            }\n            return new RangeRef(this.topLeft.relative(arow, acol, relTL), this.bottomRight.relative(arow, acol, relBR)).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.row - this.topLeft.row + 1;\n        },\n        width: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.col - this.topLeft.col + 1;\n        },\n        collapse: function () {\n            return this.topLeft.toRangeRef();\n        },\n        leftColumn: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.bottomRight.row, this.topLeft.col));\n        },\n        rightColumn: function () {\n            return new RangeRef(new CellRef(this.topLeft.row, this.bottomRight.col), this.bottomRight);\n        },\n        topRow: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.topLeft.row, this.bottomRight.col));\n        },\n        bottomRow: function () {\n            return new RangeRef(new CellRef(this.bottomRight.row, this.topLeft.col), this.bottomRight);\n        },\n        toRangeRef: function () {\n            return this;\n        },\n        toRow: function (row) {\n            row += Math.max(0, this.topLeft.row);\n            return new RangeRef(new CellRef(row, this.topLeft.col), new CellRef(row, this.bottomRight.col)).setSheet(this.sheet, this.hasSheet());\n        },\n        toColumn: function (col) {\n            col += Math.max(0, this.topLeft.col);\n            return new RangeRef(new CellRef(this.topLeft.row, col), new CellRef(this.bottomRight.row, col)).setSheet(this.sheet, this.hasSheet());\n        },\n        toCell: function (row, col) {\n            row += Math.max(0, this.topLeft.row);\n            col += Math.max(0, this.topLeft.col);\n            return new CellRef(row, col, 0).setSheet(this.sheet, this.hasSheet());\n        },\n        forEachRow: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startRow; i <= endRow; i++) {\n                callback(new RangeRef(new CellRef(i, startCol), new CellRef(i, endCol)));\n            }\n        },\n        forEachColumn: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startCol; i <= endCol; i++) {\n                callback(new RangeRef(new CellRef(startRow, i), new CellRef(endRow, i)));\n            }\n        },\n        intersecting: function (refs) {\n            return refs.filter(function (ref) {\n                return ref.toRangeRef().intersects(this);\n            }, this);\n        },\n        union: function (refs, callback) {\n            var intersecting = this.intersecting(refs);\n            var topLeftRow = this.topLeft.row;\n            var topLeftCol = this.topLeft.col;\n            var bottomRightRow = this.bottomRight.row;\n            var bottomRightCol = this.bottomRight.col;\n            var modified = false;\n            intersecting.forEach(function (ref) {\n                ref = ref.toRangeRef();\n                if (ref.topLeft.row < topLeftRow) {\n                    modified = true;\n                    topLeftRow = ref.topLeft.row;\n                }\n                if (ref.topLeft.col < topLeftCol) {\n                    modified = true;\n                    topLeftCol = ref.topLeft.col;\n                }\n                if (ref.bottomRight.row > bottomRightRow) {\n                    modified = true;\n                    bottomRightRow = ref.bottomRight.row;\n                }\n                if (ref.bottomRight.col > bottomRightCol) {\n                    modified = true;\n                    bottomRightCol = ref.bottomRight.col;\n                }\n                if (callback) {\n                    callback(ref);\n                }\n            });\n            var result = new RangeRef(new CellRef(topLeftRow, topLeftCol), new CellRef(bottomRightRow, bottomRightCol));\n            if (modified) {\n                return result.union(refs, callback);\n            } else {\n                return result;\n            }\n        },\n        resize: function (options) {\n            var limit = Math.max.bind(Math, 0);\n            function num(value) {\n                return value || 0;\n            }\n            var top = this.topLeft.row + num(options.top);\n            var left = this.topLeft.col + num(options.left);\n            var bottom = this.bottomRight.row + num(options.bottom);\n            var right = this.bottomRight.col + num(options.right);\n            if (left < 0 && right < 0 || top < 0 && bottom < 0) {\n                return NULL;\n            } else if (top <= bottom && left <= right) {\n                return new RangeRef(new CellRef(limit(top), limit(left)), new CellRef(limit(bottom), limit(right)));\n            } else {\n                return NULL;\n            }\n        },\n        move: function (rows, cols) {\n            return new RangeRef(new CellRef(this.topLeft.row + rows, this.topLeft.col + cols), new CellRef(this.bottomRight.row + rows, this.bottomRight.col + cols));\n        },\n        first: function () {\n            return this.topLeft;\n        },\n        isCell: function () {\n            return !this.endSheet && this.topLeft.eq(this.bottomRight);\n        },\n        toString: function () {\n            return this.topLeft + ':' + this.bottomRight;\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var tl = this.topLeft.adjust(row, col, trow, tcol, forRow, start, delta);\n            var tr = this.bottomRight.adjust(row, col, trow, tcol, forRow, start, delta);\n            if (tl === NULL && tr === NULL) {\n                return NULL;\n            }\n            if (tl === NULL) {\n                tl = this.topLeft.absolute(row, col);\n                if (forRow) {\n                    tl.row = start;\n                } else {\n                    tl.col = start;\n                }\n                if (trow != null && tcol != null) {\n                    tl = tl.relative(trow, tcol, this.topLeft.rel);\n                }\n            } else if (tr === NULL) {\n                tr = this.bottomRight.absolute(row, col);\n                if (forRow) {\n                    tr.row = start - 1;\n                } else {\n                    tr.col = start - 1;\n                }\n                if (trow != null && tcol != null) {\n                    tr = tr.relative(trow, tcol, this.bottomRight.rel);\n                }\n            }\n            return new RangeRef(tl, tr).setSheet(this.sheet, this.hasSheet()).simplify();\n        },\n        valid: function () {\n            return this.topLeft.valid() && this.bottomRight.valid();\n        }\n    });\n    var UnionRef = Ref.extend({\n        init: function UnionRef(refs) {\n            this.refs = refs;\n            this.length = refs.length;\n        },\n        clone: function () {\n            return new UnionRef(this.refs.slice());\n        },\n        intersect: function (ref) {\n            var a = [];\n            for (var i = 0; i < this.length; ++i) {\n                var x = ref.intersect(this.refs[i]);\n                if (x !== NULL) {\n                    a.push(x);\n                }\n            }\n            if (a.length > 0) {\n                return new UnionRef(a).simplify();\n            }\n            return NULL;\n        },\n        simplify: function () {\n            var u = new UnionRef(this.refs.reduce(function (a, ref) {\n                ref = ref.simplify();\n                if (ref !== NULL) {\n                    a.push(ref);\n                }\n                return a;\n            }, []));\n            if (u.empty()) {\n                return NULL;\n            }\n            if (u.single()) {\n                return u.refs[0];\n            }\n            return u;\n        },\n        absolute: function (arow, acol) {\n            return new UnionRef(this.refs.map(function (ref) {\n                return ref.absolute(arow, acol);\n            }));\n        },\n        forEach: function (callback, obj) {\n            this.refs.forEach(callback, obj);\n        },\n        toRangeRef: function () {\n            return this.refs[0].toRangeRef();\n        },\n        contains: function (theRef) {\n            return this.refs.some(function (ref) {\n                return ref.contains(theRef);\n            });\n        },\n        map: function (callback, obj) {\n            return new UnionRef(this.refs.map(callback, obj));\n        },\n        first: function () {\n            return this.refs[0].first();\n        },\n        lastRange: function () {\n            return this.refs[this.length - 1];\n        },\n        size: function () {\n            return this.length;\n        },\n        single: function () {\n            return this.length == 1;\n        },\n        empty: function () {\n            return this.length === 0;\n        },\n        isCell: function () {\n            return this.single() && this.refs[0].isCell();\n        },\n        rangeAt: function (index) {\n            return this.refs[index];\n        },\n        nextRangeIndex: function (index) {\n            if (index === this.length - 1) {\n                return 0;\n            } else {\n                return index + 1;\n            }\n        },\n        previousRangeIndex: function (index) {\n            if (index === 0) {\n                return this.length - 1;\n            } else {\n                return index - 1;\n            }\n        },\n        concat: function (ref) {\n            return new UnionRef(this.refs.concat([ref]));\n        },\n        print: function (row, col, mod) {\n            return this.refs.map(function (ref) {\n                return ref.print(row, col, mod);\n            }).join(',');\n        },\n        replaceAt: function (index, ref) {\n            var newRefs = this.refs.slice();\n            newRefs.splice(index, 1, ref);\n            return new UnionRef(newRefs);\n        },\n        leftColumn: function () {\n            return this.map(function (ref) {\n                return ref.leftColumn();\n            });\n        },\n        rightColumn: function () {\n            return this.map(function (ref) {\n                return ref.rightColumn();\n            });\n        },\n        topRow: function () {\n            return this.map(function (ref) {\n                return ref.topRow();\n            });\n        },\n        bottomRow: function () {\n            return this.map(function (ref) {\n                return ref.bottomRow();\n            });\n        },\n        forEachRow: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachRow(callback);\n            });\n        },\n        forEachColumn: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachColumn(callback);\n            });\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            return this.map(function (ref) {\n                return ref.adjust(row, col, trow, tcol, forRow, start, delta);\n            }).simplify();\n        },\n        toString: function () {\n            return this.refs.map(function (ref) {\n                return ref.toString();\n            }).join(', ');\n        },\n        valid: function () {\n            for (var i = this.refs.length; --i >= 0;) {\n                if (this.refs[i].valid()) {\n                    return false;\n                }\n            }\n            return true;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            this.refs.forEach(function (ref) {\n                ref.renameSheet(oldSheetName, newSheetName);\n            });\n        }\n    });\n    spreadsheet.NULLREF = NULL;\n    spreadsheet.SHEETREF = new RangeRef(new CellRef(0, 0), new CellRef(Infinity, Infinity));\n    spreadsheet.FIRSTREF = new CellRef(0, 0);\n    spreadsheet.Ref = Ref;\n    spreadsheet.NameRef = NameRef;\n    spreadsheet.CellRef = CellRef;\n    spreadsheet.RangeRef = RangeRef;\n    spreadsheet.UnionRef = UnionRef;\n    spreadsheet.SHEETREF.print = function () {\n        return '#SHEET';\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofillcalculator', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var AutoFillCalculator = kendo.Class.extend({\n            init: function (grid) {\n                this._grid = grid;\n            },\n            rectIsVertical: function (start, end, x, y) {\n                var startRect = this._grid.rectangle(start.toRangeRef());\n                var endRect = this._grid.rectangle(end.toRangeRef());\n                return Math.abs(endRect[y] - startRect[y]) > Math.abs(startRect[x] - endRect[x]);\n            },\n            autoFillDest: function (selection, cursor) {\n                var topLeft = selection.topLeft;\n                var bottomRight = selection.bottomRight;\n                var quadrant;\n                var lower = cursor.row >= topLeft.row;\n                var further = cursor.col >= topLeft.col;\n                if (lower) {\n                    quadrant = further ? 4 : 3;\n                } else {\n                    quadrant = further ? 2 : 1;\n                }\n                var pivot, opposite, cornerResult, expanding;\n                if (quadrant === 4) {\n                    pivot = topLeft;\n                    opposite = bottomRight;\n                    expanding = cursor.row > opposite.row || cursor.col > opposite.col;\n                    if (expanding) {\n                        cursor = new CellRef(Math.max(cursor.row, opposite.row), Math.max(cursor.col, opposite.col));\n                    }\n                    if (this.rectIsVertical(opposite, cursor, 'right', 'bottom')) {\n                        cornerResult = new CellRef(cursor.row, opposite.col);\n                    } else {\n                        cornerResult = new CellRef(opposite.row, cursor.col);\n                    }\n                } else if (quadrant === 3) {\n                    var bottomLeft = new CellRef(topLeft.col, bottomRight.row);\n                    if (cursor.row > bottomRight.row && this.rectIsVertical(bottomLeft, cursor, 'left', 'bottom')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(cursor.row, bottomRight.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                } else if (quadrant === 2) {\n                    var topRight = new CellRef(topLeft.row, bottomRight.col);\n                    if (cursor.col > bottomRight.col && !this.rectIsVertical(topRight, cursor, 'right', 'top')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(bottomRight.row, cursor.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    }\n                } else {\n                    pivot = bottomRight;\n                    if (this.rectIsVertical(topLeft, cursor, 'left', 'top')) {\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    } else {\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                }\n                return this._grid.normalize(new RangeRef(pivot, cornerResult));\n            }\n        });\n        kendo.spreadsheet.AutoFillCalculator = AutoFillCalculator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/navigator', [\n        'kendo.core',\n        'spreadsheet/autofillcalculator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var EdgeNavigator = kendo.Class.extend({\n            init: function (field, axis, rangeGetter, union) {\n                this.rangeGetter = rangeGetter;\n                this.prevLeft = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.prevVisible(current.topLeft[field]));\n                    return union(range).topLeft[field];\n                };\n                this.nextRight = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.nextVisible(current.bottomRight[field]));\n                    return union(range).bottomRight[field];\n                };\n                this.nextLeft = function (index) {\n                    var range = union(this.range(index));\n                    return axis.nextVisible(range.bottomRight[field]);\n                };\n                this.prevRight = function (index) {\n                    var range = union(this.range(index));\n                    return axis.prevVisible(range.topLeft[field]);\n                };\n            },\n            boundary: function (top, bottom) {\n                this.top = top;\n                this.bottom = bottom;\n            },\n            range: function (index) {\n                return this.rangeGetter(index, this.top, this.bottom);\n            }\n        });\n        var SheetNavigator = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.columns = this._sheet._grid._columns;\n                this.autoFillCalculator = new kendo.spreadsheet.AutoFillCalculator(sheet._grid);\n                this.colEdge = new EdgeNavigator('col', this._sheet._grid._columns, this.columnRange.bind(this), this.union.bind(this));\n                this.rowEdge = new EdgeNavigator('row', this._sheet._grid._rows, this.rowRange.bind(this), this.union.bind(this));\n            },\n            height: function (height) {\n                this._viewPortHeight = height;\n            },\n            union: function (ref) {\n                return this._sheet.unionWithMerged(ref);\n            },\n            columnRange: function (col, topRow, bottomRow) {\n                return this._sheet._ref(topRow, col, bottomRow - topRow, 1);\n            },\n            rowRange: function (row, leftCol, rightCol) {\n                return this._sheet._ref(row, leftCol, 1, rightCol - leftCol);\n            },\n            selectionIncludesMergedCells: function () {\n                return this._sheet.select().contains(this._sheet._mergedCells);\n            },\n            setSelectionValue: function (value) {\n                var selection = this._sheet.selection();\n                setTimeout(function () {\n                    selection.value(value());\n                });\n            },\n            selectAll: function () {\n                this._sheet.select(this._sheet._sheetRef);\n            },\n            select: function (ref, mode, addToExisting) {\n                ref = this.refForMode(ref, mode);\n                if (addToExisting) {\n                    ref = this._sheet.select().concat(ref);\n                }\n                this._sheet.select(ref);\n            },\n            refForMode: function (ref, mode) {\n                var grid = this._sheet._grid;\n                switch (mode) {\n                case 'range':\n                    ref = grid.normalize(ref);\n                    break;\n                case 'row':\n                    ref = grid.rowRef(ref.row);\n                    break;\n                case 'column':\n                    ref = grid.colRef(ref.col);\n                    break;\n                case 'sheet':\n                    ref = this._sheet._sheetRef;\n                    break;\n                }\n                return ref;\n            },\n            startSelection: function (ref, mode, addToExisting, shiftKey) {\n                if (mode == 'autofill') {\n                    this._sheet.startAutoFill();\n                } else if (shiftKey && mode == 'range') {\n                    var range = new RangeRef(this._sheet.activeCell().first(), ref);\n                    this._sheet.select(range, false, false);\n                    this._sheet.startSelection();\n                } else {\n                    this._sheet.startSelection();\n                    this.select(ref, mode, addToExisting);\n                }\n            },\n            completeSelection: function () {\n                this._sheet.completeSelection();\n            },\n            selectForContextMenu: function (ref, mode) {\n                var sheet = this._sheet;\n                if (!sheet.select().contains(this.refForMode(ref, mode))) {\n                    this.select(ref, mode);\n                }\n            },\n            modifySelection: function (action) {\n                var direction = this.determineDirection(action);\n                var sheet = this._sheet;\n                var viewPortHeight = this._viewPortHeight;\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var originalSelection = sheet.currentOriginalSelectionRange();\n                var selection = sheet.select().toRangeRef();\n                var activeCell = sheet.activeCell();\n                var topLeft = originalSelection.topLeft.clone();\n                var bottomRight = originalSelection.bottomRight.clone();\n                var scrollInto;\n                this.colEdge.boundary(selection.topLeft.row, selection.bottomRight.row);\n                this.rowEdge.boundary(selection.topLeft.col, selection.bottomRight.col);\n                switch (direction) {\n                case 'expand-left':\n                    topLeft.col = this.colEdge.prevLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-right':\n                    topLeft.col = this.colEdge.nextLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-right':\n                    bottomRight.col = this.colEdge.nextRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-left':\n                    bottomRight.col = this.colEdge.prevRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-up':\n                    topLeft.row = this.rowEdge.prevLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-down':\n                    topLeft.row = this.rowEdge.nextLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-down':\n                    bottomRight.row = this.rowEdge.nextRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-up':\n                    bottomRight.row = this.rowEdge.prevRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-page-up':\n                    topLeft.row = rows.prevPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'shrink-page-up':\n                    bottomRight.row = rows.prevPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'expand-page-down':\n                    bottomRight.row = rows.nextPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'shrink-page-down':\n                    topLeft.row = rows.nextPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'first-col':\n                    topLeft.col = columns.firstVisible();\n                    bottomRight.col = activeCell.bottomRight.col;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-col':\n                    bottomRight.col = columns.lastVisible();\n                    topLeft.col = activeCell.topLeft.col;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first-row':\n                    topLeft.row = rows.firstVisible();\n                    bottomRight.row = activeCell.bottomRight.row;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-row':\n                    bottomRight.row = rows.lastVisible();\n                    topLeft.row = activeCell.topLeft.row;\n                    scrollInto = bottomRight;\n                    break;\n                case 'last':\n                    bottomRight.row = rows.lastVisible();\n                    bottomRight.col = columns.lastVisible();\n                    topLeft = activeCell.topLeft;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first':\n                    topLeft.row = rows.firstVisible();\n                    topLeft.col = columns.firstVisible();\n                    bottomRight = activeCell.bottomRight;\n                    scrollInto = topLeft;\n                    break;\n                }\n                var newSelection = new RangeRef(topLeft, bottomRight);\n                if (!this.union(newSelection).intersects(activeCell)) {\n                    this.modifySelection(direction.replace('shrink', 'expand'));\n                    return;\n                }\n                if (scrollInto) {\n                    sheet.focus(scrollInto);\n                }\n                this.updateCurrentSelectionRange(newSelection);\n            },\n            moveActiveCell: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var bottomRight = activeCell.bottomRight;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                switch (direction) {\n                case 'left':\n                    column = columns.prevVisible(topLeft.col);\n                    break;\n                case 'up':\n                    row = rows.prevVisible(topLeft.row);\n                    break;\n                case 'right':\n                    column = columns.nextVisible(bottomRight.col);\n                    break;\n                case 'down':\n                    row = rows.nextVisible(bottomRight.row);\n                    break;\n                case 'first-col':\n                    column = columns.firstVisible();\n                    break;\n                case 'last-col':\n                    column = columns.lastVisible();\n                    break;\n                case 'first-row':\n                    row = rows.firstVisible();\n                    break;\n                case 'last-row':\n                    row = rows.lastVisible();\n                    break;\n                case 'last':\n                    row = rows.lastVisible();\n                    column = columns.lastVisible();\n                    break;\n                case 'first':\n                    row = rows.firstVisible();\n                    column = columns.firstVisible();\n                    break;\n                case 'next-page':\n                    row = rows.nextPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                case 'prev-page':\n                    row = rows.prevPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                }\n                sheet.select(new CellRef(row, column));\n            },\n            navigateInSelection: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                var selection = sheet.currentNavigationRange();\n                var selTopLeft = selection.topLeft;\n                var selBottomRight = selection.bottomRight;\n                var done = false;\n                var topLeftCol = topLeft.col;\n                var topLeftRow = topLeft.row;\n                while (!done) {\n                    var current = new CellRef(row, column);\n                    switch (direction) {\n                    case 'next':\n                        if (selBottomRight.eq(current)) {\n                            selection = sheet.nextNavigationRange();\n                            row = selection.topLeft.row;\n                            column = selection.topLeft.col;\n                        } else {\n                            column = columns.nextVisible(topLeftCol, true);\n                            if (column > selBottomRight.col) {\n                                column = selTopLeft.col;\n                                row = rows.nextVisible(row, true);\n                            }\n                        }\n                        break;\n                    case 'previous':\n                        if (selTopLeft.eq(current)) {\n                            selection = sheet.previousNavigationRange();\n                            row = selection.bottomRight.row;\n                            column = selection.bottomRight.col;\n                        } else {\n                            column = columns.prevVisible(topLeftCol, true);\n                            if (column < selTopLeft.col) {\n                                column = selBottomRight.col;\n                                row = rows.prevVisible(row, true);\n                            }\n                        }\n                        break;\n                    case 'lower':\n                        if (selBottomRight.eq(current)) {\n                            selection = sheet.nextNavigationRange();\n                            row = selection.topLeft.row;\n                            column = selection.topLeft.col;\n                        } else {\n                            row = rows.nextVisible(topLeftRow, true);\n                            if (row > selBottomRight.row) {\n                                row = selTopLeft.row;\n                                column = columns.nextVisible(column, true);\n                            }\n                        }\n                        break;\n                    case 'upper':\n                        if (selTopLeft.eq(current)) {\n                            selection = sheet.previousNavigationRange();\n                            row = selection.bottomRight.row;\n                            column = selection.bottomRight.col;\n                        } else {\n                            row = rows.prevVisible(topLeftRow, true);\n                            if (row < selTopLeft.row) {\n                                row = selBottomRight.row;\n                                column = columns.prevVisible(column, true);\n                            }\n                        }\n                        break;\n                    default:\n                        throw new Error('Unknown entry navigation: ' + direction);\n                    }\n                    done = !this.shouldSkip(row, column);\n                    topLeftCol = column;\n                    topLeftRow = row;\n                }\n                if (sheet.singleCellSelection()) {\n                    sheet.select(new CellRef(row, column));\n                } else {\n                    sheet.activeCell(new CellRef(row, column));\n                }\n            },\n            extendSelection: function (ref, mode) {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                if (mode === 'autofill') {\n                    this.resizeAutoFill(ref);\n                    return;\n                }\n                if (mode === 'range') {\n                    ref = grid.normalize(ref);\n                } else if (mode === 'row') {\n                    ref = grid.rowRef(ref.row).bottomRight;\n                } else if (mode === 'column') {\n                    ref = grid.colRef(ref.col).bottomRight;\n                }\n                var activeCell = sheet.originalActiveCell().toRangeRef();\n                this.updateCurrentSelectionRange(new RangeRef(activeCell.topLeft, ref));\n            },\n            shouldSkip: function (row, col) {\n                var ref = new CellRef(row, col);\n                var isMerged = false;\n                this._sheet.forEachMergedCell(function (merged) {\n                    if (merged.intersects(ref) && !merged.collapse().eq(ref)) {\n                        isMerged = true;\n                    }\n                });\n                return isMerged;\n            },\n            resizeAutoFill: function (ref) {\n                var sheet = this._sheet;\n                var selection = sheet.select();\n                var origin = sheet._autoFillOrigin;\n                var dest = this.autoFillCalculator.autoFillDest(selection, ref);\n                var punch = this.punch(selection, dest);\n                var hint, direction, row;\n                if (!punch) {\n                    var preview = sheet.range(dest)._previewFillFrom(sheet.range(origin));\n                    if (preview) {\n                        direction = preview.direction;\n                        var props = preview.props;\n                        if (direction === 0 || direction == 1) {\n                            row = props[props.length - 1];\n                            hint = row[row.length - 1].value;\n                        } else if (direction === 2) {\n                            row = props[0];\n                            hint = row[row.length - 1].value;\n                        } else if (direction === 3) {\n                            row = props[props.length - 1];\n                            hint = row[0].value;\n                        }\n                    }\n                }\n                sheet.updateAutoFill(dest, punch, hint, direction);\n            },\n            determineDirection: function (action) {\n                var selection = this._sheet.currentSelectionRange();\n                var activeCell = this._sheet.activeCell();\n                var leftMode = activeCell.topLeft.col == selection.topLeft.col;\n                var rightMode = activeCell.bottomRight.col == selection.bottomRight.col;\n                var topMode = activeCell.topLeft.row == selection.topLeft.row;\n                var bottomMode = activeCell.bottomRight.row == selection.bottomRight.row;\n                switch (action) {\n                case 'left':\n                    action = rightMode ? 'expand-left' : 'shrink-left';\n                    break;\n                case 'right':\n                    action = leftMode ? 'expand-right' : 'shrink-right';\n                    break;\n                case 'up':\n                    action = bottomMode ? 'expand-up' : 'shrink-up';\n                    break;\n                case 'down':\n                    action = topMode ? 'expand-down' : 'shrink-down';\n                    break;\n                case 'prev-page':\n                    action = bottomMode ? 'expand-page-up' : 'shrink-page-up';\n                    break;\n                case 'next-page':\n                    action = topMode ? 'expand-page-down' : 'shrink-page-down';\n                    break;\n                }\n                return action;\n            },\n            updateCurrentSelectionRange: function (ref) {\n                var sheet = this._sheet;\n                sheet.select(sheet.originalSelect().replaceAt(sheet.selectionRangeIndex(), ref), false);\n            },\n            punch: function (selection, subset) {\n                var punch;\n                if (subset.topLeft.eq(selection.topLeft)) {\n                    if (subset.bottomRight.row < selection.bottomRight.row) {\n                        var bottomRow = this.rowEdge.nextRight(subset.bottomRight.row);\n                        punch = new RangeRef(new CellRef(bottomRow, selection.topLeft.col), selection.bottomRight);\n                    } else if (subset.bottomRight.col < selection.bottomRight.col) {\n                        var bottomCol = this.colEdge.nextRight(subset.bottomRight.col);\n                        punch = new RangeRef(new CellRef(selection.topLeft.row, bottomCol), selection.bottomRight);\n                    }\n                }\n                return punch;\n            }\n        });\n        kendo.spreadsheet.SheetNavigator = SheetNavigator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axismanager', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var AxisManager = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n            },\n            forEachSelectedColumn: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachColumnIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            forEachSelectedRow: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachRowIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            includesHiddenColumns: function (ref) {\n                return this._sheet._grid._columns.includesHidden(ref.topLeft.col, ref.bottomRight.col);\n            },\n            includesHiddenRows: function (ref) {\n                return this._sheet._grid._rows.includesHidden(ref.topLeft.row, ref.bottomRight.row);\n            },\n            selectionIncludesHiddenColumns: function () {\n                return this.includesHiddenColumns(this._sheet.select());\n            },\n            selectionIncludesHiddenRows: function () {\n                return this.includesHiddenRows(this._sheet.select());\n            },\n            deleteSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index, i) {\n                    sheet.deleteColumn(index - i);\n                });\n            },\n            deleteSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index, i) {\n                    sheet.deleteRow(index - i);\n                });\n            },\n            hideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.hideColumn(index);\n                });\n                var sheet = this._sheet;\n                var ref = sheet.select().toRangeRef();\n                var left = ref.topLeft.col;\n                var right = ref.bottomRight.col;\n                var sel = null;\n                while (true) {\n                    var hasRight = right < sheet._columns._count;\n                    var hasLeft = left >= 0;\n                    if (!hasLeft && !hasRight) {\n                        break;\n                    }\n                    if (hasRight && !sheet.isHiddenColumn(right)) {\n                        sel = right;\n                        break;\n                    }\n                    if (hasLeft && !sheet.isHiddenColumn(left)) {\n                        sel = left;\n                        break;\n                    }\n                    left--;\n                    right++;\n                }\n                if (sel !== null) {\n                    ref = new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(0, sel), new kendo.spreadsheet.CellRef(sheet._rows._count - 1, sel));\n                    sheet.range(ref).select();\n                }\n            },\n            hideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.hideRow(index);\n                });\n                var sheet = this._sheet;\n                var ref = sheet.select().toRangeRef();\n                var top = ref.topLeft.row;\n                var bottom = ref.bottomRight.row;\n                var sel = null;\n                while (true) {\n                    var hasBottom = bottom < sheet._rows._count;\n                    var hasTop = top >= 0;\n                    if (!hasTop && !hasBottom) {\n                        break;\n                    }\n                    if (hasBottom && !sheet.isHiddenRow(bottom)) {\n                        sel = bottom;\n                        break;\n                    }\n                    if (hasTop && !sheet.isHiddenRow(top)) {\n                        sel = top;\n                        break;\n                    }\n                    top--;\n                    bottom++;\n                }\n                if (sel !== null) {\n                    ref = new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(sel, 0), new kendo.spreadsheet.CellRef(sel, sheet._columns._count - 1));\n                    sheet.range(ref).select();\n                }\n            },\n            unhideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.unhideColumn(index);\n                });\n            },\n            unhideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.unhideRow(index);\n                });\n            },\n            addColumnLeft: function () {\n                this.forEachSelectedColumn(function (sheet, index, i) {\n                    sheet.insertColumn(index - i);\n                });\n            },\n            addColumnRight: function () {\n                this.forEachSelectedColumn(function (sheet, index, i) {\n                    sheet.insertColumn(index + (i + 1));\n                });\n            },\n            canAddRow: function () {\n                var range = this._sheet.select().toRangeRef();\n                var rowCount = range.height();\n                return this._sheet.canInsertRow(0, rowCount);\n            },\n            addRowAbove: function () {\n                this.forEachSelectedRow(function (sheet, index, i) {\n                    sheet.insertRow(index - i);\n                });\n            },\n            addRowBelow: function () {\n                this.forEachSelectedRow(function (sheet, index, i) {\n                    sheet.insertRow(index + (i + 1));\n                });\n            }\n        });\n        kendo.spreadsheet.AxisManager = AxisManager;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/clipboard', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Clipboard = kendo.Class.extend({\n            init: function (workbook) {\n                this._content = {};\n                this._externalContent = {};\n                this._internalContent = {};\n                this.workbook = workbook;\n                this.origin = kendo.spreadsheet.NULLREF;\n                this.iframe = document.createElement('iframe');\n                this.iframe.className = 'k-spreadsheet-clipboard-paste';\n                this.menuInvoked = true;\n                this._uid = kendo.guid();\n                document.body.appendChild(this.iframe);\n            },\n            destroy: function () {\n                document.body.removeChild(this.iframe);\n            },\n            canCopy: function () {\n                var status = { canCopy: true };\n                var selection = this.workbook.activeSheet().select();\n                if (selection === kendo.spreadsheet.NULLREF) {\n                    status.canCopy = false;\n                }\n                if (selection instanceof kendo.spreadsheet.UnionRef) {\n                    status.canCopy = false;\n                    status.multiSelection = true;\n                }\n                if (this.menuInvoked) {\n                    status.canCopy = false;\n                    status.menuInvoked = true;\n                }\n                return status;\n            },\n            canPaste: function () {\n                var sheet = this.workbook.activeSheet();\n                var ref = this.pasteRef();\n                var range = sheet.range(ref);\n                var status = {\n                    canPaste: true,\n                    pasteOnMerged: false,\n                    pasteOnDisabled: false\n                };\n                if (!range.enable()) {\n                    status.canPaste = false;\n                    status.pasteOnDisabled = true;\n                }\n                if (!ref.eq(sheet.unionWithMerged(ref))) {\n                    status.canPaste = false;\n                    status.pasteOnMerged = true;\n                }\n                if (this.menuInvoked) {\n                    status.canPaste = false;\n                    status.menuInvoked = true;\n                }\n                if (ref.bottomRight.row >= sheet._rows._count || ref.bottomRight.col >= sheet._columns._count) {\n                    status.canPaste = false;\n                    status.overflow = true;\n                }\n                return status;\n            },\n            intersectsMerged: function () {\n                var sheet = this.workbook.activeSheet();\n                this.parse();\n                this.origin = this._content.origRef;\n                var ref = this.pasteRef();\n                return !ref.eq(sheet.unionWithMerged(ref));\n            },\n            copy: function () {\n                var sheet = this.workbook.activeSheet();\n                this.origin = sheet.select();\n                this._internalContent = sheet.selection().getState();\n                delete this._externalContent.html;\n                delete this._externalContent.plain;\n            },\n            cut: function () {\n                var sheet = this.workbook.activeSheet();\n                this.copy();\n                sheet.range(sheet.select()).clear();\n            },\n            pasteRef: function () {\n                var sheet = this.workbook.activeSheet();\n                var destination = sheet.activeCell().first();\n                var originActiveCell = this.origin.first();\n                var rowDelta = originActiveCell.row - destination.row;\n                var colDelta = originActiveCell.col - destination.col;\n                return this.origin.relative(rowDelta, colDelta, 3);\n            },\n            paste: function () {\n                var sheet = this.workbook.activeSheet();\n                var pasteRef = this.pasteRef();\n                sheet.range(pasteRef).setState(this._content, this);\n                sheet.triggerChange({\n                    recalc: true,\n                    ref: pasteRef\n                });\n            },\n            external: function (data) {\n                if (data && (data.html || data.plain)) {\n                    this._externalContent = data;\n                } else {\n                    return this._externalContent;\n                }\n            },\n            isExternal: function () {\n                return !this._isInternal();\n            },\n            parse: function () {\n                var state = newState();\n                if (this._isInternal()) {\n                    state = this._internalContent;\n                } else {\n                    var data = this._externalContent;\n                    if (data.html) {\n                        var doc = this.iframe.contentWindow.document;\n                        doc.open();\n                        doc.write(data.html);\n                        doc.close();\n                        var table = $(doc).find('table:first');\n                        if (table.length) {\n                            state = parseHTML(table);\n                        } else {\n                            state = parseTSV(data.plain);\n                        }\n                    } else {\n                        state = parseTSV(data.plain);\n                    }\n                    this.origin = state.origRef;\n                }\n                this._content = state;\n            },\n            _isInternal: function () {\n                if (this._externalContent.html === undefined) {\n                    return true;\n                }\n                var internalHTML = $('<div/>').html(this._externalContent.html).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                var internalPlain = $('<div/>').html(this._externalContent.plain).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                return internalHTML || internalPlain;\n            }\n        });\n        kendo.spreadsheet.Clipboard = Clipboard;\n        function newState() {\n            var ref = new CellRef(0, 0, 0);\n            return {\n                ref: ref,\n                mergedCells: [],\n                data: [],\n                foreign: true,\n                origRef: ref.toRangeRef()\n            };\n        }\n        function setStateData(state, row, col, value) {\n            var data = state.data || (state.data = []);\n            if (!data[row]) {\n                data[row] = [];\n            }\n            data[row][col] = value;\n            var br = state.origRef.bottomRight;\n            br.row = Math.max(br.row, row);\n            br.col = Math.max(br.col, col);\n        }\n        function stripStyle(style) {\n            return style.replace(/^-(?:ms|moz|webkit)-/, '');\n        }\n        function borderObject(styles) {\n            var obj = {};\n            [\n                'borderBottom',\n                'borderRight',\n                'borderLeft',\n                'borderTop'\n            ].forEach(function (key) {\n                obj[key] = styles[key + 'Style'] == 'none' ? null : {\n                    size: 1,\n                    color: styles[key + 'Color']\n                };\n            });\n            return obj;\n        }\n        function cellState(element) {\n            var styles = window.getComputedStyle(element[0]);\n            var text = element[0].innerText;\n            var borders = borderObject(styles);\n            var state = {\n                value: text === '' ? null : text,\n                borderBottom: borders.borderBottom,\n                borderRight: borders.borderRight,\n                borderLeft: borders.borderLeft,\n                borderTop: borders.borderTop,\n                fontSize: parseInt(styles['font-size'], 10)\n            };\n            if (styles['background-color'] !== 'rgb(0, 0, 0)' && styles['background-color'] !== 'rgba(0, 0, 0, 0)') {\n                state.background = styles['background-color'];\n            }\n            if (styles.color !== 'rgb(0, 0, 0)' && styles.color !== 'rgba(0, 0, 0, 0)') {\n                state.color = styles.color;\n            }\n            if (styles['text-decoration'] == 'underline') {\n                state.underline = true;\n            }\n            if (styles['font-style'] == 'italic') {\n                state.italic = true;\n            }\n            if (styles['font-weight'] == 'bold') {\n                state.bold = true;\n            }\n            if (stripStyle(styles['text-align']) !== 'right') {\n                state.textAlign = stripStyle(styles['text-align']);\n            }\n            if (styles['vertical-align'] !== 'middle') {\n                state.verticalAlign = styles['vertical-align'];\n            }\n            if (styles['word-wrap'] !== 'normal') {\n                state.wrap = true;\n            }\n            return state;\n        }\n        function parseHTML(table) {\n            var state = newState();\n            table.find('>tr, >tbody>tr').each(function (rowIndex, tr) {\n                $(tr).find('>td, >th').each(function (colIndex, td) {\n                    var rowspan = parseInt($(td).attr('rowspan'), 10) - 1 || 0;\n                    var colspan = parseInt($(td).attr('colspan'), 10) - 1 || 0;\n                    var blankCell = '<td/>';\n                    var ci;\n                    if (rowspan) {\n                        var endRow = rowIndex + rowspan;\n                        for (var ri = rowIndex; ri <= endRow; ri++) {\n                            var row = table.find('tr').eq(ri);\n                            if (ri > rowIndex) {\n                                blankCell = '<td class=\\'rowspan\\'></td>';\n                                if (colIndex === 0) {\n                                    row.find('td').eq(colIndex).after(blankCell);\n                                } else {\n                                    var last = Math.min(row.find('td').length, colIndex);\n                                    row.find('td').eq(last - 1).after(blankCell);\n                                }\n                            }\n                            if (colspan) {\n                                for (ci = colIndex; ci < colspan + colIndex; ci++) {\n                                    blankCell = '<td class=\\'rowspan colspan\\'></td>';\n                                    row.find('td').eq(ci).after(blankCell);\n                                }\n                            }\n                        }\n                    } else {\n                        if (colspan) {\n                            for (ci = colIndex; ci < colspan + colIndex; ci++) {\n                                blankCell = '<td class=\\'colspan\\'></td>';\n                                $(tr).find('td').eq(ci).after(blankCell);\n                            }\n                        }\n                    }\n                });\n            });\n            table.find('>tr, >tbody>tr').each(function (rowIndex, tr) {\n                $(tr).find('>td, >th').each(function (colIndex, td) {\n                    var rowspan = parseInt($(td).attr('rowspan'), 10) - 1 || 0;\n                    var colspan = parseInt($(td).attr('colspan'), 10) - 1 || 0;\n                    setStateData(state, rowIndex, colIndex, cellState($(td)));\n                    if (rowspan || colspan) {\n                        var startCol = String.fromCharCode(65 + colIndex);\n                        var endCol = String.fromCharCode(65 + colIndex + colspan);\n                        var address = startCol + (rowIndex + 1) + ':' + endCol + (rowIndex + 1 + rowspan);\n                        state.mergedCells.push(address);\n                    }\n                });\n            });\n            return state;\n        }\n        function parseTSV(data) {\n            var state = newState();\n            if (data.indexOf('\\t') === -1 && data.indexOf('\\n') == -1) {\n                setStateData(state, 0, 0, { value: data });\n            } else {\n                var rows = data.split('\\n');\n                for (var ri = 0; ri < rows.length; ri++) {\n                    var cols = rows[ri].split('\\t');\n                    for (var ci = 0; ci < cols.length; ci++) {\n                        setStateData(state, ri, ci, { value: cols[ci] });\n                    }\n                }\n            }\n            return state;\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/range', [\n        'kendo.core',\n        'util/text-metrics'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var PROPERTIES = [\n            'color',\n            'fontFamily',\n            'underline',\n            'italic',\n            'bold',\n            'textAlign',\n            'verticalAlign',\n            'background',\n            'format',\n            'link',\n            'editor'\n        ];\n        var borders = {\n            borderTop: {\n                complement: 'borderBottom',\n                direction: {\n                    top: -1,\n                    bottom: -1\n                }\n            },\n            borderLeft: {\n                complement: 'borderRight',\n                direction: {\n                    left: -1,\n                    right: -1\n                }\n            },\n            borderRight: {\n                complement: 'borderLeft',\n                direction: {\n                    left: 1,\n                    right: 1\n                }\n            },\n            borderBottom: {\n                complement: 'borderTop',\n                direction: {\n                    top: 1,\n                    bottom: 1\n                }\n            }\n        };\n        var Range = kendo.Class.extend({\n            init: function (ref, sheet) {\n                this._sheet = sheet;\n                this._ref = ref;\n            },\n            clone: function () {\n                return new Range(this._ref.clone(), this._sheet);\n            },\n            skipHiddenCells: function () {\n                var refs = [];\n                var self = this, sheet = self._sheet;\n                var skipHiddenRows = sheet.isHiddenRow.bind(sheet);\n                var skipHiddenCols = sheet.isHiddenColumn.bind(sheet);\n                self._ref.forEach(function add(ref) {\n                    if (ref instanceof UnionRef) {\n                        ref.forEach(add);\n                    } else {\n                        ref = self._normalize(ref.toRangeRef());\n                        var tl = ref.topLeft, br = ref.bottomRight;\n                        var rows = partition(tl.row, br.row, skipHiddenRows);\n                        var cols = partition(tl.col, br.col, skipHiddenCols);\n                        for (var i = 0; i < rows.length; ++i) {\n                            for (var j = 0; j < cols.length; ++j) {\n                                refs.push(new RangeRef(new CellRef(rows[i].begin, cols[j].begin), new CellRef(rows[i].end, cols[j].end)));\n                            }\n                        }\n                    }\n                });\n                return sheet.range(refs.length > 1 ? new UnionRef(refs) : refs[0]);\n            },\n            _normalize: function (ref) {\n                return this._sheet._grid.normalize(ref);\n            },\n            _set: function (name, value, noTrigger) {\n                var self = this;\n                var sheet = self._sheet;\n                self._ref.forEach(function (ref) {\n                    sheet._set(ref.toRangeRef(), name, value);\n                });\n                if (!noTrigger) {\n                    sheet.triggerChange({\n                        recalc: name == 'formula' || name == 'value' || name == 'validation',\n                        value: value,\n                        range: self,\n                        ref: self._ref\n                    });\n                }\n                return self;\n            },\n            _get: function (name) {\n                return this._sheet._get(this._ref.toRangeRef(), name);\n            },\n            _property: function (name, value) {\n                if (value === undefined) {\n                    return this._get(name);\n                } else {\n                    return this._set(name, value);\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this._set('formula', null, true);\n                }\n                return this._property('value', value);\n            },\n            resize: function (direction) {\n                var ref = this._resizedRef(direction);\n                return new Range(ref, this._sheet);\n            },\n            _resizedRef: function (direction) {\n                return this._ref.map(function (ref) {\n                    return ref.toRangeRef().resize(direction);\n                });\n            },\n            _border: function (property, value) {\n                var result;\n                var complement = borders[property].complement;\n                var direction = borders[property].direction;\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    result = this._property(property, value);\n                    if (value !== undefined) {\n                        this._resizedRef(direction).forEach(function (ref) {\n                            if (ref !== kendo.spreadsheet.NULLREF) {\n                                new Range(ref, sheet)._property(complement, null);\n                            }\n                        });\n                    }\n                }.bind(this), {});\n                return result;\n            },\n            _collapsedBorder: function (property) {\n                var result = this._property(property);\n                var complement = borders[property].complement;\n                var direction = borders[property].direction;\n                this._resizedRef(direction).forEach(function (ref) {\n                    if (!result && ref !== kendo.spreadsheet.NULLREF) {\n                        var range = new Range(ref, this._sheet);\n                        result = range._property(complement);\n                    }\n                }.bind(this));\n                return result;\n            },\n            borderTop: function (value) {\n                return this._border('borderTop', value);\n            },\n            borderRight: function (value) {\n                return this._border('borderRight', value);\n            },\n            borderBottom: function (value) {\n                return this._border('borderBottom', value);\n            },\n            borderLeft: function (value) {\n                return this._border('borderLeft', value);\n            },\n            collapsedBorderTop: function () {\n                return this._collapsedBorder('borderTop');\n            },\n            collapsedBorderRight: function () {\n                return this._collapsedBorder('borderRight');\n            },\n            collapsedBorderBottom: function () {\n                return this._collapsedBorder('borderBottom');\n            },\n            collapsedBorderLeft: function () {\n                return this._collapsedBorder('borderLeft');\n            },\n            input: function (value) {\n                var existingFormat = this._get('format'), x;\n                if (value !== undefined) {\n                    var tl = this._ref.toRangeRef().topLeft;\n                    x = kendo.spreadsheet.calc.parse(this._sheet.name(), tl.row, tl.col, value);\n                    this._sheet.batch(function () {\n                        var formula = null;\n                        if (x.type == 'exp') {\n                            formula = kendo.spreadsheet.calc.compile(x);\n                        } else if (existingFormat != '@') {\n                            if (x.type == 'date') {\n                                this.format(x.format || toExcelFormat(kendo.culture().calendar.patterns.d));\n                            } else if (x.type == 'percent') {\n                                this.format(x.value * 100 == (x.value * 100 | 0) ? '0%' : '0.00%');\n                            } else if (x.format && !existingFormat) {\n                                this.format(x.format);\n                            }\n                        } else if (x.type != 'string') {\n                            x.value = value;\n                        }\n                        this.formula(formula);\n                        if (!formula) {\n                            this.value(x.value);\n                        }\n                    }.bind(this), {\n                        recalc: true,\n                        value: value,\n                        ref: this._ref,\n                        editorChange: this._sheet.isInEditMode()\n                    });\n                    return this;\n                } else {\n                    value = this._get('value');\n                    var formula = this._get('formula');\n                    var type = existingFormat && !formula && kendo.spreadsheet.formatting.type(value, existingFormat);\n                    if (formula) {\n                        value = '=' + formula;\n                    } else\n                        OUT: {\n                            if (existingFormat && type == 'date') {\n                                var t1 = kendo.spreadsheet.formatting.text(value, existingFormat);\n                                x = kendo.spreadsheet.calc.parse(null, null, null, t1);\n                                if (typeof x.value == 'number') {\n                                    var t2 = kendo.spreadsheet.formatting.text(x.value, existingFormat);\n                                    if (t1 == t2) {\n                                        value = t1;\n                                        break OUT;\n                                    }\n                                }\n                            }\n                            if (type === 'date') {\n                                value = kendo.toString(kendo.spreadsheet.numberToDate(value), kendo.culture().calendar.patterns.d);\n                            } else if (type === 'percent') {\n                                value = value * 100 + '%';\n                            } else if (typeof value == 'string' && (/^[=']/.test(value) || /^(?:true|false)$/i.test(value) || looksLikeANumber(value))) {\n                                value = '\\'' + value;\n                            }\n                        }\n                    return value;\n                }\n            },\n            enable: function (value) {\n                if (value === undefined) {\n                    value = true;\n                    this._sheet.forEach(this._ref.toRangeRef(), function (_, __, data) {\n                        if (data.enable === false) {\n                            value = false;\n                        }\n                    });\n                    return value;\n                }\n                return this._property('enable', value);\n            },\n            formula: function (value) {\n                if (value === undefined) {\n                    var f = this._get('formula');\n                    return f ? '' + f : null;\n                }\n                return this._property('formula', value);\n            },\n            validation: function (value) {\n                if (value === undefined) {\n                    var f = this._get('validation');\n                    return f ? f.toJSON() : null;\n                }\n                return this._property('validation', value);\n            },\n            _getValidationState: function () {\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                    for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                        var validation = this._sheet._validation(ri, ci);\n                        if (validation && validation.type === 'reject' && validation.value === false) {\n                            return validation;\n                        }\n                    }\n                }\n                return false;\n            },\n            merge: function () {\n                this._ref = this._sheet._merge(this._ref);\n                return this;\n            },\n            unmerge: function () {\n                var mergedCells = this._sheet._mergedCells;\n                this._ref.forEach(function (ref) {\n                    ref.toRangeRef().intersecting(mergedCells).forEach(function (mergedRef) {\n                        mergedCells.splice(mergedCells.indexOf(mergedRef), 1);\n                    });\n                });\n                this._sheet.triggerChange({});\n                return this;\n            },\n            select: function () {\n                this._sheet.select(this._ref);\n                return this;\n            },\n            values: function (values) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (values !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                if (values === undefined) {\n                    values = new Array(ref.height());\n                    for (var vi = 0; vi < values.length; vi++) {\n                        values[vi] = new Array(ref.width());\n                    }\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            values[ri - topLeftRow][ci - topLeftCol] = this._sheet._value(ri, ci);\n                        }\n                    }\n                    return values;\n                } else {\n                    this._sheet._set(ref, 'formula', null);\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            var row = values[ri - topLeftRow];\n                            if (row) {\n                                var value = row[ci - topLeftCol];\n                                if (value !== undefined) {\n                                    this._sheet._value(ri, ci, value);\n                                }\n                            }\n                        }\n                    }\n                    this._sheet.triggerChange({\n                        recalc: true,\n                        ref: ref\n                    });\n                    return this;\n                }\n            },\n            _properties: function (props) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (props !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                var sheet = this._sheet;\n                if (props === undefined) {\n                    props = new Array(ref.height());\n                    sheet.forEach(ref, function (row, col, data) {\n                        row -= topLeftRow;\n                        col -= topLeftCol;\n                        var line = props[row] || (props[row] = []);\n                        line[col] = data;\n                    });\n                    return props;\n                } else {\n                    var data;\n                    ref = ref.clone();\n                    var setProp = function (propName) {\n                        var propValue = data[propName];\n                        ref.topLeft.row = ref.bottomRight.row = ri;\n                        ref.topLeft.col = ref.bottomRight.col = ci;\n                        if (propName == 'value') {\n                            sheet._set(ref, 'formula', null);\n                        }\n                        sheet._set(ref, propName, propValue);\n                    };\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            var row = props[ri - topLeftRow];\n                            if (row) {\n                                data = row[ci - topLeftCol];\n                                if (data) {\n                                    Object.keys(data).forEach(setProp);\n                                }\n                            }\n                        }\n                    }\n                    sheet.triggerChange({\n                        recalc: true,\n                        ref: this._ref\n                    });\n                    return this;\n                }\n            },\n            clear: function (options) {\n                var clearAll = !options || !Object.keys(options).length;\n                var sheet = this._sheet;\n                var reason = {\n                    recalc: clearAll || options && options.contentsOnly === true,\n                    ref: this._ref\n                };\n                sheet.batch(function () {\n                    if (reason.recalc) {\n                        this.formula(null);\n                    }\n                    if (clearAll) {\n                        this.validation(null);\n                    }\n                    if (clearAll || options && options.formatOnly === true) {\n                        PROPERTIES.forEach(function (x) {\n                            this[x](null);\n                        }.bind(this));\n                        this.unmerge();\n                    }\n                }.bind(this), reason);\n                return this;\n            },\n            clearContent: function () {\n                return this.clear({ contentsOnly: true });\n            },\n            clearFormat: function () {\n                return this.clear({ formatOnly: true });\n            },\n            isSortable: function () {\n                return !(this._ref instanceof UnionRef || this._ref === kendo.spreadsheet.NULLREF);\n            },\n            sort: function (spec) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    throw new Error('Unsupported for NULLREF.');\n                }\n                if (spec === undefined) {\n                    spec = { column: 0 };\n                }\n                spec = spec instanceof Array ? spec : [spec];\n                this._sheet._sortBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                    if (typeof spec === 'number') {\n                        spec = { column: spec };\n                    }\n                    return {\n                        index: spec.column === undefined ? index : spec.column,\n                        ascending: spec.ascending === undefined ? true : spec.ascending\n                    };\n                }));\n                return this;\n            },\n            isFilterable: function () {\n                return !(this._ref instanceof UnionRef);\n            },\n            filter: function (spec) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (spec === false) {\n                    this.clearFilters();\n                } else {\n                    spec = spec === true ? [] : spec instanceof Array ? spec : [spec];\n                    this._sheet._filterBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                        return {\n                            index: spec.column === undefined ? index : spec.column,\n                            filter: spec.filter\n                        };\n                    }));\n                }\n                return this;\n            },\n            clearFilter: function (spec) {\n                this._sheet.clearFilter(spec);\n            },\n            clearFilters: function () {\n                var filter = this._sheet.filter();\n                var spec = [];\n                if (filter) {\n                    for (var i = 0; i < filter.columns.length; i++) {\n                        spec.push(i);\n                    }\n                    this._sheet.batch(function () {\n                        this.clearFilter(spec);\n                        this._filter = null;\n                    }, {\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            hasFilter: function () {\n                var filter = this._sheet.filter();\n                return !!filter;\n            },\n            leftColumn: function () {\n                return new Range(this._ref.leftColumn(), this._sheet);\n            },\n            rightColumn: function () {\n                return new Range(this._ref.rightColumn(), this._sheet);\n            },\n            topRow: function () {\n                return new Range(this._ref.topRow(), this._sheet);\n            },\n            bottomRow: function () {\n                return new Range(this._ref.bottomRow(), this._sheet);\n            },\n            column: function (column) {\n                return new Range(this._ref.toColumn(column), this._sheet);\n            },\n            row: function (row) {\n                return new Range(this._ref.toRow(row), this._sheet);\n            },\n            forEachRow: function (callback) {\n                this._ref.forEachRow(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            forEachColumn: function (callback) {\n                this._ref.forEachColumn(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            sheet: function () {\n                return this._sheet;\n            },\n            topLeft: function () {\n                return this._ref.toRangeRef().topLeft;\n            },\n            intersectingMerged: function () {\n                var sheet = this._sheet;\n                var mergedCells = [];\n                sheet._mergedCells.forEach(function (ref) {\n                    if (ref.intersects(this._ref)) {\n                        mergedCells.push(ref.toString());\n                    }\n                }.bind(this));\n                return mergedCells;\n            },\n            getState: function (propertyName) {\n                var topLeft = this._ref.first();\n                var state = {\n                    ref: topLeft,\n                    data: [],\n                    origRef: this._ref\n                };\n                var properties;\n                if (!propertyName) {\n                    properties = kendo.spreadsheet.ALL_PROPERTIES;\n                    state.mergedCells = this.intersectingMerged();\n                } else if (propertyName === 'input') {\n                    properties = [\n                        'value',\n                        'formula'\n                    ];\n                } else if (propertyName === 'border') {\n                    properties = [\n                        'borderLeft',\n                        'borderTop',\n                        'borderRight',\n                        'borderBottom'\n                    ];\n                } else {\n                    properties = [propertyName];\n                }\n                var data = state.data;\n                this.forEachCell(function (row, col, cell) {\n                    var cellState = {};\n                    var dr = row - topLeft.row;\n                    var dc = col - topLeft.col;\n                    if (!data[dr]) {\n                        data[dr] = [];\n                    }\n                    data[dr][dc] = cellState;\n                    properties.forEach(function (property) {\n                        cellState[property] = typeof cell[property] == 'undefined' ? null : cell[property];\n                    });\n                });\n                return state;\n            },\n            setState: function (state, clipboard) {\n                var sheet = this._sheet;\n                var origin = this._ref.first();\n                var rowDelta = state.ref.row - origin.row;\n                var colDelta = state.ref.col - origin.col;\n                sheet.batch(function () {\n                    if (state.mergedCells) {\n                        this.unmerge();\n                    }\n                    var row = origin.row;\n                    state.data.forEach(function (data, dr) {\n                        if (clipboard && !clipboard.isExternal() && sheet.isHiddenRow(state.ref.row + dr)) {\n                            return;\n                        }\n                        var col = origin.col;\n                        data.forEach(function (cellState, dc) {\n                            if (clipboard && !clipboard.isExternal() && sheet.isHiddenColumn(state.ref.col + dc)) {\n                                return;\n                            }\n                            var range = clipboard ? sheet.range(row, col) : sheet.range(origin.row + dr, origin.col + dc);\n                            if (range.enable()) {\n                                for (var property in cellState) {\n                                    if (property != 'value') {\n                                        if (!(clipboard && property == 'enable')) {\n                                            range._set(property, cellState[property]);\n                                        }\n                                    }\n                                }\n                                if (!cellState.formula) {\n                                    if (clipboard && clipboard.isExternal()) {\n                                        try {\n                                            if (cellState.value == null) {\n                                                range._set('value', null);\n                                            } else {\n                                                range.input(cellState.value);\n                                            }\n                                        } catch (ex) {\n                                            range._set('value', cellState.value);\n                                        }\n                                    } else {\n                                        range._set('value', cellState.value);\n                                    }\n                                }\n                            }\n                            col++;\n                        });\n                        row++;\n                    });\n                    if (state.mergedCells) {\n                        state.mergedCells.forEach(function (merged) {\n                            merged = sheet._ref(merged).relative(rowDelta, colDelta, 3);\n                            sheet.range(merged).merge();\n                        }, this);\n                    }\n                }.bind(this), { recalc: true });\n            },\n            _adjustRowHeight: function () {\n                var sheet = this._sheet;\n                var state = this.getState();\n                var mergedCells = [];\n                for (var i = 0; i < state.mergedCells.length; i++) {\n                    mergedCells.push(sheet.range(state.mergedCells[i]));\n                }\n                this.forEachRow(function (row) {\n                    if (row.topLeft().row >= row.sheet()._rows._count) {\n                        return;\n                    }\n                    var maxHeight = row.sheet().rowHeight(row.topLeft().row);\n                    row.forEachCell(function (rowIndex, colIndex, cell) {\n                        var cellRange = sheet.range(rowIndex, colIndex);\n                        var totalWidth = 0;\n                        for (var i = 0; i < mergedCells.length; i++) {\n                            if (cellRange._ref.intersects(mergedCells[i]._ref)) {\n                                totalWidth += cell.width;\n                                break;\n                            }\n                        }\n                        var width = Math.max(sheet.columnWidth(colIndex), totalWidth);\n                        maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, cell.fontSize, cell.wrap));\n                    });\n                    sheet.rowHeight(row.topLeft().row, Math.max(sheet.rowHeight(row.topLeft().row), maxHeight));\n                });\n            },\n            forEachCell: function (callback) {\n                this._ref.forEach(function (ref) {\n                    this._sheet.forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            },\n            hasValue: function () {\n                var result = false;\n                this.forEachCell(function (row, col, cell) {\n                    if (Object.keys(cell).length !== 0) {\n                        result = true;\n                    }\n                });\n                return result;\n            },\n            wrap: function (flag) {\n                if (flag === undefined) {\n                    return !!this._property('wrap');\n                }\n                this.forEachRow(function (range) {\n                    var maxHeight = range.sheet().rowHeight(range.topLeft().row);\n                    range.forEachCell(function (row, col, cell) {\n                        var width = this._sheet.columnWidth(col);\n                        if (cell.value !== null && cell.value !== undefined) {\n                            maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, cell.fontSize, true));\n                        }\n                    });\n                    range.sheet().rowHeight(range.topLeft().row, maxHeight);\n                }.bind(this));\n                this._property('wrap', flag);\n                return this;\n            },\n            fontSize: function (size) {\n                if (size === undefined) {\n                    return this._property('fontSize');\n                }\n                this.forEachRow(function (range) {\n                    var maxHeight = range.sheet().rowHeight(range.topLeft().row);\n                    range.forEachCell(function (row, col, cell) {\n                        var width = this._sheet.columnWidth(col);\n                        if (cell.value !== null && cell.value !== undefined) {\n                            maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, size, cell.wrap));\n                        }\n                    });\n                    range.sheet().rowHeight(range.topLeft().row, maxHeight);\n                }.bind(this));\n                this._property('fontSize', size);\n                return this;\n            },\n            draw: function (options, callback) {\n                this._sheet.draw(this, options, callback);\n            }\n        });\n        function partition(begin, end, predicate) {\n            while (begin <= end && predicate(begin)) {\n                begin++;\n            }\n            if (begin > end) {\n                return [];\n            }\n            for (var i = begin + 1; i <= end; ++i) {\n                if (predicate(i)) {\n                    return [{\n                            begin: begin,\n                            end: i - 1\n                        }].concat(partition(i + 1, end, predicate));\n                }\n            }\n            return [{\n                    begin: begin,\n                    end: end\n                }];\n        }\n        $.each(PROPERTIES, function (i, property) {\n            Range.prototype[property] = function (value) {\n                return this._property(property, value);\n            };\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        function looksLikeANumber(str) {\n            return !/^=/.test(str) && /number|percent/.test(kendo.spreadsheet.calc.parse(null, 0, 0, str).type);\n        }\n        var measureBox = $('<div style=\"position: absolute !important; top: -4000px !important; height: auto !important;' + 'padding: 1px !important; margin: 0 !important; border: 1px solid black !important;' + 'line-height: normal !important; visibility: hidden !important;' + 'white-space: pre-wrap !important; word-break: break-all !important;\" />')[0];\n        function getTextHeight(text, width, fontSize, wrap) {\n            var styles = {\n                'baselineMarkerSize': 0,\n                'width': width + 'px',\n                'font-size': (fontSize || 12) + 'px',\n                'word-break': wrap === true ? 'break-all' : 'normal',\n                'white-space': wrap === true ? 'pre-wrap' : 'pre'\n            };\n            return kendo.util.measureText(text, styles, measureBox).height;\n        }\n        kendo.spreadsheet.util = { getTextHeight: getTextHeight };\n        kendo.spreadsheet.Range = Range;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime', ['spreadsheet/references'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var calc = {};\n    var spreadsheet = kendo.spreadsheet;\n    spreadsheet.calc = calc;\n    var exports = calc.runtime = {};\n    var Class = kendo.Class;\n    var Ref = spreadsheet.Ref;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NULL = spreadsheet.NULLREF;\n    function CalcError(code) {\n        if (code instanceof CalcError) {\n            return code;\n        }\n        this.code = code;\n    }\n    CalcError.prototype.toString = function () {\n        return '#' + this.code + (this.code == 'NAME' ? '?' : '!');\n    };\n    var Context = Class.extend({\n        init: function Context(callback, formula, ss, parent) {\n            this.callback = callback;\n            this.formula = formula;\n            this.ss = ss;\n            this.parent = parent;\n        },\n        resolve: function (val) {\n            var self = this;\n            if (val instanceof Ref) {\n                self.resolveCells([val], function () {\n                    self._resolve(val);\n                });\n            } else {\n                self._resolve(val);\n            }\n        },\n        error: function (val) {\n            return new CalcError(val);\n        },\n        _resolve: function (val) {\n            if (val === undefined) {\n                val = null;\n            } else if (Array.isArray(val)) {\n                val = this.asMatrix(val);\n            } else {\n                val = maybeRoundFloatErrors(val);\n            }\n            var f = this.formula;\n            f.value = val;\n            if (this.ss.onFormula(f) && this.callback) {\n                this.callback.call(f, val);\n            }\n        },\n        resolveCells: function (a, f) {\n            var context = this, formulas = [];\n            (function loop(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var x = a[i];\n                    if (x instanceof Ref) {\n                        add(context.getRefCells(x));\n                    }\n                    if (Array.isArray(x)) {\n                        loop(x);\n                    }\n                }\n            }(a));\n            if (!formulas.length) {\n                return f.call(context);\n            }\n            for (var pending = formulas.length, i = 0; i < formulas.length; ++i) {\n                fetch(formulas[i]);\n            }\n            function fetch(formula) {\n                formula.exec(context.ss, function () {\n                    if (!--pending) {\n                        f.call(context);\n                    }\n                }, context);\n            }\n            function add(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var cell = a[i];\n                    if (cell.formula) {\n                        formulas.push(cell.formula);\n                    }\n                }\n                return true;\n            }\n        },\n        cellValues: function (a, f) {\n            var ret = [];\n            for (var i = 0; i < a.length; ++i) {\n                var val = a[i];\n                if (val instanceof Ref) {\n                    val = this.getRefData(val);\n                    ret = ret.concat(val);\n                } else if (Array.isArray(val)) {\n                    ret = ret.concat(this.cellValues(val));\n                } else if (val instanceof Matrix) {\n                    ret = ret.concat(this.cellValues(val.data));\n                } else {\n                    ret.push(val);\n                }\n            }\n            if (f) {\n                return f.apply(this, ret);\n            }\n            return ret;\n        },\n        fetchName: function (ref, callback) {\n            var f = this.formula;\n            var val = this.ss.nameValue(ref, f.sheet, f.row, f.col);\n            if (val instanceof Formula) {\n                val = val.clone(f.sheet, f.row, f.col, true);\n                var ss = new spreadsheet.ValidationFormulaContext(this.ss.workbook);\n                val.exec(ss, callback, this);\n            } else {\n                if (val instanceof Ref) {\n                    val = val.absolute(f.row, f.col);\n                    if (!val.sheet) {\n                        val.sheet = f.sheet;\n                    }\n                }\n                callback(val == null ? new CalcError('NAME') : val);\n            }\n        },\n        force: function (val) {\n            if (val instanceof Ref) {\n                return this.getRefData(val);\n            }\n            return val;\n        },\n        func: function (fname, callback, args) {\n            fname = fname.toLowerCase();\n            var f = FUNCS[fname];\n            if (f) {\n                return f.call(this, callback, args);\n            }\n            callback(new CalcError('NAME'));\n        },\n        bool: function (val) {\n            if (val instanceof Ref) {\n                val = this.getRefData(val);\n            }\n            if (typeof val == 'string') {\n                return val.toLowerCase() == 'true';\n            }\n            if (typeof val == 'number') {\n                return val !== 0;\n            }\n            if (typeof val == 'boolean') {\n                return val;\n            }\n            return val != null;\n        },\n        asMatrix: function (range) {\n            if (range instanceof Matrix) {\n                return range;\n            }\n            var self = this;\n            if (range instanceof RangeRef) {\n                var tl = range.topLeft;\n                var top = tl.row, left = tl.col;\n                var cells = self.getRefCells(range);\n                var m = new Matrix(self);\n                if (isFinite(range.width())) {\n                    m.width = range.width();\n                }\n                if (isFinite(range.height())) {\n                    m.height = range.height();\n                }\n                if (!isFinite(top)) {\n                    top = 0;\n                }\n                if (!isFinite(left)) {\n                    left = 0;\n                }\n                cells.forEach(function (cell) {\n                    m.set(cell.row - top, cell.col - left, cell.value);\n                });\n                return m;\n            }\n            if (Array.isArray(range) && range.length > 0) {\n                var m = new Matrix(self), row = 0;\n                range.forEach(function (line) {\n                    var col = 0;\n                    var h = 1;\n                    line.forEach(function (el) {\n                        var isRange = el instanceof RangeRef;\n                        if (el instanceof Ref && !isRange) {\n                            el = self.getRefData(el);\n                        }\n                        if (isRange || Array.isArray(el)) {\n                            el = self.asMatrix(el);\n                        }\n                        if (el instanceof Matrix) {\n                            el.each(function (el, r, c) {\n                                m.set(row + r, col + c, el);\n                            });\n                            h = Math.max(h, el.height);\n                            col += el.width;\n                        } else {\n                            m.set(row, col++, el);\n                        }\n                    });\n                    row += h;\n                });\n                return m;\n            }\n        },\n        getRefCells: function (refs, hiddenInfo) {\n            var f = this.formula;\n            return this.ss.getRefCells(refs, hiddenInfo, f.sheet, f.row, f.col);\n        },\n        getRefData: function (ref) {\n            var f = this.formula;\n            return this.ss.getData(ref, f.sheet, f.row, f.col);\n        },\n        workbook: function () {\n            return this.ss.workbook;\n        }\n    });\n    var Matrix = Class.extend({\n        init: function Matrix(context) {\n            this.context = context;\n            this.height = 0;\n            this.width = 0;\n            this.data = [];\n        },\n        clone: function () {\n            var m = new Matrix(this.context);\n            m.height = this.height;\n            m.width = this.width;\n            m.data = this.data.map(function (row) {\n                return row.slice();\n            });\n            return m;\n        },\n        get: function (row, col) {\n            var line = this.data[row];\n            var val = line ? line[col] : null;\n            return val instanceof Ref ? this.context.getRefData(val) : val;\n        },\n        set: function (row, col, data) {\n            var line = this.data[row];\n            if (line == null) {\n                line = this.data[row] = [];\n            }\n            line[col] = data;\n            if (row >= this.height) {\n                this.height = row + 1;\n            }\n            if (col >= this.width) {\n                this.width = col + 1;\n            }\n        },\n        each: function (f, includeEmpty) {\n            for (var row = 0; row < this.height; ++row) {\n                for (var col = 0; col < this.width; ++col) {\n                    var val = this.get(row, col);\n                    if (includeEmpty || val != null) {\n                        val = f.call(this.context, val, row, col);\n                        if (val !== undefined) {\n                            return val;\n                        }\n                    }\n                }\n            }\n        },\n        map: function (f, includeEmpty) {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(row, col, f.call(this, el, row, col));\n            }, includeEmpty);\n            return m;\n        },\n        eachRow: function (f) {\n            for (var row = 0; row < this.height; ++row) {\n                var val = f.call(this.context, row);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        eachCol: function (f) {\n            for (var col = 0; col < this.width; ++col) {\n                var val = f.call(this.context, col);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        mapRow: function (f) {\n            var m = new Matrix(this.context);\n            this.eachRow(function (row) {\n                m.set(row, 0, f.call(this.context, row));\n            });\n            return m;\n        },\n        mapCol: function (f) {\n            var m = new Matrix(this.context);\n            this.eachCol(function (col) {\n                m.set(0, col, f.call(this.context, col));\n            });\n            return m;\n        },\n        toString: function () {\n            return JSON.stringify(this.data);\n        },\n        transpose: function () {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(col, row, el);\n            });\n            return m;\n        },\n        unit: function (n) {\n            this.width = this.height = n;\n            var a = this.data = new Array(n);\n            for (var i = n; --i >= 0;) {\n                var row = a[i] = new Array(n);\n                for (var j = n; --j >= 0;) {\n                    row[j] = i == j ? 1 : 0;\n                }\n            }\n            return this;\n        },\n        multiply: function (b) {\n            var a = this, m = new Matrix(a.context);\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < b.width; ++col) {\n                    var s = 0;\n                    for (var i = 0; i < a.width; ++i) {\n                        var va = a.get(row, i);\n                        var vb = b.get(i, col);\n                        if (typeof va != 'number' || typeof vb != 'number') {\n                            throw new CalcError('VALUE');\n                        }\n                        s += va * vb;\n                    }\n                    m.set(row, col, s);\n                }\n            }\n            return m;\n        },\n        adds: function (b, s) {\n            var a = this, m = new Matrix(a.context);\n            var sign = s ? -1 : 1;\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < a.width; ++col) {\n                    var x = a.get(row, col), y = b.get(row, col);\n                    m.set(row, col, x + sign * y);\n                }\n            }\n            return m;\n        },\n        determinant: function () {\n            var a = this.clone().data;\n            var n = a.length;\n            var d = 1, C, L, i, k;\n            for (C = 0; C < n; C++) {\n                for (L = C; L < n && !a[L][C]; L++) {\n                }\n                if (L == n) {\n                    return 0;\n                }\n                if (L != C) {\n                    d = -d;\n                    for (k = C; k < n; k++) {\n                        var t = a[C][k];\n                        a[C][k] = a[L][k];\n                        a[L][k] = t;\n                    }\n                }\n                for (i = C + 1; i < n; i++) {\n                    for (k = C + 1; k < n; k++) {\n                        a[i][k] -= a[C][k] * a[i][C] / a[C][C];\n                    }\n                }\n                d *= a[C][C];\n            }\n            return d;\n        },\n        inverse: function () {\n            var n = this.width;\n            var m = this.augment(new Matrix(this.context).unit(n));\n            var a = m.data;\n            var tmp;\n            for (var k = 0; k < n; ++k) {\n                var imax = argmax(k, n, function (i) {\n                    return a[i][k];\n                });\n                if (!a[imax][k]) {\n                    return null;\n                }\n                if (k != imax) {\n                    tmp = a[k];\n                    a[k] = a[imax];\n                    a[imax] = tmp;\n                }\n                for (var i = k + 1; i < n; ++i) {\n                    for (var j = k + 1; j < 2 * n; ++j) {\n                        a[i][j] -= a[k][j] * a[i][k] / a[k][k];\n                    }\n                    a[i][k] = 0;\n                }\n            }\n            for (var i = 0; i < n; ++i) {\n                for (var f = a[i][i], j = 0; j < 2 * n; ++j) {\n                    a[i][j] /= f;\n                }\n            }\n            for (var k = n; --k >= 0;) {\n                for (var i = k; --i >= 0;) {\n                    if (a[i][k]) {\n                        for (var j = 2 * n; --j >= n;) {\n                            a[i][j] -= a[k][j] * a[i][k];\n                        }\n                    }\n                }\n            }\n            return m.slice(0, n, n, n);\n        },\n        augment: function (m) {\n            var ret = this.clone(), n = ret.width;\n            m.each(function (val, row, col) {\n                ret.set(row, col + n, val);\n            });\n            return ret;\n        },\n        slice: function (row, col, height, width) {\n            var m = new Matrix(this.context);\n            for (var i = 0; i < height; ++i) {\n                for (var j = 0; j < width; ++j) {\n                    m.set(i, j, this.get(row + i, col + j));\n                }\n            }\n            return m;\n        }\n    });\n    function argmax(i, end, f) {\n        var max = f(i), pos = i;\n        while (++i < end) {\n            var v = f(i);\n            if (v > max) {\n                max = v;\n                pos = i;\n            }\n        }\n        return pos;\n    }\n    var Formula = Class.extend({\n        init: function Formula(refs, handler, printer, sheet, row, col) {\n            this.refs = refs;\n            this.handler = handler;\n            this.print = printer;\n            this.absrefs = null;\n            this.sheet = sheet;\n            this.row = row;\n            this.col = col;\n            this.onReady = [];\n            this.pending = false;\n        },\n        clone: function (sheet, row, col, forceRefs) {\n            var lcsheet = sheet.toLowerCase();\n            var refs = this.refs;\n            if (forceRefs || lcsheet != this.sheet.toLowerCase()) {\n                refs = refs.map(function (ref) {\n                    if (!ref.hasSheet() && (!ref.sheet || ref.sheet.toLowerCase() != lcsheet)) {\n                        ref = ref.clone().setSheet(sheet);\n                    }\n                    return ref;\n                });\n            }\n            return new Formula(refs, this.handler, this.print, sheet, row, col);\n        },\n        resolve: function (val) {\n            this.pending = false;\n            this.onReady.forEach(function (callback) {\n                callback(val);\n            });\n        },\n        exec: function (ss, callback, parentContext) {\n            if ('value' in this) {\n                if (callback) {\n                    callback(this.value);\n                }\n            } else {\n                if (callback) {\n                    this.onReady.push(callback);\n                }\n                var ctx = new Context(this.resolve, this, ss, parentContext);\n                while (parentContext) {\n                    if (parentContext.formula === this) {\n                        this.pending = false;\n                        ctx.resolve(new CalcError('CIRCULAR'));\n                        return;\n                    }\n                    parentContext = parentContext.parent;\n                }\n                if (this.pending) {\n                    return;\n                }\n                this.pending = true;\n                if (!this.absrefs) {\n                    this.absrefs = this.refs.map(function (ref) {\n                        return ref.absolute(this.row, this.col);\n                    }, this);\n                }\n                this.handler.call(ctx);\n            }\n        },\n        reset: function () {\n            this.onReady = [];\n            this.pending = false;\n            delete this.value;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            oldSheetName = oldSheetName.toLowerCase();\n            this.absrefs = null;\n            if (this.sheet.toLowerCase() == oldSheetName) {\n                this.sheet = newSheetName;\n            }\n            this.refs.forEach(function (ref) {\n                ref.renameSheet(oldSheetName, newSheetName);\n            });\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            affectedSheet = affectedSheet.toLowerCase();\n            var formulaRow = this.row;\n            var formulaCol = this.col;\n            var formulaSheet = this.sheet.toLowerCase();\n            var formulaMoves = false;\n            if (formulaSheet == affectedSheet) {\n                if (operation == 'row' && formulaRow >= start) {\n                    this.row += delta;\n                    formulaMoves = true;\n                }\n                if (operation == 'col' && formulaCol >= start) {\n                    this.col += delta;\n                    formulaMoves = true;\n                }\n            }\n            var newFormulaRow = this.row;\n            var newFormulaCol = this.col;\n            this.absrefs = null;\n            this.refs = this.refs.map(function (ref) {\n                if (ref === NULL) {\n                    return ref;\n                }\n                if (ref.sheet.toLowerCase() != affectedSheet) {\n                    if (formulaMoves) {\n                        if (operation == 'row' && formulaRow >= start) {\n                            ref = ref.relative(delta, 0);\n                        }\n                        if (operation == 'col' && formulaCol >= start) {\n                            ref = ref.relative(0, delta);\n                        }\n                    }\n                    return ref;\n                }\n                return ref.adjust(formulaRow, formulaCol, newFormulaRow, newFormulaCol, operation == 'row', start, delta);\n            }, this);\n        },\n        toString: function () {\n            return this.print(this.row, this.col);\n        }\n    });\n    var FUNCS = Object.create(null);\n    FUNCS['if'] = function (callback, args) {\n        var self = this;\n        var co = args[0], th = args[1], el = args[2];\n        this.resolveCells([co], function () {\n            var comatrix = self.asMatrix(co);\n            if (comatrix) {\n                th(function (th) {\n                    el(function (el) {\n                        var thmatrix = self.asMatrix(th);\n                        var elmatrix = self.asMatrix(el);\n                        callback(comatrix.map(function (val, row, col) {\n                            if (val instanceof CalcError) {\n                                return val;\n                            } else if (self.bool(val)) {\n                                return thmatrix ? thmatrix.get(row, col) : th;\n                            } else {\n                                return elmatrix ? elmatrix.get(row, col) : el;\n                            }\n                        }));\n                    });\n                });\n            } else {\n                co = this.force(co);\n                if (co instanceof CalcError) {\n                    callback(co);\n                } else if (self.bool(co)) {\n                    th(callback);\n                } else {\n                    el(callback);\n                }\n            }\n        });\n    };\n    FUNCS[''] = function (callback) {\n        callback((1 + Math.sqrt(5)) / 2);\n    };\n    function compileArgumentChecks(functionName, args) {\n        var arrayArgs = 'function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; ';\n        var resolve = 'function resolve(args, callback) { var toResolve = [], i = 0; ';\n        var name, forced, main = '\\'use strict\\'; function check(args) { var stack = [], tmp, xargs = [], i = 0, m, err = \\'VALUE\\'; ', haveForced = false;\n        var canBeArrayArg = false, hasArrayArgs = false;\n        main += args.map(comp).join('');\n        main += 'if (i < args.length) return new CalcError(\\'N/A\\'); ';\n        main += 'return xargs; } ';\n        arrayArgs += 'return { args: xargs, width: width, height: height, arrays: arrays }; } ';\n        var f;\n        if (haveForced) {\n            resolve += 'this.resolveCells(toResolve, callback); } ';\n            f = new Function('CalcError', 'round', main + resolve + arrayArgs + ' return { resolve: resolve, check: check, arrayArgs: arrayArgs };');\n        } else {\n            f = new Function('CalcError', 'round', main + ' return { check: check };');\n        }\n        f = f(CalcError, roundFloatErrors);\n        if (!hasArrayArgs) {\n            delete f.arrayArgs;\n        }\n        return f;\n        function comp(x) {\n            name = x[0];\n            var code = '{ ';\n            if (Array.isArray(name)) {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'while (i < args.length) { ';\n                code += x.map(comp).join('');\n                code += '} ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '+') {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'if (i >= args.length) return new CalcError(\\'N/A\\'); ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'do { ';\n                code += x.slice(1).map(comp).join('');\n                code += '} while (i < args.length); ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '?') {\n                code += 'if (!(' + cond(x[1]) + ')) return new CalcError(err); ';\n            } else {\n                var type = x[1];\n                if (Array.isArray(type) && /^#?collect/.test(type[0])) {\n                    var n = type[2];\n                    force();\n                    code += 'try {' + 'var $' + name + ' = this.cellValues(args.slice(i';\n                    if (n) {\n                        code += ', i + ' + n;\n                    }\n                    code += ')).filter(function($' + name + '){ ';\n                    if (type[0] == 'collect') {\n                        code += 'if ($' + name + ' instanceof CalcError) throw $' + name + '; ';\n                    }\n                    code += 'return ' + cond(type[1]) + '; }, this); ';\n                    if (n) {\n                        code += 'i += ' + n + '; ';\n                    } else {\n                        code += 'i = args.length; ';\n                    }\n                    code += 'xargs.push($' + name + ')' + '} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } ';\n                    resolve += 'toResolve.push(args.slice(i)); ';\n                } else if (type == 'rest') {\n                    code += 'xargs.push(args.slice(i)); i = args.length; ';\n                } else {\n                    if (canBeArrayArg = /^\\*/.test(name)) {\n                        hasArrayArgs = true;\n                        name = name.substr(1);\n                    }\n                    code += 'var $' + name + ' = args[i++]; ';\n                    var allowError = false;\n                    if (/!$/.test(type)) {\n                        type = type.substr(0, type.length - 1);\n                        allowError = true;\n                    } else {\n                        code += 'if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n                    }\n                    code += typeCheck(type, allowError) + 'xargs.push($' + name + '); ';\n                }\n            }\n            code += '} ';\n            return code;\n        }\n        function force() {\n            if (forced) {\n                return '$' + name + '';\n            }\n            haveForced = true;\n            forced = true;\n            resolve += 'toResolve.push(args[i++]); ';\n            return '($' + name + ' = this.force($' + name + '))';\n        }\n        function forceNum(round) {\n            return '(' + (round ? '(typeof ' + force() + ' == \\'number\\' ? ($' + name + ' = round($' + name + '), true) : false) || ' : '(typeof ' + force() + ' == \\'number\\') || ') + '(typeof $' + name + ' == \\'boolean\\') || ' + '(typeof $' + name + ' == \\'string\\' && !/^(?:=|true|false)/i.test($' + name + ') ? (' + 'tmp = kendo.spreadsheet.calc.parse(0, 0, 0, $' + name + '), ' + '/^date|number|percent$/.test(tmp.type) ? ($' + name + ' = +tmp.value, true) : false' + ') : false)' + ')';\n        }\n        function typeCheck(type, allowError) {\n            forced = false;\n            var ret = 'if (!(' + cond(type) + ')) { ';\n            if (forced && !allowError) {\n                ret += ' if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n            }\n            ret += 'return new CalcError(err); } ';\n            if (!forced) {\n                resolve += 'i++; ';\n            }\n            if (canBeArrayArg) {\n                arrayArgs += 'var $' + name + ' = this.asMatrix(args[i]); ' + 'if ($' + name + ') { ' + 'xargs.push($' + name + '); ' + 'width = Math.max(width, $' + name + '.width); ' + 'height = Math.max(height, $' + name + '.height); ' + 'arrays.push(true) } else { ' + 'xargs.push(args[i]); ' + 'arrays.push(false); } i++; ';\n            } else {\n                arrayArgs += 'xargs.push(args[i++]); arrays.push(false); ';\n            }\n            return ret;\n        }\n        function cond(type) {\n            if (Array.isArray(type)) {\n                if (type[0] == 'or') {\n                    return '(' + type.slice(1).map(cond).join(') || (') + ')';\n                }\n                if (type[0] == 'and') {\n                    return '(' + type.slice(1).map(cond).join(') && (') + ')';\n                }\n                if (type[0] == 'values') {\n                    return '(' + type.slice(1).map(function (val) {\n                        return force() + ' === ' + val;\n                    }).join(') || (') + ')';\n                }\n                if (type[0] == 'null') {\n                    return '(' + cond('null') + ' ? (($' + name + ' = ' + type[1] + '), true) : false)';\n                }\n                if (type[0] == 'between' || type[0] == '[between]') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between)') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between]') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '[between)') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == 'assert') {\n                    var err = type[2] || 'N/A';\n                    return '((' + type[1] + ') ? true : (err = ' + JSON.stringify(err) + ', false))';\n                }\n                if (type[0] == 'not') {\n                    return '!(' + cond(type[1]) + ')';\n                }\n                throw new Error('Unknown array type condition: ' + type[0]);\n            }\n            if (type == 'number' || type == 'datetime') {\n                return forceNum(true);\n            }\n            if (type == 'integer' || type == 'date') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0), true))';\n            }\n            if (type == 'divisor') {\n                return '(' + forceNum(true) + ' && ($' + name + ' == 0 ? ((err = \\'DIV/0\\'), false) : true))';\n            }\n            if (type == 'number+') {\n                return '(' + forceNum(true) + ' && ($' + name + ' >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer+') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0) >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'number++') {\n                return '(' + forceNum(true) + ' && ($' + name + ' > 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer++') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0) > 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'string') {\n                return '((typeof ' + force() + ' == \\'string\\' || typeof $' + name + ' == \\'boolean\\' || typeof $' + name + ' == \\'number\\') ? ($' + name + ' += \\'\\', true) : ($' + name + ' === undefined ? (($' + name + ' = \\'\\'), true) : false))';\n            }\n            if (type == 'boolean') {\n                return '(typeof ' + force() + ' == \\'boolean\\')';\n            }\n            if (type == 'logical') {\n                return '(typeof ' + force() + ' == \\'boolean\\' || (typeof $' + name + ' == \\'number\\' ? ($' + name + ' = !!$' + name + ', true) : false))';\n            }\n            if (type == 'matrix') {\n                force();\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == '#matrix') {\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == 'ref') {\n                return '($' + name + ' instanceof kendo.spreadsheet.Ref)';\n            }\n            if (type == 'area') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef || $' + name + ' instanceof kendo.spreadsheet.RangeRef)';\n            }\n            if (type == 'cell') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef)';\n            }\n            if (type == 'null') {\n                return '(' + force() + ' == null)';\n            }\n            if (type == 'anyvalue') {\n                return '(' + force() + ' != null && i <= args.length)';\n            }\n            if (type == 'forced') {\n                return '(' + force() + ', i <= args.length)';\n            }\n            if (type == 'anything') {\n                return '(i <= args.length)';\n            }\n            if (type == 'blank') {\n                return '(' + force() + ' == null || $' + name + ' === \\'\\')';\n            }\n            throw new Error('Can\\'t check for type: ' + type);\n        }\n    }\n    function roundFloatErrors(num) {\n        return Math.round(num * 1000000000000000) / 1000000000000000;\n    }\n    function maybeRoundFloatErrors(num) {\n        if (typeof num == 'number') {\n            return roundFloatErrors(num);\n        } else {\n            return num;\n        }\n    }\n    function withErrorHandling(obj, f, args) {\n        if (args instanceof CalcError) {\n            return args;\n        }\n        try {\n            return f.apply(obj, args);\n        } catch (ex) {\n            if (ex instanceof CalcError) {\n                return ex;\n            } else {\n                throw ex;\n            }\n        }\n    }\n    function makeSyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        for (var row = 0; row < x.height; ++row) {\n                            for (var col = 0; col < x.width; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        var m = args[i];\n                                        xargs[i] = m.get(row % m.height, col % m.width);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                result.set(row, col, withErrorHandling(this, handler, xargs));\n                            }\n                        }\n                        return callback(result);\n                    }\n                }\n                var xargs = check.call(this, args);\n                callback(withErrorHandling(this, handler, xargs));\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function makeAsyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        var count = x.width * x.height;\n                        var makeCallback = function (row, col) {\n                            return function (value) {\n                                result.set(row, col, value);\n                                --count;\n                                if (count === 0) {\n                                    return callback(result);\n                                }\n                            };\n                        };\n                        for (var row = 0; row < x.height && count > 0; ++row) {\n                            for (var col = 0; col < x.width && count > 0; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        var m = args[i];\n                                        xargs[i] = m.get(row % m.height, col % m.width);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                if (xargs instanceof CalcError) {\n                                    result.set(row, col, xargs);\n                                    --count;\n                                    if (count === 0) {\n                                        return callback(result);\n                                    }\n                                } else {\n                                    xargs.unshift(makeCallback(row, col));\n                                    handler.apply(this, xargs);\n                                }\n                            }\n                        }\n                        return;\n                    }\n                }\n                var x = check.call(this, args);\n                if (x instanceof CalcError) {\n                    callback(x);\n                } else {\n                    x.unshift(callback);\n                    handler.apply(this, x);\n                }\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function defineFunction(name, func) {\n        name = name.toLowerCase();\n        FUNCS[name] = func;\n        return {\n            args: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeSyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            },\n            argsAsync: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeAsyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            }\n        };\n    }\n    function dateToJulianDays(y, m, d) {\n        m++;\n        return (1461 * (y + 4800 + ((m - 14) / 12 | 0)) / 4 | 0) + (367 * (m - 2 - 12 * ((m - 14) / 12 | 0)) / 12 | 0) - (3 * ((y + 4900 + ((m - 14) / 12 | 0)) / 100 | 0) / 4 | 0) + d - 32075;\n    }\n    function julianDaysToDate(jd) {\n        var l, n, j, i, m, d, y;\n        l = jd + 68569;\n        n = 4 * l / 146097 | 0;\n        l = l - ((146097 * n + 3) / 4 | 0);\n        i = 4000 * (l + 1) / 1461001 | 0;\n        l = l - (1461 * i / 4 | 0) + 31;\n        j = 80 * l / 2447 | 0;\n        d = l - (2447 * j / 80 | 0);\n        l = j / 11 | 0;\n        m = j + 2 - 12 * l;\n        y = 100 * (n - 49) + i + l;\n        m--;\n        return {\n            year: y,\n            month: m,\n            date: d,\n            day: (jd + 1) % 7,\n            ord: ORDINAL_ADD_DAYS[isLeapYear(y)][m] + d\n        };\n    }\n    var BASE_DATE = dateToJulianDays(1900, 0, -1);\n    var DAYS_IN_MONTH = [\n        31,\n        28,\n        31,\n        30,\n        31,\n        30,\n        31,\n        31,\n        30,\n        31,\n        30,\n        31\n    ];\n    var ORDINAL_ADD_DAYS = [\n        [\n            0,\n            31,\n            59,\n            90,\n            120,\n            151,\n            181,\n            212,\n            243,\n            273,\n            304,\n            334\n        ],\n        [\n            0,\n            31,\n            60,\n            91,\n            121,\n            152,\n            182,\n            213,\n            244,\n            274,\n            305,\n            335\n        ]\n    ];\n    function isLeapYear(yr) {\n        if (yr % 4) {\n            return 0;\n        }\n        if (yr % 100) {\n            return 1;\n        }\n        if (yr % 400) {\n            return 0;\n        }\n        return 1;\n    }\n    function daysInYear(yr) {\n        return isLeapYear(yr) ? 366 : 365;\n    }\n    function daysInMonth(yr, mo) {\n        return isLeapYear(yr) && mo == 1 ? 29 : DAYS_IN_MONTH[mo];\n    }\n    function unpackDate(serial) {\n        return julianDaysToDate((serial | 0) + BASE_DATE);\n    }\n    function packDate(year, month, date) {\n        return dateToJulianDays(year, month, date) - BASE_DATE;\n    }\n    var MS_IN_MIN = 60 * 1000;\n    var MS_IN_HOUR = 60 * MS_IN_MIN;\n    var MS_IN_DAY = 24 * MS_IN_HOUR;\n    function unpackTime(serial) {\n        var frac = serial - (serial | 0);\n        if (frac < 0) {\n            frac++;\n        }\n        var ms = Math.round(MS_IN_DAY * frac);\n        var hours = Math.floor(ms / MS_IN_HOUR);\n        ms -= hours * MS_IN_HOUR;\n        var minutes = Math.floor(ms / MS_IN_MIN);\n        ms -= minutes * MS_IN_MIN;\n        var seconds = Math.floor(ms / 1000);\n        ms -= seconds * 1000;\n        return {\n            hours: hours,\n            minutes: minutes,\n            seconds: seconds,\n            milliseconds: ms\n        };\n    }\n    function serialToDate(serial) {\n        var d = unpackDate(serial), t = unpackTime(serial);\n        return new Date(d.year, d.month, d.date, t.hours, t.minutes, t.seconds, t.milliseconds);\n    }\n    function packTime(hh, mm, ss, ms) {\n        return (hh + (mm + (ss + ms / 1000) / 60) / 60) / 24;\n    }\n    function dateToSerial(date) {\n        var time = packTime(date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds());\n        date = packDate(date.getFullYear(), date.getMonth(), date.getDate());\n        if (date < 0) {\n            return date - 1 + time;\n        } else {\n            return date + time;\n        }\n    }\n    function parseDate(str) {\n        return kendo.parseDate(str) || kendo.parseDate(str, [\n            'MMMM dd yyyy',\n            'MMMM dd yy',\n            'MMM dd yyyy',\n            'MMM dd yy',\n            'dd MMMM yyyy',\n            'dd MMMM yy',\n            'dd MMM yyyy',\n            'dd MMM yy',\n            'MMMM dd, yyyy',\n            'MMMM dd, yy',\n            'MMM dd, yyyy',\n            'MMM dd, yy',\n            'MMMM dd',\n            'MMM dd',\n            'MMMM yyyy',\n            'MMM yyyy',\n            'dd MMMM',\n            'dd MMM'\n        ]);\n    }\n    exports.CalcError = CalcError;\n    exports.Formula = Formula;\n    exports.Matrix = Matrix;\n    exports.packDate = packDate;\n    exports.unpackDate = unpackDate;\n    exports.packTime = packTime;\n    exports.unpackTime = unpackTime;\n    exports.serialToDate = serialToDate;\n    exports.dateToSerial = dateToSerial;\n    exports.daysInMonth = daysInMonth;\n    exports.isLeapYear = isLeapYear;\n    exports.daysInYear = daysInYear;\n    exports.parseDate = parseDate;\n    spreadsheet.dateToNumber = dateToSerial;\n    spreadsheet.numberToDate = serialToDate;\n    spreadsheet.defineFunction = defineFunction;\n    spreadsheet.CalcError = CalcError;\n    exports.defineFunction = defineFunction;\n    exports.defineAlias = function (alias, name) {\n        var orig = FUNCS[name];\n        if (!orig) {\n            throw new Error('Function ' + name + ' is not yet defined');\n        }\n        if (!orig.kendoSpreadsheetAliases) {\n            orig.kendoSpreadsheetAliases = [name];\n        }\n        orig.kendoSpreadsheetAliases.push(alias);\n        FUNCS[alias] = orig;\n    };\n    exports.FUNCS = FUNCS;\n    var NUMBER_OR_ZERO = [\n        'or',\n        'number',\n        [\n            'null',\n            0\n        ]\n    ];\n    var ARGS_NUMERIC = [\n        [\n            '*a',\n            NUMBER_OR_ZERO\n        ],\n        [\n            '*b',\n            NUMBER_OR_ZERO\n        ]\n    ];\n    var ARGS_ANYVALUE = [\n        [\n            '*a',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '*b',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ];\n    defineFunction('binary+', function (a, b) {\n        return a + b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary-', function (a, b) {\n        return a - b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary*', function (a, b) {\n        return a * b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary/', function (a, b) {\n        return a / b;\n    }).args([\n        [\n            '*a',\n            NUMBER_OR_ZERO\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('binary^', function (a, b) {\n        return Math.pow(a, b);\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary&', function (a, b) {\n        if (a == null) {\n            a = '';\n        }\n        if (b == null) {\n            b = '';\n        }\n        return '' + a + b;\n    }).args([\n        [\n            '*a',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ],\n        [\n            '*b',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('binary=', function (a, b) {\n        return a === b;\n    }).args(ARGS_ANYVALUE);\n    defineFunction('binary<>', function (a, b) {\n        return a !== b;\n    }).args(ARGS_ANYVALUE);\n    defineFunction('binary<', binaryCompare(function (a, b) {\n        return a < b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary<=', binaryCompare(function (a, b) {\n        return a <= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>', binaryCompare(function (a, b) {\n        return a > b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>=', binaryCompare(function (a, b) {\n        return a >= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('unary+', function (a) {\n        return a;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('unary-', function (a) {\n        return -a;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('unary%', function (a) {\n        return a / 100;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('binary:', function (a, b) {\n        return new RangeRef(a, b).setSheet(a.sheet || this.formula.sheet, a.hasSheet());\n    }).args([\n        [\n            'a',\n            'cell'\n        ],\n        [\n            'b',\n            'cell'\n        ]\n    ]);\n    defineFunction('binary,', function (a, b) {\n        return new UnionRef([\n            a,\n            b\n        ]);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('binary ', function (a, b) {\n        return a.intersect(b);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('not', function (a) {\n        return !this.bool(a);\n    }).args([[\n            '*a',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]]);\n    defineFunction('isblank', function (val) {\n        if (val instanceof CellRef) {\n            val = this.getRefData(val);\n            return val == null;\n        }\n        return false;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    defineFunction('iserror', function (val) {\n        return val instanceof CalcError;\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('iserr', function (val) {\n        return val instanceof CalcError && val.code != 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isna', function (val) {\n        return val instanceof CalcError && val.code == 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('islogical', function (val) {\n        return typeof val == 'boolean';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnontext', function (val) {\n        return typeof val != 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('istext', function (val) {\n        return typeof val == 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnumber', function (val) {\n        return typeof val == 'number';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isref', function (val) {\n        return val instanceof CellRef || val instanceof RangeRef;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    FUNCS[',getname'] = function (callback, args) {\n        this.fetchName(args[0], callback);\n    };\n    function binaryCompare(func) {\n        return function (left, right) {\n            if (typeof left == 'string' && typeof right != 'string') {\n                right = right == null ? '' : right + '';\n            }\n            if (typeof left != 'string' && typeof right == 'string') {\n                left = left == null ? '' : left + '';\n            }\n            if (typeof left == 'number' && right == null) {\n                right = 0;\n            }\n            if (typeof right == 'number' && left == null) {\n                left = 0;\n            }\n            if (typeof left == 'string' && typeof right == 'string') {\n                left = left.toLowerCase();\n                right = right.toLowerCase();\n            }\n            if (typeof right == typeof left) {\n                return func(left, right);\n            } else {\n                return new CalcError('VALUE');\n            }\n        };\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/validation', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    var $ = kendo.jQuery;\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var exports = {};\n    spreadsheet.validation = exports;\n    var calc = spreadsheet.calc;\n    var Class = kendo.Class;\n    var TRANSPOSE_FORMAT = '_matrix({0})';\n    var DATE_FORMAT = 'DATEVALUE(\"{0}\")';\n    calc.runtime.defineFunction('_matrix', function (m) {\n        return m;\n    }).args([[\n            'm',\n            'matrix'\n        ]]);\n    function compileValidation(sheet, row, col, validation) {\n        var validationHandler;\n        var comparer;\n        var parsedFromDate;\n        var parsedToDate;\n        if (typeof validation === 'string') {\n            validation = JSON.parse(validation);\n        }\n        if (validation.from) {\n            if (validation.dataType === 'list' && !validation.fromIsListValue) {\n                validation.from = kendo.format(TRANSPOSE_FORMAT, validation.from);\n                validation.fromIsListValue = true;\n            }\n            if (validation.dataType === 'date') {\n                parsedFromDate = calc.runtime.parseDate(validation.from);\n                if (parsedFromDate) {\n                    validation.from = kendo.format(DATE_FORMAT, validation.from);\n                    validation.fromIsDateValue = true;\n                }\n            }\n            validation.from = calc.compile(calc.parseFormula(sheet, row, col, validation.from));\n        }\n        if (validation.to) {\n            if (validation.dataType === 'date') {\n                parsedToDate = calc.runtime.parseDate(validation.to);\n                if (parsedToDate) {\n                    validation.to = kendo.format(DATE_FORMAT, validation.to);\n                    validation.toIsDateValue = true;\n                }\n            }\n            validation.to = calc.compile(calc.parseFormula(sheet, row, col, validation.to));\n        }\n        if (validation.dataType == 'custom') {\n            comparer = exports.validationComparers.custom;\n        } else if (validation.dataType == 'list') {\n            comparer = exports.validationComparers.list;\n        } else {\n            comparer = exports.validationComparers[validation.comparerType];\n        }\n        if (!comparer) {\n            throw kendo.format('\\'{0}\\' comparer is not implemented.', validation.comparerType);\n        }\n        validationHandler = function (valueToCompare) {\n            var toValue = this.to && this.to_value ? this.to_value : undefined;\n            if (valueToCompare === null || valueToCompare === '') {\n                if (this.allowNulls) {\n                    this.value = true;\n                } else {\n                    this.value = false;\n                }\n            } else if (this.dataType == 'custom') {\n                this.value = comparer(valueToCompare, this.from_value, toValue);\n            } else if (this.dataType == 'list') {\n                var data = this._getListData();\n                this.value = comparer(valueToCompare, data, toValue);\n            } else {\n                this.value = comparer(valueToCompare, this.from_value, toValue);\n            }\n            return this.value;\n        };\n        return new kendo.spreadsheet.validation.Validation($.extend(validation, {\n            handler: validationHandler,\n            sheet: sheet,\n            row: row,\n            col: col\n        }));\n    }\n    var Validation = Class.extend({\n        init: function Validation(options) {\n            this.handler = options.handler;\n            this.from = options.from;\n            this.to = options.to;\n            this.dataType = options.dataType;\n            this.comparerType = options.comparerType;\n            this.type = options.type ? options.type : 'warning';\n            this.allowNulls = options.allowNulls ? true : false;\n            this.fromIsDateValue = options.fromIsDateValue ? true : false;\n            this.toIsDateValue = options.toIsDateValue ? true : false;\n            this.showButton = options.showButton;\n            this.fromIsListValue = options.fromIsListValue ? true : false;\n            this.sheet = options.sheet;\n            this.row = options.row;\n            this.col = options.col;\n            if (options.tooltipMessageTemplate) {\n                this.tooltipMessageTemplate = options.tooltipMessageTemplate;\n            }\n            if (options.tooltipTitleTemplate) {\n                this.tooltipTitleTemplate = options.tooltipTitleTemplate;\n            }\n            if (options.messageTemplate) {\n                this.messageTemplate = options.messageTemplate;\n            }\n            if (options.titleTemplate) {\n                this.titleTemplate = options.titleTemplate;\n            }\n        },\n        _formatMessages: function (format) {\n            var from = this.from ? this.from_value : '';\n            var to = this.to ? this.to_value : '';\n            var fromFormula = this.from ? this.from.toString() : '';\n            var toFormula = this.to ? this.to.toString() : '';\n            var dataType = this.dataType;\n            var type = this.type;\n            var comparerType = this.comparerType;\n            return kendo.format(format, from, to, fromFormula, toFormula, dataType, type, comparerType);\n        },\n        _setMessages: function () {\n            this.title = '';\n            this.message = '';\n            if (this.tooltipTitleTemplate) {\n                this.tooltipTitle = this._formatMessages(this.tooltipTitleTemplate);\n            }\n            if (this.tooltipMessageTemplate) {\n                this.tooltipMessage = this._formatMessages(this.tooltipMessageTemplate);\n            }\n            if (this.titleTemplate) {\n                this.title = this._formatMessages(this.titleTemplate);\n            }\n            if (this.messageTemplate) {\n                this.message = this._formatMessages(this.messageTemplate);\n            }\n        },\n        _getListData: function () {\n            if (!this.from_value || !this.from_value.data) {\n                return [];\n            }\n            var cube = this.from_value.data;\n            var i;\n            var y;\n            var data = [];\n            for (i = 0; i < cube.length; i++) {\n                var array = cube[i];\n                if (array) {\n                    for (y = 0; y < array.length; y++) {\n                        data.push(array[y]);\n                    }\n                }\n            }\n            return data;\n        },\n        clone: function (sheet, row, col) {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.clone(sheet, row, col);\n            }\n            if (options.to) {\n                options.to = options.to.clone(sheet, row, col);\n            }\n            return new Validation($.extend(options, { handler: this.handler }, {\n                sheet: sheet,\n                row: row,\n                col: col\n            }));\n        },\n        exec: function (ss, compareValue, compareFormat, callback) {\n            var self = this;\n            function getValue(val) {\n                if (val instanceof kendo.spreadsheet.Ref) {\n                    val = ss.getData(val);\n                    if (Array.isArray(val)) {\n                        val = val[0];\n                    }\n                }\n                return val;\n            }\n            var calculateFromCallBack = function (val) {\n                self.from_value = getValue(val);\n                self.value = self.handler.call(self, compareValue, compareFormat);\n                self._setMessages();\n                if (callback) {\n                    callback(self.value);\n                }\n            };\n            if (self.to) {\n                self.to.exec(ss, function (val) {\n                    self.to_value = getValue(val);\n                    self.from.exec(ss, calculateFromCallBack);\n                });\n            } else {\n                self.from.exec(ss, calculateFromCallBack);\n            }\n        },\n        reset: function () {\n            if (this.from) {\n                this.from.reset();\n            }\n            if (this.to) {\n                this.to.reset();\n            }\n            delete this.value;\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            if (this.from) {\n                this.from.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.to) {\n                this.to.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.sheet.toLowerCase() == affectedSheet.toLowerCase()) {\n                var formulaRow = this.row;\n                var formulaCol = this.col;\n                switch (operation) {\n                case 'row':\n                    if (formulaRow >= start) {\n                        this.row += delta;\n                    }\n                    break;\n                case 'col':\n                    if (formulaCol >= start) {\n                        this.col += delta;\n                    }\n                    break;\n                }\n            }\n        },\n        toJSON: function () {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.toString();\n                if (options.dataType === 'list') {\n                    options.from = options.from.replace(/^_matrix\\((.*)\\)$/i, '$1');\n                    delete options.fromIsListValue;\n                }\n                if (options.dataType === 'date') {\n                    if (this.fromIsDateValue) {\n                        options.from = options.from.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                        delete options.fromIsDateValue;\n                    }\n                }\n            }\n            if (options.to) {\n                options.to = options.to.toString();\n                if (options.dataType === 'date') {\n                    if (this.toIsDateValue) {\n                        options.to = options.to.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                        delete options.toIsDateValue;\n                    }\n                }\n            }\n            return options;\n        },\n        _getOptions: function () {\n            return {\n                from: this.from,\n                to: this.to,\n                dataType: this.dataType,\n                type: this.type,\n                comparerType: this.comparerType,\n                row: this.row,\n                col: this.col,\n                sheet: this.sheet,\n                allowNulls: this.allowNulls,\n                fromIsListValue: this.fromIsListValue,\n                fromIsDateValue: this.fromIsDateValue,\n                toIsDateValue: this.toIsDateValue,\n                tooltipMessageTemplate: this.tooltipMessageTemplate,\n                tooltipTitleTemplate: this.tooltipTitleTemplate,\n                messageTemplate: this.messageTemplate,\n                titleTemplate: this.titleTemplate,\n                showButton: this.showButton\n            };\n        }\n    });\n    exports.compile = compileValidation;\n    exports.validationComparers = {\n        greaterThan: function (valueToCompare, from) {\n            return valueToCompare > from;\n        },\n        lessThan: function (valueToCompare, from) {\n            return valueToCompare < from;\n        },\n        between: function (valueToCompare, from, to) {\n            return valueToCompare >= from && valueToCompare <= to;\n        },\n        equalTo: function (valueToCompare, from) {\n            return valueToCompare == from;\n        },\n        notEqualTo: function (valueToCompare, from) {\n            return valueToCompare != from;\n        },\n        greaterThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare >= from;\n        },\n        lessThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare <= from;\n        },\n        notBetween: function (valueToCompare, from, to) {\n            return valueToCompare < from || valueToCompare > to;\n        },\n        custom: function (valueToCompare, from) {\n            return from;\n        },\n        list: function (valueToCompare, data) {\n            return data.indexOf(valueToCompare) > -1;\n        }\n    };\n    exports.Validation = Validation;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheet', [\n        'kendo.core',\n        'kendo.color',\n        'spreadsheet/runtime',\n        'spreadsheet/validation',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Range = kendo.spreadsheet.Range;\n        var Selection = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.selection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalSelection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this._activeCell = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalActiveCell = kendo.spreadsheet.FIRSTREF;\n            },\n            currentSelectionRange: function () {\n                return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentOriginalNavigationRange: function () {\n                return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentNavigationRange: function () {\n                if (this.singleCellSelection()) {\n                    return this._sheet._sheetRef;\n                } else {\n                    return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n                }\n            },\n            nextNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.nextRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            previousNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.previousRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            activeCell: function (ref) {\n                if (ref) {\n                    this.originalActiveCell = ref.first();\n                    this._activeCell = this._sheet.unionWithMerged(ref.toRangeRef());\n                    this._sheet.focus(ref);\n                    this._sheet.triggerChange({\n                        activeCell: true,\n                        selection: true\n                    });\n                }\n                return this._activeCell;\n            },\n            select: function (ref, expanded, changeActiveCell) {\n                if (ref) {\n                    if (ref.eq(this.originalSelection)) {\n                        return;\n                    }\n                    this.originalSelection = ref;\n                    this.selection = expanded;\n                    if (changeActiveCell !== false) {\n                        if (ref.isCell()) {\n                            this.activeCell(ref);\n                        } else {\n                            this.activeCell(this.selection.lastRange().first());\n                        }\n                        this.selectionRangeIndex = this.selection.size() - 1;\n                    } else {\n                        this._sheet.triggerChange({ selection: true });\n                    }\n                }\n                return this.selection;\n            },\n            singleCellSelection: function () {\n                return this._activeCell.eq(this.selection);\n            }\n        });\n        var Sheet = kendo.Observable.extend({\n            init: function () {\n                kendo.Observable.prototype.init.call(this);\n                this._reinit.apply(this, arguments);\n            },\n            _reinit: function (rowCount, columnCount, rowHeight, columnWidth, headerHeight, headerWidth) {\n                var cellCount = rowCount * columnCount - 1;\n                this._rows = new kendo.spreadsheet.Axis(rowCount, rowHeight);\n                this._columns = new kendo.spreadsheet.Axis(columnCount, columnWidth);\n                this._mergedCells = [];\n                this._frozenRows = 0;\n                this._frozenColumns = 0;\n                this._suspendChanges = false;\n                this._filter = null;\n                this._showGridLines = true;\n                this._gridLinesColor = null;\n                this._grid = new kendo.spreadsheet.Grid(this._rows, this._columns, rowCount, columnCount, headerHeight, headerWidth);\n                this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n                this._properties = new kendo.spreadsheet.PropertyBag(cellCount);\n                this._sorter = new kendo.spreadsheet.Sorter(this._grid, this._properties.sortable());\n                this._viewSelection = new Selection(this);\n                this._editSelection = new Selection(this);\n                this._formulaSelections = [];\n            },\n            _selectionState: function () {\n                return this._inEdit ? this._editSelection : this._viewSelection;\n            },\n            navigator: function () {\n                if (!this._navigator) {\n                    this._navigator = new kendo.spreadsheet.SheetNavigator(this);\n                }\n                return this._navigator;\n            },\n            axisManager: function () {\n                if (!this._axisManager) {\n                    this._axisManager = new kendo.spreadsheet.AxisManager(this);\n                }\n                return this._axisManager;\n            },\n            _name: function (value) {\n                if (!value) {\n                    return this._sheetName;\n                }\n                this._sheetName = value;\n                return this;\n            },\n            name: function () {\n                return this._name();\n            },\n            _property: function (accessor, value, reason) {\n                if (value === undefined) {\n                    return accessor();\n                } else {\n                    accessor(value);\n                    return this.triggerChange(reason);\n                }\n            },\n            _field: function (name, value, reason) {\n                if (value === undefined) {\n                    return this[name];\n                } else {\n                    this[name] = value;\n                    return this.triggerChange(reason);\n                }\n            },\n            suspendChanges: function (value) {\n                if (value === undefined) {\n                    return this._suspendChanges;\n                }\n                this._suspendChanges = value;\n                return this;\n            },\n            triggerChange: function (reason) {\n                if (!this._suspendChanges) {\n                    this.trigger('change', reason);\n                }\n                return this;\n            },\n            setDataSource: function (dataSource, columns) {\n                if (this.dataSourceBinder) {\n                    this.dataSourceBinder.destroy();\n                }\n                this.dataSourceBinder = new kendo.spreadsheet.SheetDataSourceBinder({\n                    dataSource: dataSource,\n                    sheet: this,\n                    columns: columns\n                });\n                this.dataSource = this.dataSourceBinder.dataSource;\n            },\n            hideColumn: function (columnIndex) {\n                return this._property(this._columns.hide.bind(this._columns), columnIndex, { layout: true });\n            },\n            unhideColumn: function (columnIndex) {\n                return this._property(this._columns.unhide.bind(this._columns), columnIndex, { layout: true });\n            },\n            isHiddenColumn: function (columnIndex) {\n                return this._grid._columns.hidden(columnIndex);\n            },\n            _copyRange: function (sourceRangeRef, targetRef) {\n                var grid = this._grid;\n                var rowCount = grid.rowCount;\n                var nextRefTopLeft = grid.normalize(sourceRangeRef.topLeft);\n                var nextRefBottomRight = grid.normalize(sourceRangeRef.bottomRight);\n                var nextIndex = nextRefTopLeft.col * rowCount + nextRefTopLeft.row;\n                var nextBottomIndex = nextRefBottomRight.col * rowCount + nextRefBottomRight.row;\n                var targetIndex = targetRef.col * rowCount + targetRef.row;\n                this._properties.copy(nextIndex, nextBottomIndex, targetIndex);\n            },\n            _adjustReferences: function (operation, start, delta, mergedCells) {\n                this._mergedCells = mergedCells.reduce(function (a, ref) {\n                    ref = ref.adjust(null, null, null, null, operation == 'row', start, delta);\n                    if (ref instanceof RangeRef) {\n                        a.push(ref);\n                    }\n                    return a;\n                }, []);\n                if (this._workbook) {\n                    var affectedSheet = this._name();\n                    this._workbook._sheets.forEach(function (sheet) {\n                        sheet._forFormulas(function (formula) {\n                            formula.adjust(affectedSheet, operation, start, delta);\n                        });\n                        sheet._forValidations(function (validation) {\n                            validation.adjust(affectedSheet, operation, start, delta);\n                        });\n                    });\n                    this._workbook.adjustNames(affectedSheet, operation == 'row', start, delta);\n                }\n                var selection = this.select();\n                selection = selection.adjust(null, null, null, null, operation == 'row', start, delta);\n                if (selection !== kendo.spreadsheet.NULLREF) {\n                    this.select(selection);\n                }\n                var axis = operation == 'col' ? this._columns : this._rows;\n                axis.adjust(start, delta);\n            },\n            _forFormulas: function (callback) {\n                var props = this._properties;\n                var formulas = props.get('formula').values();\n                var n = formulas.length;\n                formulas.forEach(function (f, i) {\n                    callback.call(this, f.value, i, n);\n                }, this);\n            },\n            _forValidations: function (callback) {\n                var props = this._properties;\n                props.get('validation').values().forEach(function (v) {\n                    callback.call(this, v.value);\n                }, this);\n            },\n            canInsertRow: function (rowIndex, count) {\n                count = count || 1;\n                var grid = this._grid;\n                var range = this.range(grid.rowCount - count, 0, count, grid.columnCount);\n                return !range.hasValue();\n            },\n            insertRow: function (rowIndex) {\n                if (!this.canInsertRow(rowIndex)) {\n                    throw new Error('Shifting nonblank cells off the worksheet is not supported!');\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var rowCount = grid.rowCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col), new CellRef(rowCount - 2, bottomRight.col));\n                        this._copyRange(nextRef, new CellRef(topLeft.row + 1, topLeft.col));\n                        new Range(ref, this).clear();\n                    }\n                    this._adjustReferences('row', rowIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    insertRow: { index: rowIndex },\n                    ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n                });\n                this.trigger('insertRow', { index: rowIndex });\n                return this;\n            },\n            isEnabledRow: function (rowIndex) {\n                var ref = new RangeRef(new CellRef(rowIndex, 0), new CellRef(rowIndex, this._grid.columnCount));\n                return new Range(ref, this).enable();\n            },\n            deleteRow: function (rowIndex) {\n                if (!this.isEnabledRow(rowIndex)) {\n                    return this;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        new Range(ref, this).clear();\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row + 1, topLeft.col), new CellRef(Infinity, bottomRight.col));\n                        this._copyRange(nextRef, topLeft);\n                        var nextRefBottomRight = grid.normalize(nextRef.bottomRight);\n                        new Range(new RangeRef(nextRefBottomRight, nextRefBottomRight), this).clear();\n                    }\n                    this._adjustReferences('row', rowIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    deleteRow: { index: rowIndex },\n                    ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n                });\n                this.trigger('deleteRow', { index: rowIndex });\n                return this;\n            },\n            insertColumn: function (columnIndex) {\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnCount; ci >= columnIndex; ci--) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear();\n                        if (ci == columnIndex) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col - 1), new CellRef(bottomRight.row, bottomRight.col - 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    insertColumn: { index: columnIndex },\n                    ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n                });\n                return this;\n            },\n            isEnabledColumn: function (columnIndex) {\n                var ref = new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, columnIndex));\n                return new Range(ref, this).enable();\n            },\n            deleteColumn: function (columnIndex) {\n                if (!this.isEnabledColumn(columnIndex)) {\n                    return this;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnIndex; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear();\n                        if (ci == columnCount - 1) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col + 1), new CellRef(bottomRight.row, bottomRight.col + 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    deleteColumn: { index: columnIndex },\n                    ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n                });\n                return this;\n            },\n            hideRow: function (rowIndex) {\n                return this._property(this._rows.hide.bind(this._rows), rowIndex, { layout: true });\n            },\n            unhideRow: function (rowIndex) {\n                return this._property(this._rows.unhide.bind(this._rows), rowIndex, { layout: true });\n            },\n            isHiddenRow: function (rowIndex) {\n                return this._grid._rows.hidden(rowIndex);\n            },\n            columnWidth: function (columnIndex, width) {\n                return this._property(this._columns.value.bind(this._columns, columnIndex, columnIndex), width, { layout: true });\n            },\n            rowHeight: function (rowIndex, height) {\n                return this._property(this._rows.value.bind(this._rows, rowIndex, rowIndex), height, { layout: true });\n            },\n            frozenRows: function (value) {\n                return this._field('_frozenRows', value, { layout: true });\n            },\n            frozenColumns: function (value) {\n                return this._field('_frozenColumns', value, { layout: true });\n            },\n            showGridLines: function (value) {\n                return this._field('_showGridLines', value, { layout: true });\n            },\n            gridLinesColor: function (value) {\n                return this._field('_gridLinesColor', value, { layout: true });\n            },\n            _ref: function (row, column, numRows, numColumns) {\n                var ref = null;\n                if (row instanceof kendo.spreadsheet.Ref) {\n                    return row;\n                }\n                if (row instanceof kendo.spreadsheet.Range) {\n                    return row._ref.toRangeRef();\n                }\n                if (typeof row === 'string') {\n                    ref = kendo.spreadsheet.calc.parseReference(row);\n                } else {\n                    if (!numRows) {\n                        numRows = 1;\n                    }\n                    if (!numColumns) {\n                        numColumns = 1;\n                    }\n                    ref = new RangeRef(new CellRef(row, column), new CellRef(row + numRows - 1, column + numColumns - 1));\n                }\n                return ref;\n            },\n            range: function (row, column, numRows, numColumns) {\n                return new Range(this._ref(row, column, numRows, numColumns), this);\n            },\n            forEachMergedCell: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                this._mergedCells.forEach(function (merged) {\n                    if (selectAll || merged.intersects(ref)) {\n                        callback(merged);\n                    }\n                });\n            },\n            forEachFilterHeader: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                if (this._filter) {\n                    var refs = [];\n                    this._filter.ref.forEachColumn(function (columnRef) {\n                        if (selectAll || columnRef.intersects(ref)) {\n                            refs.push(columnRef.topLeft);\n                        }\n                    });\n                    this._mergedCells.forEach(function (merged) {\n                        refs = refs.map(function (ref) {\n                            if (merged.intersects(ref)) {\n                                return merged;\n                            }\n                            return ref;\n                        });\n                    });\n                    refs.reduce(function unique(result, element) {\n                        if (result.indexOf(element) < 0) {\n                            result.push(element);\n                        }\n                        return result;\n                    }, []).forEach(callback);\n                }\n            },\n            forEach: function (ref, callback) {\n                if (!(ref instanceof RangeRef)) {\n                    ref = this._ref(ref);\n                }\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var bottomRight = this._grid.normalize(ref.bottomRight);\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    var ri = topLeft.row;\n                    var startCellIndex = this._grid.index(ri, ci);\n                    var endCellIndex = this._grid.index(bottomRight.row, ci);\n                    this._properties.forEach(startCellIndex, endCellIndex, function (value) {\n                        callback(ri++, ci, value);\n                    });\n                }\n            },\n            startResizing: function (initialPosition) {\n                this._initialPosition = initialPosition;\n                this._resizeInProgress = true;\n            },\n            startAutoFill: function () {\n                this._autoFillInProgress = true;\n                var selection = this.select();\n                this._autoFillOrigin = selection;\n                this._autoFillDest = selection;\n                this.triggerChange({ selection: true });\n            },\n            updateAutoFill: function (dest, punch, hint, direction) {\n                this._autoFillDest = dest;\n                this._autoFillPunch = punch;\n                this._autoFillHint = hint;\n                this._autoFillDirection = direction;\n                this.triggerChange({ selection: true });\n            },\n            autoFillRef: function () {\n                return this._autoFillDest;\n            },\n            autoFillPunch: function () {\n                return this._autoFillPunch;\n            },\n            autoFillInProgress: function () {\n                return this._autoFillInProgress;\n            },\n            resizingInProgress: function () {\n                return this._resizeInProgress;\n            },\n            completeResizing: function () {\n                if (this._resizeInProgress) {\n                    this._resizeInProgress = false;\n                    var hintPosition = this.resizeHintPosition();\n                    if (this._initialPosition && hintPosition) {\n                        var handlePosition = this.resizeHandlePosition();\n                        if (handlePosition.col !== -Infinity) {\n                            this.trigger('commandRequest', {\n                                command: 'ColumnWidthCommand',\n                                options: {\n                                    target: handlePosition.col,\n                                    value: this.columnWidth(handlePosition.col) - (this._initialPosition.x - hintPosition.x)\n                                }\n                            });\n                        } else {\n                            this.trigger('commandRequest', {\n                                command: 'RowHeightCommand',\n                                options: {\n                                    target: handlePosition.row,\n                                    value: this.rowHeight(handlePosition.row) - (this._initialPosition.y - hintPosition.y)\n                                }\n                            });\n                        }\n                    } else {\n                        this.trigger('change', { resize: true });\n                    }\n                }\n            },\n            resizeHandlePosition: function () {\n                return this._resizeHandlePosition;\n            },\n            resizeHintPosition: function (location) {\n                if (location !== undefined) {\n                    this._resizeHintPosition = location;\n                    this.trigger('change', { resize: true });\n                }\n                return this._resizeHintPosition;\n            },\n            removeResizeHandle: function () {\n                if (this._resizeHandlePosition) {\n                    this._resizeHintPosition = undefined;\n                    this._resizeHandlePosition = undefined;\n                    this._initialPosition = undefined;\n                    this.trigger('change', { resize: true });\n                }\n            },\n            positionResizeHandle: function (ref) {\n                this._resizeHandlePosition = ref;\n                this.trigger('change', { resize: true });\n            },\n            startSelection: function () {\n                this._selectionInProgress = true;\n            },\n            completeSelection: function () {\n                if (this._selectionInProgress) {\n                    this._selectionInProgress = false;\n                    this._resizeHintPosition = undefined;\n                    this.trigger('change', { selection: true });\n                }\n                if (this._autoFillInProgress) {\n                    this._autoFillInProgress = false;\n                    var dest = this._autoFillDest;\n                    var origin = this._autoFillOrigin;\n                    if (this._autoFillPunch) {\n                        this.trigger('commandRequest', {\n                            command: 'ClearContentCommand',\n                            options: { operatingRange: this.range(this._autoFillPunch) }\n                        });\n                    } else {\n                        if (!dest.eq(origin)) {\n                            this.trigger('commandRequest', {\n                                command: 'AutoFillCommand',\n                                options: {\n                                    operatingRange: this.range(dest),\n                                    origin: this.range(origin)\n                                }\n                            });\n                        } else {\n                            this.triggerChange({ selection: true });\n                        }\n                    }\n                    this._autoFillDest = null;\n                    this._autoFillPunch = null;\n                    this._autoFillOrigin = null;\n                    this.select(dest);\n                }\n            },\n            selectionInProgress: function () {\n                return this._selectionInProgress;\n            },\n            select: function (ref, changeActiveCell) {\n                var selectionState = this._selectionState();\n                var expandedRef;\n                if (ref) {\n                    ref = this._ref(ref);\n                    ref = this._grid.normalize(ref);\n                    expandedRef = this._grid.isAxis(ref) ? ref : this.unionWithMerged(ref);\n                }\n                return selectionState.select(ref, expandedRef, changeActiveCell);\n            },\n            originalSelect: function () {\n                return this._selectionState().originalSelection;\n            },\n            currentSelectionRange: function () {\n                return this._selectionState().currentSelectionRange();\n            },\n            currentOriginalSelectionRange: function () {\n                return this._selectionState().currentOriginalNavigationRange();\n            },\n            currentNavigationRange: function () {\n                return this._selectionState().currentNavigationRange();\n            },\n            nextNavigationRange: function () {\n                return this._selectionState().nextNavigationRange();\n            },\n            previousNavigationRange: function () {\n                return this._selectionState().previousNavigationRange();\n            },\n            selectionRangeIndex: function () {\n                return this._selectionState().selectionRangeIndex;\n            },\n            activeCell: function (ref) {\n                return this._selectionState().activeCell(ref);\n            },\n            originalActiveCell: function () {\n                return this._selectionState().originalActiveCell;\n            },\n            singleCellSelection: function () {\n                return this._selectionState().singleCellSelection();\n            },\n            unionWithMerged: function (ref) {\n                var mergedCells = this._mergedCells;\n                return ref.map(function (ref) {\n                    return ref.toRangeRef().union(mergedCells);\n                });\n            },\n            trim: function (ref) {\n                var trims = [];\n                var grid = this._grid;\n                this._properties.forEachProperty(function (property) {\n                    trims.push(grid.trim(ref, property.list));\n                });\n                return this.unionWithMerged(ref.topLeft.toRangeRef().union(trims));\n            },\n            focus: function (ref) {\n                if (ref) {\n                    this._focus = ref.toRangeRef();\n                } else {\n                    var focus = this._focus;\n                    this._focus = null;\n                    return focus;\n                }\n            },\n            activeCellSelection: function () {\n                return new Range(this._grid.normalize(this.activeCell()), this);\n            },\n            selection: function () {\n                return new Range(this._grid.normalize(this._selectionState().selection), this);\n            },\n            selectedHeaders: function () {\n                var selection = this.select();\n                var rows = {};\n                var cols = {};\n                var allCols = false;\n                var allRows = false;\n                var maxRow = this._grid.rowCount - 1;\n                var maxCol = this._grid.columnCount - 1;\n                selection.forEach(function (ref) {\n                    var i;\n                    var rowState = 'partial';\n                    var colState = 'partial';\n                    ref = ref.toRangeRef();\n                    var bottomRight = ref.bottomRight;\n                    var topLeft = ref.topLeft;\n                    var rowSelection = topLeft.col <= 0 && bottomRight.col >= maxCol;\n                    var colSelection = topLeft.row <= 0 && bottomRight.row >= maxRow;\n                    if (colSelection) {\n                        allRows = true;\n                        colState = 'full';\n                    }\n                    if (rowSelection) {\n                        allCols = true;\n                        rowState = 'full';\n                    }\n                    if (!colSelection) {\n                        for (i = topLeft.row; i <= bottomRight.row; i++) {\n                            if (rows[i] !== 'full') {\n                                rows[i] = rowState;\n                            }\n                        }\n                    }\n                    if (!rowSelection) {\n                        for (i = topLeft.col; i <= bottomRight.col; i++) {\n                            if (cols[i] !== 'full') {\n                                cols[i] = colState;\n                            }\n                        }\n                    }\n                });\n                return {\n                    rows: rows,\n                    cols: cols,\n                    allRows: allRows,\n                    allCols: allCols,\n                    all: allRows && allCols\n                };\n            },\n            isInEditMode: function (isInEdit) {\n                if (isInEdit === undefined) {\n                    return this._inEdit;\n                }\n                this._inEdit = isInEdit;\n                if (isInEdit) {\n                    this._editSelection.selection = this._viewSelection.selection.clone();\n                    this._editSelection.originalSelection = this._viewSelection.originalSelection.clone();\n                    this._editSelection._activeCell = this._viewSelection._activeCell.clone();\n                    this._editSelection.originalActiveCell = this._viewSelection.originalActiveCell.clone();\n                }\n            },\n            _setFormulaSelections: function (selection) {\n                this._formulaSelections = (selection || []).slice();\n                this.triggerChange({ selection: true });\n            },\n            _viewActiveCell: function () {\n                return this._viewSelection._activeCell.toRangeRef();\n            },\n            toJSON: function () {\n                var positions = {};\n                var rows = this._rows.toJSON('height', positions);\n                var columns = this._columns.toJSON('width', {});\n                var viewSelection = this._viewSelection;\n                var hyperlinks = [];\n                this.forEach(kendo.spreadsheet.SHEETREF, function (row, col, cell) {\n                    if (Object.keys(cell).length === 0) {\n                        return;\n                    }\n                    if (cell.link) {\n                        hyperlinks.push({\n                            ref: kendo.spreadsheet.Ref.display(null, row, col),\n                            target: cell.link\n                        });\n                    }\n                    var position = positions[row];\n                    if (position === undefined) {\n                        position = rows.length;\n                        rows.push({ index: row });\n                        positions[row] = position;\n                    }\n                    row = rows[position];\n                    cell.index = col;\n                    if (row.cells === undefined) {\n                        row.cells = [];\n                    }\n                    if (cell.formula) {\n                        cell.formula = cell.formula.toString();\n                    }\n                    if (cell.validation) {\n                        cell.validation = cell.validation.toJSON();\n                    }\n                    if (cell.color) {\n                        cell.color = kendo.parseColor(cell.color).toCss();\n                    }\n                    if (cell.background) {\n                        cell.background = kendo.parseColor(cell.background).toCss();\n                    }\n                    if (cell.borderTop && cell.borderTop.color) {\n                        cell.borderTop.color = kendo.parseColor(cell.borderTop.color).toCss();\n                    }\n                    if (cell.borderBottom && cell.borderBottom.color) {\n                        cell.borderBottom.color = kendo.parseColor(cell.borderBottom.color).toCss();\n                    }\n                    if (cell.borderRight && cell.borderRight.color) {\n                        cell.borderRight.color = kendo.parseColor(cell.borderRight.color).toCss();\n                    }\n                    if (cell.borderLeft && cell.borderLeft.color) {\n                        cell.borderLeft.color = kendo.parseColor(cell.borderLeft.color).toCss();\n                    }\n                    row.cells.push(cell);\n                });\n                var json = {\n                    name: this._name(),\n                    rows: rows,\n                    columns: columns,\n                    selection: viewSelection.selection.toString(),\n                    activeCell: viewSelection.activeCell().toString(),\n                    frozenRows: this.frozenRows(),\n                    frozenColumns: this.frozenColumns(),\n                    showGridLines: this.showGridLines(),\n                    gridLinesColor: this.gridLinesColor(),\n                    mergedCells: this._mergedCells.map(function (ref) {\n                        return ref.toString();\n                    }),\n                    hyperlinks: hyperlinks\n                };\n                if (this._sort) {\n                    json.sort = {\n                        ref: this._sort.ref.toString(),\n                        columns: this._sort.columns.map(function (column) {\n                            return {\n                                index: column.index,\n                                ascending: column.ascending\n                            };\n                        })\n                    };\n                }\n                if (this._filter) {\n                    json.filter = {\n                        ref: this._filter.ref.toString(),\n                        columns: this._filter.columns.map(function (column) {\n                            var filter = column.filter.toJSON();\n                            filter.index = column.index;\n                            return filter;\n                        })\n                    };\n                }\n                return json;\n            },\n            fromJSON: function (json) {\n                this.batch(function () {\n                    if (json.name !== undefined) {\n                        this._name(json.name);\n                    }\n                    if (json.frozenColumns !== undefined) {\n                        this.frozenColumns(json.frozenColumns);\n                    }\n                    if (json.frozenRows !== undefined) {\n                        this.frozenRows(json.frozenRows);\n                    }\n                    if (json.columns !== undefined) {\n                        this._columns.fromJSON('width', json.columns);\n                    }\n                    if (json.rows !== undefined) {\n                        this._rows.fromJSON('height', json.rows);\n                        for (var ri = 0; ri < json.rows.length; ri++) {\n                            var row = json.rows[ri];\n                            var rowIndex = row.index;\n                            if (rowIndex === undefined) {\n                                rowIndex = ri;\n                            }\n                            if (row.cells) {\n                                for (var ci = 0; ci < row.cells.length; ci++) {\n                                    var cell = row.cells[ci];\n                                    var columnIndex = cell.index;\n                                    if (columnIndex === undefined) {\n                                        columnIndex = ci;\n                                    }\n                                    if (cell.formula) {\n                                        cell.formula = this._compileFormula(rowIndex, columnIndex, cell.formula);\n                                    }\n                                    if (cell.validation) {\n                                        cell.validation = this._compileValidation(rowIndex, columnIndex, cell.validation);\n                                    }\n                                    this._properties.fromJSON(this._grid.index(rowIndex, columnIndex), cell);\n                                }\n                            }\n                        }\n                    }\n                    if (json.selection) {\n                        this._viewSelection.selection = this._viewSelection.originalSelection = this._ref(json.selection);\n                    }\n                    if (json.activeCell) {\n                        var activeCellRef = this._ref(json.activeCell);\n                        this._viewSelection._activeCell = activeCellRef.toRangeRef();\n                        this._viewSelection.originalActiveCell = activeCellRef;\n                    }\n                    if (json.mergedCells) {\n                        json.mergedCells.forEach(function (ref) {\n                            this.range(ref).merge();\n                        }, this);\n                    }\n                    if (json.sort) {\n                        this._sort = {\n                            ref: this._ref(json.sort.ref),\n                            columns: json.sort.columns.slice(0)\n                        };\n                    }\n                    if (json.filter) {\n                        var ref = json.filter.ref;\n                        var columns = json.filter.columns === undefined ? [] : json.filter.columns;\n                        if (!ref) {\n                            kendo.logToConsole('Dropping filter for sheet \\'' + json.name + '\\' due to missing ref');\n                        } else {\n                            this._filter = {\n                                ref: this._ref(ref),\n                                columns: columns.map(function (column) {\n                                    return {\n                                        index: column.index,\n                                        filter: kendo.spreadsheet.Filter.create(column)\n                                    };\n                                })\n                            };\n                            this._refreshFilter();\n                        }\n                    }\n                    if (json.showGridLines !== undefined) {\n                        this._showGridLines = json.showGridLines;\n                    }\n                    this._gridLinesColor = json.gridLinesColor;\n                });\n                this._rows._refresh();\n                this._columns._refresh();\n            },\n            formula: function (ref) {\n                return this._properties.get('formula', this._grid.cellRefIndex(ref));\n            },\n            validation: function (ref) {\n                return this._properties.get('validation', this._grid.cellRefIndex(ref));\n            },\n            resetFormulas: function () {\n                this._forFormulas(function (formula) {\n                    formula.reset();\n                });\n            },\n            resetValidations: function () {\n                this._forValidations(function (validation) {\n                    validation.reset();\n                });\n            },\n            recalc: function (context, callback) {\n                var formulas = this._properties.get('formula').values();\n                var count = formulas.length, pending = 0, i = 0;\n                if (!count && callback) {\n                    return callback();\n                }\n                function next() {\n                    pending--;\n                    if (i == count && !pending) {\n                        callback();\n                    }\n                }\n                while (i < count) {\n                    pending++;\n                    formulas[i++].value.exec(context, callback ? next : null);\n                }\n            },\n            revalidate: function (context) {\n                var self = this;\n                this._forValidations(function (validation) {\n                    var cellRef = new CellRef(validation.row, validation.col);\n                    var ref = new RangeRef(cellRef, cellRef);\n                    validation.exec(context, self._get(ref, 'value'), self._get(ref, 'format'));\n                });\n            },\n            _value: function (row, col, value) {\n                var index = this._grid.index(row, col);\n                if (value !== undefined) {\n                    this._properties.set('value', index, index, value);\n                } else {\n                    return this._properties.get('value', index);\n                }\n            },\n            _validation: function (row, col) {\n                var index = this._grid.index(row, col);\n                return this._properties.get('validation', index);\n            },\n            _compileValidation: function (row, col, validation) {\n                if (validation instanceof kendo.spreadsheet.validation.Validation) {\n                    return validation.clone(this._name(), row, col);\n                }\n                if (validation.from != null) {\n                    validation.from = (validation.from + '').replace(/^=/, '');\n                }\n                if (validation.to != null) {\n                    validation.to = (validation.to + '').replace(/^=/, '');\n                }\n                return kendo.spreadsheet.validation.compile(this._name(), row, col, validation);\n            },\n            _compileFormula: function (row, col, f) {\n                f = f.replace(/^=/, '');\n                f = kendo.spreadsheet.calc.parseFormula(this._name(), row, col, f);\n                return kendo.spreadsheet.calc.compile(f);\n            },\n            _copyValuesInRange: function (topLeft, bottomRight, value, property) {\n                var ci, start, end;\n                for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    start = this._grid.index(topLeft.row, ci);\n                    end = this._grid.index(bottomRight.row, ci);\n                    for (var index = start, row = topLeft.row; index <= end; ++index, ++row) {\n                        value = value.clone(this._name(), row, ci);\n                        this._properties.set(property, index, index, value);\n                    }\n                }\n                return value;\n            },\n            _set: function (ref, name, value) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var bottomRight = this._grid.normalize(ref.bottomRight);\n                var ci, start, end;\n                if (value && name == 'formula') {\n                    if (typeof value == 'string') {\n                        value = this._compileFormula(topLeft.row, topLeft.col, value);\n                    }\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'formula');\n                } else if (value && name == 'validation') {\n                    value = this._compileValidation(topLeft.row, topLeft.col, value);\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'validation');\n                } else {\n                    for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                        start = this._grid.index(topLeft.row, ci);\n                        end = this._grid.index(bottomRight.row, ci);\n                        this._properties.set(name, start, end, value);\n                        if (name == 'formula') {\n                            this._properties.set('value', start, end, null);\n                        }\n                    }\n                }\n            },\n            _get: function (ref, name) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var index = this._grid.index(topLeft.row, topLeft.col);\n                return this._properties.get(name, index);\n            },\n            batch: function (callback, reason) {\n                var suspended = this.suspendChanges();\n                this.suspendChanges(true);\n                callback.call(this);\n                return this.suspendChanges(suspended).triggerChange(reason || { recalc: true });\n            },\n            _sortBy: function (ref, columns) {\n                var indices = null;\n                columns.forEach(function (column) {\n                    indices = this._sorter.sortBy(ref, column.index, this._properties.get('value'), column.ascending, indices);\n                }, this);\n                this._sort = {\n                    ref: ref,\n                    columns: columns\n                };\n                this._refreshFilter();\n                this.triggerChange({ recalc: true });\n            },\n            _refreshFilter: function () {\n                if (this._filter) {\n                    this._filterBy(this._filter.ref, this._filter.columns);\n                }\n            },\n            _filterBy: function (ref, columns) {\n                this.batch(function () {\n                    for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                        if (this._rows.hidden(ri)) {\n                            this._rows.unhide(ri);\n                        }\n                    }\n                    columns.forEach(function (column) {\n                        var columnRef = ref.resize({ top: 1 }).toColumn(column.index);\n                        var cells = [];\n                        if (columnRef === kendo.spreadsheet.NULLREF) {\n                            return;\n                        }\n                        this.forEach(columnRef, function (row, col, cell) {\n                            cell.row = row;\n                            cells.push(cell);\n                        });\n                        column.filter.prepare(cells);\n                        for (var ci = 0; ci < cells.length; ci++) {\n                            var cell = cells[ci];\n                            var value = column.filter.value(cell);\n                            if (column.filter.matches(value) === false) {\n                                this.hideRow(cell.row);\n                            }\n                        }\n                    }, this);\n                    this._filter = {\n                        ref: ref,\n                        columns: columns\n                    };\n                }, {\n                    layout: true,\n                    filter: true\n                });\n            },\n            filterColumn: function (ref) {\n                var filterRef = this.filter().ref;\n                return ref.toRangeRef().topLeft.col - filterRef.topLeft.col;\n            },\n            filter: function () {\n                return this._filter;\n            },\n            clearFilter: function (spec) {\n                this._clearFilter(spec instanceof Array ? spec : [spec]);\n            },\n            _clearFilter: function (indices) {\n                if (this._filter) {\n                    this.batch(function () {\n                        this._filter.columns = this._filter.columns.filter(function (column) {\n                            return indices.indexOf(column.index) < 0;\n                        });\n                        this._refreshFilter();\n                    }, {\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            getAxisState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState()\n                };\n            },\n            setAxisState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this.triggerChange({ layout: true });\n            },\n            getState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState(),\n                    mergedCells: this._mergedCells.map(function (cell) {\n                        return cell.clone();\n                    }),\n                    properties: this._properties.getState()\n                };\n            },\n            setState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this._mergedCells = state.mergedCells;\n                this._properties.setState(state.properties);\n                this.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            _merge: function (ref) {\n                var mergedCells = this._mergedCells;\n                var sheet = this;\n                var mergedRef;\n                this.batch(function () {\n                    mergedRef = ref.map(function (ref) {\n                        if (ref instanceof kendo.spreadsheet.CellRef) {\n                            return ref;\n                        }\n                        var currentRef = ref.toRangeRef().union(mergedCells, function (ref) {\n                            mergedCells.splice(mergedCells.indexOf(ref), 1);\n                        });\n                        var range = new Range(currentRef, sheet);\n                        var formula = range._get('formula');\n                        var value = range.value();\n                        var format = range.format();\n                        var background = range.background();\n                        range.value(null);\n                        range.format(null);\n                        range.background(null);\n                        var topLeft = new Range(currentRef.collapse(), sheet);\n                        if (formula) {\n                            topLeft._set('formula', formula);\n                        } else {\n                            topLeft.value(value);\n                        }\n                        topLeft.format(format);\n                        topLeft.background(background);\n                        mergedCells.push(currentRef);\n                        return currentRef;\n                    });\n                    var viewSelection = sheet._viewSelection;\n                    viewSelection.selection = sheet.unionWithMerged(viewSelection.originalSelection);\n                    viewSelection._activeCell = sheet.unionWithMerged(viewSelection.originalActiveCell);\n                }, {\n                    activeCell: true,\n                    selection: true\n                });\n                return mergedRef;\n            }\n        });\n        kendo.spreadsheet.Sheet = Sheet;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetsbar', [\n        'kendo.core',\n        'kendo.sortable'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var outerWidth = kendo._outerWidth;\n        var DOT = '.';\n        var EMPTYCHAR = ' ';\n        var sheetsBarClassNames = {\n            sheetsBarWrapper: 'k-widget k-header',\n            sheetsBarSheetsWrapper: 'k-tabstrip k-floatwrap k-tabstrip-bottom',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            sheetsBarAdd: 'k-spreadsheet-sheets-bar-add',\n            sheetsBarRemove: 'k-spreadsheet-sheets-remove',\n            sheetsBarItems: 'k-spreadsheet-sheets-items',\n            sheetsBarEditor: 'k-spreadsheet-sheets-editor',\n            sheetsBarScrollable: 'k-tabstrip-scrollable',\n            sheetsBarNext: 'k-tabstrip-next',\n            sheetsBarPrev: 'k-tabstrip-prev',\n            sheetsBarKItem: 'k-item k-state-default',\n            sheetsBarKActive: 'k-state-active k-state-tab-on-top',\n            sheetsBarKTextbox: 'k-textbox',\n            sheetsBarKLink: 'k-link',\n            sheetsBarKIcon: 'k-icon',\n            sheetsBarKFontIcon: 'k-font-icon',\n            sheetsBarKButton: 'k-button k-button-icon',\n            sheetsBarKButtonBare: 'k-button-bare',\n            sheetsBarKArrowW: 'k-i-arrow-w',\n            sheetsBarKArrowE: 'k-i-arrow-e',\n            sheetsBarKReset: 'k-reset k-tabstrip-items',\n            sheetsBarKIconX: 'k-i-x',\n            sheetsBarKSprite: 'k-sprite',\n            sheetsBarKIconPlus: 'k-i-plus',\n            sheetsBarHintWrapper: 'k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint',\n            sheetsBarKResetItems: 'k-reset k-tabstrip-items'\n        };\n        var SheetsBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                var classNames = SheetsBar.classNames;\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(classNames.sheetsBarWrapper);\n                this._tree = new kendo.dom.Tree(element[0]);\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper([])\n                ]);\n                this._toggleScrollEvents(true);\n                this._createSortable();\n                this._sortable.bind('start', this._onSheetReorderStart.bind(this));\n                this._sortable.bind('end', this._onSheetReorderEnd.bind(this));\n                element.on('click', DOT + classNames.sheetsBarRemove, this._onSheetRemove.bind(this));\n                element.on('click', 'li', this._onSheetSelect.bind(this));\n                element.on('dblclick', 'li' + DOT + classNames.sheetsBarActive, this._createEditor.bind(this));\n                element.on('click', DOT + classNames.sheetsBarAdd, this._onAddSelect.bind(this));\n            },\n            options: {\n                name: 'SheetsBar',\n                scrollable: { distance: 200 }\n            },\n            events: [\n                'select',\n                'reorder',\n                'rename'\n            ],\n            _createEditor: function () {\n                if (this._editor) {\n                    return;\n                }\n                this._renderSheets(this._sheets, this._selectedIndex, true);\n                this._editor = this.element.find(kendo.format('input{0}{1}', DOT, SheetsBar.classNames.sheetsBarEditor)).focus().on('keydown', this._onEditorKeydown.bind(this)).on('blur', this._onEditorBlur.bind(this));\n            },\n            _destroyEditor: function (canceled) {\n                var newSheetName = canceled ? null : this._editor.val();\n                this._editor.off();\n                this._editor = null;\n                this._renderSheets(this._sheets, this._selectedIndex, false);\n                this._onSheetRename(newSheetName);\n            },\n            renderSheets: function (sheets, selectedIndex) {\n                if (!sheets || selectedIndex < 0) {\n                    return;\n                }\n                this._renderSheets(sheets, selectedIndex, false);\n            },\n            _renderSheets: function (sheets, selectedIndex, isInEditMode) {\n                var that = this;\n                var wrapperOffsetWidth;\n                var sheetsGroupScrollWidth;\n                var classNames = SheetsBar.classNames;\n                that._isRtl = kendo.support.isRtl(that.element);\n                that._sheets = sheets;\n                that._selectedIndex = selectedIndex;\n                that._renderHtml(isInEditMode, true);\n                if (!that._scrollableAllowed()) {\n                    return;\n                }\n                var sheetsWrapper = that._sheetsWrapper();\n                var scrollPrevButton = sheetsWrapper.children(DOT + classNames.sheetsBarPrev);\n                var scrollNextButton = sheetsWrapper.children(DOT + classNames.sheetsBarNext);\n                var gapWidth = 2;\n                var addButton = that.element.find(DOT + classNames.sheetsBarAdd);\n                var addButtonWidth = outerWidth(addButton) + addButton.position().left + gapWidth;\n                var scrollPrevButtonWidth = outerWidth(scrollPrevButton) + gapWidth;\n                var sheetsGroup = that._sheetsGroup();\n                scrollPrevButton.css({ left: addButtonWidth });\n                sheetsWrapper.addClass(classNames.sheetsBarScrollable + EMPTYCHAR + classNames.sheetsBarSheetsWrapper);\n                sheetsGroup.css({ marginLeft: addButtonWidth });\n                wrapperOffsetWidth = sheetsWrapper[0].offsetWidth;\n                sheetsGroupScrollWidth = sheetsGroup[0].scrollWidth;\n                if (sheetsGroupScrollWidth + addButtonWidth > wrapperOffsetWidth) {\n                    var scrollNextButtonRight = Math.ceil(kendo.parseFloat(scrollNextButton.css('right')));\n                    if (!that._scrollableModeActive) {\n                        that._nowScrollingSheets = false;\n                        that._scrollableModeActive = true;\n                    }\n                    sheetsGroup.css({\n                        marginLeft: scrollPrevButtonWidth + addButtonWidth,\n                        marginRight: outerWidth(scrollNextButton) + scrollNextButtonRight + gapWidth\n                    });\n                } else {\n                    if (that._scrollableModeActive && sheetsGroupScrollWidth <= wrapperOffsetWidth) {\n                        that._scrollableModeActive = false;\n                        sheetsGroup.css({\n                            marginLeft: addButtonWidth,\n                            marginRight: ''\n                        });\n                    } else {\n                        sheetsGroup.css({ marginLeft: addButtonWidth });\n                    }\n                }\n                that._toggleScrollButtons();\n            },\n            _toggleScrollButtons: function (toggle) {\n                var that = this;\n                var ul = that._sheetsGroup();\n                var wrapper = that._sheetsWrapper();\n                var scrollLeft = ul.scrollLeft();\n                var prev = wrapper.find(DOT + SheetsBar.classNames.sheetsBarPrev);\n                var next = wrapper.find(DOT + SheetsBar.classNames.sheetsBarNext);\n                if (toggle === false) {\n                    prev.toggle(false);\n                    next.toggle(false);\n                } else {\n                    prev.toggle(that._isRtl ? scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1 : scrollLeft !== 0);\n                    next.toggle(that._isRtl ? scrollLeft !== 0 : scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1);\n                }\n            },\n            _toggleScrollEvents: function (toggle) {\n                var that = this;\n                var classNames = SheetsBar.classNames;\n                var options = that.options;\n                var scrollPrevButton;\n                var scrollNextButton;\n                var sheetsWrapper = that._sheetsWrapper();\n                scrollPrevButton = sheetsWrapper.children(DOT + classNames.sheetsBarPrev);\n                scrollNextButton = sheetsWrapper.children(DOT + classNames.sheetsBarNext);\n                if (toggle) {\n                    scrollPrevButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? 1 : -1));\n                    });\n                    scrollNextButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? -1 : 1));\n                    });\n                    scrollPrevButton.add(scrollNextButton).on('mouseup', function () {\n                        that._nowScrollingSheets = false;\n                    });\n                } else {\n                    scrollPrevButton.off();\n                    scrollNextButton.off();\n                }\n            },\n            _renderHtml: function (isInEditMode, renderScrollButtons) {\n                var idx;\n                var sheetElements = [];\n                var dom = kendo.dom;\n                var element = dom.element;\n                var sheets = this._sheets;\n                var selectedIndex = this._selectedIndex;\n                var classNames = SheetsBar.classNames;\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var sheet = sheets[idx];\n                    var isSelectedSheet = idx === selectedIndex;\n                    var attr = { className: classNames.sheetsBarKItem + EMPTYCHAR };\n                    var elementContent = [];\n                    if (isSelectedSheet) {\n                        attr.className += classNames.sheetsBarKActive + EMPTYCHAR + classNames.sheetsBarActive;\n                    } else {\n                        attr.className += classNames.sheetsBarInactive;\n                    }\n                    if (isSelectedSheet && isInEditMode) {\n                        elementContent.push(element('input', {\n                            type: 'text',\n                            value: sheet.name(),\n                            className: classNames.sheetsBarKTextbox + EMPTYCHAR + classNames.sheetsBarEditor,\n                            maxlength: 50\n                        }, []));\n                    } else {\n                        elementContent.push(element('span', {\n                            className: classNames.sheetsBarKLink,\n                            title: sheet.name()\n                        }, [dom.text(sheet.name())]));\n                        var deleteIcon = element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconX }, []);\n                        elementContent.push(element('span', { className: classNames.sheetsBarKLink + EMPTYCHAR + classNames.sheetsBarRemove }, [deleteIcon]));\n                    }\n                    sheetElements.push(element('li', attr, elementContent));\n                }\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper(sheetElements, renderScrollButtons)\n                ]);\n            },\n            _createSheetsWrapper: function (sheetElements, renderScrollButtons) {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                var childrenElements = [element('ul', { className: classNames.sheetsBarKReset }, sheetElements)];\n                renderScrollButtons = true;\n                if (renderScrollButtons) {\n                    var baseButtonClass = classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonBare + EMPTYCHAR;\n                    childrenElements.push(element('span', { className: baseButtonClass + classNames.sheetsBarPrev }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowW }, [])]));\n                    childrenElements.push(element('span', { className: baseButtonClass + classNames.sheetsBarNext }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowE }, [])]));\n                }\n                return element('div', { className: classNames.sheetsBarItems }, childrenElements);\n            },\n            _createSortable: function () {\n                var classNames = SheetsBar.classNames;\n                this._sortable = new kendo.ui.Sortable(this.element, {\n                    filter: kendo.format('ul li.{0},ul li.{1}', classNames.sheetsBarActive, classNames.sheetsBarInactive),\n                    container: DOT + classNames.sheetsBarItems,\n                    axis: 'x',\n                    animation: false,\n                    ignore: 'input',\n                    end: function () {\n                        if (this.draggable.hint) {\n                            this.draggable.hint.remove();\n                        }\n                    },\n                    hint: function (element) {\n                        var hint = $(element).clone();\n                        return hint.wrap('<div class=\\'' + classNames.sheetsBarHintWrapper + '\\'><ul class=\\'' + classNames.sheetsBarKResetItems + '\\'></ul></div>').closest('div');\n                    }\n                });\n            },\n            _onEditorKeydown: function (e) {\n                if (this._editor) {\n                    if (e.which === 13) {\n                        this._destroyEditor();\n                    }\n                    if (e.which === 27) {\n                        this._destroyEditor(true);\n                    }\n                }\n            },\n            _onEditorBlur: function () {\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n            },\n            _onSheetReorderEnd: function (e) {\n                e.preventDefault();\n                this.trigger('reorder', {\n                    oldIndex: e.oldIndex,\n                    newIndex: e.newIndex\n                });\n            },\n            _onSheetReorderStart: function (e) {\n                if (this._editor) {\n                    e.preventDefault();\n                }\n            },\n            _onSheetRemove: function (e) {\n                var removedSheetName = $(e.target).closest('li').text();\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n                this.trigger('remove', { name: removedSheetName });\n            },\n            _onSheetSelect: function (e) {\n                var selectedSheetText = $(e.target).text();\n                if ($(e.target).is(DOT + SheetsBar.classNames.sheetsBarEditor) || !selectedSheetText) {\n                    e.preventDefault();\n                    return;\n                }\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n                this._scrollSheetsToItem($(e.target).closest('li'));\n                this.trigger('select', {\n                    name: selectedSheetText,\n                    isAddButton: false\n                });\n            },\n            _onSheetRename: function (newSheetName) {\n                this.trigger('rename', {\n                    name: newSheetName,\n                    sheetIndex: this._selectedIndex\n                });\n            },\n            _onAddSelect: function () {\n                this.trigger('select', { isAddButton: true });\n            },\n            _addButton: function () {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                return element('a', { className: classNames.sheetsBarAdd + EMPTYCHAR + classNames.sheetsBarKButton }, [element('span', { className: classNames.sheetsBarKSprite + EMPTYCHAR + classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconPlus }, [])]);\n            },\n            destroy: function () {\n                this._sortable.destroy();\n            },\n            _scrollableAllowed: function () {\n                var options = this.options;\n                return options.scrollable && !isNaN(options.scrollable.distance);\n            },\n            _scrollSheetsToItem: function (item) {\n                var that = this;\n                if (!that._scrollableModeActive) {\n                    return;\n                }\n                var sheetsGroup = that._sheetsGroup();\n                var currentScrollOffset = sheetsGroup.scrollLeft();\n                var itemWidth = outerWidth(item);\n                var itemOffset = that._isRtl ? item.position().left : item.position().left - sheetsGroup.children().first().position().left;\n                var sheetsGroupWidth = sheetsGroup[0].offsetWidth;\n                var sheetsGroupPadding = Math.ceil(parseFloat(sheetsGroup.css('padding-left')));\n                var itemPosition;\n                if (that._isRtl) {\n                    if (itemOffset < 0) {\n                        itemPosition = currentScrollOffset + itemOffset - (sheetsGroupWidth - currentScrollOffset) - sheetsGroupPadding;\n                    } else if (itemOffset + itemWidth > sheetsGroupWidth) {\n                        itemPosition = currentScrollOffset + itemOffset - itemWidth + sheetsGroupPadding * 2;\n                    }\n                } else {\n                    if (currentScrollOffset + sheetsGroupWidth < itemOffset + itemWidth) {\n                        itemPosition = itemOffset + itemWidth - sheetsGroupWidth + sheetsGroupPadding * 2;\n                    } else if (currentScrollOffset > itemOffset) {\n                        itemPosition = itemOffset - sheetsGroupPadding;\n                    }\n                }\n                sheetsGroup.finish().animate({ 'scrollLeft': itemPosition }, 'fast', 'linear', function () {\n                    that._toggleScrollButtons();\n                });\n            },\n            _sheetsGroup: function () {\n                return this._sheetsWrapper().children('ul');\n            },\n            _sheetsWrapper: function () {\n                return this.element.find(DOT + SheetsBar.classNames.sheetsBarItems);\n            },\n            _scrollSheetsByDelta: function (delta) {\n                var that = this;\n                var sheetsGroup = that._sheetsGroup();\n                var scrLeft = sheetsGroup.scrollLeft();\n                sheetsGroup.finish().animate({ 'scrollLeft': scrLeft + delta }, 'fast', 'linear', function () {\n                    if (that._nowScrollingSheets) {\n                        that._scrollSheetsByDelta(delta);\n                    } else {\n                        that._toggleScrollButtons();\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.SheetsBar = SheetsBar;\n        $.extend(true, SheetsBar, { classNames: sheetsBarClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/calc', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var util = kendo.util;\n    var spreadsheet = kendo.spreadsheet;\n    var Ref = spreadsheet.Ref;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var NameRef = spreadsheet.NameRef;\n    var exports = spreadsheet.calc;\n    var runtime = exports.runtime;\n    var OPERATORS = Object.create(null);\n    var ParseError = kendo.Class.extend({\n        init: function ParseError(message, pos) {\n            this.message = message;\n            this.pos = pos;\n        },\n        toString: function () {\n            return this.message;\n        }\n    });\n    (function (ops) {\n        ops.forEach(function (cls, i) {\n            cls.forEach(function (op) {\n                OPERATORS[op] = ops.length - i;\n            });\n        });\n    }([\n        [':'],\n        [' '],\n        [','],\n        ['%'],\n        ['^'],\n        [\n            '*',\n            '/'\n        ],\n        [\n            '+',\n            '-'\n        ],\n        ['&'],\n        [\n            '=',\n            '<',\n            '>',\n            '<=',\n            '>=',\n            '<>'\n        ]\n    ]));\n    var TRUE = {\n        type: 'bool',\n        value: true\n    };\n    var FALSE = {\n        type: 'bool',\n        value: false\n    };\n    function getcol(str) {\n        str = str.toUpperCase();\n        for (var col = 0, i = 0; i < str.length; ++i) {\n            col = col * 26 + str.charCodeAt(i) - 64;\n        }\n        return col - 1;\n    }\n    function getrow(str) {\n        return parseInt(str, 10) - 1;\n    }\n    function parseReference(name, noThrow) {\n        if (name.toLowerCase() == '#sheet') {\n            return spreadsheet.SHEETREF;\n        }\n        OUT: {\n            var m;\n            if (m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name)) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row < 1048576 && col < 16384) {\n                    return new CellRef(getrow(m[4]), getcol(m[2]));\n                }\n                break OUT;\n            }\n            var stream = TokenStream(name, {});\n            var a = [];\n            while (true) {\n                var ref = stream.next();\n                if (ref instanceof CellRef) {\n                    ref.rel = 0;\n                } else if (ref instanceof RangeRef) {\n                    ref.topLeft.rel = 0;\n                    ref.bottomRight.rel = 0;\n                } else {\n                    break OUT;\n                }\n                a.push(ref);\n                if (stream.eof()) {\n                    break;\n                }\n                if (!stream.is('op', ',')) {\n                    break OUT;\n                }\n                stream.next();\n            }\n            return a.length == 1 ? a[0] : new spreadsheet.UnionRef(a);\n        }\n        if (!noThrow) {\n            throw new Error('Cannot parse reference: ' + name);\n        }\n    }\n    function parseFormula(sheet, row, col, input) {\n        var refs = [];\n        input = TokenStream(input, {\n            row: row,\n            col: col\n        });\n        var is = input.is;\n        return {\n            type: 'exp',\n            ast: parseExpression(true),\n            refs: refs,\n            sheet: sheet,\n            row: row,\n            col: col\n        };\n        function addReference(ref) {\n            ref.index = refs.length;\n            refs.push(ref);\n            return ref;\n        }\n        function skip(type, value, allowEOF) {\n            if (is(type, value)) {\n                return input.next();\n            } else {\n                var tok = input.peek();\n                if (tok) {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB but found ' + tok.type + ' \\xAB' + tok.value + '\\xBB');\n                } else if (!allowEOF) {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB');\n                }\n            }\n        }\n        function parseExpression(commas) {\n            return maybeBinary(maybeIntersect(parseAtom(commas)), 0, commas);\n        }\n        function parseSymbol(tok) {\n            if (tok.upper == 'TRUE' || tok.upper == 'FALSE') {\n                return tok.upper == 'TRUE' ? TRUE : FALSE;\n            }\n            return addReference(new NameRef(tok.value));\n        }\n        function parseFuncall() {\n            var fname = input.next();\n            fname = fname.value;\n            skip('punc', '(');\n            var args = [];\n            while (1) {\n                if (is('punc', ')')) {\n                    break;\n                }\n                if (is('op', ',')) {\n                    args.push({ type: 'null' });\n                    input.next();\n                    continue;\n                }\n                args.push(parseExpression(false));\n                if (input.eof() || is('punc', ')')) {\n                    break;\n                }\n                skip('op', ',');\n            }\n            skip('punc', ')', true);\n            return {\n                type: 'func',\n                func: fname,\n                args: args\n            };\n        }\n        function fixReference(ref) {\n            if (!ref.hasSheet()) {\n                ref.setSheet(sheet);\n            }\n            return addReference(ref);\n        }\n        function parseAtom(commas) {\n            var exp;\n            if (is('ref')) {\n                exp = fixReference(input.next());\n            } else if (is('func')) {\n                exp = parseFuncall();\n            } else if (is('punc', '(')) {\n                input.next();\n                exp = parseExpression(true);\n                skip('punc', ')', true);\n            } else if (is('punc', '{')) {\n                input.next();\n                exp = parseArray();\n                skip('punc', '}', true);\n            } else if (is('num') || is('str') || is('error')) {\n                exp = input.next();\n            } else if (is('sym')) {\n                exp = parseSymbol(input.next());\n            } else if (is('op', '+') || is('op', '-')) {\n                exp = {\n                    type: 'prefix',\n                    op: input.next().value,\n                    exp: parseAtom(commas)\n                };\n            } else if (!input.peek()) {\n                input.croak('Incomplete expression');\n            } else if (is('punc', '[')) {\n                input.croak('External reference not supported');\n            } else {\n                input.croak('Parse error');\n            }\n            return maybePercent(exp);\n        }\n        function parseArray() {\n            var row = [], value = [row], first = true;\n            while (!input.eof() && !is('punc', '}')) {\n                if (first) {\n                    first = false;\n                } else if (is('punc', ';')) {\n                    value.push(row = []);\n                    input.next();\n                } else {\n                    skip('op', ',');\n                }\n                row.push(parseExpression(false));\n            }\n            return {\n                type: 'matrix',\n                value: value\n            };\n        }\n        function maybeIntersect(exp) {\n            if (is('punc', '(') || is('ref') || is('num') || is('func')) {\n                return {\n                    type: 'binary',\n                    op: ' ',\n                    left: exp,\n                    right: parseExpression(false)\n                };\n            } else {\n                return exp;\n            }\n        }\n        function maybePercent(exp) {\n            if (is('op', '%')) {\n                input.next();\n                return maybePercent({\n                    type: 'postfix',\n                    op: '%',\n                    exp: exp\n                });\n            } else {\n                return exp;\n            }\n        }\n        function maybeBinary(left, my_prec, commas) {\n            var tok = is('op');\n            if (tok && (commas || tok.value != ',')) {\n                var his_prec = OPERATORS[tok.value];\n                if (his_prec > my_prec) {\n                    input.next();\n                    var right = maybeBinary(parseAtom(commas), his_prec, commas);\n                    return maybeBinary({\n                        type: 'binary',\n                        op: tok.value,\n                        left: left,\n                        right: right\n                    }, my_prec, commas);\n                }\n            }\n            return left;\n        }\n    }\n    function parseNameDefinition(name, def) {\n        var nameRef = parseFormula(null, 0, 0, name);\n        if (!(nameRef.ast instanceof NameRef)) {\n            throw new ParseError('Invalid name: ' + name);\n        }\n        nameRef = nameRef.ast;\n        if (!(def instanceof Ref)) {\n            var defAST = parseFormula(nameRef.sheet, 0, 0, def);\n            if (defAST.ast instanceof Ref) {\n                def = defAST.ast;\n            } else if (/^(?:str|num|bool|error)$/.test(defAST.ast.type)) {\n                def = defAST.ast.value;\n            } else {\n                def = makeFormula(defAST);\n            }\n        }\n        return {\n            name: nameRef,\n            value: def\n        };\n    }\n    function makePrinter(exp) {\n        return makeClosure('function(row, col, mod){return(' + print(exp.ast, exp, 0) + ')}');\n        function print(node, parent, prec) {\n            switch (node.type) {\n            case 'num':\n            case 'bool':\n                return JSON.stringify(node.value);\n            case 'error':\n                return JSON.stringify('#' + node.value);\n            case 'str':\n                return JSON.stringify(JSON.stringify(node.value));\n            case 'ref':\n                return 'this.refs[' + node.index + '].print(row, col, mod)';\n            case 'prefix':\n                return withParens(function () {\n                    return JSON.stringify(node.op) + ' + ' + print(node.exp, node, OPERATORS[node.op]);\n                });\n            case 'postfix':\n                return withParens(function () {\n                    return print(node.exp, node, OPERATORS[node.op]) + ' + ' + JSON.stringify(node.op);\n                });\n            case 'binary':\n                return withParens(function () {\n                    var left = parenthesize(print(node.left, node, OPERATORS[node.op]), node.left instanceof NameRef && node.op == ':');\n                    var right = parenthesize(print(node.right, node, OPERATORS[node.op]), node.right instanceof NameRef && node.op == ':');\n                    return left + ' + ' + JSON.stringify(node.op) + ' + ' + right;\n                });\n            case 'func':\n                return JSON.stringify(node.func + '(') + ' + ' + (node.args.length > 0 ? node.args.map(function (arg) {\n                    return print(arg, node, 0);\n                }).join(' + \\', \\' + ') : '\\'\\'') + ' + \\')\\'';\n            case 'matrix':\n                return '\\'{ \\' + ' + node.value.map(function (el) {\n                    return el.map(function (el) {\n                        return print(el, node, 0);\n                    }).join(' + \\', \\' + ');\n                }).join(' + \\'; \\' + ') + '+ \\' }\\'';\n            case 'null':\n                return '\\'\\'';\n            }\n            throw new Error('Cannot make printer for node ' + node.type);\n            function withParens(f) {\n                var op = node.op;\n                var needParens = OPERATORS[op] < prec || !prec && op == ',' || parent.type == 'binary' && prec == OPERATORS[op] && node === parent.right;\n                return parenthesize(f(), needParens);\n            }\n        }\n        function parenthesize(code, cond) {\n            return cond ? '\\'(\\' + ' + code + ' + \\')\\'' : code;\n        }\n    }\n    function toCPS(ast, k) {\n        var GENSYM = 0;\n        return cps(ast, k);\n        function cps(node, k) {\n            switch (node.type) {\n            case 'ref':\n                return cpsRef(node, k);\n            case 'num':\n            case 'str':\n            case 'null':\n            case 'error':\n            case 'bool':\n                return cpsAtom(node, k);\n            case 'prefix':\n            case 'postfix':\n                return cpsUnary(node, k);\n            case 'binary':\n                return cpsBinary(node, k);\n            case 'func':\n                return cpsFunc(node, k);\n            case 'lambda':\n                return cpsLambda(node, k);\n            case 'matrix':\n                return cpsMatrix(node.value, k, true);\n            }\n            throw new Error('Cannot CPS ' + node.type);\n        }\n        function cpsRef(node, k) {\n            return node.ref == 'name' ? cpsNameRef(node, k) : cpsAtom(node, k);\n        }\n        function cpsAtom(node, k) {\n            return k(node);\n        }\n        function cpsNameRef(node, k) {\n            return {\n                type: 'func',\n                func: ',getname',\n                args: [\n                    makeContinuation(k),\n                    node\n                ]\n            };\n        }\n        function cpsUnary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'unary' + node.op,\n                args: [node.exp]\n            }, k);\n        }\n        function cpsBinary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'binary' + node.op,\n                args: [\n                    node.left,\n                    node.right\n                ]\n            }, k);\n        }\n        function cpsIf(co, th, el, k) {\n            return cps(co, function (co) {\n                var rest = makeContinuation(k);\n                var thenK = gensym('T');\n                var elseK = gensym('E');\n                return {\n                    type: 'func',\n                    func: 'if',\n                    args: [\n                        rest,\n                        co,\n                        {\n                            type: 'lambda',\n                            vars: [thenK],\n                            body: cps(th || TRUE, function (th) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: thenK\n                                    },\n                                    args: [th]\n                                };\n                            })\n                        },\n                        {\n                            type: 'lambda',\n                            vars: [elseK],\n                            body: cps(el || FALSE, function (el) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: elseK\n                                    },\n                                    args: [el]\n                                };\n                            })\n                        }\n                    ]\n                };\n            });\n        }\n        function cpsAnd(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(TRUE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    {\n                        type: 'func',\n                        func: 'AND',\n                        args: args.slice(1)\n                    },\n                    FALSE\n                ]\n            }, k);\n        }\n        function cpsOr(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(FALSE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    TRUE,\n                    {\n                        type: 'func',\n                        func: 'OR',\n                        args: args.slice(1)\n                    }\n                ]\n            }, k);\n        }\n        function cpsFunc(node, k) {\n            switch (node.func.toLowerCase()) {\n            case 'if':\n                return cpsIf(node.args[0], node.args[1], node.args[2], k);\n            case 'and':\n                return cpsAnd(node.args, k);\n            case 'or':\n                return cpsOr(node.args, k);\n            case 'true':\n                return k(TRUE);\n            case 'false':\n                return k(FALSE);\n            }\n            return function loop(args, i) {\n                if (i == node.args.length) {\n                    return {\n                        type: 'func',\n                        func: node.func,\n                        args: args\n                    };\n                } else {\n                    return cps(node.args[i], function (value) {\n                        return loop(args.concat([value]), i + 1);\n                    });\n                }\n            }([makeContinuation(k)], 0);\n        }\n        function cpsLambda(node, k) {\n            var cont = gensym('K');\n            var body = cps(node.body, function (body) {\n                return {\n                    type: 'call',\n                    func: {\n                        type: 'var',\n                        value: cont\n                    },\n                    args: [body]\n                };\n            });\n            return k({\n                type: 'lambda',\n                vars: [cont].concat(node.vars),\n                body: body\n            });\n        }\n        function cpsMatrix(elements, k, isMatrix) {\n            var a = [];\n            return function loop(i) {\n                if (i == elements.length) {\n                    return k({\n                        type: 'matrix',\n                        value: a\n                    });\n                } else {\n                    return (isMatrix ? cpsMatrix : cps)(elements[i], function (val) {\n                        a[i] = val;\n                        return loop(i + 1);\n                    });\n                }\n            }(0);\n        }\n        function makeContinuation(k) {\n            var cont = gensym('R');\n            return {\n                type: 'lambda',\n                vars: [cont],\n                body: k({\n                    type: 'var',\n                    name: cont\n                })\n            };\n        }\n        function gensym(name) {\n            if (!name) {\n                name = '';\n            }\n            name = '_' + name;\n            return name + ++GENSYM;\n        }\n    }\n    var makeClosure = function (cache) {\n        return function (code) {\n            var f = cache[code];\n            if (!f) {\n                f = cache[code] = new Function('\\'use strict\\';return(' + code + ')')();\n            }\n            return f;\n        };\n    }(Object.create(null));\n    var FORMULA_CACHE = Object.create(null);\n    function makeFormula(exp) {\n        var printer = makePrinter(exp);\n        var hash = printer.call(exp);\n        var formula = FORMULA_CACHE[hash];\n        if (formula) {\n            return formula.clone(exp.sheet, exp.row, exp.col);\n        }\n        var code = js(toCPS(exp.ast, function (ret) {\n            return {\n                type: 'return',\n                value: ret\n            };\n        }));\n        code = [\n            'function(){',\n            'var context = this, refs = context.formula.absrefs',\n            code,\n            '}'\n        ].join(';\\n');\n        formula = new runtime.Formula(exp.refs, makeClosure(code), printer, exp.sheet, exp.row, exp.col);\n        FORMULA_CACHE[hash] = formula;\n        return formula;\n        function js(node) {\n            var type = node.type;\n            if (type == 'num') {\n                return node.value + '';\n            } else if (type == 'str') {\n                return JSON.stringify(node.value);\n            } else if (type == 'error') {\n                return 'context.error(' + JSON.stringify(node.value) + ')';\n            } else if (type == 'return') {\n                return 'context.resolve(' + js(node.value) + ')';\n            } else if (type == 'func') {\n                return 'context.func(' + JSON.stringify(node.func) + ', ' + js(node.args[0]) + ', ' + jsArray(node.args.slice(1)) + ')';\n            } else if (type == 'call') {\n                return js(node.func) + '(' + node.args.map(js).join(', ') + ')';\n            } else if (type == 'ref') {\n                return 'refs[' + node.index + ']';\n            } else if (type == 'bool') {\n                return '' + node.value;\n            } else if (type == 'if') {\n                return '(context.bool(' + js(node.co) + ') ? ' + js(node.th) + ' : ' + js(node.el) + ')';\n            } else if (type == 'lambda') {\n                return '(function(' + node.vars.join(', ') + '){ return(' + js(node.body) + ') })';\n            } else if (type == 'var') {\n                return node.name;\n            } else if (type == 'matrix') {\n                return jsArray(node.value);\n            } else if (type == 'null') {\n                return 'null';\n            } else {\n                throw new Error('Cannot compile expression ' + type);\n            }\n        }\n        function jsArray(a) {\n            return '[ ' + a.map(js).join(', ') + ' ]';\n        }\n    }\n    function identity(x) {\n        return x;\n    }\n    function TokenStream(input, options) {\n        input = RawTokenStream(InputStream(input), options);\n        var ahead = input.ahead;\n        var skip = input.skip;\n        var token = null;\n        var fixCell = options.row != null && options.col != null ? function (cell) {\n            if (cell.rel & 1) {\n                cell.col -= options.col;\n            }\n            if (cell.rel & 2) {\n                cell.row -= options.row;\n            }\n            return cell;\n        } : identity;\n        var addPos = options.forEditor ? function (thing, startToken, endToken) {\n            thing.begin = startToken.begin;\n            thing.end = endToken.end;\n            return thing;\n        } : identity;\n        return {\n            peek: peek,\n            next: next,\n            croak: input.croak,\n            eof: input.eof,\n            is: is\n        };\n        function is(type, value) {\n            var tok = peek();\n            return tok != null && (type == null || tok.type === type) && (value == null || tok.value === value) ? tok : null;\n        }\n        function peek() {\n            if (token == null) {\n                token = readNext();\n            }\n            return token;\n        }\n        function next() {\n            if (token != null) {\n                var tmp = token;\n                token = null;\n                return tmp;\n            }\n            return readNext();\n        }\n        function readNext() {\n            var ret;\n            var t = input.peek();\n            if (t) {\n                if (t.type == 'sym' || t.type == 'rc' || t.type == 'num') {\n                    ret = ahead(8, refRange3D) || ahead(6, refCell3D) || ahead(6, refSheetRange) || ahead(4, refSheetCell) || ahead(4, refRange) || ahead(2, refCell) || ahead(2, funcall);\n                }\n                if (!ret) {\n                    ret = input.next();\n                }\n            }\n            return ret;\n        }\n        function toCell(tok, isFirst) {\n            if (tok.type == 'rc') {\n                if (tok.rel && !options.forEditor && (options.row == null || options.col == null)) {\n                    input.croak('Cannot read relative cell in RC notation');\n                }\n                return new CellRef(tok.row, tok.col, tok.rel);\n            }\n            if (tok.type == 'num') {\n                if (tok.value <= 1048577) {\n                    return fixCell(new CellRef(getrow(tok.value), isFirst ? -Infinity : +Infinity, 2));\n                } else {\n                    return null;\n                }\n            }\n            var name = tok.value;\n            var m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name);\n            if (m) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row <= 1048576 && col <= 16383) {\n                    return fixCell(new CellRef(getrow(m[4]), getcol(m[2]), (m[1] ? 0 : 1) | (m[3] ? 0 : 2)));\n                } else {\n                    return null;\n                }\n            }\n            var abs = name.charAt(0) == '$';\n            if (abs) {\n                name = name.substr(1);\n            }\n            if (/^\\d+$/.test(name)) {\n                var row = getrow(name);\n                if (row <= 1048576) {\n                    return fixCell(new CellRef(getrow(name), isFirst ? -Infinity : +Infinity, abs ? 0 : 2));\n                }\n            } else {\n                var col = getcol(name);\n                if (col <= 16383) {\n                    return fixCell(new CellRef(isFirst ? -Infinity : +Infinity, getcol(name), abs ? 0 : 1));\n                }\n            }\n        }\n        function refRange3D(a, b, c, d, e, f, g, h) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && f.type == 'op' && f.value == ':' && (g.type == 'sym' || g.type == 'rc' || g.type == 'num' && g.value == g.value | 0) && g.type == e.type && !(h.type == 'punc' && h.value == '(' && !g.space)) {\n                var tl = toCell(e, true), br = toCell(g, false);\n                if (tl && br) {\n                    skip(7);\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, g);\n                }\n            }\n        }\n        function refCell3D(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(e);\n                if (tl) {\n                    skip(5);\n                    var br = tl.clone();\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetRange(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && d.type == 'op' && d.value == ':' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(c, true), br = toCell(e, false);\n                if (tl && br) {\n                    skip(5);\n                    return addPos(new RangeRef(tl, br).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetCell(a, b, c, d) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                skip(3);\n                var x = toCell(c);\n                if (!x || !isFinite(x.row)) {\n                    x = new NameRef(c.value);\n                }\n                return addPos(x.setSheet(a.value, true), a, c);\n            }\n        }\n        function refRange(a, b, c, d) {\n            if ((a.type == 'sym' || a.type == 'rc' || a.type == 'num' && a.value == a.value | 0) && (b.type == 'op' && b.value == ':') && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                var tl = toCell(a, true), br = toCell(c, false);\n                if (tl && br) {\n                    skip(3);\n                    return addPos(new RangeRef(tl, br), a, c);\n                }\n            }\n        }\n        function refCell(a, b) {\n            if ((a.type == 'sym' || a.type == 'rc') && !(b.type == 'punc' && b.value == '(' && !a.space)) {\n                var x = toCell(a);\n                if (x && isFinite(x.row) && isFinite(x.col)) {\n                    skip(1);\n                    return addPos(x, a, a);\n                }\n            }\n        }\n        function funcall(a, b) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '(' && !a.space) {\n                a.type = 'func';\n                skip(1);\n                return a;\n            }\n        }\n    }\n    function isWhitespace(ch) {\n        return ' \\t\\n\\xA0\\u200B'.indexOf(ch) >= 0;\n    }\n    function RawTokenStream(input, options) {\n        var tokens = [], index = 0;\n        var readWhile = input.readWhile;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: input.croak,\n            ahead: ahead,\n            skip: skip\n        };\n        function isDigit(ch) {\n            return /[0-9]/i.test(ch);\n        }\n        function isIdStart(ch) {\n            return /[a-z$_]/i.test(ch) || util.isUnicodeLetter(ch);\n        }\n        function isId(ch) {\n            return isIdStart(ch) || isDigit(ch) || ch == '.';\n        }\n        function isOpChar(ch) {\n            return ch in OPERATORS;\n        }\n        function isPunc(ch) {\n            return '!;(){}[]'.indexOf(ch) >= 0;\n        }\n        function readNumber() {\n            var has_dot = false;\n            var number = readWhile(function (ch) {\n                if (ch == '.') {\n                    if (has_dot) {\n                        return false;\n                    }\n                    has_dot = true;\n                    return true;\n                }\n                return isDigit(ch);\n            });\n            return {\n                type: 'num',\n                value: parseFloat(number)\n            };\n        }\n        function symbol(id, quote) {\n            return {\n                type: 'sym',\n                value: id,\n                upper: id.toUpperCase(),\n                space: isWhitespace(input.peek()),\n                quote: quote\n            };\n        }\n        function getRC(a, b, c) {\n            if (!a && !b && !c) {\n                return 0;\n            }\n            if (!a && !c || a && c) {\n                var negative = a && /-$/.test(a);\n                var num = parseInt(b, 10);\n                if (negative) {\n                    num = -num;\n                }\n                if (!a) {\n                    num--;\n                }\n                return num;\n            }\n        }\n        function readSymbol() {\n            var m = input.lookingAt(/^R(\\[-?)?([0-9]+)?(\\])?C(\\[-?)?([0-9]+)?(\\])?/i);\n            if (m) {\n                var row = getRC(m[1], m[2], m[3]);\n                var col = getRC(m[4], m[5], m[6]);\n                if (row != null && col != null) {\n                    input.skip(m);\n                    return {\n                        type: 'rc',\n                        row: row,\n                        col: col,\n                        rel: (m[4] || !(m[4] || m[5] || m[6]) ? 1 : 0) | (m[1] || !(m[1] || m[2] || m[3]) ? 2 : 0)\n                    };\n                }\n            }\n            return symbol(readWhile(isId));\n        }\n        function readString() {\n            input.next();\n            return {\n                type: 'str',\n                value: input.readEscaped('\"')\n            };\n        }\n        function readSheetName() {\n            input.next();\n            return symbol(input.readEscaped('\\''), true);\n        }\n        function readOperator() {\n            return {\n                type: 'op',\n                value: readWhile(function (ch, op) {\n                    return op + ch in OPERATORS;\n                })\n            };\n        }\n        function readPunc() {\n            return {\n                type: 'punc',\n                value: input.next()\n            };\n        }\n        function readNext() {\n            if (input.eof()) {\n                return null;\n            }\n            var ch = input.peek(), m;\n            if (ch == '\"') {\n                return readString();\n            }\n            if (ch == '\\'') {\n                return readSheetName();\n            }\n            if (isDigit(ch) || ch == '.') {\n                return readNumber();\n            }\n            if (isIdStart(ch)) {\n                return readSymbol();\n            }\n            if (isOpChar(ch)) {\n                return readOperator();\n            }\n            if (isPunc(ch)) {\n                return readPunc();\n            }\n            if (m = input.lookingAt(/^#([a-z\\/]+)[?!]?/i)) {\n                input.skip(m);\n                return {\n                    type: 'error',\n                    value: m[1]\n                };\n            }\n            if (!options.forEditor) {\n                input.croak('Can\\'t handle character: ' + ch);\n            }\n            return {\n                type: 'error',\n                value: input.next()\n            };\n        }\n        function peek() {\n            while (tokens.length <= index) {\n                readWhile(isWhitespace);\n                var begin = input.pos();\n                var tok = readNext();\n                if (options.forEditor && tok) {\n                    tok.begin = begin;\n                    tok.end = input.pos();\n                }\n                tokens.push(tok);\n            }\n            return tokens[index];\n        }\n        function next() {\n            var tok = peek();\n            if (tok) {\n                index++;\n            }\n            return tok;\n        }\n        function ahead(n, f) {\n            var pos = index, a = [];\n            while (n-- > 0) {\n                a.push(next() || EOF);\n            }\n            index = pos;\n            return f.apply(a, a);\n        }\n        function skip(n) {\n            index += n;\n        }\n        function eof() {\n            return peek() == null;\n        }\n    }\n    var EOF = { type: 'eof' };\n    function InputStream(input) {\n        var pos = 0, line = 1, col = 0;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: croak,\n            readWhile: readWhile,\n            readEscaped: readEscaped,\n            lookingAt: lookingAt,\n            skip: skip,\n            forward: forward,\n            pos: location\n        };\n        function location() {\n            return pos;\n        }\n        function next() {\n            var ch = input.charAt(pos++);\n            if (ch == '\\n') {\n                line++;\n                col = 0;\n            } else {\n                col++;\n            }\n            return ch;\n        }\n        function peek() {\n            return input.charAt(pos);\n        }\n        function eof() {\n            return peek() === '';\n        }\n        function croak(msg) {\n            throw new ParseError(msg + ' (input: ' + input + ')', pos);\n        }\n        function skip(ch) {\n            if (typeof ch == 'string') {\n                if (input.substr(pos, ch.length) != ch) {\n                    croak('Expected ' + ch);\n                }\n                forward(ch.length);\n            } else if (ch instanceof RegExp) {\n                var m = ch.exec(input.substr(pos));\n                if (m) {\n                    forward(m[0].length);\n                    return m;\n                }\n            } else {\n                forward(ch[0].length);\n            }\n        }\n        function forward(n) {\n            while (n-- > 0) {\n                next();\n            }\n        }\n        function readEscaped(end) {\n            var escaped = false, str = '';\n            while (!eof()) {\n                var ch = next();\n                if (escaped) {\n                    str += ch;\n                    escaped = false;\n                } else if (ch == '\\\\') {\n                    escaped = true;\n                } else if (ch == end) {\n                    break;\n                } else {\n                    str += ch;\n                }\n            }\n            return str;\n        }\n        function readWhile(predicate) {\n            var str = '';\n            while (!eof() && predicate(peek(), str)) {\n                str += next();\n            }\n            return str;\n        }\n        function lookingAt(rx) {\n            return rx.exec(input.substr(pos));\n        }\n    }\n    var FORMAT_PARSERS = [];\n    var registerFormatParser = exports.registerFormatParser = function (p) {\n        FORMAT_PARSERS.push(p);\n    };\n    exports.parse = function (sheet, row, col, input) {\n        if (input instanceof Date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(input)\n            };\n        }\n        if (typeof input == 'number') {\n            return {\n                type: 'number',\n                value: input\n            };\n        }\n        if (typeof input == 'boolean') {\n            return {\n                type: 'boolean',\n                value: input\n            };\n        }\n        input += '';\n        if (/^'/.test(input)) {\n            return {\n                type: 'string',\n                value: input.substr(1)\n            };\n        }\n        if (/^[0-9.]+%$/.test(input)) {\n            var str = input.substr(0, input.length - 1);\n            var num = parseFloat(str);\n            if (!isNaN(num) && num == str) {\n                return {\n                    type: 'percent',\n                    value: num / 100\n                };\n            }\n        }\n        if (/^=/.test(input)) {\n            input = input.substr(1);\n            if (/\\S/.test(input)) {\n                return parseFormula(sheet, row, col, input);\n            } else {\n                return {\n                    type: 'string',\n                    value: '=' + input\n                };\n            }\n        }\n        for (var i = 0; i < FORMAT_PARSERS.length; ++i) {\n            var result = FORMAT_PARSERS[i](input);\n            if (result) {\n                return result;\n            }\n        }\n        if (input.toLowerCase() == 'true') {\n            return {\n                type: 'boolean',\n                value: true\n            };\n        }\n        if (input.toLowerCase() == 'false') {\n            return {\n                type: 'boolean',\n                value: false\n            };\n        }\n        var date = runtime.parseDate(input);\n        if (date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(date)\n            };\n        }\n        var num = parseFloat(input);\n        if (!isNaN(num) && input.length > 0 && num == input) {\n            return {\n                type: 'number',\n                value: num\n            };\n        }\n        return {\n            type: 'string',\n            value: input\n        };\n    };\n    function tokenize(input, row, col) {\n        var tokens = [];\n        input = TokenStream(input, {\n            forEditor: true,\n            row: row,\n            col: col\n        });\n        while (!input.eof()) {\n            tokens.push(next());\n        }\n        var tok = tokens[0];\n        if (tok.type == 'op' && tok.value == '=') {\n            tok.type = 'startexp';\n        }\n        return tokens;\n        function next() {\n            var tok = input.next();\n            if (tok.type == 'sym') {\n                if (tok.upper == 'TRUE') {\n                    tok.type = 'bool';\n                    tok.value = true;\n                } else if (tok.upper == 'FALSE') {\n                    tok.type = 'bool';\n                    tok.value = false;\n                }\n            } else if (tok.type == 'ref') {\n                tok = {\n                    type: 'ref',\n                    ref: row != null && col != null ? tok.absolute(row, col) : tok,\n                    begin: tok.begin,\n                    end: tok.end\n                };\n            }\n            return tok;\n        }\n    }\n    exports.parseNameDefinition = parseNameDefinition;\n    exports.parseFormula = parseFormula;\n    exports.parseReference = parseReference;\n    exports.compile = makeFormula;\n    exports.InputStream = InputStream;\n    exports.ParseError = ParseError;\n    exports.tokenize = tokenize;\n    registerFormatParser(function (input) {\n        var m;\n        if (m = /^(\\d+):(\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            return {\n                type: 'date',\n                format: 'hh:mm',\n                value: runtime.packTime(hh, mm, 0, 0)\n            };\n        }\n        if (m = /^(\\d+):(\\d+)(\\.\\d+)$/.exec(input)) {\n            var mm = parseInt(m[1], 10);\n            var ss = parseInt(m[2], 10);\n            var ms = parseFloat(m[3]) * 1000;\n            return {\n                type: 'date',\n                format: 'mm:ss.00',\n                value: runtime.packTime(0, mm, ss, ms)\n            };\n        }\n        if (m = /^(\\d+):(\\d+):(\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            var ss = parseInt(m[3], 10);\n            return {\n                type: 'date',\n                format: 'hh:mm:ss',\n                value: runtime.packTime(hh, mm, ss, 0)\n            };\n        }\n        if (m = /^(\\d+):(\\d+):(\\d+)(\\.\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            var ss = parseInt(m[3], 10);\n            var ms = parseFloat(m[4]) * 1000;\n            return {\n                type: 'date',\n                format: 'hh:mm:ss.00',\n                value: runtime.packTime(hh, mm, ss, ms)\n            };\n        }\n    });\n    registerFormatParser(function (input) {\n        var m, n;\n        var culture = kendo.culture();\n        var comma = culture.numberFormat[','];\n        var dot = culture.numberFormat['.'];\n        var currency = culture.numberFormat.currency.symbol;\n        var rxnum = getNumberRegexp(comma, dot);\n        var rxcur = new RegExp('^\\\\s*\\\\' + currency + '\\\\s*');\n        var sign = 1;\n        var format = '';\n        var suffix = '';\n        var has_currency = false;\n        input = InputStream(input.replace(/^\\s+|\\s+$/g, ''));\n        if (input.skip(/^-\\s*/)) {\n            sign = -1;\n        }\n        if (m = input.skip(rxcur)) {\n            has_currency = true;\n            format += '\"' + m[0] + '\"';\n        }\n        if (input.skip(/^-\\s*/)) {\n            if (sign < 0) {\n                return null;\n            }\n            sign = -1;\n        }\n        if (!(n = input.skip(rxnum))) {\n            return null;\n        }\n        format += '#';\n        if (m = input.skip(rxcur)) {\n            if (has_currency) {\n                return null;\n            }\n            has_currency = true;\n            suffix = '\"' + m[0] + '\"';\n        }\n        if (!input.eof()) {\n            return null;\n        }\n        if (n[2] || has_currency) {\n            format += ',#';\n        }\n        if (n[3]) {\n            format += '.' + repeat('0', n[3].length - 1);\n        }\n        var value = n[0].replace(new RegExp('\\\\' + comma, 'g'), '').replace(new RegExp('\\\\' + dot, 'g'), '.');\n        format += suffix;\n        if (has_currency) {\n            format += ';-' + format;\n        }\n        return {\n            type: 'number',\n            format: format,\n            value: sign * parseFloat(value)\n        };\n    });\n    var NUMBER_FORMAT_RX = {};\n    function getNumberRegexp(comma, dot) {\n        var id = comma + dot;\n        var rx = NUMBER_FORMAT_RX[id];\n        if (!rx) {\n            rx = '^(\\\\d+(COM\\\\d{3})*(DOT\\\\d+)?)';\n            rx = rx.replace(/DOT/g, '\\\\' + dot).replace(/COM/g, '\\\\' + comma);\n            rx = new RegExp(rx);\n            NUMBER_FORMAT_RX[id] = rx;\n        }\n        return rx;\n    }\n    function repeat(str, len) {\n        var out = '';\n        while (len-- > 0) {\n            out += str;\n        }\n        return out;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/excel-reader', [\n        'kendo.core',\n        'kendo.color',\n        'util/parse-xml',\n        'spreadsheet/calc'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var $ = kendo.jQuery;\n    var parseXML = kendo.util.parseXML;\n    var parseReference = kendo.spreadsheet.calc.parseReference;\n    function readExcel(file, workbook, deferred) {\n        var reader = new FileReader();\n        reader.onload = function (e) {\n            var zip = new JSZip(e.target.result);\n            readWorkbook(zip, workbook, deferred);\n        };\n        reader.readAsArrayBuffer(file);\n    }\n    var SEL_CELL = [\n        'sheetData',\n        'row',\n        'c'\n    ];\n    var SEL_COL = [\n        'cols',\n        'col'\n    ];\n    var SEL_DEFINED_NAME = [\n        'definedNames',\n        'definedName'\n    ];\n    var SEL_FORMULA = [\n        'sheetData',\n        'row',\n        'c',\n        'f'\n    ];\n    var SEL_MERGE = [\n        'mergeCells',\n        'mergeCell'\n    ];\n    var SEL_PANE = [\n        'sheetViews',\n        'sheetView',\n        'pane'\n    ];\n    var SEL_ROW = [\n        'sheetData',\n        'row'\n    ];\n    var SEL_SELECTION = [\n        'sheetViews',\n        'sheetView',\n        'selection'\n    ];\n    var SEL_SHEET = [\n        'sheets',\n        'sheet'\n    ];\n    var SEL_STRING = [\n        'sheetData',\n        'row',\n        'c',\n        'is'\n    ];\n    var SEL_TEXT = ['t'];\n    var SEL_SHARED_STRING = ['si'];\n    var SEL_VALUE = [\n        'sheetData',\n        'row',\n        'c',\n        'v'\n    ];\n    var SEL_VIEW = [\n        'bookViews',\n        'workbookView'\n    ];\n    var SEL_SHEET_VIEW = [\n        'sheetViews',\n        'sheetView'\n    ];\n    var SEL_HYPERLINK = [\n        'hyperlinks',\n        'hyperlink'\n    ];\n    function xl(file) {\n        if (!/^\\//.test(file)) {\n            file = 'xl/' + file;\n        } else {\n            file = file.substr(1);\n        }\n        return file;\n    }\n    function readWorkbook(zip, workbook, progress) {\n        var strings = readStrings(zip);\n        var relationships = readRelationships(zip, '_rels/workbook.xml');\n        var theme = readTheme(zip, relationships.byType.theme[0]);\n        var styles = readStyles(zip, theme);\n        var items = [];\n        var activeSheet = 0;\n        parse(zip, 'xl/workbook.xml', {\n            enter: function (tag, attrs) {\n                if (this.is(SEL_SHEET)) {\n                    var relId = attrs['r:id'];\n                    var file = relationships.byId[relId];\n                    var name = attrs.name;\n                    var dim = sheetDimensions(zip, file);\n                    items.push({\n                        workbook: workbook,\n                        zip: zip,\n                        strings: strings,\n                        styles: styles,\n                        file: file,\n                        options: {\n                            name: name,\n                            rows: Math.max(workbook.options.rows || 0, dim.rows),\n                            columns: Math.max(workbook.options.columns || 0, dim.cols),\n                            columnWidth: dim.columnWidth,\n                            rowHeight: dim.rowHeight\n                        }\n                    });\n                } else if (this.is(SEL_VIEW)) {\n                    if (attrs.activeTab) {\n                        activeSheet = integer(attrs.activeTab);\n                    }\n                }\n            },\n            text: function (text) {\n                var attrs = this.is(SEL_DEFINED_NAME);\n                if (attrs && !(bool(attrs['function']) || bool(attrs.vbProcedure))) {\n                    var localSheetId = attrs.localSheetId;\n                    var sheet = null;\n                    if (localSheetId != null) {\n                        sheet = items[localSheetId].options.name;\n                    }\n                    var name = attrs.name;\n                    if (sheet) {\n                        name = '\\'' + sheet.replace(/\\'/g, '\\\\\\'') + '\\'!' + name;\n                    }\n                    workbook.defineName(name, text, bool(attrs.hidden));\n                }\n            }\n        });\n        var loading = new $.Deferred();\n        loading.progress(function (args) {\n            if (progress) {\n                progress.notify(args);\n            }\n        }).then(function () {\n            var sheets = workbook.sheets();\n            recalcSheets(sheets);\n            workbook.activeSheet(sheets[activeSheet]);\n            if (progress) {\n                progress.resolve();\n            }\n        });\n        loadSheets(items, workbook, loading);\n    }\n    function loadSheets(items, workbook, progress) {\n        var ready = new $.Deferred().resolve();\n        for (var i = 0; i < items.length; i++) {\n            (function (entry, i) {\n                ready = ready.then(function () {\n                    var sheet = workbook.insertSheet(entry.options);\n                    sheet.suspendChanges(true);\n                    var promise = queueSheet(sheet, entry);\n                    var args = {\n                        sheet: sheet,\n                        progress: i / (items.length - 1)\n                    };\n                    promise.then(function () {\n                        progress.notify(args);\n                    });\n                    return promise;\n                });\n            }(items[i], i));\n        }\n        ready.then(function () {\n            progress.resolve();\n        });\n    }\n    function queueSheet(sheet, ctx) {\n        var deferred = new $.Deferred();\n        setTimeout(function () {\n            readSheet(ctx.zip, ctx.file, sheet, ctx.strings, ctx.styles);\n            deferred.resolve();\n        }, 0);\n        return deferred;\n    }\n    function recalcSheets(sheets) {\n        for (var i = 0; i < sheets.length; i++) {\n            sheets[i].suspendChanges(false).triggerChange({ recalc: true });\n        }\n    }\n    function sheetDimensions(zip, file) {\n        var dim = {\n            rows: 0,\n            cols: 0\n        };\n        parse(zip, xl(file), {\n            enter: function (tag, attrs) {\n                if (tag == 'dimension') {\n                    var ref = parseReference(attrs.ref);\n                    if (ref.bottomRight) {\n                        dim.cols = ref.bottomRight.col + 1;\n                        dim.rows = ref.bottomRight.row + 1;\n                    }\n                } else if (tag === 'sheetFormatPr') {\n                    if (attrs.defaultColWidth) {\n                        dim.columnWidth = toColWidth(parseFloat(attrs.defaultColWidth));\n                    }\n                    if (attrs.defaultRowHeight) {\n                        dim.rowHeight = toRowHeight(parseFloat(attrs.defaultRowHeight));\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    this.exit();\n                }\n            }\n        });\n        return dim;\n    }\n    function toColWidth(size) {\n        var maximumDigitWidth = 7;\n        var fraction = (256 * size + Math.floor(128 / maximumDigitWidth)) / 256;\n        return Math.floor(fraction) * maximumDigitWidth;\n    }\n    function toRowHeight(pts) {\n        return pts * 1.5625;\n    }\n    function readSheet(zip, file, sheet, strings, styles) {\n        var ref, type, value, formula, formulaRange;\n        var nCols = sheet._columns._count;\n        var prevCellRef = null;\n        var relsFile = file.replace(/worksheets\\//, 'worksheets/_rels/');\n        var relationships = readRelationships(zip, relsFile);\n        parse(zip, xl(file), {\n            enter: function (tag, attrs) {\n                if (this.is(SEL_CELL)) {\n                    value = null;\n                    formula = null;\n                    formulaRange = null;\n                    ref = attrs.r;\n                    if (ref == null) {\n                        ref = parseReference(prevCellRef);\n                        ref.col++;\n                        ref = ref.toString();\n                    }\n                    prevCellRef = ref;\n                    type = attrs.t;\n                    var styleIndex = attrs.s;\n                    if (styleIndex != null) {\n                        applyStyle(sheet, ref, styles, styleIndex);\n                    }\n                } else if (this.is(SEL_MERGE)) {\n                    sheet.range(attrs.ref).merge();\n                } else if (this.is(SEL_COL)) {\n                    var start = integer(attrs.min) - 1;\n                    var stop = Math.min(nCols, integer(attrs.max)) - 1;\n                    var width;\n                    if (attrs.width) {\n                        width = toColWidth(parseFloat(attrs.width));\n                        if (width !== 0) {\n                            sheet._columns.values.value(start, stop, width);\n                        }\n                    }\n                    if (attrs.hidden === '1' || width === 0) {\n                        for (var ci = start; ci <= stop; ci++) {\n                            sheet.hideColumn(ci);\n                        }\n                    }\n                    if (attrs.style != null) {\n                        applyStyle(sheet, new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(-Infinity, start), new kendo.spreadsheet.CellRef(+Infinity, stop)), styles, attrs.style);\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    var row = integer(attrs.r) - 1;\n                    var height;\n                    if (attrs.ht) {\n                        height = toRowHeight(parseFloat(attrs.ht));\n                        if (height !== 0) {\n                            sheet._rows.values.value(row, row, height);\n                        }\n                    }\n                    if (attrs.hidden === '1' || height === 0) {\n                        sheet.hideRow(row);\n                    }\n                } else if (this.is(SEL_SELECTION)) {\n                    if (attrs.activeCell) {\n                        var acRef = parseReference(attrs.activeCell);\n                        sheet.select(acRef, true);\n                    }\n                } else if (this.is(SEL_PANE)) {\n                    if (attrs.state == 'frozen') {\n                        if (attrs.xSplit) {\n                            sheet.frozenColumns(integer(attrs.xSplit));\n                        }\n                        if (attrs.ySplit) {\n                            sheet.frozenRows(integer(attrs.ySplit));\n                        }\n                    }\n                } else if (this.is(SEL_SHEET_VIEW)) {\n                    sheet.showGridLines(bool(attrs.showGridLines, true));\n                } else if (this.is(SEL_HYPERLINK)) {\n                    var relId = attrs['r:id'];\n                    var target = relationships.byId[relId];\n                    if (target) {\n                        sheet.range(attrs.ref).link(target);\n                    }\n                }\n            },\n            leave: function (tag) {\n                if (this.is(SEL_CELL)) {\n                    if (formula != null) {\n                        try {\n                            sheet.range(formulaRange || ref).formula(formula);\n                        } catch (ex) {\n                            sheet.range(formulaRange || ref).value(formula).background('#ffaaaa');\n                        }\n                    } else if (value != null) {\n                        var range = sheet.range(ref);\n                        if (!range._get('formula')) {\n                            if (!type || type == 'n') {\n                                value = parseFloat(value);\n                            } else if (type == 's') {\n                                value = strings[integer(value)];\n                            } else if (type == 'b') {\n                                value = value === '1';\n                            } else if (type == 'd') {\n                                value = kendo.parseDate(value);\n                            }\n                            if (value != null) {\n                                range.value(value);\n                            }\n                        }\n                    }\n                } else if (tag == 'cols') {\n                    sheet._columns._refresh();\n                } else if (tag == 'sheetData') {\n                    sheet._rows._refresh();\n                }\n            },\n            text: function (text) {\n                var attrs;\n                if (this.is(SEL_VALUE) || this.is(SEL_STRING)) {\n                    value = text;\n                } else if (attrs = this.is(SEL_FORMULA)) {\n                    formula = text;\n                    if (attrs.t == 'shared') {\n                        formulaRange = attrs.ref;\n                    }\n                }\n            }\n        });\n    }\n    var BORDER_WIDTHS = {\n        'none': 0,\n        'thin': 1,\n        'medium': 2,\n        'dashed': 1,\n        'dotted': 1,\n        'thick': 3,\n        'double': 3,\n        'hair': 1,\n        'mediumDashed': 2,\n        'dashDot': 1,\n        'mediumDashDot': 2,\n        'dashDotDot': 1,\n        'mediumDashDotDot': 2,\n        'slantDashDot': 1\n    };\n    var DEFAULT_FORMATS = {\n        0: 'General',\n        1: '0',\n        2: '0.00',\n        3: '#,##0',\n        4: '#,##0.00',\n        9: '0%',\n        10: '0.00%',\n        11: '0.00E+00',\n        12: '# ?/?',\n        13: '# ??/??',\n        14: 'mm-dd-yy',\n        15: 'd-mmm-yy',\n        16: 'd-mmm',\n        17: 'mmm-yy',\n        18: 'h:mm AM/PM',\n        19: 'h:mm:ss AM/PM',\n        20: 'h:mm',\n        21: 'h:mm:ss',\n        22: 'm/d/yy h:mm',\n        37: '#,##0 ;(#,##0)',\n        38: '#,##0 ;[Red](#,##0)',\n        39: '#,##0.00;(#,##0.00)',\n        40: '#,##0.00;[Red](#,##0.00)',\n        45: 'mm:ss',\n        46: '[h]:mm:ss',\n        47: 'mmss.0',\n        48: '##0.0E+0',\n        49: '@'\n    };\n    function applyStyle(sheet, ref, styles, styleIndex) {\n        var range = sheet.range(ref);\n        var xf = styles.inlineStyles[styleIndex], base, value;\n        if (xf.xfId) {\n            base = styles.namedStyles[xf.xfId];\n        }\n        if (shouldSet('applyBorder', 'borderId')) {\n            setBorder(styles.borders[value]);\n        }\n        if (shouldSet('applyFont', 'fontId')) {\n            setFont(styles.fonts[value]);\n        }\n        if (shouldSet('applyAlignment', 'textAlign')) {\n            range.textAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'verticalAlign')) {\n            range.verticalAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'wrapText')) {\n            range._property('wrap', value);\n        }\n        if (shouldSet('applyFill', 'fillId')) {\n            setFill(styles.fills[value]);\n        }\n        if (shouldSet('applyNumberFormat', 'numFmtId')) {\n            setFormat(styles.numFmts[value] || DEFAULT_FORMATS[value]);\n        }\n        function setFormat(f) {\n            var format = typeof f == 'string' ? f : f.formatCode;\n            if (format != null && !/^general$/i.test(format)) {\n                format = format.replace(/^\\[\\$-[0-9]+\\]/, '');\n                range.format(format);\n            }\n        }\n        function setFill(f) {\n            if (f.type == 'solid') {\n                range.background(f.color);\n            }\n        }\n        function setFont(f) {\n            range.fontFamily(f.name);\n            range._property('fontSize', f.size);\n            if (f.bold) {\n                range.bold(true);\n            }\n            if (f.italic) {\n                range.italic(true);\n            }\n        }\n        function setBorder(b) {\n            function set(side, prop) {\n                var border = b[side];\n                if (!border) {\n                    return;\n                }\n                var width = BORDER_WIDTHS[border.style];\n                if (width === 0) {\n                    return;\n                }\n                var color = border.color;\n                if (color == null) {\n                    color = '#000';\n                }\n                range._property(prop, {\n                    size: width,\n                    color: color\n                });\n            }\n            set('left', 'borderLeft');\n            set('top', 'borderTop');\n            set('right', 'borderRight');\n            set('bottom', 'borderBottom');\n        }\n        function shouldSet(applyName, propName) {\n            var t = xf[applyName];\n            if (t != null && !t) {\n                return false;\n            }\n            value = xf[propName];\n            if (base && value == null) {\n                t = base[applyName];\n                if (t != null && !t) {\n                    return false;\n                }\n                value = base[propName];\n            }\n            return value != null;\n        }\n    }\n    function parse(zip, file, callbacks) {\n        var part = zip.files[file];\n        if (part) {\n            parseXML(part.asUint8Array(), callbacks);\n        }\n    }\n    function readStrings(zip) {\n        var strings = [];\n        var current = null;\n        parse(zip, 'xl/sharedStrings.xml', {\n            leave: function () {\n                if (this.is(SEL_SHARED_STRING)) {\n                    strings.push(current);\n                    current = null;\n                }\n            },\n            text: function (text) {\n                if (this.is(SEL_TEXT)) {\n                    if (current == null) {\n                        current = '';\n                    }\n                    current += text;\n                }\n            }\n        });\n        return strings;\n    }\n    function readRelationships(zip, file) {\n        var map = {\n            byId: {},\n            byType: { theme: [] }\n        };\n        parse(zip, xl(file) + '.rels', {\n            enter: function (tag, attrs) {\n                if (tag == 'Relationship') {\n                    map.byId[attrs.Id] = attrs.Target;\n                    var type = attrs.Type.match(/\\w+$/)[0];\n                    var entries = map.byType[type] || [];\n                    entries.push(attrs.Target);\n                    map.byType[type] = entries;\n                }\n            }\n        });\n        return map;\n    }\n    var SEL_BORDER = [\n        'borders',\n        'border'\n    ];\n    var SEL_FILL = [\n        'fills',\n        'fill'\n    ];\n    var SEL_FONT = [\n        'fonts',\n        'font'\n    ];\n    var SEL_INLINE_STYLE = [\n        'cellXfs',\n        'xf'\n    ];\n    var SEL_NAMED_STYLE = [\n        'cellStyleXfs',\n        'xf'\n    ];\n    var SEL_NUM_FMT = [\n        'numFmts',\n        'numFmt'\n    ];\n    var INDEXED_COLORS = [\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008000'),\n        toCSSColor('FF000080'),\n        toCSSColor('FF808000'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF008080'),\n        toCSSColor('FFC0C0C0'),\n        toCSSColor('FF808080'),\n        toCSSColor('FF9999FF'),\n        toCSSColor('FF993366'),\n        toCSSColor('FFFFFFCC'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FF660066'),\n        toCSSColor('FFFF8080'),\n        toCSSColor('FF0066CC'),\n        toCSSColor('FFCCCCFF'),\n        toCSSColor('FF000080'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008080'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FF00CCFF'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FFCCFFCC'),\n        toCSSColor('FFFFFF99'),\n        toCSSColor('FF99CCFF'),\n        toCSSColor('FFFF99CC'),\n        toCSSColor('FFCC99FF'),\n        toCSSColor('FFFFCC99'),\n        toCSSColor('FF3366FF'),\n        toCSSColor('FF33CCCC'),\n        toCSSColor('FF99CC00'),\n        toCSSColor('FFFFCC00'),\n        toCSSColor('FFFF9900'),\n        toCSSColor('FFFF6600'),\n        toCSSColor('FF666699'),\n        toCSSColor('FF969696'),\n        toCSSColor('FF003366'),\n        toCSSColor('FF339966'),\n        toCSSColor('FF003300'),\n        toCSSColor('FF333300'),\n        toCSSColor('FF993300'),\n        toCSSColor('FF993366'),\n        toCSSColor('FF333399'),\n        toCSSColor('FF333333'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF')\n    ];\n    function readStyles(zip, theme) {\n        var styles = {\n            fonts: [],\n            numFmts: {},\n            fills: [],\n            borders: [],\n            namedStyles: [],\n            inlineStyles: []\n        };\n        var font = null;\n        var fill = null;\n        var border = null;\n        var xf = null;\n        parse(zip, 'xl/styles.xml', {\n            enter: function (tag, attrs, closed) {\n                if (this.is(SEL_NUM_FMT)) {\n                    styles.numFmts[attrs.numFmtId] = attrs;\n                } else if (this.is(SEL_FONT)) {\n                    styles.fonts.push(font = {});\n                } else if (font) {\n                    if (tag == 'sz') {\n                        font.size = parseFloat(attrs.val);\n                    } else if (tag == 'name') {\n                        font.name = attrs.val;\n                    } else if (tag == 'b') {\n                        font.bold = bool(attrs.val, true);\n                    } else if (tag == 'i') {\n                        font.italic = bool(attrs.val, true);\n                    }\n                } else if (this.is(SEL_FILL)) {\n                    styles.fills.push(fill = {});\n                } else if (fill) {\n                    if (tag == 'patternFill') {\n                        fill.type = attrs.patternType;\n                    } else if (tag == 'fgColor' && fill.type === 'solid') {\n                        fill.color = getColor(attrs);\n                    } else if (tag == 'bgColor' && fill.type !== 'solid') {\n                        fill.color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_BORDER)) {\n                    styles.borders.push(border = {});\n                } else if (border) {\n                    if (/^(?:left|top|right|bottom)$/.test(tag) && attrs.style) {\n                        border[tag] = { style: attrs.style };\n                    }\n                    if (tag == 'color') {\n                        var side = this.stack[this.stack.length - 2].$tag;\n                        border[side].color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_NAMED_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.namedStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (this.is(SEL_INLINE_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.inlineStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (xf) {\n                    if (tag == 'alignment') {\n                        if (/^(?:left|center|right|justify)$/.test(attrs.horizontal)) {\n                            xf.textAlign = attrs.horizontal;\n                        }\n                        if (/^(?:top|center|bottom)$/.test(attrs.vertical)) {\n                            xf.verticalAlign = attrs.vertical;\n                        }\n                        if (attrs.wrapText != null) {\n                            xf.wrapText = bool(attrs.wrapText);\n                        }\n                    }\n                }\n            },\n            leave: function (tag) {\n                if (this.is(SEL_FONT)) {\n                    font = null;\n                } else if (this.is(SEL_FILL)) {\n                    fill = null;\n                } else if (this.is(SEL_BORDER)) {\n                    border = null;\n                } else if (tag == 'xf') {\n                    xf = null;\n                }\n            }\n        });\n        function getXf(attrs) {\n            var xf = {\n                borderId: integer(attrs.borderId),\n                fillId: integer(attrs.fillId),\n                fontId: integer(attrs.fontId),\n                numFmtId: integer(attrs.numFmtId),\n                pivotButton: bool(attrs.pivotButton),\n                quotePrefix: bool(attrs.quotePrefix),\n                xfId: integer(attrs.xfId)\n            };\n            addBool('applyAlignment');\n            addBool('applyBorder');\n            addBool('applyFill');\n            addBool('applyFont');\n            addBool('applyNumberFormat');\n            addBool('applyProtection');\n            function addBool(name) {\n                if (attrs[name] != null) {\n                    xf[name] = bool(attrs[name]);\n                }\n            }\n            return xf;\n        }\n        function getColor(attrs) {\n            if (attrs.rgb) {\n                return toCSSColor(attrs.rgb);\n            } else if (attrs.indexed) {\n                return INDEXED_COLORS[integer(attrs.indexed)];\n            } else if (attrs.theme) {\n                var themeColor = theme.colorScheme[integer(attrs.theme)];\n                if (!themeColor) {\n                    return INDEXED_COLORS[0];\n                }\n                var color = kendo.parseColor(themeColor);\n                if (attrs.tint) {\n                    color = color.toHSL();\n                    var tint = parseFloat(attrs.tint);\n                    if (tint < 0) {\n                        color.l = color.l * (1 + tint);\n                    } else {\n                        color.l = color.l * (1 - tint) + (100 - 100 * (1 - tint));\n                    }\n                }\n                return color.toCssRgba();\n            }\n        }\n        return styles;\n    }\n    var SEL_SCHEME_RGBCLR = [\n        'a:clrScheme',\n        '*',\n        'a:srgbClr'\n    ];\n    var SEL_SCHEME_SYSCLR = [\n        'a:clrScheme',\n        '*',\n        'a:sysClr'\n    ];\n    function readTheme(zip, rel) {\n        var scheme = [];\n        var theme = { colorScheme: scheme };\n        var file = xl(rel);\n        if (zip.files[file]) {\n            parse(zip, file, {\n                enter: function (tag, attrs) {\n                    if (this.is(SEL_SCHEME_SYSCLR)) {\n                        scheme.push(toCSSColor(attrs.val == 'window' ? 'FFFFFFFF' : 'FF000000'));\n                    } else if (this.is(SEL_SCHEME_RGBCLR)) {\n                        scheme.push(toCSSColor('FF' + attrs.val));\n                    }\n                }\n            });\n            if (scheme.length > 3) {\n                swap(scheme, 0, 1);\n                swap(scheme, 2, 3);\n            }\n        }\n        function swap(arr, a, b) {\n            var tmp = arr[a];\n            arr[a] = arr[b];\n            arr[b] = tmp;\n        }\n        return theme;\n    }\n    function integer(val) {\n        return val == null ? null : parseInt(val, 10);\n    }\n    function bool(val, def) {\n        if (val == null) {\n            return def;\n        }\n        return val == 'true' || val === true || val == 1;\n    }\n    function toCSSColor(rgb) {\n        var m = /^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(rgb);\n        return 'rgba(' + parseInt(m[2], 16) + ', ' + parseInt(m[3], 16) + ', ' + parseInt(m[4], 16) + ', ' + parseInt(m[1], 16) / 255 + ')';\n    }\n    kendo.spreadsheet.readExcel = readExcel;\n    kendo.spreadsheet._readSheet = readSheet;\n    kendo.spreadsheet._readStrings = readStrings;\n    kendo.spreadsheet._readStyles = readStyles;\n    kendo.spreadsheet._readTheme = readTheme;\n    kendo.spreadsheet._readWorkbook = readWorkbook;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/workbook', [\n        'kendo.core',\n        'spreadsheet/runtime',\n        'spreadsheet/references',\n        'spreadsheet/excel-reader'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Formula = kendo.spreadsheet.calc.runtime.Formula;\n        var Ref = kendo.spreadsheet.Ref;\n        var CalcError = kendo.spreadsheet.CalcError;\n        var Workbook = kendo.Observable.extend({\n            init: function (options, view) {\n                kendo.Observable.fn.init.call(this);\n                this.options = options;\n                this._view = view;\n                this._sheets = [];\n                this._sheetsSearchCache = {};\n                this._sheet = this.insertSheet({\n                    rows: this.options.rows,\n                    columns: this.options.columns,\n                    rowHeight: this.options.rowHeight,\n                    columnWidth: this.options.columnWidth,\n                    headerHeight: this.options.headerHeight,\n                    headerWidth: this.options.headerWidth,\n                    dataSource: this.options.dataSource\n                });\n                this.undoRedoStack = new kendo.util.UndoRedoStack();\n                this.undoRedoStack.bind([\n                    'undo',\n                    'redo'\n                ], this._onUndoRedo.bind(this));\n                this._context = new kendo.spreadsheet.FormulaContext(this);\n                this._validationContext = new kendo.spreadsheet.ValidationFormulaContext(this);\n                this._names = Object.create(null);\n                this.fromJSON(this.options);\n            },\n            clipboard: function () {\n                if (!this._clipboard) {\n                    this._clipboard = new kendo.spreadsheet.Clipboard(this);\n                }\n                return this._clipboard;\n            },\n            destroy: function () {\n                this.unbind();\n                if (this._clipboard) {\n                    this._clipboard.destroy();\n                }\n            },\n            events: [\n                'cut',\n                'copy',\n                'paste',\n                'change',\n                'excelImport',\n                'excelExport'\n            ],\n            _sheetChange: function (e) {\n                this.trigger('change', e);\n            },\n            _sheetCommandRequest: function (e) {\n                this.trigger('commandRequest', e);\n            },\n            _inputForRef: function (ref) {\n                return new kendo.spreadsheet.Range(ref, this._sheet).input();\n            },\n            _onUndoRedo: function (e) {\n                e.command.range().select();\n            },\n            execute: function (options) {\n                var commandOptions = $.extend({ workbook: this }, options.options);\n                var command = new kendo.spreadsheet[options.command](commandOptions);\n                var sheet = this.activeSheet();\n                if (commandOptions.origin) {\n                    command.origin(commandOptions.origin);\n                }\n                if (commandOptions.operatingRange) {\n                    command.range(commandOptions.operatingRange);\n                } else if (commandOptions.editActiveCell) {\n                    command.range(sheet.activeCellSelection());\n                } else {\n                    command.range(sheet.selection());\n                }\n                var result = command.exec();\n                if (!result || result.reason !== 'error') {\n                    if (command.cannotUndo) {\n                        this.undoRedoStack.clear();\n                    } else {\n                        this.undoRedoStack.push(command);\n                    }\n                }\n                return result;\n            },\n            resetFormulas: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetFormulas();\n                });\n            },\n            resetValidations: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetValidations();\n                });\n            },\n            refresh: function (reason) {\n                if (reason.recalc) {\n                    this.resetFormulas();\n                    this.resetValidations();\n                    this._sheet.recalc(this._context);\n                    this._sheet.revalidate(this._validationContext);\n                }\n            },\n            activeSheet: function (sheet) {\n                if (sheet === undefined) {\n                    return this._sheet;\n                }\n                if (!this.sheetByName(sheet.name())) {\n                    return;\n                }\n                this._sheet = sheet;\n                sheet.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            moveSheetToIndex: function (sheet, toIndex) {\n                var fromIndex = this.sheetIndex(sheet);\n                var sheets = this._sheets;\n                if (fromIndex === -1) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheets.splice(toIndex, 0, sheets.splice(fromIndex, 1)[0]);\n                this.trigger('change', { sheetSelection: true });\n            },\n            insertSheet: function (options) {\n                options = options || {};\n                var that = this;\n                var insertIndex = typeof options.index === 'number' ? options.index : that._sheets.length;\n                var sheetName;\n                var sheets = that._sheets;\n                var getUniqueSheetName = function (sheetNameSuffix) {\n                    sheetNameSuffix = sheetNameSuffix ? sheetNameSuffix : 1;\n                    var name = 'Sheet' + sheetNameSuffix;\n                    if (!that.sheetByName(name)) {\n                        return name;\n                    }\n                    return getUniqueSheetName(sheetNameSuffix + 1);\n                };\n                if (options.name && that.sheetByName(options.name)) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheetName = options.name || getUniqueSheetName();\n                var sheet = new kendo.spreadsheet.Sheet(options.rows || this.options.rows, options.columns || this.options.columns, options.rowHeight || this.options.rowHeight, options.columnWidth || this.options.columnWidth, options.headerHeight || this.options.headerHeight, options.headerWidth || this.options.headerWidth);\n                sheet._workbook = this;\n                sheet._name(sheetName);\n                sheet.bind('change', this._sheetChange.bind(this));\n                sheet.bind('commandRequest', this._sheetCommandRequest.bind(this));\n                sheets.splice(insertIndex, 0, sheet);\n                if (options.data) {\n                    sheet.fromJSON(options.data);\n                }\n                if (options.dataSource) {\n                    sheet.setDataSource(options.dataSource);\n                }\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            sheets: function () {\n                return this._sheets.slice();\n            },\n            sheetByName: function (sheetName) {\n                return this._sheets[this.sheetIndex(sheetName)];\n            },\n            sheetByIndex: function (index) {\n                return this._sheets[index];\n            },\n            sheetIndex: function (sheet) {\n                var sheets = this._sheets;\n                var sheetName = (typeof sheet == 'string' ? sheet : sheet.name()).toLowerCase();\n                var idx = this._sheetsSearchCache[sheetName];\n                if (idx >= 0) {\n                    return idx;\n                }\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var name = sheets[idx].name().toLowerCase();\n                    this._sheetsSearchCache[name] = idx;\n                    if (name === sheetName) {\n                        return idx;\n                    }\n                }\n                return -1;\n            },\n            renameSheet: function (sheet, newSheetName) {\n                var oldSheetName = sheet.name().toLowerCase();\n                if (!newSheetName || oldSheetName === newSheetName.toLowerCase() || this.sheetByName(newSheetName)) {\n                    return;\n                }\n                sheet = this.sheetByName(oldSheetName);\n                if (!sheet) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                this._sheets.forEach(function (sheet) {\n                    sheet._forFormulas(function (formula) {\n                        formula.renameSheet(oldSheetName, newSheetName);\n                    });\n                });\n                this.forEachName(function (def, name) {\n                    if (def.nameref.renameSheet(oldSheetName, newSheetName)) {\n                        this.undefineName(name);\n                        def.name = def.nameref.print();\n                        this.nameDefinition(def.name, def);\n                    }\n                    if (def.value instanceof Ref || def.value instanceof Formula) {\n                        def.value.renameSheet(oldSheetName, newSheetName);\n                    }\n                }.bind(this));\n                sheet._name(newSheetName);\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            removeSheet: function (sheet) {\n                var that = this;\n                var sheets = that._sheets;\n                var name = sheet.name();\n                var index = that.sheetIndex(sheet);\n                if (sheets.length === 1) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                if (index > -1) {\n                    sheet.unbind();\n                    sheets.splice(index, 1);\n                    if (that.activeSheet().name() === name) {\n                        var newSheet = sheets[index === sheets.length ? index - 1 : index];\n                        that.activeSheet(newSheet);\n                    } else {\n                        this.trigger('change', {\n                            recalc: true,\n                            sheetSelection: true\n                        });\n                    }\n                }\n            },\n            _clearSheets: function () {\n                for (var i = 0; i < this._sheets.length; i++) {\n                    this._sheets[i].unbind();\n                }\n                this._sheets = [];\n                this._sheetsSearchCache = {};\n                this._names = {};\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    this._clearSheets();\n                    for (var idx = 0; idx < json.sheets.length; idx++) {\n                        var data = json.sheets[idx];\n                        var args = sheetParamsFromJSON(data, this.options);\n                        var sheet = this.insertSheet({\n                            rows: args.rowCount,\n                            columns: args.columnCount,\n                            rowHeight: args.rowHeight,\n                            columnWidth: args.columnWidth,\n                            headerHeight: args.headerHeight,\n                            headerWidth: args.headerWidth,\n                            data: data\n                        });\n                        if (data.dataSource) {\n                            sheet.setDataSource(data.dataSource);\n                        }\n                    }\n                }\n                if (json.activeSheet) {\n                    this.activeSheet(this.sheetByName(json.activeSheet));\n                } else {\n                    this.activeSheet(this._sheets[0]);\n                }\n                if (json.names) {\n                    json.names.forEach(function (def) {\n                        this.defineName(def.name, def.value, def.hidden);\n                    }, this);\n                }\n            },\n            toJSON: function () {\n                this.resetFormulas();\n                this.resetValidations();\n                var names = Object.keys(this._names).map(function (name) {\n                    var def = this._names[name];\n                    var val = def.value;\n                    if (val instanceof Ref || val instanceof Formula) {\n                        val = val.print(0, 0, true);\n                    } else if (val instanceof CalcError) {\n                        val = val + '';\n                    } else {\n                        val = JSON.stringify(val);\n                    }\n                    return {\n                        value: val,\n                        hidden: def.hidden,\n                        name: def.name,\n                        sheet: def.nameref.sheet,\n                        localName: def.nameref.name\n                    };\n                }, this);\n                return {\n                    activeSheet: this.activeSheet().name(),\n                    sheets: this._sheets.map(function (sheet) {\n                        sheet.recalc(this._context);\n                        sheet.revalidate(this._validationContext);\n                        return sheet.toJSON();\n                    }, this),\n                    names: names\n                };\n            },\n            fromFile: function (file) {\n                var deferred = new $.Deferred();\n                var promise = deferred.promise();\n                var args = {\n                    file: file,\n                    promise: promise\n                };\n                if (file && !this.trigger('excelImport', args)) {\n                    this._clearSheets();\n                    kendo.spreadsheet.readExcel(file, this, deferred);\n                } else {\n                    deferred.reject();\n                }\n                return promise;\n            },\n            saveAsExcel: function (options) {\n                options = $.extend({}, this.options.excel, options);\n                var data = this.toJSON();\n                if (!this.trigger('excelExport', { workbook: data })) {\n                    var workbook = new kendo.ooxml.Workbook(data);\n                    kendo.saveAs({\n                        dataURI: workbook.toDataURL(),\n                        fileName: data.fileName || options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy\n                    });\n                }\n            },\n            draw: function (options, callback) {\n                if (typeof options == 'function' && !callback) {\n                    callback = options;\n                    options = {};\n                }\n                var parts = [], sheets = this._sheets;\n                (function loop(i) {\n                    if (i < sheets.length) {\n                        sheets[i].draw(kendo.spreadsheet.SHEETREF, options, function (group) {\n                            parts.push(group);\n                            loop(i + 1);\n                        });\n                    } else {\n                        var group = parts[0];\n                        for (i = 1; i < parts.length; ++i) {\n                            group.children = group.children.concat(parts[i].children);\n                        }\n                        callback(group);\n                    }\n                }(0));\n            },\n            nameForRef: function (ref, sheet) {\n                if (sheet === undefined) {\n                    sheet = ref.sheet;\n                }\n                sheet = sheet.toLowerCase();\n                var str = ref + '';\n                for (var name in this._names) {\n                    var def = this._names[name];\n                    var val = def.value;\n                    if (val instanceof Ref) {\n                        if (!val.sheet || val.sheet && sheet == val.sheet.toLowerCase()) {\n                            if (val + '' == str) {\n                                return def;\n                            }\n                        }\n                    }\n                }\n                return { name: str };\n            },\n            defineName: function (name, value, hidden) {\n                var x = kendo.spreadsheet.calc.parseNameDefinition(name, value);\n                name = x.name.print();\n                this._names[name.toLowerCase()] = {\n                    value: x.value,\n                    hidden: hidden,\n                    name: name,\n                    nameref: x.name\n                };\n            },\n            undefineName: function (name) {\n                delete this._names[name.toLowerCase()];\n            },\n            nameValue: function (name) {\n                name = name.toLowerCase();\n                if (name in this._names) {\n                    return this._names[name].value;\n                }\n                return null;\n            },\n            nameDefinition: function (name, def) {\n                name = name.toLowerCase();\n                if (arguments.length > 1) {\n                    if (def === undefined) {\n                        delete this._names[name];\n                    } else {\n                        this._names[name] = def;\n                    }\n                }\n                return this._names[name];\n            },\n            forEachName: function (func) {\n                Object.keys(this._names).forEach(function (name) {\n                    func(this._names[name], name);\n                }, this);\n            },\n            adjustNames: function (affectedSheet, forRow, start, delta) {\n                affectedSheet = affectedSheet.toLowerCase();\n                Object.keys(this._names).forEach(function (name) {\n                    var def = this._names[name];\n                    var x = def.value;\n                    if (x instanceof Ref && x.sheet.toLowerCase() == affectedSheet) {\n                        def.value = x.adjust(null, null, null, null, forRow, start, delta);\n                    } else if (x instanceof Formula) {\n                        x.adjust(affectedSheet, forRow ? 'row' : 'col', start, delta);\n                    }\n                }, this);\n            },\n            options: {}\n        });\n        function sheetParamsFromJSON(data, options) {\n            function or(a, b, c) {\n                return a !== undefined ? a : b !== undefined ? b : c;\n            }\n            var rowCount = or(data.rowCount, options.rows, 200), columnCount = or(data.columnCount, options.columns, 50), rowHeight = or(data.rowHeight, options.rowHeight, 20), columnWidth = or(data.columnWidth, options.columnWidth, 64), headerHeight = or(data.headerHeight, options.headerHeight, 20), headerWidth = or(data.headerWidth, options.headerWidth, 32);\n            if (data.rows !== undefined) {\n                for (var i = 0; i < data.rows.length; ++i) {\n                    var row = data.rows[i];\n                    var ri = or(row.index, i);\n                    if (ri >= rowCount) {\n                        rowCount = ri + 1;\n                    }\n                    if (row.cells) {\n                        for (var j = 0; j < row.cells.length; ++j) {\n                            var cell = row.cells[j];\n                            var ci = or(cell.index, j);\n                            if (ci >= columnCount) {\n                                columnCount = ci + 1;\n                            }\n                        }\n                    }\n                }\n            }\n            return {\n                rowCount: rowCount,\n                columnCount: columnCount,\n                rowHeight: rowHeight,\n                columnWidth: columnWidth,\n                headerHeight: headerHeight,\n                headerWidth: headerWidth\n            };\n        }\n        kendo.spreadsheet.Workbook = Workbook;\n        if (kendo.PDFMixin) {\n            kendo.PDFMixin.extend(Workbook.prototype);\n            Workbook.prototype.saveAsPDF = function (options) {\n                var progress = new $.Deferred();\n                var promise = progress.promise();\n                var args = { promise: promise };\n                if (this.trigger('pdfExport', args)) {\n                    return;\n                }\n                this._drawPDF(options, progress).then(function (root) {\n                    return kendo.drawing.exportPDF(root);\n                }).done(function (dataURI) {\n                    kendo.saveAs({\n                        dataURI: dataURI,\n                        fileName: options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy,\n                        proxyTarget: options.proxyTarget\n                    });\n                    progress.resolve();\n                }).fail(function (err) {\n                    progress.reject(err);\n                });\n                return promise;\n            };\n            Workbook.prototype._drawPDF = function (options) {\n                var result = new $.Deferred();\n                var callback = function (group) {\n                    result.resolve(group);\n                };\n                switch (options.area) {\n                case 'workbook':\n                    options.workbook.draw(options, callback);\n                    break;\n                case 'sheet':\n                    options.workbook.activeSheet().draw(options, callback);\n                    break;\n                case 'selection':\n                    options.workbook.activeSheet().selection().draw(options, callback);\n                    break;\n                }\n                return result.promise();\n            };\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulacontext', ['kendo.core'], f);\n}(function () {\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NameRef = spreadsheet.NameRef;\n    var Ref = spreadsheet.Ref;\n    var FormulaContext = kendo.Class.extend({\n        init: function (workbook) {\n            this.workbook = workbook;\n        },\n        getRefCells: function (ref, hiddenInfo, fsheet, frow, fcol) {\n            var sheet, formula, value, i;\n            if (ref instanceof CellRef) {\n                sheet = this.workbook.sheetByName(ref.sheet);\n                if (!sheet || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                formula = sheet.formula(ref);\n                value = sheet.range(ref.row, ref.col).value();\n                if (formula != null || value != null) {\n                    return [{\n                            formula: formula,\n                            value: value,\n                            row: ref.row,\n                            col: ref.col,\n                            sheet: ref.sheet,\n                            hidden: hiddenInfo ? sheet.columnWidth(ref.col) === 0 || sheet.rowHeight(ref.row) === 0 : false\n                        }];\n                } else {\n                    return [];\n                }\n            }\n            if (ref instanceof RangeRef) {\n                i = this.workbook.sheetIndex(ref.sheet);\n                var states = [], n = i;\n                if (ref.endSheet) {\n                    n = this.workbook.sheetIndex(ref.endSheet);\n                    if (i > n) {\n                        var tmp = i;\n                        i = n;\n                        n = tmp;\n                    }\n                }\n                if (i < 0 || n < 0 || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                while (i <= n) {\n                    sheet = this.workbook.sheetByIndex(i++);\n                    var tl = sheet._grid.normalize(ref.topLeft);\n                    var br = sheet._grid.normalize(ref.bottomRight);\n                    var startCellIndex = sheet._grid.cellRefIndex(tl);\n                    var endCellIndex = sheet._grid.cellRefIndex(br);\n                    var values = sheet._properties.iterator('value', startCellIndex, endCellIndex);\n                    for (var col = tl.col; col <= br.col; ++col) {\n                        for (var row = tl.row; row <= br.row; ++row) {\n                            var index = sheet._grid.index(row, col);\n                            formula = sheet._properties.get('formula', index);\n                            value = values.at(index);\n                            if (formula != null || value != null) {\n                                states.push({\n                                    formula: formula,\n                                    value: value,\n                                    row: row,\n                                    col: col,\n                                    sheet: sheet.name(),\n                                    hidden: hiddenInfo ? sheet.columnWidth(col) === 0 || sheet.rowHeight(row) === 0 : false\n                                });\n                            }\n                        }\n                    }\n                }\n                return states;\n            }\n            if (ref instanceof UnionRef) {\n                var a = [];\n                for (i = 0; i < ref.refs.length; ++i) {\n                    a = a.concat(this.getRefCells(ref.refs[i], hiddenInfo, fsheet, frow, fcol));\n                }\n                return a;\n            }\n            if (ref instanceof NameRef) {\n                var val = this.nameValue(ref, fsheet, frow, fcol);\n                if (val instanceof Ref) {\n                    return this.getRefCells(val, hiddenInfo, fsheet, frow, fcol);\n                }\n                return [{ value: val == null ? new kendo.spreadsheet.calc.runtime.CalcError('NAME') : val }];\n            }\n            return [];\n        },\n        nameValue: function (ref, fsheet, frow, fcol) {\n            var val;\n            if (ref.hasSheet()) {\n                val = this.workbook.nameValue(ref.print());\n            } else {\n                ref = ref.clone().setSheet(fsheet, true);\n                val = this.workbook.nameValue(ref.print());\n                if (val == null) {\n                    val = this.workbook.nameValue(ref.name);\n                }\n            }\n            if (val instanceof Ref) {\n                val = val.absolute(frow, fcol);\n            }\n            return val;\n        },\n        getData: function (ref, fsheet, frow, fcol) {\n            var single = ref instanceof CellRef;\n            if (ref instanceof NameRef) {\n                single = this.workbook.nameValue(ref.name) instanceof CellRef;\n            }\n            var data = this.getRefCells(ref, false, fsheet, frow, fcol).map(function (cell) {\n                var val = cell.value;\n                if (val instanceof kendo.spreadsheet.calc.runtime.Formula) {\n                    val = val.value;\n                }\n                return val;\n            });\n            return single ? data[0] : data;\n        },\n        onFormula: function (f) {\n            var sheet = this.workbook.sheetByName(f.sheet);\n            var row = f.row, col = f.col, value = f.value;\n            var currentFormula = sheet.formula({\n                row: row,\n                col: col\n            });\n            if (currentFormula !== f) {\n                return false;\n            }\n            if (value instanceof Ref) {\n                value = this.getData(value, f.sheet, row, col);\n                if (Array.isArray(value)) {\n                    value = value[0];\n                }\n                if (value === undefined) {\n                    value = null;\n                }\n            }\n            if (value instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                value.each(function (value, r, c) {\n                    sheet._value(row + r, col + c, value);\n                });\n            } else {\n                sheet._value(row, col, value);\n            }\n            clearTimeout(sheet._formulaContextRefresh);\n            sheet._formulaContextRefresh = setTimeout(function () {\n                sheet.batch(function () {\n                }, { layout: true });\n            }, 50);\n            return true;\n        }\n    });\n    var ValidationFormulaContext = FormulaContext.extend({\n        onFormula: function () {\n            return true;\n        }\n    });\n    spreadsheet.FormulaContext = FormulaContext;\n    spreadsheet.ValidationFormulaContext = ValidationFormulaContext;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/controller', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        'use strict';\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var alphaNumRegExp = /:alphanum$/;\n        var ACTIONS = {\n            'up': 'up',\n            'down': 'down',\n            'left': 'left',\n            'right': 'right',\n            'home': 'first-col',\n            'ctrl+left': 'first-col',\n            'end': 'last-col',\n            'ctrl+right': 'last-col',\n            'ctrl+up': 'first-row',\n            'ctrl+down': 'last-row',\n            'ctrl+home': 'first',\n            'ctrl+end': 'last',\n            'pageup': 'prev-page',\n            'pagedown': 'next-page'\n        };\n        var ENTRY_ACTIONS = {\n            'tab': 'next',\n            'shift+tab': 'previous',\n            'enter': 'lower',\n            'shift+enter': 'upper',\n            'delete': 'clearContents',\n            'backspace': 'clearContents',\n            'shift+:alphanum': 'edit',\n            ':alphanum': 'edit',\n            'ctrl+:alphanum': 'ctrl',\n            'alt+ctrl+:alphanum': 'edit',\n            ':edit': 'edit'\n        };\n        var CONTAINER_EVENTS = {\n            'wheel': 'onWheel',\n            '*+mousedown': 'onMouseDown',\n            'contextmenu': 'onContextMenu',\n            '*+mousedrag': 'onMouseDrag',\n            '*+mouseup': 'onMouseUp',\n            '*+dblclick': 'onDblClick',\n            'mousemove': 'onMouseMove'\n        };\n        var CLIPBOARD_EVENTS = {\n            '*+pageup': 'onPageUp',\n            '*+pagedown': 'onPageDown',\n            'mouseup': 'onMouseUp',\n            '*+cut': 'onCut',\n            '*+paste': 'onPaste',\n            '*+copy': 'onCopy'\n        };\n        var EDITOR_EVENTS = {\n            'esc': 'onEditorEsc',\n            'enter': 'onEditorBlur',\n            'alt+enter': 'insertNewline',\n            'shift+enter': 'onEditorBlur',\n            'tab': 'onEditorBlur',\n            'shift+tab': 'onEditorBlur'\n        };\n        var FORMULABAR_EVENTS = $.extend({ focus: 'onEditorBarFocus' }, EDITOR_EVENTS);\n        var FORMULAINPUT_EVENTS = $.extend({ focus: 'onEditorCellFocus' }, EDITOR_EVENTS);\n        var SELECTION_MODES = {\n            cell: 'range',\n            rowheader: 'row',\n            columnheader: 'column',\n            topcorner: 'sheet',\n            autofill: 'autofill'\n        };\n        function toActionSelector(selectors) {\n            return selectors.map(function (action) {\n                return '[data-action=\"' + action + '\"]';\n            }).join(',');\n        }\n        var COMPOSITE_UNAVAILABLE_ACTION_SELECTORS = toActionSelector([\n            'cut',\n            'copy',\n            'paste',\n            'insert-left',\n            'insert-right',\n            'insert-above',\n            'insert-below'\n        ]);\n        var UNHIDE_ACTION_SELECTORS = toActionSelector([\n            'unhide-row',\n            'unhide-column'\n        ]);\n        var ACTION_KEYS = [];\n        var SHIFT_ACTION_KEYS = [];\n        var ENTRY_ACTION_KEYS = [];\n        for (var key in ACTIONS) {\n            ACTION_KEYS.push(key);\n            SHIFT_ACTION_KEYS.push('shift+' + key);\n        }\n        for (key in ENTRY_ACTIONS) {\n            ENTRY_ACTION_KEYS.push(key);\n        }\n        CLIPBOARD_EVENTS[ACTION_KEYS] = 'onAction';\n        CLIPBOARD_EVENTS[SHIFT_ACTION_KEYS] = 'onShiftAction';\n        CLIPBOARD_EVENTS[ENTRY_ACTION_KEYS] = 'onEntryAction';\n        FORMULAINPUT_EVENTS[ACTION_KEYS] = 'onEditorAction';\n        FORMULAINPUT_EVENTS[SHIFT_ACTION_KEYS] = 'onEditorShiftAction';\n        var Controller = kendo.Class.extend({\n            init: function (view, workbook) {\n                this.view = view;\n                this.workbook(workbook);\n                this.container = $(view.container);\n                this.clipboardElement = $(view.clipboard);\n                this.cellContextMenu = view.cellContextMenu;\n                this.rowHeaderContextMenu = view.rowHeaderContextMenu;\n                this.colHeaderContextMenu = view.colHeaderContextMenu;\n                this.scroller = view.scroller;\n                this.tabstrip = view.tabstrip;\n                this.sheetsbar = view.sheetsbar;\n                view.nameEditor.bind('enter', this.onNameEditorEnter.bind(this));\n                view.nameEditor.bind('cancel', this.onNameEditorCancel.bind(this));\n                view.nameEditor.bind('select', this.onNameEditorSelect.bind(this));\n                view.nameEditor.bind('delete', this.onNameEditorDelete.bind(this));\n                this.editor = view.editor;\n                this.editor.bind('change', this.onEditorChange.bind(this));\n                this.editor.bind('activate', this.onEditorActivate.bind(this));\n                this.editor.bind('deactivate', this.onEditorDeactivate.bind(this));\n                this.editor.bind('update', this.onEditorUpdate.bind(this));\n                $(view.scroller).on('scroll', this.onScroll.bind(this));\n                this.listener = new kendo.spreadsheet.EventListener(this.container, this, CONTAINER_EVENTS);\n                this._enableEditorEvents();\n                if (this.sheetsbar) {\n                    this.sheetsbar.bind('select', this.onSheetBarSelect.bind(this));\n                    this.sheetsbar.bind('reorder', this.onSheetBarReorder.bind(this));\n                    this.sheetsbar.bind('rename', this.onSheetBarRename.bind(this));\n                    this.sheetsbar.bind('remove', this.onSheetBarRemove.bind(this));\n                }\n                this.cellContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.rowHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.colHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.cellContextMenu.element.add(this.rowHeaderContextMenu.element).add(this.colHeaderContextMenu.element).on('contextmenu', false);\n                if (this.tabstrip) {\n                    this.tabstrip.bind('action', this.onCommandRequest.bind(this));\n                    this.tabstrip.bind('dialog', this.onDialogRequest.bind(this));\n                }\n            },\n            _enableEditorEvents: function (enable) {\n                if (enable === undefined || enable) {\n                    this.keyListener = new kendo.spreadsheet.EventListener(this.clipboardElement, this, CLIPBOARD_EVENTS);\n                    this.barKeyListener = new kendo.spreadsheet.EventListener(this.editor.barElement(), this, FORMULABAR_EVENTS);\n                    this.inputKeyListener = new kendo.spreadsheet.EventListener(this.editor.cellElement(), this, FORMULAINPUT_EVENTS);\n                } else {\n                    this.keyListener.destroy();\n                    this.barKeyListener.destroy();\n                    this.inputKeyListener.destroy();\n                }\n            },\n            _execute: function (options) {\n                var result = this._workbook.execute(options);\n                if (options.command === 'EditCommand' && !result) {\n                    this._workbook.trigger('change', { editorClose: true });\n                }\n                if (result) {\n                    var closeHandler;\n                    if (this.view.editor.isActive()) {\n                        this.enableEditor(false);\n                        closeHandler = this.enableEditor.bind(this, true, true);\n                    }\n                    if (result.reason === 'error') {\n                        this._lastCommandRequest = null;\n                        this.view.showError(result, closeHandler);\n                    } else {\n                        this.view.openDialog(result.reason, { close: closeHandler });\n                    }\n                }\n                return result;\n            },\n            _activeTooltip: function () {\n                return this._workbook.activeSheet().activeCell().simplify().toString();\n            },\n            onContextMenuSelect: function (e) {\n                var action = $(e.item).data('action');\n                var command;\n                switch (action) {\n                case 'cut':\n                    command = {\n                        command: 'ToolbarCutCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'copy':\n                    command = {\n                        command: 'ToolbarCopyCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'paste':\n                    command = {\n                        command: 'ToolbarPasteCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'unmerge':\n                    command = {\n                        command: 'MergeCellCommand',\n                        options: { value: 'unmerge' }\n                    };\n                    break;\n                case 'merge':\n                    this.view.openDialog('merge');\n                    break;\n                case 'hide-row':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'hide-column':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'unhide-row':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'unhide-column':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'delete-row':\n                    command = { command: 'DeleteRowCommand' };\n                    break;\n                case 'delete-column':\n                    command = { command: 'DeleteColumnCommand' };\n                    break;\n                }\n                if (command) {\n                    this._execute(command);\n                }\n            },\n            onSheetBarRemove: function (e) {\n                var sheet = this._workbook.sheetByName(e.name);\n                if (!sheet) {\n                    return;\n                }\n                this._workbook.removeSheet(sheet);\n            },\n            destroy: function () {\n                this.listener.destroy();\n                this._enableEditorEvents(false);\n                this.keyListener.destroy();\n                this.inputKeyListener.destroy();\n            },\n            onSheetBarSelect: function (e) {\n                var sheet;\n                var workbook = this._workbook;\n                if (e.isAddButton) {\n                    sheet = workbook.insertSheet();\n                } else {\n                    sheet = workbook.sheetByName(e.name);\n                }\n                if (workbook.activeSheet().name() !== sheet.name()) {\n                    workbook.activeSheet(sheet);\n                }\n            },\n            onSheetBarReorder: function (e) {\n                var sheet = this._workbook.sheetByIndex(e.oldIndex);\n                this._workbook.moveSheetToIndex(sheet, e.newIndex);\n                this._workbook.activeSheet(sheet);\n            },\n            onSheetBarRename: function (e) {\n                var sheet = this._workbook.sheetByIndex(e.sheetIndex);\n                if (this._workbook.sheetByName(e.name)) {\n                    this.view.showError({\n                        reason: 'error',\n                        type: 'duplicateSheetName'\n                    });\n                    return;\n                }\n                this._workbook.renameSheet(sheet, e.name);\n                this.clipboardElement.focus();\n            },\n            sheet: function (sheet) {\n                this.navigator = sheet.navigator();\n                this.axisManager = sheet.axisManager();\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n                this.clipboard = workbook.clipboard();\n                workbook.bind('commandRequest', this.onCommandRequest.bind(this));\n            },\n            refresh: function () {\n                var editor = this.editor;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                this._viewPortHeight = this.view.scroller.clientHeight;\n                this.navigator.height(this._viewPortHeight);\n                if (!editor.isActive() && !this.isEditorDisabled) {\n                    editor.enable(sheet.selection().enable() !== false);\n                    editor.value(workbook._inputForRef(sheet.activeCell()));\n                }\n                var ref = sheet.selection()._ref.simplify();\n                var def = this._workbook.nameForRef(ref, sheet.name());\n                this.view.nameEditor.value(def.name);\n            },\n            onScroll: function () {\n                this.view.render();\n            },\n            onWheel: function (event) {\n                var deltaX = event.originalEvent.deltaX;\n                var deltaY = event.originalEvent.deltaY;\n                if (event.originalEvent.deltaMode === 1) {\n                    deltaX *= 10;\n                    deltaY *= 10;\n                }\n                this.scrollWith(deltaX, deltaY);\n                event.preventDefault();\n            },\n            onAction: function (event, action) {\n                this.navigator.moveActiveCell(ACTIONS[action]);\n                event.preventDefault();\n            },\n            onPageUp: function () {\n                this.scrollDown(-this._viewPortHeight);\n            },\n            onPageDown: function () {\n                this.scrollDown(this._viewPortHeight);\n            },\n            onEntryAction: function (event, action) {\n                if (event.mod) {\n                    var shouldPrevent = true;\n                    var key = String.fromCharCode(event.keyCode);\n                    switch (key) {\n                    case 'A':\n                        this.navigator.selectAll();\n                        break;\n                    case 'Y':\n                        this._workbook.undoRedoStack.redo();\n                        break;\n                    case 'Z':\n                        this._workbook.undoRedoStack.undo();\n                        break;\n                    default:\n                        shouldPrevent = false;\n                        break;\n                    }\n                    if (shouldPrevent) {\n                        event.preventDefault();\n                    }\n                } else {\n                    var disabled = this._workbook.activeSheet().selection().enable() === false;\n                    if (action == 'delete' || action == 'backspace') {\n                        if (!disabled) {\n                            this._execute({ command: 'ClearContentCommand' });\n                        }\n                        event.preventDefault();\n                    } else if (alphaNumRegExp.test(action) || action === ':edit') {\n                        if (disabled) {\n                            event.preventDefault();\n                            return;\n                        }\n                        if (action !== ':edit') {\n                            this.editor.value('');\n                        }\n                        this.editor.activate({\n                            range: this._workbook.activeSheet()._viewActiveCell(),\n                            rect: this.view.activeCellRectangle(),\n                            tooltip: this._activeTooltip()\n                        }).focus();\n                    } else {\n                        this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                        event.preventDefault();\n                    }\n                }\n            },\n            onShiftAction: function (event, action) {\n                this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                event.preventDefault();\n            },\n            onMouseMove: function (event) {\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress() || sheet.selectionInProgress()) {\n                    return;\n                }\n                var object = this.objectAt(event);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.positionResizeHandle(object.ref);\n                } else {\n                    sheet.removeResizeHandle();\n                }\n            },\n            onMouseDown: function (event) {\n                var object = this.objectAt(event);\n                if (object.pane) {\n                    this.originFrame = object.pane;\n                }\n                if (object.type === 'editor') {\n                    this.onEditorEsc();\n                    this.openCustomEditor();\n                    event.preventDefault();\n                    return;\n                }\n                if (this.editor.canInsertRef(false) && object.ref) {\n                    this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n                    this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey);\n                    event.preventDefault();\n                    return;\n                } else {\n                    this.editor.deactivate();\n                    if (this.editor.isActive()) {\n                        event.preventDefault();\n                        return;\n                    }\n                }\n                var sheet = this._workbook.activeSheet();\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.startResizing({\n                        x: object.x,\n                        y: object.y\n                    });\n                    event.preventDefault();\n                    return;\n                }\n                if (object.type === 'filtericon') {\n                    this.openFilterMenu(event);\n                    event.preventDefault();\n                    return;\n                }\n                this._selectionMode = SELECTION_MODES[object.type];\n                this.appendSelection = event.mod;\n                this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey);\n            },\n            onContextMenu: function (event) {\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress()) {\n                    return;\n                }\n                event.preventDefault();\n                this.cellContextMenu.close();\n                this.colHeaderContextMenu.close();\n                this.rowHeaderContextMenu.close();\n                var menu;\n                var location = {\n                    pageX: event.pageX,\n                    pageY: event.pageY\n                };\n                var object = this.objectAt(location);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    return;\n                }\n                this.navigator.selectForContextMenu(object.ref, SELECTION_MODES[object.type]);\n                var isComposite = this.navigator._sheet.select() instanceof kendo.spreadsheet.UnionRef;\n                var showUnhide = false;\n                var showUnmerge = false;\n                if (object.type == 'columnheader') {\n                    menu = this.colHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenColumns();\n                } else if (object.type == 'rowheader') {\n                    menu = this.rowHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenRows();\n                } else {\n                    menu = this.cellContextMenu;\n                    showUnmerge = this.navigator.selectionIncludesMergedCells();\n                }\n                menu.element.find(COMPOSITE_UNAVAILABLE_ACTION_SELECTORS).toggle(!isComposite);\n                menu.element.find(UNHIDE_ACTION_SELECTORS).toggle(showUnhide);\n                menu.element.find('[data-action=unmerge]').toggle(showUnmerge);\n                setTimeout(function () {\n                    menu.open(event.pageX, event.pageY);\n                });\n            },\n            prevent: function (event) {\n                event.preventDefault();\n            },\n            constrainResize: function (type, ref) {\n                var sheet = this._workbook.activeSheet();\n                var resizeHandle = sheet.resizeHandlePosition();\n                return !resizeHandle || type === 'outside' || type === 'topcorner' || ref.col < resizeHandle.col || ref.row < resizeHandle.row;\n            },\n            onMouseDrag: function (event) {\n                if (this._selectionMode === 'sheet') {\n                    return;\n                }\n                var location = {\n                    pageX: event.pageX,\n                    pageY: event.pageY\n                };\n                var object = this.objectAt(location);\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress()) {\n                    if (!this.constrainResize(object.type, object.ref)) {\n                        sheet.resizeHintPosition({\n                            x: object.x,\n                            y: object.y\n                        });\n                    }\n                    return;\n                }\n                if (object.type === 'outside') {\n                    this.startAutoScroll(object);\n                    return;\n                }\n                if (this.originFrame === object.pane) {\n                    this.selectToLocation(location);\n                } else {\n                    var frame = this.originFrame._grid;\n                    if (object.x > frame.right) {\n                        this.scrollLeft();\n                    }\n                    if (object.y > frame.bottom) {\n                        this.scrollTop();\n                    }\n                    if (object.y < frame.top || object.x < frame.left) {\n                        this.startAutoScroll(object, location);\n                    } else {\n                        this.selectToLocation(location);\n                    }\n                }\n                event.preventDefault();\n            },\n            onMouseUp: function (event) {\n                var sheet = this._workbook.activeSheet();\n                sheet.completeResizing();\n                this.navigator.completeSelection();\n                this.stopAutoScroll();\n                var editor = this.editor.activeEditor();\n                if (!editor) {\n                    return;\n                }\n                var el = event.target;\n                while (el) {\n                    if (el === editor.element[0]) {\n                        return;\n                    }\n                    el = el.parentNode;\n                }\n                var object = this.objectAt(event);\n                if (object && object.ref && editor.canInsertRef(false)) {\n                    editor.refAtPoint(sheet.selection()._ref);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                }\n            },\n            onDblClick: function (event) {\n                var object = this.objectAt(event);\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (object.type !== 'cell' || disabled) {\n                    return;\n                }\n                this.editor.activate({\n                    range: this._workbook.activeSheet()._viewActiveCell(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                }).focus();\n                this.onEditorUpdate();\n            },\n            onCut: function (e) {\n                if (e) {\n                    var table = this.clipboardElement.find('table.kendo-clipboard-' + this.clipboard._uid).detach();\n                    this.clipboardElement.append(table.clone(false));\n                    setTimeout(function () {\n                        this.clipboardElement.empty().append(table);\n                    }.bind(this));\n                }\n                this._execute({\n                    command: 'CutCommand',\n                    options: {\n                        workbook: this.view._workbook,\n                        event: e.originalEvent || e\n                    }\n                });\n            },\n            clipBoardValue: function () {\n                return this.clipboardElement.html();\n            },\n            onPaste: function (e) {\n                var html = '';\n                var plain = '';\n                this.clipboard.menuInvoked = e === undefined;\n                if (e) {\n                    if (e.originalEvent.clipboardData && e.originalEvent.clipboardData.getData) {\n                        e.preventDefault();\n                        var hasHTML = false;\n                        var hasPlainText = false;\n                        if (window.DOMStringList && e.originalEvent.clipboardData.types instanceof window.DOMStringList) {\n                            hasHTML = e.originalEvent.clipboardData.types.contains('text/html');\n                            hasPlainText = e.originalEvent.clipboardData.types.contains('text/plain');\n                        } else {\n                            hasHTML = /text\\/html/.test(e.originalEvent.clipboardData.types);\n                            hasPlainText = /text\\/plain/.test(e.originalEvent.clipboardData.types);\n                        }\n                        if (hasHTML) {\n                            html = e.originalEvent.clipboardData.getData('text/html');\n                        }\n                        if (hasPlainText) {\n                            plain = e.originalEvent.clipboardData.getData('text/plain').trim();\n                        }\n                    } else {\n                        var table = this.clipboardElement.find('table.kendo-clipboard-' + this.clipboard._uid).detach();\n                        this.clipboardElement.empty();\n                        setTimeout(function () {\n                            var html = this.clipboardElement.html();\n                            var plain = window.clipboardData.getData('Text').trim();\n                            if (!html && !plain) {\n                                return;\n                            }\n                            this.clipboard.external({\n                                html: html,\n                                plain: plain\n                            });\n                            this.clipboardElement.empty().append(table);\n                            this._execute({\n                                command: 'PasteCommand',\n                                options: {\n                                    workbook: this.view._workbook,\n                                    event: e.originalEvent || e\n                                }\n                            });\n                            this.clipboard.menuInvoked = true;\n                        }.bind(this));\n                        return;\n                    }\n                } else {\n                    if (kendo.support.browser.msie) {\n                        this.clipboardElement.focus().select();\n                        document.execCommand('paste');\n                        return;\n                    } else {\n                        this.clipboard.menuInvoked = true;\n                    }\n                }\n                if (!html && !plain) {\n                    return;\n                }\n                this.clipboard.external({\n                    html: html,\n                    plain: plain\n                });\n                this._execute({\n                    command: 'PasteCommand',\n                    options: {\n                        workbook: this.view._workbook,\n                        event: e.originalEvent || e\n                    }\n                });\n            },\n            onCopy: function (e) {\n                this.clipboard.menuInvoked = e === undefined;\n                this._execute({\n                    command: 'CopyCommand',\n                    options: {\n                        workbook: this.view._workbook,\n                        event: e.originalEvent || e\n                    }\n                });\n            },\n            scrollTop: function () {\n                this.scroller.scrollTop = 0;\n            },\n            scrollLeft: function () {\n                this.scroller.scrollLeft = 0;\n            },\n            scrollDown: function (value) {\n                this.scroller.scrollTop += value;\n            },\n            scrollRight: function (value) {\n                this.scroller.scrollLeft += value;\n            },\n            scrollWith: function (right, down) {\n                this.scroller.scrollTop += down;\n                this.scroller.scrollLeft += right;\n            },\n            objectAt: function (location) {\n                var offset = this.container.offset();\n                var coordinates = {\n                    left: location.pageX - offset.left,\n                    top: location.pageY - offset.top\n                };\n                return this.view.objectAt(coordinates.left, coordinates.top);\n            },\n            selectToLocation: function (cellLocation) {\n                var object = this.objectAt(cellLocation);\n                if (object.pane) {\n                    this.extendSelection(object);\n                    this.lastKnownCellLocation = cellLocation;\n                    this.originFrame = object.pane;\n                }\n                this.stopAutoScroll();\n            },\n            extendSelection: function (object) {\n                this.navigator.extendSelection(object.ref, this._selectionMode, this.appendSelection);\n            },\n            autoScroll: function () {\n                var x = this._autoScrollTarget.x;\n                var y = this._autoScrollTarget.y;\n                var boundaries = this.originFrame._grid;\n                var scroller = this.view.scroller;\n                var scrollStep = 8;\n                var scrollLeft = scroller.scrollLeft;\n                var scrollTop = scroller.scrollTop;\n                if (x < boundaries.left) {\n                    this.scrollRight(-scrollStep);\n                }\n                if (x > boundaries.right) {\n                    this.scrollRight(scrollStep);\n                }\n                if (y < boundaries.top) {\n                    this.scrollDown(-scrollStep);\n                }\n                if (y > boundaries.bottom) {\n                    this.scrollDown(scrollStep);\n                }\n                if (scrollTop === scroller.scrollTop && scrollLeft === scroller.scrollLeft) {\n                    this.selectToLocation(this.finalLocation);\n                } else {\n                    this.extendSelection(this.objectAt(this.lastKnownCellLocation));\n                }\n            },\n            startAutoScroll: function (viewObject, location) {\n                if (!this._scrollInterval) {\n                    this._scrollInterval = setInterval(this.autoScroll.bind(this), 50);\n                }\n                this.finalLocation = location || this.lastKnownCellLocation;\n                this._autoScrollTarget = viewObject;\n            },\n            stopAutoScroll: function () {\n                clearInterval(this._scrollInterval);\n                this._scrollInterval = null;\n            },\n            openCustomEditor: function () {\n                this.view.openCustomEditor();\n            },\n            openFilterMenu: function (event) {\n                var object = this.objectAt(event);\n                var sheet = this._workbook.activeSheet();\n                var column = sheet.filterColumn(object.ref);\n                var filterMenu = this.view.createFilterMenu(column);\n                filterMenu.bind('action', this.onCommandRequest.bind(this));\n                filterMenu.bind('action', filterMenu.close.bind(filterMenu));\n                filterMenu.openFor(event.target);\n            },\n            onEditorChange: function (e) {\n                this._workbook.activeSheet().isInEditMode(false);\n                var result = this._execute({\n                    command: 'EditCommand',\n                    options: {\n                        editActiveCell: true,\n                        value: e.value\n                    }\n                });\n                if (result && result.reason === 'error') {\n                    e.preventDefault();\n                }\n            },\n            onEditorActivate: function () {\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                sheet._setFormulaSelections(this.editor.highlightedRefs());\n                sheet.isInEditMode(true);\n            },\n            onEditorDeactivate: function () {\n                var sheet = this._workbook.activeSheet();\n                sheet.isInEditMode(false);\n                sheet._setFormulaSelections([]);\n            },\n            onEditorUpdate: function () {\n                this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n            },\n            onEditorBarFocus: function () {\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (disabled) {\n                    return;\n                }\n                this.editor.activate({\n                    range: this._workbook.activeSheet()._viewActiveCell(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                });\n            },\n            onEditorCellFocus: function () {\n                this.editor.scale();\n            },\n            onEditorEsc: function () {\n                this.resetEditorValue();\n                this.editor.deactivate();\n                this.clipboardElement.focus();\n            },\n            insertNewline: function (e) {\n                e.preventDefault();\n                this.editor.insertNewline();\n            },\n            onEditorBlur: function (_, action) {\n                if (this.editor.isFiltered()) {\n                    return;\n                }\n                this.editor.deactivate();\n                if (!this.editor.isActive()) {\n                    this.clipboardElement.focus();\n                    this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                }\n            },\n            onEditorAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (editor.canInsertRef(true)) {\n                    this.navigator.moveActiveCell(ACTIONS[action]);\n                    editor.activeEditor().refAtPoint(sheet.selection()._ref);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            onEditorShiftAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (editor.canInsertRef(true)) {\n                    this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                    editor.activeEditor().refAtPoint(sheet.selection()._ref);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            resetEditorValue: function () {\n                this.editor.value(this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell()));\n            },\n            deactivateEditor: function (callback, options) {\n                var viewEditor = this.view.editor;\n                this._lastCommandRequest = {\n                    callback: callback,\n                    options: options\n                };\n                if (!this.isEditorDeactivateBound) {\n                    this.isEditorDeactivateBound = true;\n                    viewEditor.one('deactivate', function () {\n                        this.isEditorDeactivateBound = false;\n                        if (this._lastCommandRequest) {\n                            this._lastCommandRequest.callback(this._lastCommandRequest.options);\n                            this._lastCommandRequest = null;\n                        }\n                    }.bind(this));\n                }\n                viewEditor.deactivate();\n                this.enableEditor(false);\n            },\n            enableEditor: function (enable, focusLastActive, event) {\n                if (event && event.action === 'revert') {\n                    this.resetEditorValue();\n                }\n                enable = enable === undefined || enable;\n                this._enableEditorEvents(enable);\n                this.editor.enableEditing(enable);\n                this.isEditorDisabled = !enable;\n                this.view.enableClipboard(enable);\n                if (focusLastActive) {\n                    this.editor.focusLastActive();\n                }\n            },\n            executeRequest: function (callback, options) {\n                if (this.view.editor.isActive()) {\n                    this.deactivateEditor(callback, options);\n                } else {\n                    callback(options);\n                }\n            },\n            onCommandRequest: function (e) {\n                var executeCommand = function (e) {\n                    if (e.command) {\n                        this._execute(e);\n                    } else {\n                        this._workbook.undoRedoStack[e.action]();\n                    }\n                }.bind(this);\n                this.executeRequest(executeCommand, e);\n            },\n            onDialogRequest: function (e) {\n                var executeDialog = function (e) {\n                    this.enableEditor(false);\n                    var additionalOptions = {\n                        pdfExport: this._workbook.options.pdf,\n                        excelExport: this._workbook.options.excel,\n                        close: this.enableEditor.bind(this, true, false)\n                    };\n                    if (e.options) {\n                        $.extend(true, e.options, additionalOptions);\n                    } else {\n                        e.options = additionalOptions;\n                    }\n                    this.view.openDialog(e.name, e.options);\n                }.bind(this);\n                this.executeRequest(executeDialog, e);\n            },\n            onNameEditorEnter: function () {\n                var ref;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                var name = this.view.nameEditor.value();\n                ref = kendo.spreadsheet.calc.parseReference(name, true) || workbook.nameValue(name);\n                if (ref instanceof kendo.spreadsheet.Ref) {\n                    if (ref.sheet && ref.sheet.toLowerCase() != sheet.name().toLowerCase()) {\n                        var tmp = workbook.sheetByName(ref.sheet);\n                        if (tmp) {\n                            workbook.activeSheet(tmp);\n                            sheet = tmp;\n                        }\n                    }\n                    sheet.range(ref).select();\n                    return;\n                }\n                ref = sheet.selection()._ref.clone().simplify().setSheet(sheet.name(), true);\n                this._execute({\n                    command: 'DefineNameCommand',\n                    options: {\n                        name: name,\n                        value: ref\n                    }\n                });\n                this.clipboardElement.focus();\n            },\n            onNameEditorCancel: function () {\n                this.clipboardElement.focus();\n            },\n            onNameEditorSelect: function (ev) {\n                var name = ev.name;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                var ref = workbook.nameValue(name);\n                if (ref instanceof kendo.spreadsheet.Ref) {\n                    if (ref.sheet && ref.sheet.toLowerCase() != sheet.name().toLowerCase()) {\n                        var tmp = workbook.sheetByName(ref.sheet);\n                        if (tmp) {\n                            workbook.activeSheet(tmp);\n                            sheet = tmp;\n                        }\n                    }\n                    sheet.range(ref).select();\n                    return;\n                }\n                this.clipboardElement.focus();\n            },\n            onNameEditorDelete: function (ev) {\n                this._execute({\n                    command: 'DeleteNameCommand',\n                    options: { name: ev.name }\n                });\n                this.clipboardElement.focus();\n            }\n        });\n        kendo.spreadsheet.Controller = Controller;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/view', [\n        'kendo.core',\n        'kendo.menu',\n        'spreadsheet/sheetsbar'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var DOT = '.';\n        var RESIZE_HANDLE_WIDTH = 7;\n        var viewClassNames = {\n            view: 'k-spreadsheet-view',\n            fixedContainer: 'k-spreadsheet-fixed-container',\n            editContainer: 'k-spreadsheet-edit-container',\n            scroller: 'k-spreadsheet-scroller',\n            viewSize: 'k-spreadsheet-view-size',\n            clipboard: 'k-spreadsheet-clipboard',\n            cellEditor: 'k-spreadsheet-cell-editor',\n            barEditor: 'k-spreadsheet-editor',\n            topCorner: 'k-spreadsheet-top-corner',\n            filterHeadersWrapper: 'k-filter-wrapper',\n            filterRange: 'k-filter-range',\n            filterButton: 'k-spreadsheet-filter',\n            filterButtonActive: 'k-state-active',\n            horizontalResize: 'k-horizontal-resize',\n            verticalResize: 'k-vertical-resize',\n            icon: 'k-icon k-font-icon',\n            iconFilterDefault: 'k-i-arrow-s',\n            sheetsBar: 'k-spreadsheet-sheets-bar',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            cellContextMenu: 'k-spreadsheet-cell-context-menu',\n            rowHeaderContextMenu: 'k-spreadsheet-row-header-context-menu',\n            colHeaderContextMenu: 'k-spreadsheet-col-header-context-menu'\n        };\n        kendo.spreadsheet.messages.view = {\n            errors: {\n                openUnsupported: 'Unsupported format. Please select an .xlsx file.',\n                shiftingNonblankCells: 'Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.',\n                filterRangeContainingMerges: 'Cannot create a filter within a range containing merges',\n                sortRangeContainingMerges: 'Cannot sort a range containing merges',\n                validationError: 'The value that you entered violates the validation rules set on the cell.',\n                cannotModifyDisabled: 'Cannot modify disabled cells.'\n            },\n            tabs: {\n                home: 'Home',\n                insert: 'Insert',\n                data: 'Data'\n            }\n        };\n        function selectElementContents(el) {\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            var range = document.createRange();\n            range.selectNodeContents(el);\n            sel.addRange(range);\n        }\n        function cellBefore(table, row) {\n            var cells = table.trs[row].children;\n            return cells[cells.length - 2];\n        }\n        function cellAbove(table, row) {\n            var prevRow = table.trs[row - 1];\n            var index = table.trs[row].children.length - 1;\n            if (prevRow && index >= 0) {\n                return prevRow.children[index];\n            }\n        }\n        function cellBorder(value) {\n            return [\n                'solid',\n                (value.size || 1) + 'px',\n                value.color || '#000'\n            ].join(' ');\n        }\n        function asURL(link) {\n            if (!/:\\/\\//.test(link)) {\n                link = 'http://' + link;\n            }\n            return link;\n        }\n        function drawCell(collection, cell, cls, hBorders, vBorders, showGrid) {\n            function maybeLink(el) {\n                var link = cell.link;\n                if (!link) {\n                    if (typeof cell.value == 'object') {\n                        link = cell.value.link;\n                    }\n                }\n                if (link) {\n                    var style = { textDecoration: 'none' };\n                    if (cell.color) {\n                        style.color = cell.color;\n                    }\n                    if (cell.underline) {\n                        style.textDecoration = 'underline';\n                    }\n                    return kendo.dom.element('a', {\n                        href: asURL(link),\n                        style: style,\n                        target: '_blank'\n                    }, el ? [el] : []);\n                }\n                return el;\n            }\n            if (!cls && !kendo.spreadsheet.draw.shouldDrawCell(cell)) {\n                return;\n            }\n            var left = cell.left;\n            var top = cell.top;\n            var width = cell.width + 1;\n            var height = cell.height + 1;\n            var style = {};\n            var background = cell.background;\n            var defaultBorder = null;\n            if (background) {\n                defaultBorder = background;\n                if (showGrid) {\n                    defaultBorder = kendo.parseColor(defaultBorder).toHSV();\n                    defaultBorder.v *= 0.9;\n                    defaultBorder = defaultBorder.toCssRgba();\n                }\n                defaultBorder = cellBorder({ color: defaultBorder });\n            }\n            if (background) {\n                style.backgroundColor = background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n                style.wordBreak = 'break-all';\n            }\n            if (cell.borderLeft) {\n                style.borderLeft = cellBorder(cell.borderLeft);\n                if (vBorders) {\n                    vBorders[cell.left] = true;\n                }\n            } else if (defaultBorder && vBorders && !vBorders[cell.left]) {\n                style.borderLeft = defaultBorder;\n            } else {\n                left++;\n                width--;\n            }\n            if (cell.borderTop) {\n                style.borderTop = cellBorder(cell.borderTop);\n                if (hBorders) {\n                    hBorders[cell.top] = true;\n                }\n            } else if (defaultBorder && hBorders && !hBorders[cell.top]) {\n                style.borderTop = defaultBorder;\n            } else {\n                top++;\n                height--;\n            }\n            if (cell.borderRight) {\n                style.borderRight = cellBorder(cell.borderRight);\n                if (vBorders) {\n                    vBorders[cell.right] = true;\n                }\n            } else if (defaultBorder && vBorders && !vBorders[cell.right]) {\n                style.borderRight = defaultBorder;\n            } else {\n                width--;\n            }\n            if (cell.borderBottom) {\n                style.borderBottom = cellBorder(cell.borderBottom);\n                if (hBorders) {\n                    hBorders[cell.bottom] = true;\n                }\n            } else if (defaultBorder && hBorders && !hBorders[cell.bottom]) {\n                style.borderBottom = defaultBorder;\n            } else {\n                height--;\n            }\n            style.left = left + 'px';\n            style.top = top + 'px';\n            style.width = width + 'px';\n            style.height = height + 'px';\n            var data = cell.value, type = typeof data;\n            if (cell.format && data != null) {\n                data = kendo.spreadsheet.formatting.format(data, cell.format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            } else if (data !== null && data !== undefined) {\n                data = kendo.dom.text(data);\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            var classNames = [paneClassNames.cell];\n            if (cls) {\n                classNames.push(cls);\n            }\n            if (cell.enable === false) {\n                classNames.push('k-state-disabled');\n            }\n            if (cell.merged) {\n                classNames.push('k-spreadsheet-merged-cell');\n            }\n            var verticalAlign = cell.verticalAlign || 'bottom';\n            if (verticalAlign && data) {\n                data = kendo.dom.element('div', { className: 'k-vertical-align-' + verticalAlign }, [maybeLink(data)]);\n            } else {\n                data = maybeLink(data);\n            }\n            var children = data ? [data] : [];\n            var properties = { style: style };\n            var validation = cell.validation;\n            if (validation && !validation.value) {\n                children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                classNames.push('k-dirty-cell');\n                properties.title = validation._getOptions().messageTemplate;\n            }\n            properties.className = classNames.join(' ');\n            var div = kendo.dom.element('div', properties, children);\n            collection.push(div);\n            return div;\n        }\n        function addCell(table, row, cell) {\n            var style = {};\n            if (cell.background) {\n                style.backgroundColor = cell.background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.verticalAlign) {\n                style.verticalAlign = cell.verticalAlign === 'center' ? 'middle' : cell.verticalAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n                style.wordBreak = 'break-all';\n            }\n            if (cell.borderRight) {\n                style.borderRight = cellBorder(cell.borderRight);\n            } else if (cell.background) {\n                style.borderRightColor = cell.background;\n            }\n            if (cell.borderBottom) {\n                style.borderBottom = cellBorder(cell.borderBottom);\n            } else if (cell.background) {\n                style.borderBottomColor = cell.background;\n            }\n            var data = cell.value, type = typeof data;\n            if (cell.format && data != null) {\n                data = kendo.spreadsheet.formatting.format(data, cell.format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            var className = null;\n            if (cell.enable === false) {\n                className = 'k-state-disabled';\n            }\n            var td = table.addCell(row, data, style, className, cell.validation);\n            var border, sibling;\n            if (cell.borderLeft) {\n                sibling = cellBefore(table, row);\n                border = cellBorder(cell.borderLeft);\n                if (sibling && border) {\n                    sibling.attr.style.borderRight = border;\n                }\n            } else if (cell.background) {\n                style.borderLeftColor = cell.background;\n            }\n            if (cell.borderTop) {\n                sibling = cellAbove(table, row);\n                border = cellBorder(cell.borderTop);\n                if (sibling && border) {\n                    sibling.attr.style.borderBottom = border;\n                }\n            } else if (cell.background) {\n                style.borderTopColor = cell.background;\n            }\n            return td;\n        }\n        var HtmlTable = kendo.Class.extend({\n            init: function () {\n                this.cols = [];\n                this.trs = [];\n                this._height = 0;\n                this._width = 0;\n            },\n            addColumn: function (width) {\n                this._width += width;\n                var col = kendo.dom.element('col', { style: { width: width + 'px' } });\n                col.visible = width > 0;\n                this.cols.push(col);\n            },\n            addRow: function (height) {\n                var attr = null;\n                attr = { style: { height: height + 'px' } };\n                this._height += height;\n                var tr = kendo.dom.element('tr', attr);\n                tr.visible = height > 0;\n                this.trs.push(tr);\n            },\n            addCell: function (rowIndex, text, style, className, validation) {\n                if (text === null || text === undefined) {\n                    text = '';\n                }\n                if (!(text instanceof kendo.dom.Node)) {\n                    text = kendo.dom.text(text);\n                }\n                var children = [text];\n                var properties = { style: style };\n                if (validation && !validation.value) {\n                    children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                    className = (className || '') + (className ? ' ' : '') + 'k-dirty-cell';\n                    properties.title = validation._getOptions().messageTemplate;\n                }\n                if (className) {\n                    properties.className = className;\n                }\n                var td = kendo.dom.element('td', properties, children);\n                this.trs[rowIndex].children.push(td);\n                return td;\n            },\n            toDomTree: function (x, y, className) {\n                this.trs = this.trs.filter(function (tr) {\n                    return tr.visible;\n                });\n                var offset = 0;\n                this.cols = this.cols.filter(function (col, ci) {\n                    if (!col.visible) {\n                        this.trs.forEach(function (tr) {\n                            tr.children.splice(ci - offset, 1);\n                        });\n                        offset++;\n                    }\n                    return col.visible;\n                }, this);\n                return kendo.dom.element('table', {\n                    style: {\n                        left: x + 'px',\n                        top: y + 'px',\n                        height: this._height + 'px',\n                        width: this._width + 'px'\n                    },\n                    className: className\n                }, [\n                    kendo.dom.element('colgroup', null, this.cols),\n                    kendo.dom.element('tbody', null, this.trs)\n                ]);\n            }\n        });\n        var CELL_CONTEXT_MENU = '<ul class=\"#=classNames.cellContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=merge>Merge</li>' + '<li data-action=unmerge>Unmerge</li>' + '</ul>';\n        var ROW_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.rowHeaderContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-row\">Delete</li>' + '<li data-action=\"hide-row\">Hide</li>' + '<li data-action=\"unhide-row\">Unhide</li>' + '</ul>';\n        var COL_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.colHeaderContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-column\">Delete</li>' + '<li data-action=\"hide-column\">Hide</li>' + '<li data-action=\"unhide-column\">Unhide</li>' + '</ul>';\n        kendo.spreadsheet.ContextMenu = kendo.ui.ContextMenu;\n        var VIEW_CONTENTS = kendo.template('<div class=\"#=classNames.view#\"><div class=\"#=classNames.fixedContainer#\"></div><div class=\"#=classNames.scroller#\"><div class=\"#=classNames.viewSize#\"></div></div>' + '<div tabindex=\"0\" class=\"#=classNames.clipboard#\" contenteditable=true></div><div class=\"#=classNames.cellEditor#\"></div></div><div class=\"#=classNames.sheetsBar#\"></div>' + CELL_CONTEXT_MENU + ROW_HEADER_CONTEXT_MENU + COL_HEADER_CONTEXT_MENU);\n        function within(value, min, max) {\n            return value >= min && value <= max;\n        }\n        var View = kendo.Class.extend({\n            init: function (element, options) {\n                var classNames = View.classNames;\n                this.element = element;\n                this.options = $.extend(true, { messages: kendo.spreadsheet.messages.view }, this.options, options);\n                this._chrome();\n                this._dialogs = [];\n                element.append(VIEW_CONTENTS({ classNames: classNames }));\n                this._formulaInput();\n                this.wrapper = element.find(DOT + classNames.view);\n                this.container = element.find(DOT + classNames.fixedContainer)[0];\n                this.scroller = element.find(DOT + classNames.scroller)[0];\n                this.clipboard = element.find(DOT + classNames.clipboard);\n                this.viewSize = $(this.scroller.firstChild);\n                this.tree = new kendo.dom.Tree(this.container);\n                this.clipboardContents = new kendo.dom.Tree(this.clipboard[0]);\n                this.editor = new kendo.spreadsheet.SheetEditor(this);\n                this._sheetsbar();\n                var contextMenuConfig = {\n                    target: element,\n                    animation: false,\n                    showOn: 'never'\n                };\n                this.cellContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.cellContextMenu), contextMenuConfig);\n                this.colHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.colHeaderContextMenu), contextMenuConfig);\n                this.rowHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.rowHeaderContextMenu), contextMenuConfig);\n                var scrollbar = kendo.support.scrollbar();\n                $(this.container).css({\n                    width: this.wrapper[0].clientWidth - scrollbar,\n                    height: this.wrapper[0].clientHeight - scrollbar\n                });\n            },\n            enableClipboard: function (enable) {\n                this.isClipboardDeactivated = !enable;\n                if (enable) {\n                    this.clipboard.attr('contenteditable', enable);\n                } else {\n                    this.clipboard.removeAttr('contenteditable');\n                }\n            },\n            _resize: function () {\n                var outerHeight = kendo._outerHeight;\n                var tabstripHeight = this.tabstrip ? outerHeight(this.tabstrip.element) : 0;\n                var formulaBarHeight = this.formulaBar ? outerHeight(this.formulaBar.element) : 0;\n                var sheetsBarHeight = this.sheetsbar ? outerHeight(this.sheetsbar.element) : 0;\n                this.wrapper.height(this.element.height() - (tabstripHeight + formulaBarHeight + sheetsBarHeight));\n                if (this.tabstrip) {\n                    this.tabstrip.quickAccessAdjust();\n                }\n            },\n            _chrome: function () {\n                var wrapper = $('<div class=\\'k-spreadsheet-action-bar\\' />').prependTo(this.element);\n                var nameEditor = $('<div class=\\'k-spreadsheet-name-editor\\' />').appendTo(wrapper);\n                this.nameEditor = new kendo.spreadsheet.NameEditor(nameEditor);\n                var formulaBar = $('<div />').appendTo(wrapper);\n                this.formulaBar = new kendo.spreadsheet.FormulaBar(formulaBar);\n                if (this.options.toolbar) {\n                    this._tabstrip();\n                }\n            },\n            _formulaInput: function () {\n                var editor = this.element.find(DOT + View.classNames.cellEditor);\n                this.formulaInput = new kendo.spreadsheet.FormulaInput(editor, { autoScale: true });\n            },\n            _sheetsbar: function () {\n                if (this.options.sheetsbar) {\n                    this.sheetsbar = new kendo.spreadsheet.SheetsBar(this.element.find(DOT + View.classNames.sheetsBar), $.extend(true, {}, this.options.sheetsbar));\n                }\n            },\n            _tabstrip: function () {\n                var messages = this.options.messages.tabs;\n                var options = $.extend(true, {\n                    home: true,\n                    insert: true,\n                    data: true\n                }, this.options.toolbar);\n                var tabs = [];\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                    this.element.children('.k-tabstrip').remove();\n                }\n                for (var name in options) {\n                    if (options[name] === true || options[name] instanceof Array) {\n                        tabs.push({\n                            id: name,\n                            text: messages[name],\n                            content: ''\n                        });\n                    }\n                }\n                this.tabstrip = new kendo.spreadsheet.TabStrip($('<div />').prependTo(this.element), {\n                    animation: false,\n                    dataTextField: 'text',\n                    dataContentField: 'content',\n                    dataSource: tabs,\n                    toolbarOptions: options,\n                    view: this\n                });\n                this.tabstrip.select(0);\n            },\n            _executeCommand: function (e) {\n                this._sheet.trigger('commandRequest', e);\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n                this.nameEditor._workbook = workbook;\n            },\n            sheet: function (sheet) {\n                this._sheet = sheet;\n            },\n            activeCellRectangle: function () {\n                return this.cellRectangle(this._sheet._viewActiveCell());\n            },\n            _rectangle: function (pane, ref) {\n                return pane._grid.boundingRectangle(ref.toRangeRef());\n            },\n            isColumnResizer: function (x, pane, ref) {\n                var rectangle = this._rectangle(pane, ref);\n                x -= this._sheet._grid._headerWidth;\n                var handleWidth = RESIZE_HANDLE_WIDTH / 2;\n                var right = rectangle.right - this.scroller.scrollLeft;\n                return right - handleWidth <= x && x <= right + handleWidth;\n            },\n            isRowResizer: function (y, pane, ref) {\n                var rectangle = this._rectangle(pane, ref);\n                y -= this._sheet._grid._headerHeight;\n                var handleWidth = RESIZE_HANDLE_WIDTH / 2;\n                var bottom = rectangle.bottom - this.scroller.scrollTop;\n                return bottom - handleWidth <= y && y <= bottom + handleWidth;\n            },\n            isFilterIcon: function (x, y, pane, ref) {\n                var theGrid = pane._grid;\n                var scrollTop = theGrid.rows.frozen ? 0 : this.scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : this.scroller.scrollLeft;\n                x -= this._sheet._grid._headerWidth - scrollLeft;\n                y -= this._sheet._grid._headerHeight - scrollTop;\n                var result = false;\n                this._sheet.forEachFilterHeader(ref, function (ref) {\n                    if (!result) {\n                        var rect = this._rectangle(pane, ref);\n                        result = pane.filterIconRect(rect).intersects(x, y);\n                    }\n                }.bind(this));\n                return result;\n            },\n            isAutoFill: function (x, y, pane) {\n                var selection = this._sheet.select();\n                if (selection.size > 1) {\n                    return false;\n                }\n                x -= this._sheet._grid._headerWidth;\n                y -= this._sheet._grid._headerHeight;\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n                var rectangle = this._rectangle(pane, selection);\n                return Math.abs(rectangle.right - x) < 8 && Math.abs(rectangle.bottom - y) < 8;\n            },\n            isEditButton: function (x, y) {\n                var ed = this._sheet.activeCellCustomEditor();\n                if (ed) {\n                    var r = this.activeCellRectangle();\n                    if (x > r.right && x <= r.right + 20 && y >= r.top && y <= r.bottom) {\n                        return true;\n                    }\n                }\n            },\n            objectAt: function (x, y) {\n                var grid = this._sheet._grid;\n                var object, pane;\n                if (x < 0 || y < 0 || x > this.scroller.clientWidth || y > this.scroller.clientHeight) {\n                    object = { type: 'outside' };\n                } else if (x < grid._headerWidth && y < grid._headerHeight) {\n                    object = { type: 'topcorner' };\n                } else {\n                    pane = this.paneAt(x, y);\n                    if (!pane) {\n                        object = { type: 'outside' };\n                    } else {\n                        var row = pane._grid.rows.index(y, this.scroller.scrollTop);\n                        var column = pane._grid.columns.index(x, this.scroller.scrollLeft);\n                        var type = 'cell';\n                        var ref = new CellRef(row, column);\n                        var selecting = this._sheet.selectionInProgress();\n                        if (this.isAutoFill(x, y, pane)) {\n                            type = 'autofill';\n                        } else if (this.isFilterIcon(x, y, pane, ref)) {\n                            type = 'filtericon';\n                        } else if (!selecting && x < grid._headerWidth) {\n                            ref = new CellRef(row, -Infinity);\n                            type = this.isRowResizer(y, pane, ref) ? 'rowresizehandle' : 'rowheader';\n                        } else if (!selecting && y < grid._headerHeight) {\n                            ref = new CellRef(-Infinity, column);\n                            type = this.isColumnResizer(x, pane, ref) ? 'columnresizehandle' : 'columnheader';\n                        } else if (this.isEditButton(x, y)) {\n                            type = 'editor';\n                        }\n                        object = {\n                            type: type,\n                            ref: ref\n                        };\n                    }\n                }\n                object.pane = pane;\n                object.x = x;\n                object.y = y;\n                return object;\n            },\n            paneAt: function (x, y) {\n                return this.panes.filter(function paneLocationWithin(pane) {\n                    var grid = pane._grid;\n                    return within(y, grid.top, grid.bottom) && within(x, grid.left, grid.right);\n                })[0];\n            },\n            containingPane: function (cell) {\n                return this.panes.filter(function (pane) {\n                    if (pane._grid.contains(cell)) {\n                        return true;\n                    }\n                    return false;\n                })[0];\n            },\n            cellRectangle: function (cell) {\n                var theGrid = this.containingPane(cell)._grid;\n                var rectangle = this._sheet._grid.rectangle(cell);\n                return rectangle.offset(theGrid.headerWidth - (theGrid.columns.frozen ? 0 : this.scroller.scrollLeft), theGrid.headerHeight - (theGrid.rows.frozen ? 0 : this.scroller.scrollTop));\n            },\n            refresh: function (reason) {\n                var sheet = this._sheet;\n                if (this.tabstrip) {\n                    this.tabstrip.refreshTools(sheet.range(sheet.activeCell()));\n                }\n                if (reason.sheetSelection && this.sheetsbar) {\n                    this.sheetsbar.renderSheets(this._workbook.sheets(), this._workbook.sheetIndex(this._sheet));\n                }\n                this._resize();\n                this.viewSize[0].style.height = sheet._grid.totalHeight() + 'px';\n                this.viewSize[0].style.width = sheet._grid.totalWidth() + 'px';\n                if (reason.layout) {\n                    var frozenColumns = sheet.frozenColumns();\n                    var frozenRows = sheet.frozenRows();\n                    this.panes = [this._pane(frozenRows, frozenColumns)];\n                    if (frozenColumns > 0) {\n                        this.panes.push(this._pane(frozenRows, 0, null, frozenColumns));\n                    }\n                    if (frozenRows > 0) {\n                        this.panes.push(this._pane(0, frozenColumns, frozenRows, null));\n                    }\n                    if (frozenRows > 0 && frozenColumns > 0) {\n                        this.panes.push(this._pane(0, 0, frozenRows, frozenColumns));\n                    }\n                }\n                if (reason.filter) {\n                    this._destroyFilterMenu();\n                }\n                if (reason.activeCell) {\n                    this._focus = sheet.activeCell().toRangeRef();\n                }\n            },\n            createFilterMenu: function (column) {\n                if (this._filterMenu && this._filterMenu.options.column == column) {\n                    return this._filterMenu;\n                }\n                this._destroyFilterMenu();\n                var sheet = this._sheet;\n                var ref = sheet.filter().ref;\n                var range = new kendo.spreadsheet.Range(ref, sheet);\n                var element = $('<div />').appendTo(this.element);\n                var options = {\n                    column: column,\n                    range: range\n                };\n                var filterMenu = new kendo.spreadsheet.FilterMenu(element, options);\n                this._filterMenu = filterMenu;\n                return filterMenu;\n            },\n            selectClipBoardContents: function () {\n                if (!this.isClipboardDeactivated) {\n                    this.clipboard.focus();\n                    selectElementContents(this.clipboard[0]);\n                }\n            },\n            scrollIntoView: function (cell) {\n                var willScroll = false;\n                var theGrid = this.containingPane(cell)._grid;\n                var boundaries = theGrid.scrollBoundaries(cell);\n                var scroller = this.scroller;\n                var scrollTop = theGrid.rows.frozen ? 0 : scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n                if (boundaries.top < scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollTop;\n                }\n                if (boundaries.bottom > scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollBottom;\n                }\n                if (boundaries.left < scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollLeft;\n                }\n                if (boundaries.right > scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollRight;\n                }\n                return willScroll;\n            },\n            _destroyDialog: function () {\n                this._dialogs.pop();\n            },\n            openCustomEditor: function () {\n                var self = this;\n                var cell = self._sheet.activeCell().first();\n                var editor = self._sheet.activeCellCustomEditor();\n                var range = self._sheet.range(cell);\n                editor.edit({\n                    range: range,\n                    rect: self.activeCellRectangle(),\n                    view: this,\n                    validation: this._sheet.validation(cell),\n                    callback: function (value, parse) {\n                        self._executeCommand({\n                            command: 'EditCommand',\n                            options: {\n                                operatingRange: range,\n                                property: parse ? 'input' : 'value',\n                                value: value\n                            }\n                        });\n                    }\n                });\n            },\n            openDialog: function (name, options) {\n                var sheet = this._sheet;\n                var ref = sheet.activeCell();\n                var range = new kendo.spreadsheet.Range(ref, sheet);\n                var dialog = kendo.spreadsheet.dialogs.create(name, options);\n                if (dialog) {\n                    dialog.bind('action', this._executeCommand.bind(this));\n                    dialog.bind('deactivate', this._destroyDialog.bind(this));\n                    this._dialogs.push(dialog);\n                    dialog.open(range);\n                    return dialog;\n                }\n            },\n            showError: function (options, callback) {\n                var errorMessages = this.options.messages.errors;\n                if (kendo.spreadsheet.dialogs.registered(options.type)) {\n                    var dialogOptions = { close: callback };\n                    if (options.type === 'validationError') {\n                        dialogOptions = $.extend(dialogOptions, {\n                            title: options.title || 'Error',\n                            text: options.body ? options.body : errorMessages[options.type]\n                        });\n                    }\n                    this.openDialog(options.type, dialogOptions);\n                } else {\n                    this.openDialog('message', {\n                        title: options.title || 'Error',\n                        text: options.body ? options.body : errorMessages[options.type],\n                        activate: function (e) {\n                            e.sender.dialog().element.find('.k-button').focus();\n                        }.bind(this),\n                        close: callback\n                    });\n                }\n            },\n            destroy: function () {\n                this._dialogs.forEach(function (dialog) {\n                    dialog.destroy();\n                });\n                this.cellContextMenu.destroy();\n                this.rowHeaderContextMenu.destroy();\n                this.colHeaderContextMenu.destroy();\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                }\n                this._destroyFilterMenu();\n            },\n            _destroyFilterMenu: function () {\n                if (this._filterMenu) {\n                    this._filterMenu.destroy();\n                    this._filterMenu = undefined;\n                    this._filterMenuColumn = undefined;\n                }\n            },\n            render: function () {\n                if (!this.element.is(':visible')) {\n                    return;\n                }\n                var sheet = this._sheet;\n                var focus = sheet.focus();\n                if (focus && this.scrollIntoView(focus)) {\n                    return;\n                }\n                var resizeDirection = !sheet.resizingInProgress() ? 'none' : sheet.resizeHandlePosition().col === -Infinity ? 'column' : 'row';\n                this.wrapper.toggleClass(viewClassNames.editContainer, this.editor.isActive()).toggleClass(viewClassNames.horizontalResize, resizeDirection == 'row').toggleClass(viewClassNames.verticalResize, resizeDirection == 'column');\n                var grid = sheet._grid;\n                var scrollTop = this.scroller.scrollTop;\n                var scrollLeft = this.scroller.scrollLeft;\n                if (scrollTop < 0) {\n                    scrollTop = 0;\n                }\n                if (scrollLeft < 0) {\n                    scrollLeft = 0;\n                }\n                var result = this.panes.map(function (pane) {\n                    return pane.render(scrollLeft, scrollTop);\n                }, this);\n                var merged = [];\n                merged = Array.prototype.concat.apply(merged, result);\n                var topCorner = kendo.dom.element('div', {\n                    style: {\n                        width: grid._headerWidth + 'px',\n                        height: grid._headerHeight + 'px'\n                    },\n                    className: View.classNames.topCorner\n                });\n                merged.push(topCorner);\n                if (sheet.resizeHandlePosition() && sheet.resizeHintPosition()) {\n                    merged.push(this.renderResizeHint());\n                }\n                this.tree.render(merged);\n                if (this.editor.isActive()) {\n                    this.editor.toggleTooltip(this.activeCellRectangle());\n                } else if (!sheet.selectionInProgress() && !sheet.resizingInProgress() && !sheet.isInEditMode()) {\n                    this.renderClipboardContents();\n                }\n            },\n            renderResizeHint: function () {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var horizontal = ref.col !== -Infinity;\n                var style;\n                if (horizontal) {\n                    style = {\n                        height: this.scroller.clientHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: sheet.resizeHintPosition().x + 'px',\n                        top: '0px'\n                    };\n                } else {\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this.scroller.clientWidth + 'px',\n                        top: sheet.resizeHintPosition().y + 'px',\n                        left: '0px'\n                    };\n                }\n                var classNames = Pane.classNames;\n                return kendo.dom.element('div', {\n                    className: classNames.resizeHint + (!horizontal ? ' ' + classNames.resizeHintVertical : ''),\n                    style: style\n                }, [\n                    kendo.dom.element('div', { className: classNames.resizeHintHandle }),\n                    kendo.dom.element('div', { className: classNames.resizeHintMarker })\n                ]);\n            },\n            renderClipboardContents: function () {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                var selection = sheet.select().toRangeRef();\n                var status = this._workbook.clipboard().canCopy();\n                if (status.canCopy === false && status.multiSelection) {\n                    this.clipboardContents.render([]);\n                    this.selectClipBoardContents();\n                    return;\n                }\n                selection = sheet.trim(selection);\n                var table = new HtmlTable();\n                var selectionView = grid.rangeDimensions(selection);\n                selectionView.rows.forEach(function (height) {\n                    table.addRow(height);\n                });\n                selectionView.columns.forEach(function (width) {\n                    table.addColumn(width);\n                });\n                var primaryMergedCells = {};\n                var secondaryMergedCells = {};\n                sheet.forEachMergedCell(selection, function (ref) {\n                    var topLeft = ref.topLeft;\n                    grid.forEach(ref, function (cellRef) {\n                        if (topLeft.eq(cellRef)) {\n                            primaryMergedCells[cellRef.print()] = ref;\n                        } else {\n                            secondaryMergedCells[cellRef.print()] = true;\n                        }\n                    });\n                });\n                sheet.forEach(selection, function (row, col, cell) {\n                    var location = new CellRef(row, col).print();\n                    if (!secondaryMergedCells[location]) {\n                        var td = addCell(table, row - selection.topLeft.row, cell);\n                        var mergedCell = primaryMergedCells[location];\n                        if (mergedCell) {\n                            td.attr.colspan = mergedCell.width();\n                            td.attr.rowspan = mergedCell.height();\n                        }\n                    }\n                });\n                this.clipboardContents.render([table.toDomTree(0, 0, 'kendo-clipboard-' + this._workbook.clipboard()._uid)]);\n                this.selectClipBoardContents();\n            },\n            _pane: function (row, column, rowCount, columnCount) {\n                var pane = new Pane(this._sheet, this._sheet._grid.pane({\n                    row: row,\n                    column: column,\n                    rowCount: rowCount,\n                    columnCount: columnCount\n                }));\n                pane.refresh(this.scroller.clientWidth, this.scroller.clientHeight);\n                return pane;\n            }\n        });\n        var paneClassNames = {\n            cell: 'k-spreadsheet-cell',\n            vaxis: 'k-spreadsheet-vaxis',\n            haxis: 'k-spreadsheet-haxis',\n            rowHeader: 'k-spreadsheet-row-header',\n            columnHeader: 'k-spreadsheet-column-header',\n            pane: 'k-spreadsheet-pane',\n            data: 'k-spreadsheet-data',\n            mergedCell: 'k-spreadsheet-merged-cell',\n            mergedCellsWrapper: 'k-merged-cells-wrapper',\n            activeCell: 'k-spreadsheet-active-cell',\n            selection: 'k-spreadsheet-selection',\n            selectionWrapper: 'k-selection-wrapper',\n            autoFillWrapper: 'k-auto-fill-wrapper',\n            single: 'k-single',\n            top: 'k-top',\n            right: 'k-right',\n            bottom: 'k-bottom',\n            left: 'k-left',\n            resizeHandle: 'k-resize-handle',\n            columnResizeHandle: 'k-column-resize-handle',\n            rowResizeHandle: 'k-row-resize-handle',\n            resizeHint: 'k-resize-hint',\n            resizeHintHandle: 'k-resize-hint-handle',\n            resizeHintMarker: 'k-resize-hint-marker',\n            resizeHintVertical: 'k-resize-hint-vertical',\n            selectionHighlight: 'k-spreadsheet-selection-highlight',\n            series: [\n                'k-series-a',\n                'k-series-b',\n                'k-series-c',\n                'k-series-d',\n                'k-series-e',\n                'k-series-f'\n            ]\n        };\n        var Pane = kendo.Class.extend({\n            init: function (sheet, grid) {\n                this._sheet = sheet;\n                this._grid = grid;\n            },\n            refresh: function (width, height) {\n                this._grid.refresh(width, height);\n            },\n            isVisible: function (scrollLeft, scrollTop, ref) {\n                return this._grid.view(scrollLeft, scrollTop).ref.intersects(ref);\n            },\n            render: function (scrollLeft, scrollTop) {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var grid = this._grid;\n                var view = grid.view(scrollLeft, scrollTop);\n                this._currentView = view;\n                this._currentRect = this._rectangle(view.ref);\n                this._selectedHeaders = sheet.selectedHeaders();\n                var children = [];\n                children.push(this.renderData());\n                children.push(this.renderSelection());\n                children.push(this.renderAutoFill());\n                children.push(this.renderEditorSelection());\n                children.push(this.renderFilterHeaders());\n                if (grid.hasRowHeader) {\n                    var rowHeader = kendo.dom.element('div', {\n                        className: classNames.rowHeader,\n                        style: {\n                            width: grid.headerWidth + 'px',\n                            top: view.rowOffset + 'px'\n                        }\n                    });\n                    children.push(rowHeader);\n                    sheet.forEach(view.ref.leftColumn(), function (row) {\n                        if (!sheet.isHiddenRow(row)) {\n                            var text = row + 1, height = sheet.rowHeight(row);\n                            rowHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(row, 'row'),\n                                style: {\n                                    width: grid.headerWidth + 'px',\n                                    height: height + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                        }\n                    }.bind(this));\n                }\n                if (grid.hasColumnHeader) {\n                    var columnHeader = kendo.dom.element('div', {\n                        className: classNames.columnHeader,\n                        style: {\n                            top: '0px',\n                            left: view.columnOffset + 'px',\n                            width: this._currentRect.width + 'px',\n                            height: grid.headerHeight + 'px'\n                        }\n                    });\n                    children.push(columnHeader);\n                    var left = 0;\n                    sheet.forEach(view.ref.topRow(), function (row, col) {\n                        if (!sheet.isHiddenColumn(col)) {\n                            var text = kendo.spreadsheet.Ref.display(null, Infinity, col), width = sheet.columnWidth(col);\n                            columnHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(col, 'col'),\n                                style: {\n                                    position: 'absolute',\n                                    left: left + 'px',\n                                    width: width + 'px',\n                                    height: grid.headerHeight + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                            left += width;\n                        }\n                    }.bind(this));\n                }\n                if (sheet.resizeHandlePosition() && (grid.hasColumnHeader || grid.hasRowHeader)) {\n                    var ref = sheet._grid.normalize(sheet.resizeHandlePosition());\n                    if (view.ref.intersects(ref)) {\n                        if (!sheet.resizeHintPosition()) {\n                            children.push(this.renderResizeHandle());\n                        }\n                    }\n                }\n                var paneClasses = [classNames.pane];\n                if (grid.hasColumnHeader) {\n                    paneClasses.push(classNames.top);\n                }\n                if (grid.hasRowHeader) {\n                    paneClasses.push(classNames.left);\n                }\n                return kendo.dom.element('div', {\n                    style: grid.style,\n                    className: paneClasses.join(' ')\n                }, children);\n            },\n            headerClassName: function (index, type) {\n                var selectedHeaders = this._selectedHeaders;\n                var itemSelection;\n                var allHeaders;\n                if (type === 'row') {\n                    itemSelection = selectedHeaders.rows[index];\n                    allHeaders = selectedHeaders.allRows;\n                } else {\n                    itemSelection = selectedHeaders.cols[index];\n                    allHeaders = selectedHeaders.allCols;\n                }\n                var className = itemSelection || (selectedHeaders.all ? 'full' : allHeaders ? 'partial' : 'none');\n                if (className) {\n                    className = 'k-selection-' + className;\n                }\n                return className;\n            },\n            renderData: function () {\n                var sheet = this._sheet;\n                var view = this._currentView;\n                var cont = kendo.dom.element('div', {\n                    className: Pane.classNames.data,\n                    style: {\n                        position: 'relative',\n                        left: view.columnOffset + 'px',\n                        top: view.rowOffset + 'px'\n                    }\n                });\n                var rect = this._currentRect;\n                var layout = kendo.spreadsheet.draw.doLayout(sheet, view.ref, { forScreen: true }), prev;\n                var showGridLines = sheet._showGridLines;\n                if (showGridLines) {\n                    prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        if (x !== prev) {\n                            prev = x;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.vaxis,\n                                style: {\n                                    left: x + 'px',\n                                    height: rect.height + 'px',\n                                    borderColor: sheet.gridLinesColor()\n                                }\n                            }));\n                        }\n                    });\n                    prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        if (y !== prev) {\n                            prev = y;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.haxis,\n                                style: {\n                                    top: y + 'px',\n                                    width: rect.width + 'px',\n                                    borderColor: sheet.gridLinesColor()\n                                }\n                            }));\n                        }\n                    });\n                }\n                var vBorders = {}, hBorders = {};\n                layout.cells.forEach(function (cell) {\n                    var hb = hBorders[cell.col] || (hBorders[cell.col] = {});\n                    var vb = vBorders[cell.row] || (vBorders[cell.row] = {});\n                    drawCell(cont.children, cell, null, hb, vb, showGridLines);\n                });\n                return cont;\n            },\n            renderResizeHandle: function () {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var rectangle = this._rectangle(ref);\n                var classNames = [Pane.classNames.resizeHandle];\n                var style;\n                if (ref.col !== -Infinity) {\n                    style = {\n                        height: this._grid.headerHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: rectangle.right - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        top: '0px'\n                    };\n                    classNames.push(viewClassNames.horizontalResize);\n                } else {\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this._grid.headerWidth + 'px',\n                        top: rectangle.bottom - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        left: '0px'\n                    };\n                    classNames.push(viewClassNames.verticalResize);\n                }\n                return kendo.dom.element('div', {\n                    className: classNames.join(' '),\n                    style: style\n                });\n            },\n            filterIconRect: function (rect) {\n                var BUTTON_SIZE = 16;\n                var BUTTON_OFFSET = 3;\n                return new kendo.spreadsheet.Rectangle(rect.right - BUTTON_SIZE - BUTTON_OFFSET, rect.top + BUTTON_OFFSET, BUTTON_SIZE, BUTTON_SIZE);\n            },\n            renderFilterHeaders: function () {\n                var sheet = this._sheet;\n                var children = [];\n                var classNames = View.classNames;\n                var filter = sheet.filter();\n                function icon(className) {\n                    return kendo.dom.element('span', { className: classNames.icon + ' ' + className });\n                }\n                function filterButton(classNames, position, index) {\n                    var style = {\n                        left: position.left + 'px',\n                        top: position.top + 'px'\n                    };\n                    var filtered = filter && filter.columns.some(function (c) {\n                        return c.index === index;\n                    });\n                    var classes = classNames.filterButton;\n                    if (filtered) {\n                        classes += ' ' + classNames.filterButtonActive;\n                    }\n                    var button = kendo.dom.element('span', {\n                        className: classes,\n                        style: style\n                    }, [icon(classNames.iconFilterDefault)]);\n                    return button;\n                }\n                if (filter) {\n                    this._addDiv(children, filter.ref, classNames.filterRange);\n                }\n                sheet.forEachFilterHeader(this._currentView.ref, function (ref) {\n                    var rect = this._rectangle(ref);\n                    var position = this.filterIconRect(rect);\n                    var column = this._sheet.filterColumn(ref);\n                    var button = filterButton(classNames, position, column);\n                    children.push(button);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.filterHeadersWrapper }, children);\n            },\n            renderEditorSelection: function () {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var selections = [];\n                sheet._formulaSelections.forEach(function (range) {\n                    var ref = range.ref;\n                    if (ref === kendo.spreadsheet.NULLREF) {\n                        return;\n                    }\n                    this._addDiv(selections, ref, classNames.selectionHighlight + ' ' + range.colorClass);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderSelection: function () {\n                var classNames = Pane.classNames;\n                var selections = [];\n                var activeCellClasses = [classNames.activeCell];\n                var selectionClasses = [classNames.selection];\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell().toRangeRef();\n                var activeFormulaColor = this._activeFormulaColor();\n                var selection = sheet.select();\n                activeCellClasses = activeCellClasses.concat(activeFormulaColor, this._directionClasses(activeCell));\n                selectionClasses = selectionClasses.concat(activeFormulaColor);\n                if (sheet.singleCellSelection()) {\n                    activeCellClasses.push(classNames.single);\n                }\n                if (selection.size() === 1) {\n                    selectionClasses.push('k-single-selection');\n                }\n                if (this._sheet.autoFillPunch()) {\n                    selectionClasses.push('k-dim-auto-fill-handle');\n                }\n                selection.forEach(function (ref) {\n                    if (ref !== kendo.spreadsheet.NULLREF) {\n                        this._addDiv(selections, ref, selectionClasses.join(' '));\n                    }\n                }.bind(this));\n                this._addTable(selections, activeCell, activeCellClasses.join(' '));\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderAutoFill: function () {\n                var autoFillRectangle = [];\n                if (this._sheet.autoFillInProgress()) {\n                    var autoFillRef = this._sheet.autoFillRef();\n                    var punch = this._sheet.autoFillPunch();\n                    var direction = this._sheet._autoFillDirection;\n                    this._addDiv(autoFillRectangle, autoFillRef, 'k-auto-fill');\n                    if (punch) {\n                        this._addDiv(autoFillRectangle, punch, 'k-auto-fill-punch');\n                    } else if (direction !== undefined) {\n                        var ref, cssClass;\n                        switch (direction) {\n                        case 0:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 1:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 2:\n                            ref = new CellRef(autoFillRef.topLeft.row, autoFillRef.bottomRight.col);\n                            cssClass = 'k-auto-fill-tr-hint';\n                            break;\n                        case 3:\n                            ref = new CellRef(autoFillRef.bottomRight.row, autoFillRef.topLeft.col);\n                            cssClass = 'k-auto-fill-bl-hint';\n                            break;\n                        }\n                        var hint = kendo.dom.element('span', { className: 'k-tooltip' }, [kendo.dom.text(this._sheet._autoFillHint)]);\n                        var rectangle = this._addDiv(autoFillRectangle, ref, cssClass);\n                        if (rectangle) {\n                            rectangle.children.push(hint);\n                        }\n                    }\n                }\n                return kendo.dom.element('div', { className: Pane.classNames.autoFillWrapper }, autoFillRectangle);\n            },\n            _addDiv: function (collection, ref, className) {\n                var view = this._currentView, div;\n                if (view.ref.intersects(ref)) {\n                    div = this._rectangle(ref).resize(1, 1).toDiv(className);\n                    collection.push(div);\n                }\n                return div;\n            },\n            _addTable: function (collection, ref, className) {\n                var self = this;\n                var sheet = self._sheet;\n                var view = self._currentView;\n                if (view.ref.intersects(ref)) {\n                    var rectangle = self._rectangle(ref);\n                    var ed = self._sheet.activeCellCustomEditor();\n                    sheet.forEach(ref.collapse(), function (row, col, cell) {\n                        cell.left = rectangle.left;\n                        cell.top = rectangle.top;\n                        cell.width = rectangle.width;\n                        cell.height = rectangle.height;\n                        drawCell(collection, cell, className, null, null, true);\n                        if (ed) {\n                            var btn = kendo.dom.element('div', {\n                                className: 'k-button k-spreadsheet-editor-button',\n                                style: {\n                                    left: cell.left + cell.width + 'px',\n                                    top: cell.top + 'px',\n                                    height: cell.height + 'px'\n                                }\n                            });\n                            if (ed.icon) {\n                                btn.children.push(kendo.dom.element('span', { className: 'k-icon ' + ed.icon }));\n                            }\n                            collection.push(btn);\n                        }\n                    });\n                }\n            },\n            _activeFormulaColor: function () {\n                var activeFormulaSelection;\n                var colorClasses = [];\n                if (this._sheet.isInEditMode()) {\n                    activeFormulaSelection = this._sheet._formulaSelections.filter(function (sel) {\n                        return sel.active && sel.type == 'ref';\n                    })[0];\n                    if (activeFormulaSelection) {\n                        colorClasses.push(activeFormulaSelection.colorClass);\n                    }\n                }\n                return colorClasses;\n            },\n            _directionClasses: function (cell) {\n                var cellClasses = [];\n                var classNames = Pane.classNames;\n                var view = this._currentView.ref;\n                if (!cell.move(0, -1).intersects(view)) {\n                    cellClasses.push(classNames.left);\n                }\n                if (!cell.move(-1, 0).intersects(view)) {\n                    cellClasses.push(classNames.top);\n                }\n                if (!cell.move(0, 1).intersects(view)) {\n                    cellClasses.push(classNames.right);\n                }\n                if (!cell.move(1, 0).intersects(view)) {\n                    cellClasses.push(classNames.bottom);\n                }\n                return cellClasses;\n            },\n            _rectangle: function (ref) {\n                return this._grid.boundingRectangle(ref.toRangeRef()).offset(-this._currentView.mergedCellLeft, -this._currentView.mergedCellTop);\n            }\n        });\n        kendo.spreadsheet.View = View;\n        kendo.spreadsheet.Pane = Pane;\n        kendo.spreadsheet.drawCell = drawCell;\n        $.extend(true, View, { classNames: viewClassNames });\n        $.extend(true, Pane, { classNames: paneClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/customeditors', [\n        'kendo.core',\n        'kendo.popup',\n        'kendo.calendar',\n        'kendo.listview',\n        'spreadsheet/sheet'\n    ], f);\n}(function () {\n    (function (kendo) {\n        'use strict';\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var EDITORS = {};\n        var registerEditor = kendo.spreadsheet.registerEditor = function (name, editor) {\n            EDITORS[name] = editor;\n        };\n        kendo.spreadsheet.Sheet.prototype.activeCellCustomEditor = function () {\n            var cell = this.activeCell().first();\n            if (this.range(cell).enable()) {\n                var val = this.validation(cell);\n                var key = this._properties.get('editor', this._grid.cellRefIndex(cell));\n                var editor;\n                if (key != null) {\n                    editor = EDITORS[key];\n                } else if (val && val.showButton) {\n                    key = '_validation_' + val.dataType;\n                    editor = EDITORS[key];\n                }\n                if (typeof editor == 'function') {\n                    editor = EDITORS[key] = editor();\n                }\n                return editor;\n            }\n        };\n        registerEditor('_validation_date', function () {\n            var context, calendar, popup;\n            function create() {\n                if (!calendar) {\n                    calendar = $('<div>').kendoCalendar();\n                    popup = $('<div>').kendoPopup();\n                    calendar.appendTo(popup);\n                    calendar = calendar.getKendoCalendar();\n                    popup = popup.getKendoPopup();\n                    calendar.bind('change', function () {\n                        popup.close();\n                        var date = calendar.value();\n                        if (!context.range.format()) {\n                            context.range.format('yyyy-mm-dd');\n                        }\n                        context.callback(kendo.spreadsheet.dateToNumber(date));\n                    });\n                }\n                popup.setOptions({ anchor: context.view.element.find('.k-spreadsheet-editor-button') });\n            }\n            function open() {\n                create();\n                var date = context.range.value();\n                if (date != null) {\n                    calendar.value(kendo.spreadsheet.numberToDate(date));\n                } else {\n                    calendar.value(null);\n                }\n                var val = context.validation;\n                if (val) {\n                    var min = kendo.ui.Calendar.fn.options.min;\n                    var max = kendo.ui.Calendar.fn.options.max;\n                    if (/^(?:greaterThan|between)/.test(val.comparerType)) {\n                        min = kendo.spreadsheet.numberToDate(val.from.value);\n                    }\n                    if (val.comparerType == 'between') {\n                        max = kendo.spreadsheet.numberToDate(val.to.value);\n                    }\n                    if (val.comparerType == 'lessThan') {\n                        max = kendo.spreadsheet.numberToDate(val.from.value);\n                    }\n                    calendar.setOptions({\n                        disableDates: function (date) {\n                            var from = val.from ? val.from.value | 0 : 0;\n                            var to = val.to ? val.to.value | 0 : 0;\n                            date = kendo.spreadsheet.dateToNumber(date) | 0;\n                            return !kendo.spreadsheet.validation.validationComparers[val.comparerType](date, from, to);\n                        },\n                        min: min,\n                        max: max\n                    });\n                } else {\n                    calendar.setOptions({\n                        disableDates: null,\n                        min: null,\n                        max: null\n                    });\n                }\n                popup.open();\n            }\n            return {\n                edit: function (options) {\n                    context = options;\n                    open();\n                },\n                icon: 'k-i-calendar'\n            };\n        });\n        registerEditor('_validation_list', function () {\n            var context, list, popup;\n            function create() {\n                if (!list) {\n                    list = $('<div/>').kendoStaticList({\n                        template: '<div>#:value#</div>',\n                        selectable: true,\n                        autoBind: false\n                    });\n                    popup = $('<div>').kendoPopup();\n                    list.appendTo(popup);\n                    popup = popup.getKendoPopup();\n                    list = list.getKendoStaticList();\n                    list.bind('change', function () {\n                        popup.close();\n                        var item = list.value()[0];\n                        if (item) {\n                            context.callback(item.value);\n                        }\n                    });\n                }\n                popup.setOptions({ anchor: context.view.element.find('.k-spreadsheet-editor-button') });\n            }\n            function open() {\n                create();\n                var matrix = context.validation.from.value;\n                var data = [];\n                if (matrix) {\n                    matrix.each(function (el) {\n                        data.push({ value: el });\n                    });\n                }\n                var dataSource = new kendo.data.DataSource({ data: data });\n                list.setDataSource(dataSource);\n                dataSource.read();\n                popup.open();\n            }\n            return {\n                edit: function (options) {\n                    context = options;\n                    open();\n                },\n                icon: 'k-i-arrow-s'\n            };\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/grid', [\n        'kendo.core',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var Rectangle = kendo.Class.extend({\n            init: function (left, top, width, height) {\n                this.left = left;\n                this.width = width;\n                this.right = left + width;\n                this.top = top;\n                this.height = height;\n                this.bottom = top + height;\n            },\n            offset: function (left, top) {\n                return new Rectangle(this.left + left, this.top + top, this.width, this.height);\n            },\n            resize: function (width, height) {\n                return new Rectangle(this.left, this.top, this.width + width, this.height + height);\n            },\n            intersects: function (x, y) {\n                return this.left < x && x < this.left + this.width && this.top < y && y < this.top + this.height;\n            },\n            toDiv: function (className) {\n                return kendo.dom.element('div', {\n                    className: className,\n                    style: {\n                        width: this.width + 'px',\n                        height: this.height + 'px',\n                        top: this.top + 'px',\n                        left: this.left + 'px'\n                    }\n                });\n            }\n        });\n        var Grid = kendo.Class.extend({\n            init: function (rows, columns, rowCount, columnCount, headerHeight, headerWidth) {\n                this.rowCount = rowCount;\n                this.columnCount = columnCount;\n                this._columns = columns;\n                this._rows = rows;\n                this._headerHeight = headerHeight;\n                this._headerWidth = headerWidth;\n            },\n            isAxis: function (ref) {\n                ref = ref.toRangeRef();\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                return topLeft.row === 0 && bottomRight.row === this.rowCount - 1 || topLeft.col === 0 && bottomRight.col === this.columnCount - 1;\n            },\n            width: function (start, end) {\n                return this._columns.sum(start, end);\n            },\n            height: function (start, end) {\n                return this._rows.sum(start, end);\n            },\n            totalHeight: function () {\n                return this._rows.total + this._headerHeight;\n            },\n            totalWidth: function () {\n                return this._columns.total + this._headerWidth;\n            },\n            index: function (row, column) {\n                return column * this.rowCount + row;\n            },\n            cellRef: function (index) {\n                return new CellRef(index % this.rowCount, index / this.rowCount >> 0);\n            },\n            rowRef: function (row) {\n                return new RangeRef(new CellRef(row, 0), new CellRef(row, this.columnCount - 1));\n            },\n            colRef: function (col) {\n                return new RangeRef(new CellRef(0, col), new CellRef(this.rowCount - 1, col));\n            },\n            cellRefIndex: function (ref) {\n                return this.index(ref.row, ref.col);\n            },\n            normalize: function (ref) {\n                if (ref instanceof RangeRef) {\n                    return new RangeRef(this.normalize(ref.topLeft), this.normalize(ref.bottomRight)).setSheet(ref.sheet, ref.hasSheet());\n                }\n                if (ref instanceof UnionRef) {\n                    return ref.map(function (ref) {\n                        return this.normalize(ref);\n                    }, this);\n                }\n                if (ref instanceof CellRef) {\n                    ref = ref.clone();\n                    ref.col = Math.max(0, Math.min(this.columnCount - 1, ref.col));\n                    ref.row = Math.max(0, Math.min(this.rowCount - 1, ref.row));\n                }\n                return ref;\n            },\n            rectangle: function (ref) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                return new Rectangle(this.width(0, topLeft.col - 1), this.height(0, topLeft.row - 1), this.width(topLeft.col, bottomRight.col), this.height(topLeft.row, bottomRight.row));\n            },\n            pane: function (options) {\n                return new PaneGrid(new kendo.spreadsheet.PaneAxis(this._rows, options.row, options.rowCount, this._headerHeight), new kendo.spreadsheet.PaneAxis(this._columns, options.column, options.columnCount, this._headerWidth), this);\n            },\n            rangeDimensions: function (rangeRef) {\n                return {\n                    rows: this._rows.values.iterator(rangeRef.topLeft.row, rangeRef.bottomRight.row),\n                    columns: this._columns.values.iterator(rangeRef.topLeft.col, rangeRef.bottomRight.col)\n                };\n            },\n            forEach: function (ref, callback) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    for (var ri = topLeft.row; ri <= bottomRight.row; ri++) {\n                        callback(new CellRef(ri, ci));\n                    }\n                }\n            },\n            trim: function (ref, property) {\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                var bottomRightRow = topLeft.row;\n                var bottomRightCol = topLeft.col;\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    var start = this.index(topLeft.row, ci);\n                    var end = this.index(bottomRight.row, ci);\n                    var values = property.tree.intersecting(start, end);\n                    if (values.length) {\n                        var cell = this.cellRef(values[values.length - 1].end);\n                        bottomRightRow = Math.max(bottomRightRow, cell.row);\n                        bottomRightCol = ci;\n                    }\n                }\n                return new RangeRef(ref.topLeft, new CellRef(Math.min(bottomRightRow, ref.bottomRight.row), bottomRightCol));\n            }\n        });\n        var PaneGrid = kendo.Class.extend({\n            init: function (rows, columns, grid) {\n                this.rows = rows;\n                this.columns = columns;\n                this._grid = grid;\n                this.headerHeight = rows.headerSize;\n                this.headerWidth = columns.headerSize;\n                this.hasRowHeader = columns.hasHeader;\n                this.hasColumnHeader = rows.hasHeader;\n            },\n            refresh: function (width, height) {\n                this.columns.viewSize(width);\n                this.rows.viewSize(height);\n                var x = this.columns.paneSegment();\n                var y = this.rows.paneSegment();\n                this.left = x.offset;\n                this.top = y.offset;\n                this.right = x.offset + x.length;\n                this.bottom = y.offset + y.length;\n                this.style = {\n                    top: y.offset + 'px',\n                    left: x.offset + 'px',\n                    height: y.length + 'px',\n                    width: x.length + 'px'\n                };\n            },\n            view: function (left, top) {\n                var rows = this.rows.visible(top);\n                var columns = this.columns.visible(left);\n                return {\n                    rows: rows,\n                    columns: columns,\n                    rowOffset: rows.offset,\n                    columnOffset: columns.offset,\n                    mergedCellLeft: columns.start,\n                    mergedCellTop: rows.start,\n                    ref: new RangeRef(new CellRef(rows.values.start, columns.values.start), new CellRef(rows.values.end, columns.values.end))\n                };\n            },\n            contains: function (ref) {\n                return this.rows.contains(ref.topLeft.row, ref.bottomRight.row) && this.columns.contains(ref.topLeft.col, ref.bottomRight.col);\n            },\n            index: function (row, column) {\n                return this._grid.index(row, column);\n            },\n            boundingRectangle: function (ref) {\n                return this._grid.rectangle(ref);\n            },\n            cellRefIndex: function (ref) {\n                return this._grid.cellRefIndex(ref);\n            },\n            scrollBoundaries: function (cell) {\n                var position = this.boundingRectangle(cell);\n                var boundaries = {\n                    top: Math.max(0, position.top - this.top + (this.hasColumnHeader ? 0 : this.headerHeight)),\n                    left: Math.max(0, position.left - this.left + (this.hasRowHeader ? 0 : this.headerWidth)),\n                    right: position.right - this.columns._viewSize + this.headerWidth,\n                    bottom: position.bottom - this.rows._viewSize + this.headerHeight\n                };\n                var widthCompensation = this.columns.defaultValue / 2;\n                var heightCompensation = this.rows.defaultValue / 2;\n                boundaries.scrollTop = boundaries.top - heightCompensation;\n                boundaries.scrollBottom = boundaries.bottom + heightCompensation;\n                boundaries.scrollLeft = boundaries.left - widthCompensation;\n                boundaries.scrollRight = boundaries.right + widthCompensation;\n                return boundaries;\n            }\n        });\n        kendo.spreadsheet.Grid = Grid;\n        kendo.spreadsheet.PaneGrid = PaneGrid;\n        kendo.spreadsheet.Rectangle = Rectangle;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axis', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Axis = kendo.Class.extend({\n            init: function (count, value) {\n                this._value = value;\n                this._count = count;\n                this.values = new kendo.spreadsheet.RangeList(0, count - 1, value);\n                this._hidden = new kendo.spreadsheet.RangeList(0, count - 1, 0);\n                this.scrollBarSize = kendo.support.scrollbar();\n                this._refresh();\n            },\n            adjust: function (start, delta) {\n                if (delta < 0) {\n                    this.values.copy(start - delta, this._count - 1, start);\n                    this._hidden.copy(start - delta, this._count - 1, start);\n                } else {\n                    this.values.copy(start, this._count, start + delta);\n                    this._hidden.copy(start, this._count, start + delta);\n                    this.values.value(start, start + delta - 1, this._value);\n                    this._hidden.value(start, start + delta - 1, 0);\n                }\n                this._refresh();\n            },\n            toJSON: function (field, positions) {\n                var values = [];\n                var iterator = this.values.iterator(0, this._count - 1);\n                for (var idx = 0; idx < this._count; idx++) {\n                    var value = iterator.at(idx);\n                    if (value === this._value) {\n                        continue;\n                    }\n                    var position = positions[idx];\n                    if (position === undefined) {\n                        position = values.length;\n                        var item = { index: idx };\n                        item[field] = value;\n                        values.push(item);\n                        positions[idx] = position;\n                    }\n                }\n                return values;\n            },\n            fromJSON: function (field, values) {\n                for (var idx = 0; idx < values.length; idx++) {\n                    var value = values[idx][field];\n                    var index = values[idx].index;\n                    if (index === undefined) {\n                        index = idx;\n                    }\n                    this.value(index, index, value);\n                }\n            },\n            hide: function (index) {\n                if (!this.hidden(index)) {\n                    var value = this.value(index, index);\n                    this._hidden.value(index, index, value);\n                    this.value(index, index, 0);\n                }\n            },\n            hidden: function (index) {\n                return this._hidden.value(index, index) !== 0;\n            },\n            includesHidden: function (start, end) {\n                return this._hidden.intersecting(start, end).length > 1;\n            },\n            nextVisible: function (index, overflow) {\n                var end = this._count - 1;\n                if (index === end) {\n                    return overflow ? index + 1 : index;\n                }\n                index += 1;\n                var range = this._hidden.intersecting(index, index)[0];\n                if (range.value !== 0) {\n                    if (range.end === end) {\n                        return index - 1;\n                    } else {\n                        return range.end + 1;\n                    }\n                } else {\n                    return index;\n                }\n            },\n            nextPage: function (index, pageSize) {\n                return this.index(this.sum(0, index - 1) + pageSize);\n            },\n            prevPage: function (index, pageSize) {\n                return this.index(this.sum(0, index) - pageSize);\n            },\n            firstVisible: function () {\n                var firstHidden = this._hidden.first();\n                if (firstHidden.value === 0) {\n                    return 0;\n                } else {\n                    return firstHidden.end + 1;\n                }\n            },\n            lastVisible: function () {\n                var lastHidden = this._hidden.last();\n                if (lastHidden.value === 0) {\n                    return this._count - 1;\n                } else {\n                    return lastHidden.start - 1;\n                }\n            },\n            prevVisible: function (index, overflow) {\n                if (index === 0) {\n                    return overflow ? -1 : 0;\n                }\n                index -= 1;\n                var range = this._hidden.intersecting(index, index)[0];\n                if (range.value !== 0) {\n                    if (range.start === 0) {\n                        return index + 1;\n                    } else {\n                        return range.start - 1;\n                    }\n                } else {\n                    return index;\n                }\n            },\n            unhide: function (index) {\n                if (this.hidden(index)) {\n                    var value = this._hidden.value(index, index);\n                    this._hidden.value(index, index, 0);\n                    this.value(index, index, value);\n                }\n            },\n            value: function (start, end, value) {\n                if (value !== undefined) {\n                    this.values.value(start, end, value);\n                    this._refresh();\n                } else {\n                    return this.values.iterator(start, end).at(0);\n                }\n            },\n            sum: function (start, end) {\n                var values = this.values.iterator(start, end);\n                var sum = 0;\n                for (var idx = start; idx <= end; idx++) {\n                    sum += values.at(idx);\n                }\n                return sum;\n            },\n            visible: function (start, end) {\n                var startSegment = null;\n                var endSegment = null;\n                var lastPage = false;\n                if (end >= this.total + this.scrollBarSize) {\n                    lastPage = true;\n                }\n                var ranges = this._pixelValues.intersecting(start, end);\n                startSegment = ranges[0];\n                endSegment = ranges[ranges.length - 1];\n                if (!startSegment) {\n                    return {\n                        values: this.values.iterator(0, 0),\n                        offset: 0\n                    };\n                }\n                var startOffset = start - startSegment.start;\n                var startIndex = (startOffset / startSegment.value.value >> 0) + startSegment.value.start;\n                var offset = startOffset - (startIndex - startSegment.value.start) * startSegment.value.value;\n                var endOffset = end - endSegment.start;\n                var endIndex = (endOffset / endSegment.value.value >> 0) + endSegment.value.start;\n                if (endIndex > endSegment.value.end) {\n                    endIndex = endSegment.value.end;\n                }\n                if (lastPage) {\n                    offset += endSegment.value.value - (endOffset - (endIndex - endSegment.value.start) * endSegment.value.value);\n                }\n                offset = Math.min(-offset, 0);\n                return {\n                    values: this.values.iterator(startIndex, endIndex),\n                    offset: offset\n                };\n            },\n            index: function (value) {\n                var index = 0;\n                var iterator = this.values.iterator(0, this._count - 1);\n                var current = iterator.at(0);\n                while (current < value && index < this._count - 1) {\n                    current += iterator.at(++index);\n                }\n                return index;\n            },\n            _refresh: function () {\n                var current = 0;\n                this._pixelValues = this.values.map(function (range) {\n                    var start = current;\n                    current += (range.end - range.start + 1) * range.value;\n                    var end = current - 1;\n                    return new kendo.spreadsheet.ValueRange(start, end, range);\n                });\n                this.total = current;\n            },\n            getState: function () {\n                return {\n                    values: this.values.getState(),\n                    hidden: this._hidden.getState()\n                };\n            },\n            setState: function (state) {\n                this.values.setState(state.values);\n                this._hidden.setState(state.hidden);\n                this._refresh();\n            }\n        });\n        var PaneAxis = kendo.Class.extend({\n            init: function (axis, start, count, headerSize) {\n                this._axis = axis;\n                this._start = start;\n                this._count = count;\n                this.hasHeader = start === 0;\n                this.headerSize = headerSize;\n                this.defaultValue = axis._value;\n                this.frozen = count > 0;\n            },\n            viewSize: function (viewSize) {\n                this._viewSize = viewSize;\n            },\n            sum: function (start, end) {\n                return this._axis.sum(start, end - 1);\n            },\n            start: function () {\n                return this.sum(0, this._start);\n            },\n            size: function () {\n                return this.sum(this._start, this._start + this._count);\n            },\n            index: function (value, offset) {\n                return this._axis.index(value + (this.frozen ? 0 : offset) - this.headerSize);\n            },\n            paneSegment: function () {\n                var offset = this.start();\n                var length;\n                if (!this.hasHeader) {\n                    offset += this.headerSize;\n                }\n                if (this.frozen) {\n                    length = this.size();\n                    if (this.hasHeader) {\n                        length += this.headerSize;\n                    } else {\n                        length -= this.headerSize;\n                    }\n                } else {\n                    length = this._viewSize - offset;\n                }\n                return {\n                    offset: offset,\n                    length: length\n                };\n            },\n            visible: function (offset) {\n                var start = this.start();\n                var size;\n                if (this.frozen) {\n                    size = this.size();\n                    if (!this.hasHeader) {\n                        size -= this.headerSize;\n                    }\n                } else {\n                    size = this._viewSize - start - this.headerSize;\n                    start += offset;\n                }\n                var result = this._axis.visible(start, start + size - 1);\n                if (this.frozen) {\n                    result.offset = 0;\n                }\n                result.start = start;\n                if (this.hasHeader) {\n                    result.offset += this.headerSize;\n                    result.start -= this.headerSize;\n                }\n                return result;\n            },\n            contains: function (start, end) {\n                if (this.frozen) {\n                    if (start > this._start + this._count) {\n                        return false;\n                    }\n                    if (end < this._start) {\n                        return false;\n                    }\n                    return true;\n                } else {\n                    return end >= this._start;\n                }\n            }\n        });\n        kendo.spreadsheet.Axis = Axis;\n        kendo.spreadsheet.PaneAxis = PaneAxis;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filter', [\n        'kendo.core',\n        'kendo.data'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Filter = kendo.spreadsheet.Filter = kendo.Class.extend({\n            prepare: function () {\n            },\n            value: function (cell) {\n                return cell.value;\n            },\n            matches: function () {\n                throw new Error('The \\'matches\\' method is not implemented.');\n            },\n            toJSON: function () {\n                throw new Error('The \\'toJSON\\' method is not implemented.');\n            }\n        });\n        Filter.create = function (options) {\n            var filter = options.filter;\n            if (!filter) {\n                throw new Error('Filter type not specified.');\n            }\n            var constructor = kendo.spreadsheet[filter.charAt(0).toUpperCase() + filter.substring(1) + 'Filter'];\n            if (!constructor) {\n                throw new Error('Filter type not recognized.');\n            }\n            return new constructor(options);\n        };\n        kendo.spreadsheet.ValueFilter = Filter.extend({\n            _values: [],\n            _dates: [],\n            _blanks: false,\n            init: function (options) {\n                if (options.values !== undefined) {\n                    this._values = options.values;\n                }\n                if (options.blanks !== undefined) {\n                    this._blanks = options.blanks;\n                }\n                if (options.dates !== undefined) {\n                    this._dates = options.dates;\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (this._dates.length > 0 && cell.format && typeof value === 'number') {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            matches: function (value) {\n                if (value === null || value === undefined) {\n                    return this._blanks;\n                }\n                if (value instanceof Date) {\n                    return this._dates.some(function (date) {\n                        return date.year === value.getFullYear() && (date.month === undefined || date.month === value.getMonth()) && (date.day === undefined || date.day === value.getDate()) && (date.hours === undefined || date.hours === value.getHours()) && (date.minutes === undefined || date.minutes === value.getMinutes()) && (date.seconds === undefined || date.seconds === value.getSeconds());\n                    });\n                }\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'value',\n                    values: this._values.slice(0)\n                };\n            }\n        });\n        kendo.spreadsheet.CustomFilter = Filter.extend({\n            _logic: 'and',\n            init: function (options) {\n                if (options.logic !== undefined) {\n                    this._logic = options.logic;\n                }\n                if (options.criteria === undefined) {\n                    throw new Error('Must specify criteria.');\n                }\n                this._criteria = options.criteria;\n                var expression = kendo.data.Query.filterExpr({\n                    logic: this._logic,\n                    filters: this._criteria\n                }).expression;\n                this._matches = new Function('d', 'return ' + expression);\n            },\n            matches: function (value) {\n                if (value === null) {\n                    return false;\n                }\n                return this._matches(value);\n            },\n            value: function (cell) {\n                var value = cell.value;\n                var criterionValue = this._criteria[0].value;\n                var criterionType = criterionValue instanceof Date ? 'date' : typeof criterionValue;\n                var valueType = typeof value;\n                if (cell.format) {\n                    valueType = kendo.spreadsheet.formatting.type(value, cell.format);\n                }\n                if (valueType != criterionType) {\n                    if (criterionType == 'string') {\n                        if (cell.format) {\n                            value = kendo.spreadsheet.formatting.text(value, cell.format);\n                        }\n                        value = value + '';\n                    }\n                } else if (valueType == 'date') {\n                    value = kendo.spreadsheet.numberToDate(value);\n                }\n                return value;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'custom',\n                    logic: this._logic,\n                    criteria: this._criteria\n                };\n            }\n        });\n        kendo.spreadsheet.TopFilter = Filter.extend({\n            init: function (options) {\n                this._type = options.type;\n                this._value = options.value;\n                this._values = [];\n            },\n            prepare: function (cells) {\n                var values = cells.map(this.value).sort().filter(function (value, index, array) {\n                    return index === 0 || value !== array[index - 1];\n                });\n                if (this._type === 'topNumber' || this._type == 'topPercent') {\n                    values.sort(function (x, y) {\n                        return y - x;\n                    });\n                } else {\n                    values.sort(function (x, y) {\n                        return x - y;\n                    });\n                }\n                var count = this._value;\n                if (this._type === 'topPercent' || this._type === 'bottomPercent') {\n                    count = values.length * count / 100 >> 0;\n                }\n                this._values = values.slice(0, count);\n            },\n            matches: function (value) {\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'top',\n                    type: this._type,\n                    value: this._value\n                };\n            }\n        });\n        kendo.spreadsheet.DynamicFilter = Filter.extend({\n            init: function (options) {\n                this._type = options.type;\n                this._predicate = this[options.type];\n                if (typeof this._predicate !== 'function') {\n                    throw new Error('DynamicFilter type \\'' + options.type + '\\' not recognized.');\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (cell.format) {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            prepare: function (cells) {\n                var sum = 0;\n                var count = 0;\n                for (var ci = 0; ci < cells.length; ci++) {\n                    var value = this.value(cells[ci]);\n                    if (typeof value === 'number') {\n                        sum += value;\n                        count++;\n                    }\n                }\n                if (count > 0) {\n                    this._average = sum / count;\n                } else {\n                    this._average = 0;\n                }\n            },\n            matches: function (value) {\n                return this._predicate(value);\n            },\n            aboveAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value > this._average;\n            },\n            belowAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value < this._average;\n            },\n            tomorrow: function (value) {\n                if (value instanceof Date) {\n                    var tomorrow = kendo.date.addDays(kendo.date.today(), 1);\n                    return kendo.date.getDate(value).getTime() === tomorrow.getTime();\n                }\n                return false;\n            },\n            today: function (value) {\n                if (value instanceof Date) {\n                    return kendo.date.isToday(value);\n                }\n                return false;\n            },\n            yesterday: function (value) {\n                if (value instanceof Date) {\n                    var yesterday = kendo.date.addDays(kendo.date.today(), -1);\n                    return kendo.date.getDate(value).getTime() === yesterday.getTime();\n                }\n                return false;\n            },\n            nextWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), 7), value);\n            },\n            thisWeek: function (value) {\n                return sameWeek(kendo.date.today(), value);\n            },\n            lastWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), -7), value);\n            },\n            nextMonth: function (value) {\n                return sameMonth(value, 1);\n            },\n            thisMonth: function (value) {\n                return sameMonth(value, 0);\n            },\n            lastMonth: function (value) {\n                return sameMonth(value, -1);\n            },\n            nextQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() + 1 === value.getFullYear();\n                }\n                return false;\n            },\n            thisQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 0 && today.getFullYear() === value.getFullYear();\n                }\n                return false;\n            },\n            lastQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(today) - quarter(value);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() - 1 === value.getFullYear();\n                }\n                return false;\n            },\n            nextYear: function (value) {\n                return sameYear(value, 1);\n            },\n            thisYear: function (value) {\n                return sameYear(value, 0);\n            },\n            lastYear: function (value) {\n                return sameYear(value, -1);\n            },\n            yearToDate: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    return value.getFullYear() === today.getFullYear() && value <= today;\n                }\n                return false;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'dynamic',\n                    type: this._type\n                };\n            }\n        });\n        [\n            1,\n            2,\n            3,\n            4\n        ].forEach(function (target) {\n            kendo.spreadsheet.DynamicFilter.prototype['quarter' + target] = function (value) {\n                if (value instanceof Date) {\n                    return quarter(value) === target;\n                }\n                return false;\n            };\n        });\n        kendo.cultures['en-US'].calendar.months.names.forEach(function (month, index) {\n            kendo.spreadsheet.DynamicFilter.prototype[month.toLowerCase()] = function (value) {\n                if (value instanceof Date) {\n                    return value.getMonth() === index;\n                }\n                return false;\n            };\n        });\n        function quarter(value) {\n            var month = value.getMonth() + 1;\n            if (month >= 1 && month <= 3) {\n                return 1;\n            } else if (month >= 4 && month <= 6) {\n                return 2;\n            } else if (month >= 7 && month <= 9) {\n                return 3;\n            } else {\n                return 4;\n            }\n        }\n        function sameYear(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.today();\n                today.setFullYear(today.getFullYear() + offset);\n                return today.getFullYear() === value.getFullYear();\n            }\n            return false;\n        }\n        function sameMonth(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.firstDayOfMonth(kendo.date.today());\n                today.setMonth(today.getMonth() + offset, 1);\n                return today.getTime() === kendo.date.firstDayOfMonth(value).getTime();\n            }\n            return false;\n        }\n        function sameWeek(a, b) {\n            if (b instanceof Date) {\n                var firstWeek = kendo.date.dayOfWeek(kendo.date.getDate(a), 1);\n                var secondWeek = kendo.date.dayOfWeek(kendo.date.getDate(b), 1);\n                return firstWeek.getTime() === secondWeek.getTime();\n            }\n            return false;\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sorter', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Sorter = kendo.Class.extend({\n            init: function (grid, lists) {\n                this._grid = grid;\n                this._lists = lists;\n            },\n            indices: function (rangeRef, list, ascending, indices) {\n                var comparer = Sorter.ascendingComparer;\n                if (ascending === false) {\n                    comparer = Sorter.descendingComparer;\n                }\n                return list.sortedIndices(this._grid.cellRefIndex(rangeRef.topLeft), this._grid.cellRefIndex(rangeRef.bottomRight), comparer, indices);\n            },\n            sortBy: function (ref, column, list, ascending, indices) {\n                var sortedIndices = this.indices(ref.toColumn(column), list, ascending, indices);\n                for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col; ci++) {\n                    var start = this._grid.index(ref.topLeft.row, ci);\n                    var end = this._grid.index(ref.bottomRight.row, ci);\n                    for (var li = 0; li < this._lists.length; li++) {\n                        if (start < this._lists[li].lastRangeStart()) {\n                            this._lists[li].sort(start, end, sortedIndices);\n                        }\n                    }\n                }\n                return sortedIndices;\n            }\n        });\n        Sorter.ascendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            var typeA = typeof a;\n            var typeB = typeof b;\n            if (typeA === 'number') {\n                if (typeB === 'number') {\n                    return a - b;\n                } else {\n                    return -1;\n                }\n            }\n            if (typeA === 'string') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return a.localeCompare(b);\n                default:\n                    return -1;\n                }\n            }\n            if (typeA === 'boolean') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return 1;\n                case 'boolean':\n                    return a - b;\n                default:\n                    return -1;\n                }\n            }\n            if (a instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                if (b instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                    return 0;\n                } else {\n                    return 1;\n                }\n            }\n            throw new Error('Cannot compare ' + a + ' and ' + b);\n        };\n        Sorter.descendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            return Sorter.ascendingComparer(b, a);\n        };\n        kendo.spreadsheet.Sorter = Sorter;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/numformat', [\n        'spreadsheet/calc',\n        'kendo.dom'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var calc = kendo.spreadsheet.calc;\n    var dom = kendo.dom;\n    var RX_COLORS = /^\\[(black|green|white|blue|magenta|yellow|cyan|red)\\]/i;\n    var RX_CONDITION = /^\\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\\]/;\n    function parse(input) {\n        input = calc.InputStream(input);\n        var sections = [], haveConditional = false, decimalPart;\n        while (!input.eof()) {\n            var sec = readSection();\n            sections.push(sec);\n            if (sec.cond) {\n                haveConditional = true;\n            }\n        }\n        if (!haveConditional) {\n            if (sections.length == 1) {\n                sections[0].cond = 'num';\n            } else if (sections.length == 2) {\n                sections[0].cond = {\n                    op: '>=',\n                    value: 0\n                };\n                sections[1].cond = {\n                    op: '<',\n                    value: 0\n                };\n            } else if (sections.length >= 3) {\n                sections[0].cond = {\n                    op: '>',\n                    value: 0\n                };\n                sections[1].cond = {\n                    op: '<',\n                    value: 0\n                };\n                sections[2].cond = {\n                    op: '=',\n                    value: 0\n                };\n                if (sections.length > 3) {\n                    sections[3].cond = 'text';\n                    sections = sections.slice(0, 4);\n                }\n            }\n        }\n        return sections;\n        function maybeColor() {\n            var m = input.skip(RX_COLORS);\n            if (m) {\n                return m[1].toLowerCase();\n            }\n        }\n        function maybeCondition() {\n            var m = input.skip(RX_CONDITION);\n            if (m) {\n                var val = parseFloat(m[2]);\n                if (!isNaN(val)) {\n                    return {\n                        op: m[1],\n                        value: val\n                    };\n                }\n            }\n        }\n        function readFormat() {\n            var format = [], tok, prev = null;\n            while (!input.eof() && (tok = readNext())) {\n                if (tok.type == 'date') {\n                    if (prev && /^(el)?time$/.test(prev.type) && prev.part == 'h' && tok.part == 'm' && tok.format < 3) {\n                        tok.type = 'time';\n                    }\n                } else if (/^(el)?time$/.test(tok.type) && tok.part == 's') {\n                    if (prev && prev.type == 'date' && prev.part == 'm' && prev.format < 3) {\n                        prev.type = 'time';\n                    }\n                }\n                if (!/^(?:str|space|fill)$/.test(tok.type)) {\n                    prev = tok;\n                }\n                format.push(tok);\n            }\n            return format;\n        }\n        function maybeFraction(tok) {\n            if (tok.type != 'date' || tok.part == 'm' && tok.format < 3) {\n                var m = input.skip(/^\\.(0+)/);\n                if (m) {\n                    tok.fraction = m[1].length;\n                    if (tok.type == 'date') {\n                        tok.type = 'time';\n                    }\n                }\n            }\n            return tok;\n        }\n        function readNext() {\n            var ch, m;\n            if (m = input.skip(/^([#0?]+)(?:,([#0?]+))+/)) {\n                return {\n                    type: 'digit',\n                    sep: true,\n                    format: m[1] + m[2],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^[#0?]+/)) {\n                return {\n                    type: 'digit',\n                    sep: false,\n                    format: m[0],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^(e)([+-])/i)) {\n                return {\n                    type: 'exp',\n                    ch: m[1],\n                    sign: m[2]\n                };\n            }\n            if (m = input.skip(/^(d{1,4}|m{1,5}|yyyy|yy)/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'date',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^(hh?|ss?)/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'time',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^\\[(hh?|mm?|ss?)\\]/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'eltime',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^(am\\/pm|a\\/p)/i)) {\n                m = m[1].split('/');\n                return {\n                    type: 'ampm',\n                    am: m[0],\n                    pm: m[1]\n                };\n            }\n            switch (ch = input.next()) {\n            case ';':\n                return null;\n            case '\\\\':\n                return {\n                    type: 'str',\n                    value: input.next()\n                };\n            case '\"':\n                return {\n                    type: 'str',\n                    value: input.readEscaped(ch)\n                };\n            case '@':\n                return { type: 'text' };\n            case '_':\n                return {\n                    type: 'space',\n                    value: input.next()\n                };\n            case '*':\n                return {\n                    type: 'fill',\n                    value: input.next()\n                };\n            case '.':\n                if (input.lookingAt(/^\\s*[#0?]/)) {\n                    decimalPart = true;\n                    return { type: 'dec' };\n                }\n                return {\n                    type: 'str',\n                    value: '.'\n                };\n            case '%':\n                return { type: 'percent' };\n            case ',':\n                return { type: 'comma' };\n            }\n            return {\n                type: 'str',\n                value: ch\n            };\n        }\n        function readSection() {\n            decimalPart = false;\n            var color = maybeColor(), cond = maybeCondition();\n            if (!color && cond) {\n                color = maybeColor();\n            }\n            return {\n                color: color,\n                cond: cond,\n                body: readFormat()\n            };\n        }\n    }\n    function print(sections) {\n        return sections.map(printSection).join(';');\n        function printSection(sec) {\n            var out = '';\n            if (sec.color) {\n                out += '[' + sec.color + ']';\n            }\n            if (sec.cond) {\n                if (!(sec.cond == 'text' || sec.cond == 'num')) {\n                    out += '[' + sec.cond.op + sec.cond.value + ']';\n                }\n            }\n            out += sec.body.map(printToken).join('');\n            return out;\n        }\n        function maybeFraction(fmt, tok) {\n            if (tok.fraction) {\n                fmt += '.' + padLeft('', tok.fraction, '0');\n            }\n            return fmt;\n        }\n        function printToken(tok) {\n            if (tok.type == 'digit') {\n                if (tok.sep) {\n                    return tok.format.charAt(0) + ',' + tok.format.substr(1);\n                } else {\n                    return tok.format;\n                }\n            } else if (tok.type == 'exp') {\n                return tok.ch + tok.sign;\n            } else if (tok.type == 'date' || tok.type == 'time') {\n                return maybeFraction(padLeft('', tok.format, tok.part), tok);\n            } else if (tok.type == 'eltime') {\n                return maybeFraction('[' + padLeft('', tok.format, tok.part) + ']', tok);\n            } else if (tok.type == 'ampm') {\n                return tok.am + '/' + tok.pm;\n            } else if (tok.type == 'str') {\n                return JSON.stringify(tok.value);\n            } else if (tok.type == 'text') {\n                return '@';\n            } else if (tok.type == 'space') {\n                return '_' + tok.value;\n            } else if (tok.type == 'fill') {\n                return '*' + tok.value;\n            } else if (tok.type == 'dec') {\n                return '.';\n            } else if (tok.type == 'percent') {\n                return '%';\n            } else if (tok.type == 'comma') {\n                return ',';\n            }\n        }\n    }\n    function adjustDecimals(sections, x) {\n        sections.forEach(function (sec) {\n            var diff = x;\n            if (sec.cond == 'text') {\n                return;\n            }\n            var body = sec.body, adjusted = false, i = body.length;\n            while (diff !== 0 && --i >= 0) {\n                var tok = body[i];\n                if (tok.type == 'digit') {\n                    if (tok.decimal) {\n                        adjusted = true;\n                        if (diff > 0) {\n                            tok.format += padLeft('', diff, '0');\n                        } else if (diff < 0) {\n                            var tmp = tok.format.length;\n                            tok.format = tok.format.substr(0, tmp + diff);\n                            diff += tmp - tok.format.length;\n                        }\n                        if (tok.format.length === 0) {\n                            body.splice(i, 1);\n                            while (--i >= 0) {\n                                tok = body[i];\n                                if (tok.type == 'digit' && tok.decimal) {\n                                    ++i;\n                                    break;\n                                }\n                                if (tok.type == 'dec') {\n                                    body.splice(i, 1);\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                    if (diff > 0) {\n                        break;\n                    }\n                }\n            }\n            if (!adjusted && diff > 0) {\n                body.splice(i + 1, 0, { type: 'dec' }, {\n                    type: 'digit',\n                    sep: false,\n                    decimal: true,\n                    format: padLeft('', diff, '0')\n                });\n            }\n        });\n    }\n    function TokenStream(parts) {\n        var index = 0;\n        return {\n            next: function () {\n                return parts[index++];\n            },\n            eof: function () {\n                return index >= parts.length;\n            },\n            ahead: function (n, f) {\n                if (index + n <= parts.length) {\n                    var val = f.apply(null, parts.slice(index, index + n));\n                    if (val) {\n                        index += n;\n                    }\n                    return val;\n                }\n            },\n            restart: function () {\n                index = 0;\n            }\n        };\n    }\n    function compileFormatPart(format) {\n        var input = TokenStream(format.body);\n        var hasDate = false;\n        var hasTime = false;\n        var hasAmpm = false;\n        var percentCount = 0;\n        var scaleCount = 0;\n        var code = '';\n        var separeThousands = false;\n        var declen = 0;\n        var intFormat = [], decFormat = [];\n        var condition = format.cond;\n        var preamble = '';\n        if (condition == 'text') {\n            preamble = 'if (typeof value == \\'string\\' || value instanceof kendo.spreadsheet.CalcError) { ';\n        } else if (condition == 'num') {\n            preamble = 'if (typeof value == \\'number\\') { ';\n        } else if (condition) {\n            var op = condition.op == '=' ? '==' : condition.op;\n            preamble = 'if (typeof value == \\'number\\' && value ' + op + ' ' + condition.value + ') { ';\n            code += 'value = Math.abs(value); ';\n        }\n        if (format.color) {\n            code += 'result.color = ' + JSON.stringify(format.color) + '; ';\n        }\n        function checkComma(a, b) {\n            if (a.type == 'digit' && b.type == 'comma' || a.type == 'comma' && a.hidden && b.type == 'comma') {\n                b.hidden = true;\n                scaleCount++;\n            }\n        }\n        while (!input.eof()) {\n            input.ahead(2, checkComma);\n            var tok = input.next();\n            if (tok.type == 'percent') {\n                percentCount++;\n            } else if (tok.type == 'digit') {\n                if (tok.decimal) {\n                    declen += tok.format.length;\n                    decFormat.push(tok.format);\n                } else {\n                    intFormat.push(tok.format);\n                    if (tok.sep) {\n                        separeThousands = true;\n                    }\n                }\n            } else if (tok.type == 'time') {\n                hasTime = true;\n            } else if (tok.type == 'date') {\n                hasDate = true;\n            } else if (tok.type == 'ampm') {\n                hasAmpm = hasTime = true;\n            }\n        }\n        if (percentCount > 0) {\n            code += 'value *= ' + Math.pow(100, percentCount) + '; ';\n        }\n        if (scaleCount > 0) {\n            code += 'value /= ' + Math.pow(1000, scaleCount) + '; ';\n        }\n        if (intFormat.length) {\n            code += 'var intPart = runtime.formatInt(culture, value, ' + JSON.stringify(intFormat) + ', ' + declen + ', ' + separeThousands + '); ';\n        }\n        if (decFormat.length) {\n            code += 'var decPart = runtime.formatDec(value, ' + JSON.stringify(decFormat) + ', ' + declen + '); ';\n        }\n        if (intFormat.length || decFormat.length) {\n            code += 'type = \\'number\\'; ';\n        }\n        if (hasDate) {\n            code += 'var date = runtime.unpackDate(value); ';\n        }\n        if (hasTime) {\n            code += 'var time = runtime.unpackTime(value); ';\n        }\n        if (hasDate || hasTime) {\n            code += 'type = \\'date\\'; ';\n        }\n        if (percentCount > 0 || scaleCount > 0 || intFormat.length || decFormat.length || hasDate || hasTime) {\n            if (!preamble) {\n                preamble = 'if (typeof value == \\'number\\') { ';\n            }\n        }\n        input.restart();\n        while (!input.eof()) {\n            var tok = input.next();\n            if (tok.type == 'dec') {\n                code += 'output += culture.numberFormat[\\'.\\']; ';\n            } else if (tok.type == 'comma' && !tok.hidden) {\n                code += 'output += \\',\\'; ';\n            } else if (tok.type == 'percent') {\n                code += 'type = \\'percent\\'; ';\n                code += 'output += culture.numberFormat.percent.symbol; ';\n            } else if (tok.type == 'str') {\n                code += 'output += ' + JSON.stringify(tok.value) + '; ';\n            } else if (tok.type == 'text') {\n                code += 'type = \\'text\\'; ';\n                code += 'output += value; ';\n            } else if (tok.type == 'space') {\n                code += 'if (output) result.body.push(output); ';\n                code += 'output = \\'\\'; ';\n                code += 'result.body.push({ type: \\'space\\', value: ' + JSON.stringify(tok.value) + ' }); ';\n            } else if (tok.type == 'fill') {\n                code += 'output += runtime.fill(' + JSON.stringify(tok.value) + '); ';\n            } else if (tok.type == 'digit') {\n                code += 'output += ' + (tok.decimal ? 'decPart' : 'intPart') + '.shift(); ';\n            } else if (tok.type == 'date') {\n                code += 'output += runtime.date(culture, date, ' + JSON.stringify(tok.part) + ', ' + tok.format + '); ';\n            } else if (tok.type == 'time') {\n                code += 'output += runtime.time(time, ' + JSON.stringify(tok.part) + ', ' + tok.format + ', ' + hasAmpm + ', ' + tok.fraction + '); ';\n            } else if (tok.type == 'eltime') {\n                code += 'output += runtime.eltime(value, ' + JSON.stringify(tok.part) + ', ' + tok.format + ', ' + tok.fraction + '); ';\n            } else if (tok.type == 'ampm') {\n                code += 'output += time.hours < 12 ? ' + JSON.stringify(tok.am) + ' : ' + JSON.stringify(tok.pm) + '; ';\n            }\n        }\n        code += 'if (output) result.body.push(output); ';\n        code += 'result.type = type; ';\n        code += 'return result; ';\n        if (preamble) {\n            code = preamble + code + '}';\n        }\n        return code;\n    }\n    var CACHE = Object.create(null);\n    var TEXT = compileFormatPart({\n        cond: 'text',\n        body: [{ type: 'text' }]\n    });\n    function compile(format) {\n        var f = CACHE[format];\n        if (!f) {\n            var tree = parse(format);\n            var code = tree.map(compileFormatPart);\n            code.push(TEXT);\n            code = code.join('\\n');\n            code = '\\'use strict\\'; return function(value, culture){ ' + 'if (!culture) culture = kendo.culture(); ' + 'var output = \\'\\', type = null, result = { body: [] }; ' + code + '; return result; };';\n            f = CACHE[format] = new Function('runtime', code)(runtime);\n        }\n        return f;\n    }\n    var runtime = {\n        unpackDate: calc.runtime.unpackDate,\n        unpackTime: calc.runtime.unpackTime,\n        date: function (culture, d, part, length) {\n            switch (part) {\n            case 'd':\n                switch (length) {\n                case 1:\n                    return d.date;\n                case 2:\n                    return padLeft(d.date, 2, '0');\n                case 3:\n                    return culture.calendars.standard.days.namesAbbr[d.day];\n                case 4:\n                    return culture.calendars.standard.days.names[d.day];\n                }\n                break;\n            case 'm':\n                switch (length) {\n                case 1:\n                    return d.month + 1;\n                case 2:\n                    return padLeft(d.month + 1, 2, '0');\n                case 3:\n                    return culture.calendars.standard.months.namesAbbr[d.month];\n                case 4:\n                    return culture.calendars.standard.months.names[d.month];\n                case 5:\n                    return culture.calendars.standard.months.names[d.month].charAt(0);\n                }\n                break;\n            case 'y':\n                switch (length) {\n                case 2:\n                    return d.year % 100;\n                case 4:\n                    return d.year;\n                }\n                break;\n            }\n            return '##';\n        },\n        time: function (t, part, length, ampm, fraclen) {\n            var ret, fraction;\n            switch (part) {\n            case 'h':\n                ret = padLeft(ampm ? t.hours % 12 || 12 : t.hours, length, '0');\n                if (fraclen) {\n                    fraction = (t.minutes + (t.seconds + t.milliseconds / 1000) / 60) / 60;\n                }\n                break;\n            case 'm':\n                ret = padLeft(t.minutes, length, '0');\n                if (fraclen) {\n                    fraction = (t.seconds + t.milliseconds / 1000) / 60;\n                }\n                break;\n            case 's':\n                ret = padLeft(t.seconds, length, '0');\n                if (fraclen) {\n                    fraction = t.milliseconds / 1000;\n                }\n                break;\n            }\n            if (fraction) {\n                ret += fraction.toFixed(fraclen).replace(/^0+/, '');\n            }\n            return ret;\n        },\n        eltime: function (value, part, length, fraclen) {\n            var ret, fraction;\n            switch (part) {\n            case 'h':\n                ret = value * 24;\n                break;\n            case 'm':\n                ret = value * 24 * 60;\n                break;\n            case 's':\n                ret = value * 24 * 60 * 60;\n                break;\n            }\n            if (fraclen) {\n                fraction = ret - (ret | 0);\n            }\n            ret = padLeft(ret | 0, length, '0');\n            if (fraction) {\n                ret += fraction.toFixed(fraclen).replace(/^0+/, '');\n            }\n            return ret;\n        },\n        fill: function (ch) {\n            return ch;\n        },\n        formatInt: function (culture, value, parts, declen, sep) {\n            value = value.toFixed(declen).replace(/\\..*$/, '');\n            if (declen > 0) {\n                if (value === '0') {\n                    value = '';\n                } else if (value === '-0') {\n                    value = '-';\n                }\n            }\n            var iv = value.length - 1;\n            var result = [];\n            var len = 0, str;\n            function add(ch) {\n                if (sep && len && len % 3 === 0 && /^[0-9]$/.test(ch)) {\n                    str = culture.numberFormat[','] + str;\n                }\n                str = ch + str;\n                len++;\n            }\n            for (var j = parts.length; --j >= 0;) {\n                var format = parts[j];\n                str = '';\n                for (var k = format.length; --k >= 0;) {\n                    var chf = format.charAt(k);\n                    if (iv < 0) {\n                        if (chf == '0') {\n                            add('0');\n                        } else if (chf == '?') {\n                            add(' ');\n                        }\n                    } else {\n                        add(value.charAt(iv--));\n                    }\n                }\n                if (j === 0) {\n                    while (iv >= 0) {\n                        add(value.charAt(iv--));\n                    }\n                }\n                result.unshift(str);\n            }\n            return result;\n        },\n        formatDec: function (value, parts, declen) {\n            value = value.toFixed(declen);\n            var pos = value.indexOf('.');\n            if (pos >= 0) {\n                value = value.substr(pos + 1).replace(/0+$/, '');\n            } else {\n                value = '';\n            }\n            var iv = 0;\n            var result = [];\n            for (var j = 0; j < parts.length; ++j) {\n                var format = parts[j];\n                var str = '';\n                for (var k = 0; k < format.length; ++k) {\n                    var chf = format.charAt(k);\n                    if (iv < value.length) {\n                        str += value.charAt(iv++);\n                    } else if (chf == '0') {\n                        str += '0';\n                    } else if (chf == '?') {\n                        str += ' ';\n                    }\n                }\n                result.push(str);\n            }\n            return result;\n        }\n    };\n    function padLeft(val, width, ch) {\n        val += '';\n        while (val.length < width) {\n            val = ch + val;\n        }\n        return val;\n    }\n    function text(f) {\n        var a = f.body;\n        var text = '';\n        for (var i = 0; i < a.length; ++i) {\n            var el = a[i];\n            if (typeof el == 'string') {\n                text += el;\n            } else if (el.type == 'space') {\n                text += ' ';\n            }\n        }\n        return text;\n    }\n    kendo.spreadsheet.formatting = {\n        compile: compile,\n        parse: parse,\n        format: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            var span = dom.element('span');\n            span.__dataType = f.type;\n            var a = f.body;\n            if (f.color) {\n                span.attr.style = { color: f.color };\n            }\n            for (var i = 0; i < a.length; ++i) {\n                var el = a[i];\n                if (typeof el == 'string') {\n                    span.children.push(dom.text(el));\n                } else if (el.type == 'space') {\n                    span.children.push(dom.element('span', { style: { visibility: 'hidden' } }, [dom.text(el.value)]));\n                }\n            }\n            return span;\n        },\n        text: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return text(f);\n        },\n        textAndColor: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return {\n                text: text(f),\n                color: f.color,\n                type: f.type\n            };\n        },\n        type: function (value, format) {\n            return compile(format)(value).type;\n        },\n        adjustDecimals: function (format, diff) {\n            var ast = parse(format);\n            adjustDecimals(ast, diff);\n            return print(ast);\n        }\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions', [\n        'spreadsheet/runtime',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var util = kendo.util;\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var defineAlias = runtime.defineAlias;\n    var CalcError = runtime.CalcError;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var Matrix = runtime.Matrix;\n    var Ref = spreadsheet.Ref;\n    var daysInMonth = runtime.daysInMonth;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var daysInYear = runtime.daysInYear;\n    [\n        'abs',\n        'cos',\n        'sin',\n        'acos',\n        'asin',\n        'tan',\n        'atan',\n        'exp',\n        'sqrt'\n    ].forEach(function (name) {\n        defineFunction(name, Math[name]).args([[\n                '*n',\n                'number'\n            ]]);\n    });\n    defineFunction('ln', Math.log).args([[\n            '*n',\n            'number'\n        ]]);\n    defineFunction('log', function (num, base) {\n        return Math.log(num) / Math.log(base);\n    }).args([\n        [\n            '*num',\n            'number++'\n        ],\n        [\n            '*base',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    10\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$base != 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('log10', function (num) {\n        return Math.log(num) / Math.log(10);\n    }).args([[\n            '*num',\n            'number++'\n        ]]);\n    defineFunction('pi', function () {\n        return Math.PI;\n    }).args([]);\n    defineFunction('sqrtpi', function (n) {\n        return Math.sqrt(n * Math.PI);\n    }).args([[\n            '*num',\n            'number+'\n        ]]);\n    defineFunction('degrees', function (rad) {\n        return 180 * rad / Math.PI % 360;\n    }).args([[\n            '*radians',\n            'number'\n        ]]);\n    defineFunction('radians', function (deg) {\n        return Math.PI * deg / 180;\n    }).args([[\n            '*degrees',\n            'number'\n        ]]);\n    function _cosh(n) {\n        return (Math.exp(n) + Math.exp(-n)) / 2;\n    }\n    defineFunction('cosh', _cosh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acosh', function (n) {\n        return Math.log(n + Math.sqrt(n - 1) * Math.sqrt(n + 1));\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$num >= 1'\n            ]\n        ]\n    ]);\n    function _sinh(n) {\n        return (Math.exp(n) - Math.exp(-n)) / 2;\n    }\n    defineFunction('sinh', _sinh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('asinh', function (n) {\n        return Math.log(n + Math.sqrt(n * n + 1));\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sec', function (n) {\n        return 1 / Math.cos(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sech', function (n) {\n        return 1 / _cosh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csc', function (n) {\n        return 1 / Math.sin(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csch', function (n) {\n        return 1 / _sinh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atan2', function (x, y) {\n        return Math.atan(y / x);\n    }).args([\n        [\n            '*x',\n            'divisor'\n        ],\n        [\n            '*y',\n            'number'\n        ]\n    ]);\n    function _tanh(n) {\n        return _sinh(n) / _cosh(n);\n    }\n    defineFunction('tanh', _tanh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atanh', function (n) {\n        return Math.log(Math.sqrt(1 - n * n) / (1 - n));\n    }).args([[\n            '*num',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('cot', function (n) {\n        return 1 / Math.tan(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('coth', function (n) {\n        return 1 / _tanh(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('acot', function (n) {\n        return Math.PI / 2 - Math.atan(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acoth', function (n) {\n        return Math.log((n + 1) / (n - 1)) / 2;\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'or',\n                [\n                    'assert',\n                    '$num < -1'\n                ],\n                [\n                    'assert',\n                    '$num > 1'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('power', function (a, b) {\n        return Math.pow(a, b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'number'\n        ]\n    ]);\n    defineFunction('mod', function (a, b) {\n        return a % b;\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('quotient', function (a, b) {\n        return Math.floor(a / b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('ceiling', function (num, s) {\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('ceiling.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('iso.ceiling', 'ceiling.precise');\n    defineFunction('ceiling.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor', function (num, s) {\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('floor.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('int', Math.floor).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('mround', function (num, mult) {\n        return mult ? mult * Math.round(num / mult) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*multiple',\n            'number'\n        ]\n    ]);\n    defineFunction('round', function (num, digits) {\n        var sign = num < 0 ? -1 : 1;\n        if (sign < 0) {\n            num = -num;\n        }\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = Math.round(num);\n        return sign * num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('roundup', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('rounddown', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.ceil(num) : Math.floor(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('even', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n + (n < 0 ? -1 : 1) : n;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('odd', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n : n + (n < 0 ? -1 : 1);\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('sign', function (num) {\n        return num < 0 ? -1 : num > 0 ? 1 : 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    function _gcd(a, b) {\n        while (b) {\n            var r = a % b;\n            a = b;\n            b = r;\n        }\n        return a;\n    }\n    function _lcm(a, b) {\n        return Math.abs(a * b) / _gcd(a, b);\n    }\n    defineFunction('gcd', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _gcd(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('lcm', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _lcm(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sum', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('product', function (numbers) {\n        return numbers.reduce(function (prod, num) {\n            return prod * num;\n        }, 1);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumproduct', function (first, rest) {\n        var sum = 0;\n        first.each(function (p, row, col) {\n            if (typeof p == 'number') {\n                for (var i = 0; i < rest.length; ++i) {\n                    var v = rest[i].get(row, col);\n                    if (typeof v != 'number') {\n                        return;\n                    }\n                    p *= v;\n                }\n                sum += p;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a1',\n            'matrix'\n        ],\n        [\n            '+',\n            [\n                'a2',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$a2.width == $a1.width'\n                    ],\n                    [\n                        'assert',\n                        '$a2.height == $a1.height'\n                    ]\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumsq', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num * num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumx2my2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x - y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumx2py2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x + y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumxmy2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += (x - y) * (x - y);\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('seriessum', function (x, n, m, a) {\n        var sum = 0;\n        a.each(function (coef) {\n            if (typeof coef != 'number') {\n                throw new CalcError('VALUE');\n            }\n            sum += coef * Math.pow(x, n);\n            n += m;\n        });\n        return sum;\n    }).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'y',\n            'number'\n        ],\n        [\n            'm',\n            'number'\n        ],\n        [\n            'a',\n            'matrix'\n        ]\n    ]);\n    defineFunction('min', function (numbers) {\n        return Math.min.apply(Math, numbers);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('max', function (numbers) {\n        return Math.max.apply(Math, numbers);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('counta', function (values) {\n        return values.length;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('count', function (numbers) {\n        return numbers.length;\n    }).args([[\n            'numbers',\n            [\n                '#collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('countunique', function (values) {\n        var count = 0, seen = [];\n        values.forEach(function (val) {\n            if (seen.indexOf(val) < 0) {\n                count++;\n                seen.push(val);\n            }\n        });\n        return count;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('countblank', function (a) {\n        var count = 0;\n        function add(val) {\n            if (val == null || val === '') {\n                count++;\n            }\n        }\n        function loop(args) {\n            for (var i = 0; i < args.length; ++i) {\n                var x = args[i];\n                if (x instanceof Matrix) {\n                    x.each(add, true);\n                } else {\n                    add(x);\n                }\n            }\n        }\n        loop(a);\n        return count;\n    }).args([[\n            '+',\n            [\n                'args',\n                [\n                    'or',\n                    'matrix',\n                    'anyvalue'\n                ]\n            ]\n        ]]);\n    defineFunction('iseven', function (num) {\n        return num % 2 === 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('isodd', function (num) {\n        return num % 2 !== 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('n', function (val) {\n        if (typeof val == 'boolean') {\n            return val ? 1 : 0;\n        }\n        if (typeof val == 'number') {\n            return val;\n        }\n        return 0;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('na', function () {\n        return new CalcError('N/A');\n    }).args([]);\n    function forIFS(args, f) {\n        var chunks = [], i = 0, matrix = args[0];\n        while (i < args.length) {\n            chunks.push({\n                matrix: args[i++],\n                pred: parseCriteria(args[i++])\n            });\n        }\n        ROW:\n            for (var row = 0; row < matrix.height; ++row) {\n                COL:\n                    for (var col = 0; col < matrix.width; ++col) {\n                        for (i = 0; i < chunks.length; ++i) {\n                            var val = chunks[i].matrix.get(row, col);\n                            if (!chunks[i].pred(val == null || val === '' ? 0 : val)) {\n                                continue COL;\n                            }\n                        }\n                        f(row, col);\n                    }\n            }\n    }\n    var ARGS_COUNTIFS = [\n        [\n            'm1',\n            'matrix'\n        ],\n        [\n            'c1',\n            'anyvalue'\n        ],\n        [\n            [\n                'm2',\n                'matrix'\n            ],\n            [\n                'c2',\n                'anyvalue'\n            ]\n        ]\n    ];\n    defineFunction('countifs', function (m1, c1, rest) {\n        var count = 0;\n        rest.unshift(m1, c1);\n        forIFS(rest, function () {\n            count++;\n        });\n        return count;\n    }).args(ARGS_COUNTIFS);\n    var ARGS_SUMIFS = [[\n            'range',\n            'matrix'\n        ]].concat(ARGS_COUNTIFS);\n    defineFunction('sumifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val) {\n                sum += val;\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIFS);\n    defineFunction('averageifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0, count = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val == null || val === '') {\n                val = 0;\n            }\n            sum += val;\n            count++;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args(ARGS_SUMIFS);\n    defineFunction('countif', function (matrix, criteria) {\n        criteria = parseCriteria(criteria);\n        var count = 0;\n        matrix.each(function (val) {\n            if (criteria(val)) {\n                count++;\n            }\n        });\n        return count;\n    }).args([\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ]\n    ]);\n    var ARGS_SUMIF = [\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ],\n        [\n            'sumRange',\n            [\n                'or',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$sumRange.width == $range.width'\n                    ],\n                    [\n                        'assert',\n                        '$sumRange.height == $range.height'\n                    ]\n                ],\n                [\n                    'null',\n                    '$range'\n                ]\n            ]\n        ]\n    ];\n    defineFunction('sumif', function (range, criteria, sumRange) {\n        var sum = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                }\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIF);\n    defineFunction('averageif', function (range, criteria, sumRange) {\n        var sum = 0, count = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                    count++;\n                }\n            }\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args(ARGS_SUMIF);\n    (function (def) {\n        def('large', function (numbers, nth) {\n            return numbers.sort(descending)[nth];\n        });\n        def('small', function (numbers, nth) {\n            return numbers.sort(ascending)[nth];\n        });\n    }(function (name, handler) {\n        defineFunction(name, function (matrix, nth) {\n            var numbers = [];\n            var error = matrix.each(function (val) {\n                if (val instanceof CalcError) {\n                    return val;\n                }\n                if (typeof val == 'number') {\n                    numbers.push(val);\n                }\n            });\n            if (error) {\n                return error;\n            }\n            if (nth > numbers.length) {\n                return new CalcError('NUM');\n            }\n            return handler(numbers, nth - 1);\n        }).args([\n            [\n                'array',\n                'matrix'\n            ],\n            [\n                '*nth',\n                'number++'\n            ]\n        ]);\n    }));\n    function _avg(numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n    }\n    function _var_sp(numbers, divisor, avg) {\n        if (avg == null) {\n            avg = _avg(numbers);\n        }\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.pow(num - avg, 2);\n        }, 0) / divisor;\n    }\n    function _stdev_sp(numbers, divisor) {\n        return Math.sqrt(_var_sp(numbers, divisor));\n    }\n    defineFunction('stdev.s', function (numbers) {\n        return _stdev_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('stdev.p', function (numbers) {\n        return _stdev_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.s', function (numbers) {\n        return _var_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.p', function (numbers) {\n        return _var_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('median', function (numbers) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        if (n % 2) {\n            return numbers[n >> 1];\n        }\n        return (numbers[n >> 1] + numbers[n >> 1 + 1]) / 2;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('mode.sngl', function (numbers) {\n        numbers.sort(ascending);\n        var prev = null, count = 0, max = 1, mode = null;\n        for (var i = 0; i < numbers.length; ++i) {\n            var n = numbers[i];\n            if (n != prev) {\n                count = 1;\n                prev = n;\n            } else {\n                count++;\n            }\n            if (count > max) {\n                max = count;\n                mode = n;\n            }\n        }\n        return mode == null ? new CalcError('N/A') : mode;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('mode.mult', function (numbers) {\n        var seen = Object.create(null), max = 2, res = [];\n        numbers.forEach(function (num) {\n            var s = seen[num] || 0;\n            seen[num] = ++s;\n            if (s == max) {\n                res.push(num);\n            } else if (s > max) {\n                max = s;\n                res = [num];\n            }\n        });\n        var m = new Matrix(this);\n        res.forEach(function (num, i) {\n            m.set(i, 0, num);\n        });\n        return m;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('geomean', function (numbers) {\n        var n = numbers.length;\n        var p = numbers.reduce(function (p, num) {\n            if (num < 0) {\n                throw new CalcError('NUM');\n            }\n            return p * num;\n        }, 1);\n        return Math.pow(p, 1 / n);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('harmean', function (numbers) {\n        var n = numbers.length;\n        var s = numbers.reduce(function (s, num) {\n            if (!num) {\n                throw new CalcError('DIV/0');\n            }\n            return s + 1 / num;\n        }, 0);\n        return n / s;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('trimmean', function (numbers, p) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        var discard = Math.floor(n * p);\n        if (discard % 2) {\n            --discard;\n        }\n        discard /= 2;\n        var sum = 0;\n        for (var i = discard; i < n - discard; ++i) {\n            sum += numbers[i];\n        }\n        return sum / (n - discard * 2);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'percent',\n            [\n                'and',\n                'number',\n                [\n                    '[between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('frequency', function (data, bins) {\n        data.sort(ascending);\n        bins.sort(ascending);\n        var prev = -Infinity;\n        var i = 0;\n        function count(max) {\n            var n = 0;\n            while (i < data.length && data[i] > prev && data[i] <= max) {\n                ++n;\n                ++i;\n            }\n            return n;\n        }\n        var m = new Matrix(this);\n        bins.forEach(function (val, i) {\n            var n = count(val);\n            prev = val;\n            m.set(i, 0, n);\n        });\n        m.set(m.height, 0, data.length - i);\n        return m;\n    }).args([\n        [\n            'data',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'bins',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ]\n    ]);\n    defineFunction('rank.eq', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        return pos < 0 ? new CalcError('N/A') : pos + 1;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('rank', 'rank.eq');\n    defineFunction('rank.avg', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        if (pos < 0) {\n            return new CalcError('N/A');\n        }\n        for (var i = pos; numbers[i] == val; ++i) {\n        }\n        return (pos + i + 1) / 2;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('kurt', function (numbers) {\n        var n = numbers.length;\n        var avg = _avg(numbers);\n        var variance = _var_sp(numbers, n - 1, avg);\n        var stddev = Math.sqrt(variance);\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + Math.pow((num - avg) / stddev, 4);\n        }, 0);\n        return n * (n + 1) / ((n - 1) * (n - 2) * (n - 3)) * sum - 3 * Math.pow(n - 1, 2) / ((n - 2) * (n - 3));\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 4',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _percentrank(numbers, x, exc) {\n        var nlt = 0, ngt = 0, left = null, right = null, found = false;\n        numbers.forEach(function (num) {\n            if (num < x) {\n                nlt++;\n                left = left == null ? num : Math.max(left, num);\n            } else if (num > x) {\n                ngt++;\n                right = right == null ? num : Math.min(right, num);\n            } else {\n                found = true;\n            }\n        });\n        if (!nlt && !ngt) {\n            return new CalcError('N/A');\n        }\n        if (found) {\n            if (exc) {\n                return (nlt + 1) / (numbers.length + 1);\n            }\n            return nlt / (nlt + ngt);\n        }\n        return ((right - x) * _percentrank(numbers, left, exc) + (x - left) * _percentrank(numbers, right, exc)) / (right - left);\n    }\n    var ARGS_PERCENTRANK = [\n        [\n            'array',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'x',\n            'number'\n        ],\n        [\n            'significance',\n            [\n                'or',\n                [\n                    'null',\n                    3\n                ],\n                'integer++'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array.length > 0',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('percentrank.inc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 0);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineFunction('percentrank.exc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 1);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineAlias('percentrank', 'percentrank.inc');\n    function _covariance(x, y, divisor) {\n        var sum = 0;\n        var ax = _avg(x);\n        var ay = _avg(y);\n        var n = x.length;\n        for (var i = 0; i < n; ++i) {\n            sum += (x[i] - ax) * (y[i] - ay);\n        }\n        return sum / divisor;\n    }\n    defineFunction('covariance.p', function (x, y) {\n        return _covariance(x, y, x.length);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('covariance.s', function (x, y) {\n        return _covariance(x, y, x.length - 1);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineAlias('covar', 'covariance.p');\n    var _fact = util.memoize(function (n) {\n        for (var i = 2, fact = 1; i <= n; ++i) {\n            fact *= i;\n        }\n        return fact;\n    });\n    defineFunction('fact', _fact).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('factdouble', function (n) {\n        for (var i = 2 + (n & 1), fact = 1; i <= n; i += 2) {\n            fact *= i;\n        }\n        return fact;\n    }).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('multinomial', function (numbers) {\n        var div = 1, sum = 0;\n        numbers.forEach(function (n) {\n            if (n < 0) {\n                throw new CalcError('NUM');\n            }\n            sum += n;\n            div *= _fact(n);\n        });\n        return _fact(sum) / div;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    var _combinations = util.memoize(function (n, k) {\n        for (var f1 = k + 1, f2 = 1, p1 = 1, p2 = 1; f2 <= n - k; ++f1, ++f2) {\n            p1 *= f1;\n            p2 *= f2;\n        }\n        return p1 / p2;\n    });\n    defineFunction('combin', _combinations).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('combina', function (n, k) {\n        return _combinations(n + k - 1, n - 1);\n    }).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    1,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('average', function (numbers) {\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n        return sum / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                [\n                    'and',\n                    'number',\n                    [\n                        'not',\n                        'boolean'\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('averagea', function (values) {\n        var sum = 0, count = 0;\n        values.forEach(function (num) {\n            if (typeof num != 'string') {\n                sum += num;\n            }\n            ++count;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args([[\n            'values',\n            [\n                'collect',\n                'anyvalue'\n            ]\n        ]]);\n    function _percentile(numbers, rank) {\n        numbers.sort(ascending);\n        var n = numbers.length;\n        var k = rank | 0, d = rank - k;\n        if (k === 0) {\n            return numbers[0];\n        }\n        if (k >= n) {\n            return numbers[n - 1];\n        }\n        --k;\n        return numbers[k] + d * (numbers[k + 1] - numbers[k]);\n    }\n    function _percentile_inc(numbers, p) {\n        var rank = p * (numbers.length - 1) + 1;\n        return _percentile(numbers, rank);\n    }\n    function _percentile_exc(numbers, p) {\n        var rank = p * (numbers.length + 1);\n        return _percentile(numbers, rank);\n    }\n    defineFunction('percentile.inc', _percentile_inc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('percentile.exc', _percentile_exc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('quartile.inc', function (numbers, quarter) {\n        return _percentile_inc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineFunction('quartile.exc', function (numbers, quarter) {\n        return _percentile_exc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineAlias('quartile', 'quartile.inc');\n    defineAlias('percentile', 'percentile.inc');\n    var AGGREGATE_FUNCS = [\n        'AVERAGE',\n        'COUNT',\n        'COUNTA',\n        'MAX',\n        'MIN',\n        'PRODUCT',\n        'STDEV.S',\n        'STDEV.P',\n        'SUM',\n        'VAR.S',\n        'VAR.P',\n        'MEDIAN',\n        'MODE.SNGL',\n        'LARGE',\n        'SMALL',\n        'PERCENTILE.INC',\n        'QUARTILE.INC',\n        'PERCENTILE.EXC',\n        'QUARTILE.EXC'\n    ];\n    function fetchValuesForAggregate(self, args, options) {\n        var values = [];\n        var opt_ignore_hidden_rows = 1;\n        var opt_ignore_errors = 2;\n        var opt_use_aggregates = 4;\n        (function fetchValues(args) {\n            if (args instanceof Ref) {\n                self.getRefCells(args, true).forEach(function (cell) {\n                    var value = cell.value;\n                    if (options & opt_ignore_hidden_rows && cell.hidden) {\n                        return;\n                    }\n                    if (cell.formula) {\n                        var str = cell.formula.print(cell.row, cell.col);\n                        if (/^\\s*(?:aggregate|subtotal)\\s*\\(/i.test(str)) {\n                            if (!(options & opt_use_aggregates)) {\n                                return;\n                            }\n                        }\n                        if ('value' in cell.formula) {\n                            value = cell.formula.value;\n                        }\n                    }\n                    if (options & opt_ignore_errors && value instanceof CalcError) {\n                        return;\n                    }\n                    if (typeof value == 'number' || value instanceof CalcError) {\n                        values.push(value);\n                    }\n                });\n            } else if (Array.isArray(args)) {\n                for (var i = 0; i < args.length; ++i) {\n                    fetchValues(args[i]);\n                }\n            } else if (args instanceof Matrix) {\n                args.each(fetchValues);\n            } else if (typeof args == 'number') {\n                values.push(args);\n            } else if (args instanceof CalcError && !(options & opt_ignore_errors)) {\n                values.push(args);\n            }\n        }(args));\n        return values;\n    }\n    defineFunction('aggregate', function (callback, funcId, options, args) {\n        var self = this;\n        self.resolveCells(args, function () {\n            var values;\n            if (funcId > 12) {\n                values = fetchValuesForAggregate(self, args[0], options);\n                var k = args[1];\n                if (k instanceof CellRef) {\n                    k = self.getRefData(k);\n                }\n                if (typeof k != 'number') {\n                    return callback(new CalcError('VALUE'));\n                }\n            } else {\n                values = fetchValuesForAggregate(self, args, options);\n            }\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                12,\n                13,\n                14,\n                15,\n                16,\n                17,\n                18,\n                19\n            ]\n        ],\n        [\n            'options',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4,\n                    5,\n                    6,\n                    7\n                ]\n            ]\n        ],\n        [\n            'args',\n            'rest'\n        ]\n    ]);\n    defineFunction('subtotal', function (callback, funcId) {\n        var self = this;\n        var ignoreHidden = funcId > 100;\n        if (ignoreHidden) {\n            funcId -= 100;\n        }\n        var args = [];\n        for (var i = 2; i < arguments.length; ++i) {\n            args.push(arguments[i]);\n        }\n        self.resolveCells(args, function () {\n            var values = fetchValuesForAggregate(self, args, ignoreHidden ? 1 : 0);\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                101,\n                102,\n                103,\n                104,\n                105,\n                106,\n                107,\n                108,\n                109,\n                110,\n                111\n            ]\n        ],\n        [\n            '+',\n            [\n                'ref',\n                [\n                    'or',\n                    'ref',\n                    '#matrix'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('avedev', function (numbers) {\n        var avg = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.abs(num - avg);\n        }, 0) / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _binom_dist(x, n, p, cumulative) {\n        if (!cumulative) {\n            return _combinations(n, x) * Math.pow(p, x) * Math.pow(1 - p, n - x);\n        } else {\n            var sum = 0;\n            for (var j = 0; j <= x; ++j) {\n                sum += _combinations(n, j) * Math.pow(p, j) * Math.pow(1 - p, n - j);\n            }\n            return sum;\n        }\n    }\n    defineFunction('binom.dist', _binom_dist).args([\n        [\n            'successes',\n            'integer+'\n        ],\n        [\n            'trials',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$trials >= $successes'\n                ]\n            ]\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('binomdist', 'binom.dist');\n    defineFunction('binom.inv', function (n, p, alpha) {\n        for (var x = 0; x <= n; ++x) {\n            if (_binom_dist(x, n, p, true) >= alpha) {\n                return x;\n            }\n        }\n        return new CalcError('N/A');\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('critbinom', 'binom.inv');\n    defineFunction('binom.dist.range', function (n, p, s, s2) {\n        var sum = 0;\n        for (var k = s; k <= s2; ++k) {\n            sum += _combinations(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);\n        }\n        return sum;\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'successes_min',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$trials'\n                ]\n            ]\n        ],\n        [\n            'successes_max',\n            [\n                'or',\n                [\n                    'and',\n                    'integer',\n                    [\n                        '[between]',\n                        '$successes_min',\n                        '$trials'\n                    ]\n                ],\n                [\n                    'null',\n                    '$successes_min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('negbinom.dist', function (x, k, p, cumulative) {\n        if (cumulative) {\n            var sum = 0;\n            while (x >= 0) {\n                sum += _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n                x--;\n            }\n            return sum;\n        }\n        return _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n    }).args([\n        [\n            'number_f',\n            'integer+'\n        ],\n        [\n            'number_s',\n            'integer+'\n        ],\n        [\n            'probability_s',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('negbinomdist', 'negbinom.dist');\n    defineFunction('address', function (row, col, abs, a1, sheet) {\n        var cell = new CellRef(row - 1, col - 1, abs - 1);\n        if (sheet) {\n            cell.setSheet(sheet, true);\n        }\n        return a1 ? cell.print(0, 0) : cell.print();\n    }).args([\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'abs',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ],\n        [\n            'a1',\n            [\n                'or',\n                [\n                    'null',\n                    true\n                ],\n                'logical'\n            ]\n        ],\n        [\n            'sheet',\n            [\n                'or',\n                'null',\n                'string'\n            ]\n        ]\n    ]);\n    defineFunction('areas', function (ref) {\n        var count = 0;\n        (function loop(x) {\n            if (x instanceof CellRef || x instanceof RangeRef) {\n                count++;\n            } else if (x instanceof UnionRef) {\n                x.refs.forEach(loop);\n            }\n        }(ref));\n        return count;\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('choose', function (index, args) {\n        if (index > args.length) {\n            return new CalcError('N/A');\n        } else {\n            return args[index - 1];\n        }\n    }).args([\n        [\n            '*index',\n            'integer'\n        ],\n        [\n            '+',\n            [\n                'value',\n                'anything'\n            ]\n        ]\n    ]);\n    defineFunction('column', function (ref) {\n        if (!ref) {\n            return this.formula.col + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.col + 1;\n        }\n        return this.asMatrix(ref).mapCol(function (col) {\n            return col + ref.topLeft.col + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('columns', function (m) {\n        return m instanceof Ref ? m.width() : m.width;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('formulatext', function (ref) {\n        var cell = this.getRefCells(ref)[0];\n        if (!cell.formula) {\n            return new CalcError('N/A');\n        }\n        return cell.formula.print(cell.row, cell.col);\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('hlookup', function (value, m, row, approx) {\n        var resultCol = null;\n        m.eachCol(function (col) {\n            var data = m.get(0, col);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultCol = col;\n            } else if (data === value) {\n                resultCol = col;\n                return true;\n            }\n        });\n        if (resultCol == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(row - 1, resultCol);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('index', function (callback, ref, row, col, areanum) {\n        var self = this;\n        if (ref instanceof UnionRef) {\n            ref = ref.refs[areanum - 1];\n        }\n        if (!row && !col || !ref) {\n            return callback(new CalcError('N/A'));\n        }\n        if (ref instanceof CellRef) {\n            ref = ref.toRangeRef();\n        }\n        if (ref instanceof RangeRef) {\n            if (row && col) {\n                if (col > ref.width() || row > ref.height()) {\n                    return callback(new CalcError('REF'));\n                }\n                var cell = ref.toCell(row - 1, col - 1);\n                self.resolveCells([cell], function () {\n                    callback(self.getRefData(cell));\n                });\n                return;\n            }\n            if (!row) {\n                var colRange = ref.toColumn(col - 1);\n                self.resolveCells([colRange], function () {\n                    callback(self.asMatrix(colRange));\n                });\n                return;\n            }\n            if (!col) {\n                var rowRange = ref.toRow(row - 1);\n                self.resolveCells([rowRange], function () {\n                    callback(self.asMatrix(rowRange));\n                });\n                return;\n            }\n        } else if (ref instanceof Matrix) {\n            if (ref.width > 1 && ref.height > 1) {\n                if (row && col) {\n                    return callback(ref.get(row - 1, col - 1));\n                }\n                if (!row) {\n                    return callback(ref.mapRow(function (row) {\n                        return ref.get(row, col - 1);\n                    }));\n                }\n                if (!col) {\n                    return callback(ref.mapCol(function (col) {\n                        return ref.get(row - 1, col);\n                    }));\n                }\n            }\n            if (ref.width == 1) {\n                return callback(ref.get(row - 1, 0));\n            }\n            if (ref.height == 1) {\n                return callback(ref.get(0, col - 1));\n            }\n        } else {\n            callback(new CalcError('REF'));\n        }\n    }).argsAsync([\n        [\n            'range',\n            [\n                'or',\n                'ref',\n                'matrix'\n            ]\n        ],\n        [\n            'row',\n            [\n                'or',\n                'integer+',\n                'null'\n            ]\n        ],\n        [\n            'col',\n            [\n                'or',\n                'integer+',\n                'null'\n            ]\n        ],\n        [\n            'areanum',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('indirect', function (thing) {\n        try {\n            var f = this.formula;\n            var exp = calc.parseFormula(f.sheet, f.row, f.col, thing);\n            if (!(exp.ast instanceof Ref)) {\n                throw 1;\n            }\n            return exp.ast.absolute(f.row, f.col);\n        } catch (ex) {\n            return new CalcError('REF');\n        }\n    }).args([[\n            'thing',\n            'string'\n        ]]);\n    defineFunction('match', function (val, m, type) {\n        var index = 1, cmp;\n        if (type === 0) {\n            cmp = parseCriteria(val);\n        } else if (type === -1) {\n            cmp = parseCriteria('<=' + val);\n        } else if (type === 1) {\n            cmp = parseCriteria('>=' + val);\n        }\n        if (m.each(function (el) {\n                if (el != null && cmp(el)) {\n                    if (type !== 0 && val != el) {\n                        --index;\n                    }\n                    return true;\n                }\n                index++;\n            }, true) && index > 0) {\n            return index;\n        } else {\n            return new CalcError('N/A');\n        }\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    -1,\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('offset', function (ref, rows, cols, height, width) {\n        var topLeft = (ref instanceof CellRef ? ref : ref.topLeft).clone();\n        topLeft.row += rows;\n        topLeft.col += cols;\n        if (topLeft.row < 0 || topLeft.col < 0) {\n            return new CalcError('VALUE');\n        }\n        if (height > 1 || width > 1) {\n            return new RangeRef(topLeft, new CellRef(topLeft.row + height - 1, topLeft.col + width - 1)).setSheet(ref.sheet, ref.hasSheet());\n        }\n        return topLeft;\n    }).args([\n        [\n            'ref',\n            'area'\n        ],\n        [\n            '*rows',\n            'integer'\n        ],\n        [\n            '*cols',\n            'integer'\n        ],\n        [\n            '*height',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.height()'\n                ]\n            ]\n        ],\n        [\n            '*width',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.width()'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('row', function (ref) {\n        if (!ref) {\n            return this.formula.row + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.row + 1;\n        }\n        return this.asMatrix(ref).mapRow(function (row) {\n            return row + ref.topLeft.row + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('rows', function (m) {\n        return m instanceof Ref ? m.height() : m.height;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('vlookup', function (value, m, col, approx) {\n        var resultRow = null;\n        if (typeof value != 'number') {\n            approx = false;\n        }\n        if (typeof value == 'string') {\n            value = value.toLowerCase();\n        }\n        m.eachRow(function (row) {\n            var data = m.get(row, 0);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultRow = row;\n            } else {\n                if (typeof data == 'string') {\n                    data = data.toLowerCase();\n                }\n                if (data === value) {\n                    resultRow = row;\n                    return true;\n                }\n            }\n        });\n        if (resultRow == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(resultRow, col - 1);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('date', function (year, month, date) {\n        return packDate(year, month - 1, date);\n    }).args([\n        [\n            '*year',\n            'integer'\n        ],\n        [\n            '*month',\n            'integer'\n        ],\n        [\n            '*date',\n            'integer'\n        ]\n    ]);\n    defineFunction('day', function (date) {\n        return unpackDate(date).date;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('month', function (date) {\n        return unpackDate(date).month + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('year', function (date) {\n        return unpackDate(date).year;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weekday', function (date) {\n        return unpackDate(date).day + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weeknum', function (date, type) {\n        var fw = packDate(unpackDate(date).year, 0, 1);\n        var sy = unpackDate(fw);\n        var diff;\n        if (type == 21) {\n            diff = 3 - (sy.day + 6) % 7;\n            if (diff < 0) {\n                diff += 7;\n            }\n            fw += diff;\n            sy.date += diff;\n            sy.day = 4;\n            type = 1;\n        } else {\n            if (type == 1) {\n                type = 0;\n            } else if (type == 2) {\n                type = 1;\n            } else {\n                type = (type - 10) % 7;\n            }\n        }\n        diff = sy.day - type;\n        if (diff < 0) {\n            diff += 7;\n        }\n        fw -= diff;\n        return Math.ceil((date + 1 - fw) / 7);\n    }).args([\n        [\n            '*date',\n            'date'\n        ],\n        [\n            '*type',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    11,\n                    12,\n                    13,\n                    14,\n                    15,\n                    16,\n                    17,\n                    21\n                ]\n            ]\n        ]\n    ]);\n    function weeksInYear(year) {\n        var d = unpackDate(packDate(year, 0, 1));\n        if (d.day == 4 || d.day == 3 && runtime.isLeapYear(year)) {\n            return 53;\n        }\n        return 52;\n    }\n    defineFunction('isoweeknum', function isoweeknum(date) {\n        var d = unpackDate(date);\n        var dow = d.day || 7;\n        var wk = Math.floor((d.ord - dow + 10) / 7);\n        if (wk < 1) {\n            return weeksInYear(d.year - 1);\n        } else if (wk == 53 && wk > weeksInYear(d.year)) {\n            return 1;\n        }\n        return wk;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('now', function () {\n        return runtime.dateToSerial(new Date());\n    }).args([]);\n    defineFunction('today', function () {\n        return runtime.dateToSerial(new Date()) | 0;\n    }).args([]);\n    defineFunction('time', function (hh, mm, ss) {\n        return runtime.packTime(hh, mm, ss, 0);\n    }).args([\n        [\n            '*hours',\n            'integer'\n        ],\n        [\n            '*minutes',\n            'integer'\n        ],\n        [\n            '*seconds',\n            'integer'\n        ]\n    ]);\n    defineFunction('hour', function (time) {\n        return runtime.unpackTime(time).hours;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('minute', function (time) {\n        return runtime.unpackTime(time).minutes;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('second', function (time) {\n        return runtime.unpackTime(time).seconds;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('edate', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('eomonth', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = daysInMonth(y, m);\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('workday', function (date, n, holidays) {\n        var inc = n > 0 ? 1 : -1;\n        n = Math.abs(n);\n        var dow = unpackDate(date).day;\n        while (n > 0) {\n            date += inc;\n            dow = (dow + inc) % 7;\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                --n;\n            }\n        }\n        return date;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'days',\n            'integer'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('networkdays', function (date, end, holidays) {\n        if (date > end) {\n            var tmp = date;\n            date = end;\n            end = tmp;\n        }\n        var count = 0;\n        var dow = unpackDate(date).day;\n        while (date <= end) {\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                count++;\n            }\n            date++;\n            dow = (dow + 1) % 7;\n        }\n        return count;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'end_date',\n            'date'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('days', function (start, end) {\n        return end - start;\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ]\n    ]);\n    function _days_360(start, end, method) {\n        var d1 = unpackDate(start);\n        var d2 = unpackDate(end);\n        if (method) {\n            if (d1.date == 31) {\n                d1.date = 30;\n            }\n            if (d2.date == 31) {\n                d2.date = 30;\n            }\n        } else {\n            if (d1.month == 1 && d2.month == 1 && d1.date == daysInMonth(d1.year, 1) && d2.date == daysInMonth(d2.year, 1)) {\n                d2.date = 30;\n            }\n            if (d1.date == daysInMonth(d1.year, d1.month)) {\n                d1.date = 30;\n                if (d2.date == 31) {\n                    d2.date = 30;\n                }\n            } else {\n                if (d1.date == 30 && d2.date == 31) {\n                    d2.date = 30;\n                }\n            }\n        }\n        return 360 * (d2.year - d1.year) + 30 * (d2.month - d1.month) + (d2.date - d1.date);\n    }\n    runtime._days_360 = _days_360;\n    defineFunction('days360', _days_360).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('yearfrac', function (start, end, method) {\n        switch (method) {\n        case 0:\n            return _days_360(start, end, false) / 360;\n        case 1:\n            return (end - start) / daysInYear(unpackDate(start).year);\n        case 2:\n            return (end - start) / 360;\n        case 3:\n            return (end - start) / 365;\n        case 4:\n            return _days_360(start, end, true) / 360;\n        }\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('datevalue', function (text) {\n        var date = runtime.parseDate(text);\n        if (date) {\n            return runtime.dateToSerial(date);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('timevalue', function (text) {\n        var m = text.toLowerCase().match(/(\\d+):(\\d+)(:(\\d+)(\\.(\\d+))?)?\\s*(am?|pm?)?/);\n        if (m) {\n            var hh = parseFloat(m[1]);\n            var mm = parseFloat(m[2]);\n            var ss = m[3] ? parseFloat(m[4]) : 0;\n            var ampm = m[7];\n            if (ampm && (hh > 12 || hh < 1)) {\n                return new CalcError('VALUE');\n            }\n            if (/^p/.test(ampm)) {\n                hh += 12;\n            }\n            return runtime.packTime(hh, mm, ss, 0);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mdeterm', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.determinant();\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('transpose', function (m) {\n        return m.transpose();\n    }).args([[\n            'range',\n            'matrix'\n        ]]);\n    defineFunction('mmult', function (a, b) {\n        return a.multiply(b);\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.height == $a.width'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('munit', function (n) {\n        return new Matrix(this).unit(n);\n    }).args([[\n            'n',\n            'integer+'\n        ]]);\n    defineFunction('minverse', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.inverse() || new CalcError('VALUE');\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('rand', function () {\n        return Math.random();\n    }).args([]);\n    defineFunction('randbetween', function (min, max) {\n        return min + Math.floor((max - min + 1) * Math.random());\n    }).args([\n        [\n            'min',\n            'integer'\n        ],\n        [\n            'max',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$max >= $min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('true', function () {\n        return true;\n    }).args([]);\n    defineFunction('false', function () {\n        return true;\n    }).args([]);\n    defineFunction('roman', function (num) {\n        return util.arabicToRoman(num).toUpperCase();\n    }).args([[\n            '*number',\n            'integer'\n        ]]);\n    defineFunction('arabic', function (rom) {\n        var num = util.romanToArabic(rom);\n        return num == null ? new CalcError('VALUE') : num;\n    }).args([[\n            '*roman',\n            'string'\n        ]]);\n    defineFunction('base', function (number, radix, minLen) {\n        var str = number.toString(radix).toUpperCase();\n        while (str.length < minLen) {\n            str = '0' + str;\n        }\n        return str;\n    }).args([\n        [\n            '*number',\n            'integer'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ],\n        [\n            '*minLen',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('decimal', function (text, radix) {\n        text = text.toUpperCase();\n        var val = 0;\n        for (var i = 0; i < text.length; ++i) {\n            var d = text.charCodeAt(i);\n            if (d >= 48 && d <= 57) {\n                d -= 48;\n            } else if (d >= 65 && d < 55 + radix) {\n                d -= 55;\n            } else {\n                return new CalcError('VALUE');\n            }\n            val = val * radix + d;\n        }\n        return val;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('char', function (code) {\n        return String.fromCharCode(code);\n    }).args([[\n            '*code',\n            'integer+'\n        ]]);\n    var RX_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\n    defineFunction('clean', function (text) {\n        return text.replace(RX_NON_PRINTABLE, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('code', function (text) {\n        return text.charAt(0);\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineAlias('unichar', 'char');\n    defineAlias('unicode', 'code');\n    defineFunction('concatenate', function (args) {\n        var out = '';\n        for (var i = 0; i < args.length; ++i) {\n            out += args[i];\n        }\n        return out;\n    }).args([[\n            '+',\n            [\n                '*text',\n                'string'\n            ]\n        ]]);\n    defineFunction('dollar', function (number, decimals) {\n        var format = '$#,##0.DECIMALS;($#,##0.DECIMALS)';\n        var dec = '';\n        while (decimals-- > 0) {\n            dec += '0';\n        }\n        format = format.replace(/DECIMALS/g, dec);\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('exact', function (a, b) {\n        return a === b;\n    }).args([\n        [\n            '*text1',\n            'string'\n        ],\n        [\n            '*text2',\n            'string'\n        ]\n    ]);\n    defineFunction('find', function (substring, string, start) {\n        var pos = string.indexOf(substring, start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('fixed', function (number, decimals, noCommas) {\n        var format = noCommas ? '0.DECIMALS' : '#,##0.DECIMALS';\n        var dec = '';\n        while (decimals-- > 0) {\n            dec += '0';\n        }\n        format = format.replace(/DECIMALS/g, dec);\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            '*noCommas',\n            [\n                'or',\n                'boolean',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('left', function (text, length) {\n        return text.substr(0, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('right', function (text, length) {\n        return text.substr(-length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('len', function (text) {\n        return text.length;\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('lower', function (text) {\n        return text.toLowerCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('upper', function (text) {\n        return text.toUpperCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('ltrim', function (text) {\n        return text.replace(/^\\s+/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('rtrim', function (text) {\n        return text.replace(/\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('trim', function (text) {\n        return text.replace(/^\\s+|\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mid', function (text, start, length) {\n        return text.substr(start - 1, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ]\n    ]);\n    defineFunction('proper', function (text) {\n        return text.toLowerCase().replace(/\\b./g, function (s) {\n            return s.toUpperCase();\n        });\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('replace', function (text, start, length, newText) {\n        return text.substr(0, --start) + newText + text.substr(start + length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ],\n        [\n            '*newText',\n            'string'\n        ]\n    ]);\n    defineFunction('rept', function (text, number) {\n        var out = '';\n        while (number-- > 0) {\n            out += text;\n        }\n        return out;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*number',\n            'integer+'\n        ]\n    ]);\n    defineFunction('search', function (substring, string, start) {\n        var pos = string.toLowerCase().indexOf(substring.toLowerCase(), start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('substitute', function (text, oldText, newText, nth) {\n        if (oldText === newText) {\n            return text;\n        }\n        var pos = -1;\n        function replace() {\n            text = text.substring(0, pos) + newText + text.substring(pos + oldText.length);\n        }\n        while ((pos = text.indexOf(oldText, pos + 1)) >= 0) {\n            if (nth == null) {\n                replace();\n            } else if (--nth === 0) {\n                replace();\n                break;\n            }\n        }\n        return text;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*oldText',\n            'string'\n        ],\n        [\n            '*newText',\n            'string'\n        ],\n        [\n            '*nth',\n            [\n                'or',\n                'integer++',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('t', function (value) {\n        return typeof value == 'string' ? value : '';\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('text', function (value, format) {\n        return spreadsheet.formatting.text(value, format);\n    }).args([\n        [\n            '*value',\n            'anyvalue'\n        ],\n        [\n            '*format',\n            'string'\n        ]\n    ]);\n    defineFunction('value', function (value) {\n        if (typeof value == 'number') {\n            return value;\n        }\n        if (typeof value == 'boolean') {\n            return +value;\n        }\n        value = (value + '').replace(/[$,]/g, '');\n        value = parseFloat(value);\n        return isNaN(value) ? new CalcError('VALUE') : value;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    function Hyperlink(link, text) {\n        this.link = link;\n        this.text = text;\n    }\n    Hyperlink.prototype.toString = function () {\n        return this.text;\n    };\n    defineFunction('hyperlink', function (link, text) {\n        return new Hyperlink(link, text);\n    }).args([\n        [\n            '*link',\n            'string'\n        ],\n        [\n            '*text',\n            [\n                'or',\n                'string',\n                [\n                    'null',\n                    '$link'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('iferror', function (value, valueIfError) {\n        return value instanceof CalcError ? valueIfError : value;\n    }).args([\n        [\n            '*value',\n            'forced!'\n        ],\n        [\n            '*value_if_error',\n            'anyvalue!'\n        ]\n    ]);\n    var parseCriteria = function () {\n        var RXCACHE = Object.create(null);\n        function makeComparator(cmp, x) {\n            if (typeof x == 'string') {\n                var num = parseFloat(x);\n                if (!isNaN(num) && num == x) {\n                    x = num;\n                }\n            }\n            return function (a) {\n                var b = x;\n                if (typeof a == 'string' && typeof b == 'string') {\n                    a = a.toLowerCase();\n                    b = b.toLowerCase();\n                }\n                return cmp(a, b);\n            };\n        }\n        function lc(a) {\n            var num, str;\n            if (typeof a == 'string') {\n                a = a.toLowerCase();\n            }\n            if (/^[0-9.]+%$/.test(a)) {\n                str = a.substr(0, a.length - 1);\n                num = parseFloat(str);\n                if (!isNaN(num) && num == str) {\n                    a = num / 100;\n                }\n            } else if (/^[0-9.]+$/.test(a)) {\n                num = parseFloat(a);\n                if (!isNaN(num) && num == a) {\n                    a = num;\n                }\n            }\n            return a;\n        }\n        function compLT(a, b) {\n            return lc(a) < lc(b);\n        }\n        function compLTE(a, b) {\n            return lc(a) <= lc(b);\n        }\n        function compGT(a, b) {\n            return lc(a) > lc(b);\n        }\n        function compGTE(a, b) {\n            return lc(a) >= lc(b);\n        }\n        function compNE(a, b) {\n            return !compEQ(a, b);\n        }\n        function compEQ(a, b) {\n            if (b instanceof RegExp) {\n                return b.test(a);\n            }\n            if (typeof a == 'string' || typeof b == 'string') {\n                a = String(a);\n                b = String(b);\n            }\n            return lc(a) == lc(b);\n        }\n        return function (cmp) {\n            if (typeof cmp == 'function') {\n                return cmp;\n            }\n            var m;\n            if (m = /^=(.*)$/.exec(cmp)) {\n                return makeComparator(compEQ, m[1]);\n            }\n            if (m = /^<>(.*)$/.exec(cmp)) {\n                return makeComparator(compNE, m[1]);\n            }\n            if (m = /^<=(.*)$/.exec(cmp)) {\n                return makeComparator(compLTE, m[1]);\n            }\n            if (m = /^<(.*)$/.exec(cmp)) {\n                return makeComparator(compLT, m[1]);\n            }\n            if (m = /^>=(.*)$/.exec(cmp)) {\n                return makeComparator(compGTE, m[1]);\n            }\n            if (m = /^>(.*)$/.exec(cmp)) {\n                return makeComparator(compGT, m[1]);\n            }\n            if (/[?*]/.exec(cmp)) {\n                var rx = RXCACHE[cmp];\n                if (!rx) {\n                    rx = cmp.replace(/(~\\?|~\\*|[\\]({\\+\\.\\|\\^\\$\\\\})\\[]|[?*])/g, function (s) {\n                        switch (s) {\n                        case '~?':\n                            return '\\\\?';\n                        case '~*':\n                            return '\\\\*';\n                        case '?':\n                            return '.';\n                        case '*':\n                            return '.*';\n                        default:\n                            return '\\\\' + s;\n                        }\n                    });\n                    rx = RXCACHE[cmp] = new RegExp('^' + rx + '$', 'i');\n                }\n                return makeComparator(compEQ, rx);\n            }\n            return makeComparator(compEQ, cmp);\n        };\n    }();\n    function numericPredicate(val) {\n        return typeof val == 'number' || typeof val == 'boolean' || val == null || val === '';\n    }\n    function ascending(a, b) {\n        return a === b ? 0 : a < b ? -1 : 1;\n    }\n    function descending(a, b) {\n        return a === b ? 0 : a < b ? 1 : -1;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions.2', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var CalcError = runtime.CalcError;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var isLeapYear = runtime.isLeapYear;\n    var daysInMonth = runtime.daysInMonth;\n    var _days_360 = runtime._days_360;\n    defineFunction('ERF', function (ll, ul) {\n        if (ul == null) {\n            return ERF(ll);\n        }\n        return ERF(ul) - ERF(ll);\n    }).args([\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('ERFC', ERFC).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMALN', GAMMALN).args([[\n            'x',\n            'number++'\n        ]]);\n    defineFunction('GAMMA', GAMMA).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMA.DIST', GAMMA_DIST).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('GAMMA.INV', GAMMA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ]\n    ]);\n    defineFunction('NORM.S.DIST', NORM_S_DIST).args([\n        [\n            'z',\n            'number'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.S.INV', NORM_S_INV).args([[\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('NORM.DIST', NORM_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.INV', NORM_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ]\n    ]);\n    defineFunction('BETADIST', BETADIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.DIST', BETA_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.INV', BETA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CHISQ.DIST', chisq_left).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('CHISQ.DIST.RT', chisq_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV', chisq_left_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV.RT', chisq_right_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.TEST', function (ac, ex) {\n        return chisq_test(ac.data, ex.data);\n    }).args([\n        [\n            'actual_range',\n            'matrix'\n        ],\n        [\n            'expected_range',\n            'matrix'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.width == $expected_range.width'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.height == $expected_range.height'\n            ]\n        ]\n    ]);\n    defineFunction('EXPON.DIST', expon).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'lambda',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('POISSON.DIST', poisson).args([\n        [\n            'x',\n            'integer+'\n        ],\n        [\n            'mean',\n            'number+'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST', Fdist).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST.RT', Fdist_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV', Finv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV.RT', Finv_right).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.TEST', Ftest).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FISHER', fisher).args([[\n            'x',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('FISHERINV', fisherinv).args([[\n            'y',\n            'number'\n        ]]);\n    defineFunction('T.DIST', Tdist).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('T.DIST.RT', Tdist_right).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.DIST.2T', Tdist_2tail).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV', Tdist_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV.2T', Tdist_2tail_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.TEST', Tdist_test).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'tails',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    3\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$type != 1 || $array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.T', confidence_t).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++',\n                [\n                    'assert',\n                    '$size != 1',\n                    'DIV/0'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.NORM', confidence_norm).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++'\n            ]\n        ]\n    ]);\n    defineFunction('GAUSS', gauss).args([[\n            'z',\n            'number'\n        ]]);\n    defineFunction('PHI', phi).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('LOGNORM.DIST', lognorm_dist).args([\n        [\n            'x',\n            'number++'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('LOGNORM.INV', lognorm_inv).args([\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ]\n    ]);\n    defineFunction('PROB', prob).args([\n        [\n            'x_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'prob_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$lower_limit'\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$prob_range.length == $x_range.length',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('SLOPE', slope).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('INTERCEPT', intercept).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('PEARSON', pearson).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length == $array1.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length > 0 && $array1.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('RSQ', rsq).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length != 1 && $known_y.length != 1',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('STEYX', steyx).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length >= 3 && $known_y.length >= 3',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FORECAST', forecast).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('LINEST', linest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('LOGEST', logest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('TREND', trend).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('GROWTH', growth).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('FV', FV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $pv'\n            ]\n        ]\n    ]);\n    defineFunction('PV', PV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $fv'\n            ]\n        ]\n    ]);\n    defineFunction('PMT', PMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('NPER', NPER).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('RATE', RATE).args([\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    0.01\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $fv'\n            ]\n        ]\n    ]);\n    defineFunction('IPMT', IPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('PPMT', PPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('CUMPRINC', CUMPRINC).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('CUMIPMT', CUMIPMT).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('NPV', NPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('IRR', IRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('EFFECT', EFFECT).args([\n        [\n            'nominal_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('NOMINAL', NOMINAL).args([\n        [\n            'effect_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('XNPV', XNPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('XIRR', XIRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ISPMT', ISPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('DB', DB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'month',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    12\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('DDB', DDB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('SLN', SLN).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ]\n    ]);\n    defineFunction('SYD', SYD).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'per',\n            'number++'\n        ]\n    ]);\n    defineFunction('VDB', VDB).args([\n        [\n            'cost',\n            'number+'\n        ],\n        [\n            'salvage',\n            'number+'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number+'\n        ],\n        [\n            'end_period',\n            'number+'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number+',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            'no_switch',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    var COUPS_ARGS = [\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('COUPDAYBS', COUPDAYBS).args(COUPS_ARGS);\n    defineFunction('COUPDAYS', COUPDAYS).args(COUPS_ARGS);\n    defineFunction('COUPDAYSNC', COUPDAYSNC).args(COUPS_ARGS);\n    defineFunction('COUPPCD', COUPPCD).args(COUPS_ARGS);\n    defineFunction('COUPNCD', COUPNCD).args(COUPS_ARGS);\n    defineFunction('COUPNUM', COUPNUM).args(COUPS_ARGS);\n    defineFunction('ACCRINTM', ACCRINTM).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ACCRINT', ACCRINT).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'first_interest',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            'calc_method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('DISC', DISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'pr',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('INTRATE', INTRATE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('RECEIVED', RECEIVED).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICE', PRICE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'yld',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICEDISC', PRICEDISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    var MAX_IT = 300, EPS = 2.2204e-16, FP_MIN = 1e-30, f_abs = Math.abs;\n    function ERF(x) {\n        if (f_abs(x) >= 3.3) {\n            return 1 - ERFC(x);\n        }\n        var S = x > 0 ? 1 : -1;\n        if (S == -1) {\n            x = -x;\n        }\n        var m = 0, an = 1;\n        for (var n = 1; n < 100; n++) {\n            m += an;\n            an *= 2 * x * x / (2 * n + 1);\n        }\n        return S * 2 / Math.sqrt(Math.PI) * x * Math.exp(-x * x) * m;\n    }\n    function ERFC(x) {\n        if (f_abs(x) < 3.3) {\n            return 1 - ERF(x);\n        }\n        var s = 1;\n        if (x < 0) {\n            s = -1;\n            x = -x;\n        }\n        var frac = x;\n        for (var n = 8; n >= 1; n -= 0.5) {\n            frac = x + n / frac;\n        }\n        frac = 1 / (x + frac);\n        return s == 1 ? Math.exp(-x * x) / Math.sqrt(Math.PI) * frac : 2 - Math.exp(-x * x) / Math.sqrt(Math.PI) * frac;\n    }\n    function GAMMALN(x) {\n        var cof = [\n            1.000000000190015,\n            76.18009172947146,\n            -86.50532032941678,\n            24.01409824083091,\n            -1.231739572450155,\n            0.001208650973866179,\n            -0.000005395239384953\n        ];\n        var y = x, tmp = x + 5.5, ser = cof[0];\n        tmp -= (x + 0.5) * Math.log(tmp);\n        for (var j = 1; j <= 6; j++) {\n            y += 1;\n            ser += cof[j] / y;\n        }\n        return -tmp + Math.log(Math.sqrt(2 * Math.PI) * ser / x);\n    }\n    function GAMMA(x) {\n        if (x > 0) {\n            return Math.exp(GAMMALN(x));\n        }\n        var pi = Math.PI, y = -x;\n        return -pi / (y * GAMMA(y) * Math.sin(pi * y));\n    }\n    function BETALN(a, b) {\n        return GAMMALN(a) + GAMMALN(b) - GAMMALN(a + b);\n    }\n    function BETA(a, b) {\n        return Math.exp(BETALN(a, b));\n    }\n    function gamma_inc(a, x) {\n        return x < a + 1 ? g_series(a, x) : 1 - g_contfrac(a, x);\n    }\n    function g_series(a, x) {\n        var sum = 1 / a, frac = sum, ap = a;\n        var gln = GAMMALN(a), n;\n        for (n = 1; n <= MAX_IT; n++) {\n            ap++;\n            frac *= x / ap;\n            sum += frac;\n            if (f_abs(frac) < f_abs(sum) * EPS) {\n                break;\n            }\n        }\n        return sum * Math.exp(-x + a * Math.log(x) - gln);\n    }\n    function g_contfrac(a, x) {\n        var f = FP_MIN, c = f, d = 0, aj = 1, bj = x + 1 - a;\n        var gln = GAMMALN(a);\n        for (var i = 1; i <= MAX_IT; i++) {\n            d = bj + aj * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = bj + aj / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            var delta = c * d;\n            f *= delta;\n            if (f_abs(delta - 1) < EPS) {\n                break;\n            }\n            bj += 2;\n            aj = -i * (i - a);\n        }\n        return f * Math.exp(-x - gln + a * Math.log(x));\n    }\n    function GAMMA_DIST(x, a, b, cumulative) {\n        if (!cumulative) {\n            return Math.pow(x / b, a - 1) * Math.exp(-x / b) / (b * GAMMA(a));\n        }\n        return gamma_inc(a, x / b);\n    }\n    function GAMMA_INV(p, a, b) {\n        if (p === 0) {\n            return 0;\n        }\n        if (p == 1) {\n            return Infinity;\n        }\n        var m = 0, M = 10, x = 0, ab = a * b;\n        if (ab > 1) {\n            M *= ab;\n        }\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = GAMMA_DIST(x, a, b, true);\n            if (f_abs(p - q) < 1e-16) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function NORM_S_DIST(x, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-x * x / 2) / Math.sqrt(2 * Math.PI);\n        }\n        return 0.5 + 0.5 * ERF(x / Math.sqrt(2));\n    }\n    function NORM_S_INV(p) {\n        var a = [\n                -39.69683028665376,\n                220.9460984245205,\n                -275.9285104469687,\n                138.357751867269,\n                -30.66479806614716,\n                2.506628277459239\n            ], b = [\n                -54.47609879822406,\n                161.5858368580409,\n                -155.6989798598866,\n                66.80131188771972,\n                -13.28068155288572\n            ], c = [\n                -0.007784894002430293,\n                -0.3223964580411365,\n                -2.400758277161838,\n                -2.549732539343734,\n                4.374664141464968,\n                2.938163982698783\n            ], d = [\n                0.007784695709041462,\n                0.3224671290700398,\n                2.445134137142996,\n                3.754408661907416\n            ];\n        var plow = 0.02425, phigh = 1 - plow;\n        var q, r;\n        if (p < plow) {\n            q = Math.sqrt(-2 * Math.log(p));\n            return (((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        if (phigh < p) {\n            q = Math.sqrt(-2 * Math.log(1 - p));\n            return -(((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        q = p - 0.5;\n        r = q * q;\n        return (((((a[0] * r + a[1]) * r + a[2]) * r + a[3]) * r + a[4]) * r + a[5]) * q / (((((b[0] * r + b[1]) * r + b[2]) * r + b[3]) * r + b[4]) * r + 1);\n    }\n    function NORM_DIST(x, m, s, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-(x - m) * (x - m) / (2 * s * s)) / (s * Math.sqrt(2 * Math.PI));\n        }\n        return NORM_S_DIST((x - m) / s, true);\n    }\n    function NORM_INV(p, m, s) {\n        return m + s * NORM_S_INV(p);\n    }\n    function betastd_pdf(x, a, b) {\n        return Math.exp((a - 1) * Math.log(x) + (b - 1) * Math.log(1 - x) - BETALN(a, b));\n    }\n    function betastd_cdf(x, a, b) {\n        var k = Math.exp(a * Math.log(x) + b * Math.log(1 - x) - BETALN(a, b));\n        return x < (a + 1) / (a + b + 2) ? k * beta_lentz(a, b, x) / a : 1 - k * beta_lentz(b, a, 1 - x) / b;\n    }\n    function beta_lentz(a, b, x) {\n        var m, m2;\n        var aa, c, d, del, h, qab, qam, qap;\n        qab = a + b;\n        qap = a + 1;\n        qam = a - 1;\n        c = 1;\n        d = 1 - qab * x / qap;\n        if (f_abs(d) < FP_MIN) {\n            d = FP_MIN;\n        }\n        d = 1 / d;\n        h = d;\n        for (m = 1; m <= MAX_IT; m++) {\n            m2 = 2 * m;\n            aa = m * (b - m) * x / ((qam + m2) * (a + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            h *= d * c;\n            aa = -(a + m) * (qab + m) * x / ((a + m2) * (qap + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            del = d * c;\n            h *= del;\n            if (f_abs(del - 1) < EPS) {\n                break;\n            }\n        }\n        return h;\n    }\n    function betastd_inv(p, a, b) {\n        var m = 0, M = 1, x = 0;\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = betastd_cdf(x, a, b);\n            if (f_abs(p - q) < EPS) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function BETADIST(x, a, b, m, M) {\n        return betastd_cdf((x - m) / (M - m), a, b);\n    }\n    function BETA_DIST(x, a, b, cdf, m, M) {\n        if (cdf) {\n            return betastd_cdf((x - m) / (M - m), a, b);\n        }\n        return betastd_pdf((x - m) / (M - m), a, b) / (M - m);\n    }\n    function BETA_INV(p, a, b, m, M) {\n        return m + (M - m) * betastd_inv(p, a, b);\n    }\n    function chisq_left(x, n, cds) {\n        return GAMMA_DIST(x, n / 2, 2, cds);\n    }\n    function chisq_right(x, n) {\n        return 1 - chisq_left(x, n, true);\n    }\n    function chisq_left_inv(p, n) {\n        return GAMMA_INV(p, n / 2, 2);\n    }\n    function chisq_right_inv(p, n) {\n        return chisq_left_inv(1 - p, n);\n    }\n    function chisq_test(obsv, expect) {\n        var rows = obsv.length, cols = obsv[0].length;\n        var x = 0, i, j;\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                var eij = expect[i][j];\n                var delta = obsv[i][j] - eij;\n                delta *= delta;\n                x += delta / eij;\n            }\n        }\n        var n = (rows - 1) * (cols - 1);\n        return chisq_right(x, n);\n    }\n    function expon(x, r, cdf) {\n        if (cdf) {\n            return 1 - Math.exp(-r * x);\n        }\n        return r * Math.exp(-r * x);\n    }\n    function poisson(k, m, cdf) {\n        if (cdf) {\n            return 1 - chisq_left(2 * m, 2 * (k + 1), true);\n        }\n        var lnf = 0;\n        for (var i = 2; i <= k; i++) {\n            lnf += Math.log(i);\n        }\n        return Math.exp(k * Math.log(m) - m - lnf);\n    }\n    function Fdist(x, n, d, cdf) {\n        if (cdf) {\n            return betastd_cdf(n * x / (d + n * x), n / 2, d / 2);\n        }\n        var u = n / d;\n        n /= 2;\n        d /= 2;\n        return u / BETA(n, d) * Math.pow(u * x, n - 1) / Math.pow(1 + u * x, n + d);\n    }\n    function Fdist_right(x, n, d) {\n        return 1 - Fdist(x, n, d, true);\n    }\n    function Finv_right(p, n, d) {\n        return d / n * (1 / BETA_INV(p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function Finv(p, n, d) {\n        return d / n * (1 / BETA_INV(1 - p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function _mean(arr) {\n        var me = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            me += arr[i];\n        }\n        return me / n;\n    }\n    function _var_sq(arr, m) {\n        var v = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            var delta = arr[i] - m;\n            v += delta * delta;\n        }\n        return v / (n - 1);\n    }\n    function Ftest(arr1, arr2) {\n        var n1 = arr1.length - 1, n2 = arr2.length - 1;\n        var va1 = _var_sq(arr1, _mean(arr1)), va2 = _var_sq(arr2, _mean(arr2));\n        if (!va1 || !va2) {\n            throw new CalcError('DIV/0');\n        }\n        return 2 * Fdist(va1 / va2, n1, n2, true);\n    }\n    function fisher(x) {\n        return 0.5 * Math.log((1 + x) / (1 - x));\n    }\n    function fisherinv(x) {\n        var e2 = Math.exp(2 * x);\n        return (e2 - 1) / (e2 + 1);\n    }\n    function Tdist(x, n, cdf) {\n        if (cdf) {\n            return 1 - 0.5 * betastd_cdf(n / (x * x + n), n / 2, 0.5);\n        }\n        return 1 / (Math.sqrt(n) * BETA(0.5, n / 2)) * Math.pow(1 + x * x / n, -(n + 1) / 2);\n    }\n    function Tdist_right(x, n) {\n        return 1 - Tdist(x, n, true);\n    }\n    function Tdist_2tail(x, n) {\n        if (x < 0) {\n            x = -x;\n        }\n        return 2 * Tdist_right(x, n);\n    }\n    function Tdist_inv(p, n) {\n        var x = betastd_inv(2 * Math.min(p, 1 - p), n / 2, 0.5);\n        x = Math.sqrt(n * (1 - x) / x);\n        return p > 0.5 ? x : -x;\n    }\n    function Tdist_2tail_inv(p, n) {\n        return Tdist_inv(1 - p / 2, n);\n    }\n    function Tdist_test(gr1, gr2, tail, type) {\n        var n1 = gr1.length, n2 = gr2.length;\n        var t_st, df;\n        if (type == 1) {\n            var d = 0, d2 = 0;\n            for (var i = 0; i < n1; i++) {\n                var delta = gr1[i] - gr2[i];\n                d += delta;\n                d2 += delta * delta;\n            }\n            var md = d / n1;\n            t_st = md / Math.sqrt((d2 - d * md) / (n1 * (n1 - 1)));\n            return tail == 1 ? Tdist_right(t_st, n1 - 1) : Tdist_2tail(t_st, n1 - 1);\n        }\n        var m1 = _mean(gr1), m2 = _mean(gr2), v1 = _var_sq(gr1, m1), v2 = _var_sq(gr2, m2);\n        if (type == 3) {\n            var u1 = v1 / n1, u2 = v2 / n2, u = u1 + u2;\n            var q1 = u1 / u, q2 = u2 / u;\n            df = 1 / (q1 * q1 / (n1 - 1) + q2 * q2 / (n2 - 1));\n            t_st = f_abs(m1 - m2) / Math.sqrt(u);\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        } else {\n            df = n1 + n2 - 2;\n            t_st = f_abs(m1 - m2) * Math.sqrt(df * n1 * n2 / ((n1 + n2) * ((n1 - 1) * v1 + (n2 - 1) * v2)));\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        }\n    }\n    function confidence_t(alpha, stddev, size) {\n        return -Tdist_inv(alpha / 2, size - 1) * stddev / Math.sqrt(size);\n    }\n    function confidence_norm(alpha, stddev, size) {\n        return -NORM_S_INV(alpha / 2) * stddev / Math.sqrt(size);\n    }\n    function gauss(z) {\n        return NORM_S_DIST(z, true) - 0.5;\n    }\n    function phi(x) {\n        return NORM_S_DIST(x);\n    }\n    function lognorm_dist(x, m, s, cumulative) {\n        if (cumulative) {\n            return 0.5 + 0.5 * ERF((Math.log(x) - m) / (s * Math.sqrt(2)));\n        }\n        var t = Math.log(x) - m;\n        return Math.exp(-t * t / (2 * s * s)) / (x * s * Math.sqrt(2 * Math.PI));\n    }\n    function lognorm_inv(p, m, s) {\n        return Math.exp(NORM_INV(p, m, s));\n    }\n    function prob(x_, p_, lw, up) {\n        var n = x_.length;\n        var s = 0, i;\n        for (i = 0; i < n; i++) {\n            if (p_[i] <= 0 || p_[i] > 1) {\n                throw new CalcError('NUM');\n            }\n            s += p_[i];\n        }\n        if (s != 1) {\n            throw new CalcError('NUM');\n        }\n        var res = 0;\n        for (i = 0; i < n; i++) {\n            var x = x_[i];\n            if (x >= lw && x <= up) {\n                res += p_[i];\n            }\n        }\n        return res;\n    }\n    function slope(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_), b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return b1 / b2;\n    }\n    function intercept(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return my - b1 * mx / b2;\n    }\n    function pearson(x_, y_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n            s3 += t2 * t2;\n        }\n        return s1 / Math.sqrt(s2 * s3);\n    }\n    function rsq(x_, y_) {\n        var r = pearson(x_, y_);\n        return r * r;\n    }\n    function steyx(y_, x_) {\n        var n = x_.length;\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t2 * t2;\n            s2 += t1 * t2;\n            s3 += t1 * t1;\n        }\n        return Math.sqrt((s1 - s2 * s2 / s3) / (n - 2));\n    }\n    function forecast(x, y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (s2 === 0) {\n            throw new CalcError('N/A');\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return a + b * x;\n    }\n    function _mat_mean(Mat) {\n        var n = Mat.height, sum = 0;\n        for (var i = 0; i < n; i++) {\n            sum += Mat.data[i][0];\n        }\n        return sum / n;\n    }\n    function _mat_devsq(Mat, mean) {\n        var n = Mat.height, sq = 0;\n        for (var i = 0; i < n; i++) {\n            var x = Mat.data[i][0] - mean;\n            sq += x * x;\n        }\n        return sq;\n    }\n    function linest(Y, X, konst, stats) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        var line_1 = [];\n        for (i = B.height - 1; i >= 0; i--) {\n            line_1.push(B.data[i][0]);\n        }\n        if (!konst) {\n            line_1.push(0);\n        }\n        if (!stats) {\n            return this.asMatrix([line_1]);\n        }\n        var Y1 = X.multiply(B);\n        var y_y1 = Y.adds(Y1, true);\n        var mp = !konst ? 0 : _mat_mean(Y1);\n        var SSreg = _mat_devsq(Y1, mp);\n        var me = !konst ? 0 : _mat_mean(y_y1);\n        var SSresid = _mat_devsq(y_y1, me);\n        var line_5 = [];\n        line_5.push(SSreg, SSresid);\n        var R2 = SSreg / (SSreg + SSresid);\n        var degfre = Y.height - X.width;\n        var err_est = Math.sqrt(SSresid / degfre);\n        var line_3 = [];\n        line_3.push(R2, err_est);\n        var F_sta = !konst ? R2 / X.width / ((1 - R2) / degfre) : SSreg / (X.width - 1) / (SSresid / degfre);\n        var line_4 = [];\n        line_4.push(F_sta, degfre);\n        var SCP = Xt.multiply(X).inverse();\n        var line_2 = [];\n        for (i = SCP.height - 1; i >= 0; i--) {\n            line_2.push(Math.sqrt(SCP.data[i][i] * SSresid / degfre));\n        }\n        return this.asMatrix([\n            line_1,\n            line_2,\n            line_3,\n            line_4,\n            line_5\n        ]);\n    }\n    function logest(Y, X, konst, stats) {\n        return linest.call(this, Y.map(Math.log), X, konst, stats).map(Math.exp);\n    }\n    function trend(Y, X, W, konst) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        if (!W) {\n            W = X;\n        } else {\n            if (konst) {\n                W = W.clone();\n                W.eachRow(function (row) {\n                    W.data[row].unshift(1);\n                });\n                ++W.width;\n            }\n        }\n        return W.multiply(B);\n    }\n    function growth(Y, X, new_X, konst) {\n        return trend.call(this, Y.map(Math.log), X, new_X, konst).map(Math.exp);\n    }\n    function root_newton(func, guess, max_it, eps) {\n        var MAX_IT = max_it || 20, EPS = eps || 1e-7;\n        var root = guess;\n        for (var j = 1; j <= MAX_IT; j++) {\n            var f_d = func(root), f = f_d[0], df = f_d[1];\n            var dx = f / df;\n            root -= dx;\n            if (Math.abs(dx) < EPS) {\n                return root;\n            }\n        }\n        return new CalcError('NUM');\n    }\n    function FV(rate, nper, pmt, pv, type) {\n        var h1 = Math.pow(1 + rate, nper);\n        var h2 = rate ? (h1 - 1) / rate : nper;\n        return -(pv * h1 + pmt * h2 * (1 + rate * type));\n    }\n    function PV(rate, nper, pmt, fv, type) {\n        if (!rate) {\n            return -fv - pmt * nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -(fv + pmt * (h1 - 1) / rate * (1 + rate * type)) / h1;\n    }\n    function PMT(rate, nper, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -rate * (fv + pv * h1) / ((1 + rate * type) * (h1 - 1));\n    }\n    function NPER(rate, pmt, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / pmt;\n        }\n        var h1 = pmt * (1 + rate * type);\n        return Math.log((h1 - fv * rate) / (h1 + pv * rate)) / Math.log(1 + rate);\n    }\n    function RATE(nper, pmt, pv, fv, type, guess) {\n        function xfd(x) {\n            var h2 = Math.pow(1 + x, nper - 1), h1 = h2 * (1 + x);\n            return [\n                pv * h1 + pmt * (1 / x + type) * (h1 - 1) + fv,\n                nper * pv * h2 + pmt * (-(h1 - 1) / (x * x) + (1 / x + type) * nper * h2)\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function IPMT(rate, per, nper, pv, fv, type) {\n        if (type == 1 && per == 1) {\n            return 0;\n        }\n        var pmt = PMT(rate, nper, pv, fv, type);\n        var ipmt = FV(rate, per - 1, pmt, pv, type) * rate;\n        return type ? ipmt / (1 + rate) : ipmt;\n    }\n    function PPMT(rate, per, nper, pv, fv, type) {\n        var pmt = PMT(rate, nper, pv, fv, type);\n        return pmt - IPMT(rate, per, nper, pv, fv, type);\n    }\n    function CUMPRINC(rate, nper, pv, start, end, type) {\n        if (type == 1) {\n            start--;\n            end--;\n        }\n        var tn = Math.pow(1 + rate, nper), ts = Math.pow(1 + rate, start - 1), te = Math.pow(1 + rate, end);\n        var monthlyPayment = rate * pv * tn / (tn - 1);\n        var remainingBalanceAtStart = ts * pv - (ts - 1) / rate * monthlyPayment;\n        var remainingBalanceAtEnd = te * pv - (te - 1) / rate * monthlyPayment;\n        return remainingBalanceAtEnd - remainingBalanceAtStart;\n    }\n    function CUMIPMT(rate, nper, pv, start, end, type) {\n        var cip = 0;\n        for (var i = start; i <= end; i++) {\n            cip += IPMT(rate, i, nper, pv, 0, type);\n        }\n        return cip;\n    }\n    function NPV(rate, flows) {\n        var npv = 0;\n        for (var i = 0, n = flows.length; i < n; i++) {\n            npv += flows[i] * Math.pow(1 + rate, -i - 1);\n        }\n        return npv;\n    }\n    function IRR(flows, guess) {\n        function xfd(x) {\n            var npv = 0, npv1 = 0;\n            for (var j = 0, n = flows.length; j < n; j++) {\n                npv += flows[j] * Math.pow(1 + x, -j - 1);\n                npv1 += -j * flows[j] * Math.pow(1 + x, -j - 2);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function EFFECT(nominal_rate, npery) {\n        return Math.pow(1 + nominal_rate / npery, npery) - 1;\n    }\n    function NOMINAL(effect_rate, npery) {\n        return npery * (Math.pow(effect_rate + 1, 1 / npery) - 1);\n    }\n    function XNPV(rate, values, dates) {\n        var npv = 0;\n        for (var i = 0, n = values.length; i < n; i++) {\n            npv += values[i] * Math.pow(1 + rate, (dates[0] - dates[i]) / 365);\n        }\n        return npv;\n    }\n    function XIRR(values, dates, guess) {\n        function xfd(x) {\n            var npv = values[0], npv1 = 0;\n            for (var j = 1, n = values.length; j < n; j++) {\n                var delta = (dates[0] - dates[j]) / 365;\n                npv += values[j] * Math.pow(1 + x, delta);\n                npv1 += delta * values[j] * Math.pow(1 + x, delta - 1);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function ISPMT(rate, per, nper, pv) {\n        var tmp = -pv * rate;\n        return tmp * (1 - per / nper);\n    }\n    function DB(cost, salvage, life, period, month) {\n        var rate = 1 - Math.pow(salvage / cost, 1 / life);\n        rate = Math.floor(rate * 1000 + 0.5) / 1000;\n        var db = cost * rate * month / 12;\n        if (period == 1) {\n            return db;\n        }\n        for (var i = 1; i < life; i++) {\n            if (i == period - 1) {\n                return (cost - db) * rate;\n            }\n            db += (cost - db) * rate;\n        }\n        return (cost - db) * rate * (12 - month) / 12;\n    }\n    function DDB(cost, salvage, life, period, factor) {\n        var f = factor / life;\n        var prior = -cost * (Math.pow(1 - f, period - 1) - 1);\n        var dep = (cost - prior) * f;\n        dep = Math.min(dep, Math.max(0, cost - prior - salvage));\n        return dep;\n    }\n    function SLN(cost, salvage, life) {\n        return (cost - salvage) / life;\n    }\n    function SYD(cost, salvage, life, per) {\n        return (cost - salvage) * (life - per + 1) * 2 / (life * (life + 1));\n    }\n    function VDB(cost, salvage, life, start, end, factor, no_switch) {\n        var interest = factor >= life ? 1 : factor / life;\n        function _getGDA(value, period) {\n            var gda, oldValue, newValue;\n            if (interest == 1) {\n                oldValue = period == 1 ? value : 0;\n            } else {\n                oldValue = value * Math.pow(1 - interest, period - 1);\n            }\n            newValue = value * Math.pow(1 - interest, period);\n            gda = newValue < salvage ? oldValue - salvage : oldValue - newValue;\n            return gda < 0 ? 0 : gda;\n        }\n        function _interVDB(cost, life1, period) {\n            var remValue = cost - salvage;\n            var intEnd = Math.ceil(period);\n            var term, lia = 0, vdb = 0, nowLia = false;\n            for (var i = 1; i <= intEnd; i++) {\n                if (!nowLia) {\n                    var gda = _getGDA(cost, i);\n                    lia = remValue / (life1 - i + 1);\n                    if (lia > gda) {\n                        term = lia;\n                        nowLia = true;\n                    } else {\n                        term = gda;\n                        remValue -= gda;\n                    }\n                } else {\n                    term = lia;\n                }\n                if (i == intEnd) {\n                    term *= period + 1 - intEnd;\n                }\n                vdb += term;\n            }\n            return vdb;\n        }\n        var intStart = Math.floor(start), intEnd = Math.ceil(end);\n        var vdb = 0;\n        if (no_switch) {\n            for (var i = intStart + 1; i <= intEnd; i++) {\n                var term = _getGDA(cost, i);\n                if (i == intStart + 1) {\n                    term *= Math.min(end, intStart + 1) - start;\n                } else {\n                    if (i == intEnd) {\n                        term *= end + 1 - intEnd;\n                    }\n                }\n                vdb += term;\n            }\n        } else {\n            var life1 = life;\n            if (start != Math.floor(start)) {\n                if (factor > 1) {\n                    if (start >= life / 2) {\n                        var part = start - life / 2;\n                        start = life / 2;\n                        end -= part;\n                        life1 += 1;\n                    }\n                }\n            }\n            cost -= _interVDB(cost, life1, start);\n            vdb = _interVDB(cost, life - start, end - start);\n        }\n        return vdb;\n    }\n    function _edate(base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }\n    function _daysBetween(from, to, basis) {\n        if (basis == 1 || basis == 2 || basis == 3) {\n            return to - from;\n        }\n        return _days_360(from, to, basis);\n    }\n    function _borderCoupons(settlement, maturity, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(maturity);\n        var periods = base.year - sett.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev, next, months = 12 / freq;\n        do {\n            periods++;\n            prev = _edate(maturity, -periods * months);\n        } while (settlement < prev);\n        periods--;\n        next = _edate(maturity, -periods * months);\n        return [\n            prev,\n            next\n        ];\n    }\n    function _borderCoupons_fw(first, settlement, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(first);\n        var periods = sett.year - base.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev = first, next, months = 12 / freq;\n        while (settlement > prev) {\n            next = prev;\n            periods++;\n            prev = _edate(first, periods * months);\n        }\n        return [\n            next,\n            prev\n        ];\n    }\n    function COUPDAYBS(settlement, maturity, frequency, basis) {\n        var prev = _borderCoupons(settlement, maturity, frequency)[0];\n        return _daysBetween(prev, settlement, basis);\n    }\n    function COUPDAYS(settl, matur, freq, basis) {\n        if (basis == 1) {\n            var borders = _borderCoupons(settl, matur, freq);\n            return _daysBetween(borders[0], borders[1], 1);\n        }\n        if (basis == 3) {\n            return 365 / freq;\n        }\n        return 360 / freq;\n    }\n    function COUPDAYSNC(settl, matur, freq, basis) {\n        var next = _borderCoupons(settl, matur, freq)[1];\n        return _daysBetween(settl, next, basis);\n    }\n    function COUPPCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[0];\n    }\n    function COUPNCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[1];\n    }\n    function COUPNUM(settl, matur, freq) {\n        var sett = unpackDate(settl), mat = unpackDate(matur);\n        var months = 12 * (mat.year - sett.year) + mat.month - sett.month;\n        return 1 + (months * freq / 12 | 0);\n    }\n    function daysInYear(yr, basis) {\n        if (basis == 3) {\n            return 365;\n        }\n        if (basis == 1) {\n            return isLeapYear(yr) ? 366 : 365;\n        }\n        return 360;\n    }\n    function ACCRINTM(issue, maturity, rate, par, basis) {\n        var year_days = daysInYear(unpackDate(maturity).year, basis);\n        return rate * par * _daysBetween(issue, maturity, basis) / year_days;\n    }\n    function ACCRINT(issue, first, settl, rate, par, freq, basis, calc) {\n        var accr = 0, cost = par * rate / freq;\n        var brace, prev, next, prev1, next1, nrc;\n        var annual = basis % 2 === 0 ? 360 : 365;\n        function _numCoupons(from, to) {\n            return (to - from) * freq / annual | 0;\n        }\n        if (settl <= first) {\n            brace = _borderCoupons(settl, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            if (prev <= issue) {\n                return cost * _daysBetween(issue, settl, basis) / _daysBetween(prev, next, basis);\n            }\n            brace = _borderCoupons(issue, prev, freq);\n            prev1 = brace[0];\n            next1 = brace[1];\n            nrc = _numCoupons(next1, settl);\n            return cost * (nrc + _daysBetween(issue, next1, basis) / _daysBetween(prev1, next1, basis) + (settl < next ? _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis) : 0));\n        } else {\n            brace = _borderCoupons_fw(first, settl, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(first, settl);\n            if (next == settl) {\n                accr = cost * nrc;\n            } else {\n                accr = cost * (nrc + _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis));\n            }\n            if (!calc) {\n                return accr;\n            }\n            brace = _borderCoupons(issue, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(issue, first);\n            accr += cost * (nrc + _daysBetween(issue, next, basis) / _daysBetween(prev, next, basis));\n            return accr;\n        }\n    }\n    function DISC(settl, matur, pr, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - pr) / redemption * annual / _daysBetween(settl, matur, basis);\n    }\n    function INTRATE(settl, matur, investment, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - investment) / investment * annual / _daysBetween(settl, matur, basis);\n    }\n    function RECEIVED(settl, matur, investment, discount, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return investment / (1 - discount * _daysBetween(settl, matur, basis) / annual);\n    }\n    function PRICE(settl, matur, rate, yld, redemption, freq, basis) {\n        var N = 1 + ((matur - settl) * freq / (basis % 2 === 0 ? 360 : 365) | 0);\n        var brace = _borderCoupons(settl, matur, freq), prev = brace[0], next = brace[1];\n        var beg_settl = _daysBetween(prev, settl, basis), settl_end = _daysBetween(settl, next, basis), beg_end = _daysBetween(prev, next, basis);\n        var den = 100 * rate / freq, yf = yld / freq, frac = settl_end / beg_end;\n        if (N == 1) {\n            return (redemption + den) / (1 + frac * yf) - beg_settl / beg_end * den;\n        }\n        return redemption / Math.pow(1 + yf, N - 1 + frac) + den * Math.pow(1 + yf, 1 - N - frac) * (Math.pow(1 + yf, N) - 1) / yf - beg_settl / beg_end * den;\n    }\n    function PRICEDISC(settl, matur, discount, redemption, basis) {\n        var dsm = _daysBetween(settl, matur, basis), dy = daysInYear(unpackDate(matur).year, basis);\n        return redemption - discount * redemption * dsm / dy;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/borderpalette', [\n        'kendo.core',\n        'kendo.colorpicker',\n        'kendo.popup'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var BORDER_TYPES = [\n            'allBorders',\n            'insideBorders',\n            'insideHorizontalBorders',\n            'insideVerticalBorders',\n            'outsideBorders',\n            'leftBorder',\n            'topBorder',\n            'rightBorder',\n            'bottomBorder',\n            'noBorders'\n        ];\n        var BORDER_PALETTE_MESSAGES = kendo.spreadsheet.messages.borderPalette = {\n            allBorders: 'All borders',\n            insideBorders: 'Inside borders',\n            insideHorizontalBorders: 'Inside horizontal borders',\n            insideVerticalBorders: 'Inside vertical borders',\n            outsideBorders: 'Outside borders',\n            leftBorder: 'Left border',\n            topBorder: 'Top border',\n            rightBorder: 'Right border',\n            bottomBorder: 'Bottom border',\n            noBorders: 'No border',\n            reset: 'Reset color',\n            customColor: 'Custom color...',\n            apply: 'Apply',\n            cancel: 'Cancel'\n        };\n        function withPreventDefault(f) {\n            return function (e) {\n                e.preventDefault();\n                return f.apply(this, arguments);\n            };\n        }\n        var ColorChooser = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = options.color;\n                this._resetButton();\n                this._colorPalette();\n                this._customColorPalette();\n                this._customColorButton();\n                this.resetButton.on('click', withPreventDefault(this.resetColor.bind(this)));\n                this.customColorButton.on('click', withPreventDefault(this.customColor.bind(this)));\n            },\n            options: { name: 'ColorChooser' },\n            events: ['change'],\n            destroy: function () {\n                kendo.unbind(this.dialog.element.find('.k-action-buttons'));\n                this.dialog.destroy();\n                this.colorPalette.destroy();\n                this.resetButton.off('click');\n                this.customColorButton.off('click');\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.color = value;\n                    this.customColorButton.find('.k-icon').css('background-color', this.color);\n                    this.colorPalette.value(null);\n                    this.flatColorPicker.value(this.color);\n                } else {\n                    return this.color;\n                }\n            },\n            _change: function (value) {\n                this.color = value;\n                this.trigger('change', { value: value });\n            },\n            _colorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-color-palette' });\n                var colorPalette = this.colorPalette = $('<div />').kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    value: this.color,\n                    change: function (e) {\n                        this.customColorButton.find('.k-icon').css('background-color', 'transparent');\n                        this.flatColorPicker.value(null);\n                        this._change(e.value);\n                    }.bind(this)\n                }).data('kendoColorPalette');\n                element.append(colorPalette.wrapper).appendTo(this.element);\n            },\n            _customColorPalette: function () {\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-window',\n                    'html': '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>' + BORDER_PALETTE_MESSAGES.apply + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>' + BORDER_PALETTE_MESSAGES.cancel + '</button>' + '</div>'\n                });\n                var dialog = this.dialog = element.appendTo(document.body).kendoWindow({\n                    animation: false,\n                    scrollable: false,\n                    resizable: false,\n                    maximizable: false,\n                    modal: true,\n                    visible: false,\n                    width: 268,\n                    open: function () {\n                        this.center();\n                    }\n                }).data('kendoWindow');\n                dialog.one('activate', function () {\n                    this.element.find('[data-role=flatcolorpicker]').data('kendoFlatColorPicker')._hueSlider.resize();\n                });\n                var flatColorPicker = this.flatColorPicker = dialog.element.children().first().kendoFlatColorPicker().data('kendoFlatColorPicker');\n                var viewModel = kendo.observable({\n                    apply: function () {\n                        this.customColorButton.find('.k-icon').css('background-color', flatColorPicker.value());\n                        this.colorPalette.value(null);\n                        this._change(flatColorPicker.value());\n                        dialog.close();\n                    }.bind(this),\n                    close: function () {\n                        flatColorPicker.value(null);\n                        dialog.close();\n                    }\n                });\n                kendo.bind(dialog.element.find('.k-action-buttons'), viewModel);\n            },\n            _resetButton: function () {\n                this.resetButton = $('<a class=\\'k-button k-reset-color\\' href=\\'#\\'>' + '<span class=\\'k-icon k-font-icon k-i-reset-color\\'></span>' + BORDER_PALETTE_MESSAGES.reset + '</a>').appendTo(this.element);\n            },\n            _customColorButton: function () {\n                this.customColorButton = $('<a class=\\'k-button k-custom-color\\' href=\\'#\\'>' + '<span class=\\'k-icon\\'></span>' + BORDER_PALETTE_MESSAGES.customColor + '</a>').appendTo(this.element);\n            },\n            resetColor: function () {\n                this.colorPalette.value(null);\n                this.flatColorPicker.value(null);\n                this._change(null);\n            },\n            customColor: function () {\n                this.dialog.open();\n            }\n        });\n        var BorderPalette = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = '#000';\n                this.element.addClass('k-spreadsheet-border-palette');\n                this._borderTypePalette();\n                this._borderColorPalette();\n                this.element.on('click', '.k-spreadsheet-border-type-palette .k-button', withPreventDefault(this._click.bind(this)));\n            },\n            options: { name: 'BorderPalette' },\n            events: ['change'],\n            destroy: function () {\n                this.colorChooser.destroy();\n                this.element.off('click');\n            },\n            _borderTypePalette: function () {\n                var messages = BORDER_PALETTE_MESSAGES;\n                var buttons = BORDER_TYPES.map(function (type) {\n                    return '<a title=\"' + messages[type] + '\" href=\"#\" data-border-type=\"' + type + '\" class=\"k-button k-button-icon\">' + '<span class=\"k-sprite k-font-icon k-icon k-i-' + kendo.toHyphens(type) + '\"></span>' + '</a>';\n                }).join('');\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-border-type-palette',\n                    'html': buttons\n                });\n                element.appendTo(this.element);\n            },\n            _borderColorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-border-color-palette' });\n                element.appendTo(this.element);\n                this.colorChooser = new ColorChooser(element, {\n                    color: this.color,\n                    change: this._colorChange.bind(this)\n                });\n            },\n            _click: function (e) {\n                this.type = $(e.currentTarget).data('borderType');\n                this.trigger('change', {\n                    type: this.type,\n                    color: this.color\n                });\n            },\n            _colorChange: function (e) {\n                this.color = e.value;\n                if (this.type) {\n                    this.trigger('change', {\n                        type: this.type,\n                        color: this.color\n                    });\n                }\n            }\n        });\n        kendo.spreadsheet.ColorChooser = ColorChooser;\n        kendo.spreadsheet.BorderPalette = BorderPalette;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/toolbar', [\n        'kendo.toolbar',\n        'kendo.colorpicker',\n        'kendo.combobox',\n        'kendo.dropdownlist',\n        'kendo.popup',\n        'spreadsheet/borderpalette'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var ToolBar = kendo.ui.ToolBar;\n        var MESSAGES = kendo.spreadsheet.messages.toolbar = {\n            addColumnLeft: 'Add column left',\n            addColumnRight: 'Add column right',\n            addRowAbove: 'Add row above',\n            addRowBelow: 'Add row below',\n            alignment: 'Alignment',\n            alignmentButtons: {\n                justtifyLeft: 'Align left',\n                justifyCenter: 'Center',\n                justifyRight: 'Align right',\n                justifyFull: 'Justify',\n                alignTop: 'Align top',\n                alignMiddle: 'Align middle',\n                alignBottom: 'Align bottom'\n            },\n            backgroundColor: 'Background',\n            bold: 'Bold',\n            borders: 'Borders',\n            colorPicker: {\n                reset: 'Reset color',\n                customColor: 'Custom color...'\n            },\n            copy: 'Copy',\n            cut: 'Cut',\n            deleteColumn: 'Delete column',\n            deleteRow: 'Delete row',\n            filter: 'Filter',\n            fontFamily: 'Font',\n            fontSize: 'Font size',\n            format: 'Custom format...',\n            formatTypes: {\n                automatic: 'Automatic',\n                number: 'Number',\n                percent: 'Percent',\n                financial: 'Financial',\n                currency: 'Currency',\n                date: 'Date',\n                time: 'Time',\n                dateTime: 'Date time',\n                duration: 'Duration',\n                moreFormats: 'More formats...'\n            },\n            formatDecreaseDecimal: 'Decrease decimal',\n            formatIncreaseDecimal: 'Increase decimal',\n            freeze: 'Freeze panes',\n            freezeButtons: {\n                freezePanes: 'Freeze panes',\n                freezeRows: 'Freeze rows',\n                freezeColumns: 'Freeze columns',\n                unfreeze: 'Unfreeze panes'\n            },\n            italic: 'Italic',\n            merge: 'Merge cells',\n            mergeButtons: {\n                mergeCells: 'Merge all',\n                mergeHorizontally: 'Merge horizontally',\n                mergeVertically: 'Merge vertically',\n                unmerge: 'Unmerge'\n            },\n            open: 'Open...',\n            paste: 'Paste',\n            quickAccess: {\n                redo: 'Redo',\n                undo: 'Undo'\n            },\n            exportAs: 'Export...',\n            toggleGridlines: 'Toggle gridlines',\n            sortAsc: 'Sort ascending',\n            sortDesc: 'Sort descending',\n            sortButtons: {\n                sortSheetAsc: 'Sort sheet A to Z',\n                sortSheetDesc: 'Sort sheet Z to A',\n                sortRangeAsc: 'Sort range A to Z',\n                sortRangeDesc: 'Sort range Z to A'\n            },\n            textColor: 'Text Color',\n            textWrap: 'Wrap text',\n            underline: 'Underline',\n            validation: 'Data validation...',\n            hyperlink: 'Link'\n        };\n        var defaultTools = {\n            home: [\n                'open',\n                'exportAs',\n                [\n                    'cut',\n                    'copy',\n                    'paste'\n                ],\n                [\n                    'bold',\n                    'italic',\n                    'underline'\n                ],\n                'hyperlink',\n                'backgroundColor',\n                'textColor',\n                'borders',\n                'fontSize',\n                'fontFamily',\n                'alignment',\n                'textWrap',\n                [\n                    'formatDecreaseDecimal',\n                    'formatIncreaseDecimal'\n                ],\n                'format',\n                'merge',\n                'freeze',\n                'filter',\n                'toggleGridlines'\n            ],\n            insert: [\n                [\n                    'addColumnLeft',\n                    'addColumnRight',\n                    'addRowBelow',\n                    'addRowAbove'\n                ],\n                [\n                    'deleteColumn',\n                    'deleteRow'\n                ]\n            ],\n            data: [\n                'sort',\n                'filter',\n                'validation'\n            ]\n        };\n        var toolDefaults = {\n            open: {\n                type: 'open',\n                overflow: 'never',\n                iconClass: 'xlsa'\n            },\n            exportAs: {\n                type: 'exportAsDialog',\n                dialogName: 'exportAs',\n                overflow: 'never',\n                text: '',\n                iconClass: 'xlsa'\n            },\n            bold: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'bold',\n                value: true,\n                iconClass: 'bold',\n                togglable: true\n            },\n            italic: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'italic',\n                value: true,\n                iconClass: 'italic',\n                togglable: true\n            },\n            underline: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'underline',\n                value: true,\n                iconClass: 'underline',\n                togglable: true\n            },\n            formatDecreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: -1,\n                iconClass: 'decrease-decimal'\n            },\n            formatIncreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: +1,\n                iconClass: 'increase-decimal'\n            },\n            textWrap: {\n                type: 'button',\n                command: 'TextWrapCommand',\n                property: 'wrap',\n                value: true,\n                iconClass: 'text-wrap',\n                togglable: true\n            },\n            cut: {\n                type: 'button',\n                command: 'ToolbarCutCommand',\n                iconClass: 'cut'\n            },\n            copy: {\n                type: 'button',\n                command: 'ToolbarCopyCommand',\n                iconClass: 'copy'\n            },\n            paste: {\n                type: 'button',\n                command: 'ToolbarPasteCommand',\n                iconClass: 'paste'\n            },\n            separator: { type: 'separator' },\n            alignment: {\n                type: 'alignment',\n                iconClass: 'justify-left'\n            },\n            backgroundColor: {\n                type: 'colorPicker',\n                property: 'background',\n                iconClass: 'background'\n            },\n            textColor: {\n                type: 'colorPicker',\n                property: 'color',\n                iconClass: 'text'\n            },\n            fontFamily: {\n                type: 'fontFamily',\n                property: 'fontFamily',\n                iconClass: 'text'\n            },\n            fontSize: {\n                type: 'fontSize',\n                property: 'fontSize',\n                iconClass: 'font-size'\n            },\n            format: {\n                type: 'format',\n                property: 'format',\n                iconClass: 'format-number'\n            },\n            filter: {\n                type: 'filter',\n                property: 'hasFilter',\n                iconClass: 'filter'\n            },\n            merge: {\n                type: 'merge',\n                iconClass: 'merge-cells'\n            },\n            freeze: {\n                type: 'freeze',\n                iconClass: 'freeze-panes'\n            },\n            borders: {\n                type: 'borders',\n                iconClass: 'all-borders'\n            },\n            formatCells: {\n                type: 'dialog',\n                dialogName: 'formatCells',\n                overflow: 'never'\n            },\n            hyperlink: {\n                type: 'dialog',\n                dialogName: 'hyperlink',\n                iconClass: 'hyperlink',\n                overflow: 'never',\n                text: ''\n            },\n            toggleGridlines: {\n                type: 'button',\n                command: 'GridLinesChangeCommand',\n                property: 'gridLines',\n                value: true,\n                iconClass: 'no-borders',\n                togglable: true\n            },\n            addColumnLeft: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'left',\n                iconClass: 'add-column-left'\n            },\n            addColumnRight: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'right',\n                iconClass: 'add-column-right'\n            },\n            addRowBelow: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'below',\n                iconClass: 'add-row-below'\n            },\n            addRowAbove: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'above',\n                iconClass: 'add-row-above'\n            },\n            deleteColumn: {\n                type: 'button',\n                command: 'DeleteColumnCommand',\n                iconClass: 'delete-column'\n            },\n            deleteRow: {\n                type: 'button',\n                command: 'DeleteRowCommand',\n                iconClass: 'delete-row'\n            },\n            sort: {\n                type: 'sort',\n                iconClass: 'sort-desc'\n            },\n            validation: {\n                type: 'dialog',\n                dialogName: 'validation',\n                iconClass: 'exception',\n                overflow: 'never'\n            }\n        };\n        var SpreadsheetToolBar = ToolBar.extend({\n            init: function (element, options) {\n                options.items = this._expandTools(options.tools || SpreadsheetToolBar.prototype.options.tools[options.toolbarName]);\n                ToolBar.fn.init.call(this, element, options);\n                var handleClick = this._click.bind(this);\n                this.element.addClass('k-spreadsheet-toolbar');\n                this._addSeparators(this.element);\n                this.bind({\n                    click: handleClick,\n                    toggle: handleClick\n                });\n            },\n            _addSeparators: function (element) {\n                var groups = element.children('.k-widget, a.k-button, .k-button-group');\n                groups.before('<span class=\\'k-separator\\' />');\n            },\n            _expandTools: function (tools) {\n                function expandTool(toolName) {\n                    var options = $.isPlainObject(toolName) ? toolName : toolDefaults[toolName] || {};\n                    var spriteCssClass = 'k-icon k-font-icon k-i-' + options.iconClass;\n                    var type = options.type;\n                    var typeDefaults = {\n                        splitButton: { spriteCssClass: spriteCssClass },\n                        button: { showText: 'overflow' },\n                        colorPicker: { toolIcon: spriteCssClass }\n                    };\n                    var tool = $.extend({\n                        name: options.name || toolName,\n                        text: MESSAGES[options.name || toolName],\n                        spriteCssClass: spriteCssClass,\n                        attributes: { title: MESSAGES[options.name || toolName] }\n                    }, typeDefaults[type], options);\n                    if (type == 'splitButton') {\n                        tool.menuButtons = tool.menuButtons.map(expandTool);\n                    }\n                    tool.attributes['data-tool'] = toolName;\n                    if (options.property) {\n                        tool.attributes['data-property'] = options.property;\n                    }\n                    return tool;\n                }\n                return tools.reduce(function (tools, tool) {\n                    if ($.isArray(tool)) {\n                        tools.push({\n                            type: 'buttonGroup',\n                            buttons: tool.map(expandTool)\n                        });\n                    } else {\n                        tools.push(expandTool.call(this, tool));\n                    }\n                    return tools;\n                }, []);\n            },\n            _click: function (e) {\n                var toolName = e.target.attr('data-tool');\n                var tool = toolDefaults[toolName] || {};\n                var commandType = tool.command;\n                if (!commandType) {\n                    return;\n                }\n                var args = {\n                    command: commandType,\n                    options: {\n                        property: tool.property || null,\n                        value: tool.value || null\n                    }\n                };\n                if (typeof args.options.value === 'boolean') {\n                    args.options.value = e.checked ? true : null;\n                }\n                this.action(args);\n            },\n            events: [\n                'click',\n                'toggle',\n                'open',\n                'close',\n                'overflowOpen',\n                'overflowClose',\n                'action',\n                'dialog'\n            ],\n            options: {\n                name: 'SpreadsheetToolBar',\n                resizable: true,\n                tools: defaultTools\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refresh: function (activeCell) {\n                var range = activeCell;\n                var tools = this._tools();\n                function setToggle(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    var togglable = toolbar && toolbar.options.togglable || overflow && overflow.options.togglable;\n                    if (!togglable) {\n                        return;\n                    }\n                    var toggle = false;\n                    if (typeof value === 'boolean') {\n                        toggle = value;\n                    } else if (typeof value === 'string') {\n                        toggle = toolbar.options.value === value;\n                    }\n                    toolbar.toggle(toggle);\n                    if (overflow) {\n                        overflow.toggle(toggle);\n                    }\n                }\n                function update(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    if (toolbar && toolbar.update) {\n                        toolbar.update(value);\n                    }\n                    if (overflow && overflow.update) {\n                        overflow.update(value);\n                    }\n                }\n                for (var i = 0; i < tools.length; i++) {\n                    var property = tools[i].property;\n                    var tool = tools[i].tool;\n                    var value = kendo.isFunction(range[property]) ? range[property]() : range;\n                    if (property == 'gridLines') {\n                        value = range.sheet().showGridLines();\n                    }\n                    if (tool.type === 'button') {\n                        setToggle(tool, value);\n                    } else {\n                        update(tool, value);\n                    }\n                }\n            },\n            _tools: function () {\n                return this.element.find('[data-property]').toArray().map(function (element) {\n                    element = $(element);\n                    return {\n                        property: element.attr('data-property'),\n                        tool: this._getItem(element)\n                    };\n                }.bind(this));\n            },\n            destroy: function () {\n                this.element.find('[data-command],.k-button').each(function () {\n                    var element = $(this);\n                    var instance = element.data('instance');\n                    if (instance && instance.destroy) {\n                        instance.destroy();\n                    }\n                });\n                ToolBar.fn.destroy.call(this);\n            }\n        });\n        kendo.spreadsheet.ToolBar = SpreadsheetToolBar;\n        var DropDownTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var dropDownList = $('<select />').kendoDropDownList({ height: 'auto' }).data('kendoDropDownList');\n                this.dropDownList = dropDownList;\n                this.element = dropDownList.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                dropDownList.bind('open', this._open.bind(this));\n                dropDownList.bind('change', this._change.bind(this));\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n            },\n            _open: function () {\n                var ddl = this.dropDownList;\n                var list = ddl.list;\n                var listWidth;\n                list.css({\n                    whiteSpace: 'nowrap',\n                    width: 'auto'\n                });\n                listWidth = list.width();\n                if (listWidth) {\n                    listWidth += 20;\n                } else {\n                    listWidth = ddl._listWidth;\n                }\n                list.css('width', listWidth + kendo.support.scrollbar());\n                ddl._listWidth = listWidth;\n            },\n            _change: function (e) {\n                var instance = e.sender;\n                var value = instance.value();\n                var dataItem = instance.dataItem();\n                var popupName = dataItem ? dataItem.popup : undefined;\n                if (popupName) {\n                    this.toolbar.dialog({ name: popupName });\n                } else {\n                    this.toolbar.action({\n                        command: 'PropertyChangeCommand',\n                        options: {\n                            property: this.options.property,\n                            value: value == 'null' ? null : value\n                        }\n                    });\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.dropDownList.value(value);\n                } else {\n                    return this.dropDownList.value();\n                }\n            }\n        });\n        var PopupTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.element = $('<a href=\\'#\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'' + options.spriteCssClass + '\\'>' + '</span><span class=\\'k-icon k-i-arrow-s\\'></span>' + '</a>');\n                this.element.on('click touchend', this.open.bind(this)).attr('data-command', options.command);\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this._popup();\n            },\n            destroy: function () {\n                this.popup.destroy();\n            },\n            open: function (ev) {\n                ev.preventDefault();\n                this.popup.toggle();\n            },\n            _popup: function () {\n                var element = this.element;\n                this.popup = $('<div class=\\'k-spreadsheet-popup\\' />').appendTo(element).kendoPopup({ anchor: element }).data('kendoPopup');\n            }\n        });\n        kendo.toolbar.registerComponent('dialog', kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this._dialogName = options.dialogName;\n                this.element.bind('click touchend', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        kendo.toolbar.registerComponent('exportAsDialog', kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this._dialogName = options.dialogName;\n                this.toolbar = toolbar;\n                this.element = $('<button class=\\'k-button k-button-icon\\' title=\\'' + options.attributes.title + '\\'>' + '<span class=\\'k-icon k-font-icon k-i-xls\\' />' + '</button>').data('instance', this);\n                this.element.bind('click', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        var OverflowDialogButton = kendo.toolbar.OverflowButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.OverflowButton.fn.init.call(this, options, toolbar);\n                this.element.on('click touchend', this._click.bind(this));\n                this.message = this.options.text;\n                var instance = this.element.data('button');\n                this.element.data(this.options.type, instance);\n            },\n            _click: $.noop\n        });\n        var ColorPicker = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.popup.element.addClass('k-spreadsheet-colorpicker');\n                this.colorChooser = new kendo.spreadsheet.ColorChooser(this.popup.element, { change: this._colorChange.bind(this) });\n                this.element.attr({ 'data-property': options.property });\n                this.element.data({\n                    type: 'colorPicker',\n                    colorPicker: this,\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.colorChooser.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (value) {\n                this.value(value);\n            },\n            value: function (value) {\n                this.colorChooser.value(value);\n            },\n            _colorChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: e.sender.value()\n                    }\n                });\n                this.popup.close();\n            }\n        });\n        var ColorPickerButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                options.iconName = 'text';\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n            },\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'colorPicker',\n                    options: {\n                        title: this.options.property,\n                        property: this.options.property\n                    }\n                });\n            }\n        });\n        kendo.toolbar.registerComponent('colorPicker', ColorPicker, ColorPickerButton);\n        var FONT_SIZES = [\n            8,\n            9,\n            10,\n            11,\n            12,\n            13,\n            14,\n            16,\n            18,\n            20,\n            22,\n            24,\n            26,\n            28,\n            36,\n            48,\n            72\n        ];\n        var DEFAULT_FONT_SIZE = 12;\n        var FontSize = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var comboBox = $('<input />').kendoComboBox({\n                    change: this._valueChange.bind(this),\n                    clearButton: false,\n                    dataSource: options.fontSizes || FONT_SIZES,\n                    value: DEFAULT_FONT_SIZE\n                }).data('kendoComboBox');\n                this.comboBox = comboBox;\n                this.element = comboBox.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n                this.element.data({\n                    type: 'fontSize',\n                    fontSize: this\n                });\n            },\n            _valueChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: kendo.parseInt(e.sender.value())\n                    }\n                });\n            },\n            update: function (value) {\n                this.value(kendo.parseInt(value) || DEFAULT_FONT_SIZE);\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.comboBox.value(value);\n                } else {\n                    return this.comboBox.value();\n                }\n            }\n        });\n        var FontSizeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontSize',\n                    options: {\n                        sizes: FONT_SIZES,\n                        defaultSize: DEFAULT_FONT_SIZE\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_SIZE;\n                this.element.find('.k-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontSize', FontSize, FontSizeButton);\n        var FONT_FAMILIES = [\n            'Arial',\n            'Courier New',\n            'Georgia',\n            'Times New Roman',\n            'Trebuchet MS',\n            'Verdana'\n        ];\n        var DEFAULT_FONT_FAMILY = 'Arial';\n        var FontFamily = DropDownTool.extend({\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.setDataSource(options.fontFamilies || FONT_FAMILIES);\n                ddl.value(DEFAULT_FONT_FAMILY);\n                this.element.data({\n                    type: 'fontFamily',\n                    fontFamily: this\n                });\n            },\n            update: function (value) {\n                this.value(value || DEFAULT_FONT_FAMILY);\n            }\n        });\n        var FontFamilyButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontFamily',\n                    options: {\n                        fonts: FONT_FAMILIES,\n                        defaultFont: DEFAULT_FONT_FAMILY\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_FAMILY;\n                this.element.find('.k-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontFamily', FontFamily, FontFamilyButton);\n        var defaultFormats = kendo.spreadsheet.formats = {\n            automatic: null,\n            number: '#,0.00',\n            percent: '0.00%',\n            financial: '_(\"$\"* #,##0.00_);_(\"$\"* (#,##0.00);_(\"$\"* \"-\"??_);_(@_)',\n            currency: '$#,##0.00;[Red]$#,##0.00',\n            date: 'm/d/yyyy',\n            time: 'h:mm:ss AM/PM',\n            dateTime: 'm/d/yyyy h:mm',\n            duration: '[h]:mm:ss'\n        };\n        var Format = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                var icon = '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>';\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    dataValueField: 'format',\n                    dataTextField: 'name',\n                    dataValuePrimitive: true,\n                    valueTemplate: icon,\n                    template: '# if (data.sample) { #' + '<span class=\\'k-spreadsheet-sample\\'>#: data.sample #</span>' + '# } #' + '#: data.name #'\n                });\n                ddl.text(icon);\n                ddl.setDataSource([\n                    {\n                        format: defaultFormats.automatic,\n                        name: MESSAGES.formatTypes.automatic\n                    },\n                    {\n                        format: defaultFormats.number,\n                        name: MESSAGES.formatTypes.number,\n                        sample: '1,499.99'\n                    },\n                    {\n                        format: defaultFormats.percent,\n                        name: MESSAGES.formatTypes.percent,\n                        sample: '14.50%'\n                    },\n                    {\n                        format: defaultFormats.financial,\n                        name: MESSAGES.formatTypes.financial,\n                        sample: '(1,000.12)'\n                    },\n                    {\n                        format: defaultFormats.currency,\n                        name: MESSAGES.formatTypes.currency,\n                        sample: '$1,499.99'\n                    },\n                    {\n                        format: defaultFormats.date,\n                        name: MESSAGES.formatTypes.date,\n                        sample: '4/21/2012'\n                    },\n                    {\n                        format: defaultFormats.time,\n                        name: MESSAGES.formatTypes.time,\n                        sample: '5:49:00 PM'\n                    },\n                    {\n                        format: defaultFormats.dateTime,\n                        name: MESSAGES.formatTypes.dateTime,\n                        sample: '4/21/2012 5:49:00'\n                    },\n                    {\n                        format: defaultFormats.duration,\n                        name: MESSAGES.formatTypes.duration,\n                        sample: '168:05:00'\n                    },\n                    {\n                        popup: 'formatCells',\n                        name: MESSAGES.formatTypes.moreFormats\n                    }\n                ]);\n                this.element.data({\n                    type: 'format',\n                    format: this\n                });\n            }\n        });\n        var FormatButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'formatCells' });\n            }\n        });\n        kendo.toolbar.registerComponent('format', Format, FormatButton);\n        var BorderChangeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._borderPalette();\n                this.element.data({\n                    type: 'borders',\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.borderPalette.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            _borderPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this._action.bind(this) });\n            },\n            _action: function (e) {\n                this.toolbar.action({\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: e.type,\n                        style: {\n                            size: 1,\n                            color: e.color\n                        }\n                    }\n                });\n            }\n        });\n        var BorderChangeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'borders' });\n            }\n        });\n        kendo.toolbar.registerComponent('borders', BorderChangeTool, BorderChangeButton);\n        var AlignmentTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.element.attr({ 'data-property': 'alignment' });\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'alignment',\n                    alignment: this,\n                    instance: this\n                });\n            },\n            buttons: [\n                {\n                    property: 'textAlign',\n                    value: 'left',\n                    iconClass: 'justify-left',\n                    text: MESSAGES.alignmentButtons.justtifyLeft\n                },\n                {\n                    property: 'textAlign',\n                    value: 'center',\n                    iconClass: 'justify-center',\n                    text: MESSAGES.alignmentButtons.justifyCenter\n                },\n                {\n                    property: 'textAlign',\n                    value: 'right',\n                    iconClass: 'justify-right',\n                    text: MESSAGES.alignmentButtons.justifyRight\n                },\n                {\n                    property: 'textAlign',\n                    value: 'justify',\n                    iconClass: 'justify-full',\n                    text: MESSAGES.alignmentButtons.justifyFull\n                },\n                {\n                    property: 'verticalAlign',\n                    value: 'top',\n                    iconClass: 'align-top',\n                    text: MESSAGES.alignmentButtons.alignTop\n                },\n                {\n                    property: 'verticalAlign',\n                    value: 'center',\n                    iconClass: 'align-middle',\n                    text: MESSAGES.alignmentButtons.alignMiddle\n                },\n                {\n                    property: 'verticalAlign',\n                    value: 'bottom',\n                    iconClass: 'align-bottom',\n                    text: MESSAGES.alignmentButtons.alignBottom\n                }\n            ],\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (range) {\n                var textAlign = range.textAlign();\n                var verticalAlign = range.verticalAlign();\n                var element = this.popup.element;\n                element.find('.k-button').removeClass('k-state-active');\n                if (textAlign) {\n                    element.find('[data-property=textAlign][data-value=' + textAlign + ']').addClass('k-state-active');\n                }\n                if (verticalAlign) {\n                    element.find('[data-property=verticalAlign][data-value=' + verticalAlign + ']').addClass('k-state-active');\n                }\n            },\n            _commandPalette: function () {\n                var buttons = this.buttons;\n                var element = $('<div />').appendTo(this.popup.element);\n                buttons.forEach(function (options, index) {\n                    var button = '<a title=\\'' + options.text + '\\' data-property=\\'' + options.property + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\'></span>' + '</a>';\n                    if (index !== 0 && buttons[index - 1].property !== options.property) {\n                        element.append($('<span class=\\'k-separator\\' />'));\n                    }\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var property = button.attr('data-property');\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: property,\n                        value: value\n                    }\n                });\n            }\n        });\n        var AlignmentButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'alignment' });\n            }\n        });\n        kendo.toolbar.registerComponent('alignment', AlignmentTool, AlignmentButton);\n        var MergeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'merge',\n                    merge: this,\n                    instance: this\n                });\n            },\n            buttons: [\n                {\n                    value: 'cells',\n                    iconClass: 'merge-cells',\n                    text: MESSAGES.mergeButtons.mergeCells\n                },\n                {\n                    value: 'horizontally',\n                    iconClass: 'merge-horizontally',\n                    text: MESSAGES.mergeButtons.mergeHorizontally\n                },\n                {\n                    value: 'vertically',\n                    iconClass: 'merge-vertically',\n                    text: MESSAGES.mergeButtons.mergeVertically\n                },\n                {\n                    value: 'unmerge',\n                    iconClass: 'normal-layout',\n                    text: MESSAGES.mergeButtons.unmerge\n                }\n            ],\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icontext\\'>' + '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\'></span>' + options.text + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'MergeCellCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var MergeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'merge' });\n            }\n        });\n        kendo.toolbar.registerComponent('merge', MergeTool, MergeButton);\n        var FreezeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'freeze',\n                    freeze: this,\n                    instance: this\n                });\n            },\n            buttons: [\n                {\n                    value: 'panes',\n                    iconClass: 'freeze-panes',\n                    text: MESSAGES.freezeButtons.freezePanes\n                },\n                {\n                    value: 'rows',\n                    iconClass: 'freeze-row',\n                    text: MESSAGES.freezeButtons.freezeRows\n                },\n                {\n                    value: 'columns',\n                    iconClass: 'freeze-col',\n                    text: MESSAGES.freezeButtons.freezeColumns\n                },\n                {\n                    value: 'unfreeze',\n                    iconClass: 'normal-layout',\n                    text: MESSAGES.freezeButtons.unfreeze\n                }\n            ],\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icontext\\'>' + '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\'></span>' + options.text + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'FreezePanesCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var FreezeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'freeze' });\n            }\n        });\n        kendo.toolbar.registerComponent('freeze', FreezeTool, FreezeButton);\n        var Sort = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    valueTemplate: '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>',\n                    template: '<span class=\\'k-icon k-font-icon k-i-#= iconClass #\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>#=text#',\n                    dataTextField: 'text',\n                    dataValueField: 'value'\n                });\n                ddl.setDataSource([\n                    {\n                        value: 'asc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeAsc,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        value: 'desc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeDesc,\n                        iconClass: 'sort-desc'\n                    }\n                ]);\n                ddl.select(0);\n                this.element.data({\n                    type: 'sort',\n                    sort: this\n                });\n            },\n            _change: function (e) {\n                var instance = e.sender;\n                var dataItem = instance.dataItem();\n                if (dataItem) {\n                    this.toolbar.action({\n                        command: 'SortCommand',\n                        options: {\n                            value: dataItem.value,\n                            sheet: dataItem.sheet\n                        }\n                    });\n                }\n            },\n            value: $.noop\n        });\n        var SortButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'sort' });\n            }\n        });\n        kendo.toolbar.registerComponent('sort', Sort, SortButton);\n        var Filter = kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                options.showText = 'overflow';\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this.element.on('click', this._click.bind(this));\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        var FilterButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        kendo.toolbar.registerComponent('filter', Filter, FilterButton);\n        var Open = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.toolbar = toolbar;\n                this.element = $('<div class=\\'k-button k-upload-button k-button-icon\\'>' + '<span class=\\'k-icon k-font-icon k-i-folder-open\\' />' + '</div>').data('instance', this);\n                this._title = options.attributes.title;\n                this._reset();\n            },\n            _reset: function () {\n                this.element.remove('input');\n                $('<input type=\\'file\\' autocomplete=\\'off\\' accept=\\'.xlsx\\'/>').attr('title', this._title).one('change', this._change.bind(this)).appendTo(this.element);\n            },\n            _change: function (e) {\n                this.toolbar.action({\n                    command: 'OpenCommand',\n                    options: { file: e.target.files[0] }\n                });\n                this._reset();\n            }\n        });\n        kendo.toolbar.registerComponent('open', Open);\n        kendo.spreadsheet.TabStrip = kendo.ui.TabStrip.extend({\n            init: function (element, options) {\n                kendo.ui.TabStrip.fn.init.call(this, element, options);\n                element.addClass('k-spreadsheet-tabstrip');\n                this._quickAccessButtons();\n                this.toolbars = {};\n                var tabs = options.dataSource;\n                this.contentElements.each(function (idx, element) {\n                    this._toolbar($(element), tabs[idx].id, options.toolbarOptions[tabs[idx].id]);\n                }.bind(this));\n                this.one('activate', function () {\n                    this.toolbars[this.options.dataSource[0].id].resize();\n                });\n            },\n            events: kendo.ui.TabStrip.fn.events.concat([\n                'action',\n                'dialog'\n            ]),\n            destroy: function () {\n                this.quickAccessToolBar.off('click');\n                kendo.ui.TabStrip.fn.destroy.call(this);\n                for (var name in this.toolbars) {\n                    this.toolbars[name].destroy();\n                }\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refreshTools: function (range) {\n                var toolbars = this.toolbars;\n                for (var name in toolbars) {\n                    if (toolbars.hasOwnProperty(name)) {\n                        toolbars[name].refresh(range);\n                    }\n                }\n            },\n            _quickAccessButtons: function () {\n                var buttons = [\n                    {\n                        title: MESSAGES.quickAccess.undo,\n                        iconClass: 'undo-large',\n                        action: 'undo'\n                    },\n                    {\n                        title: MESSAGES.quickAccess.redo,\n                        iconClass: 'redo-large',\n                        action: 'redo'\n                    }\n                ];\n                var buttonTemplate = kendo.template('<a href=\\'\\\\#\\' title=\\'#= title #\\' data-action=\\'#= action #\\' class=\\'k-button k-button-icon\\'><span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span></a>');\n                this.quickAccessToolBar = $('<div />', {\n                    'class': 'k-spreadsheet-quick-access-toolbar',\n                    'html': kendo.render(buttonTemplate, buttons)\n                }).insertBefore(this.wrapper);\n                this.quickAccessToolBar.on('click', '.k-button', function (e) {\n                    e.preventDefault();\n                    var action = $(e.currentTarget).attr('data-action');\n                    this.action({ action: action });\n                }.bind(this));\n                this.quickAccessAdjust();\n            },\n            quickAccessAdjust: function () {\n                this.tabGroup.css('padding-left', kendo._outerWidth(this.quickAccessToolBar));\n            },\n            _toolbar: function (container, name, tools) {\n                var element;\n                var options;\n                if (this.toolbars[name]) {\n                    this.toolbars[name].destroy();\n                    container.children('.k-toolbar').remove();\n                }\n                if (tools) {\n                    element = container.html('<div />').children('div');\n                    options = {\n                        tools: typeof tools === 'boolean' ? undefined : tools,\n                        toolbarName: name,\n                        action: this.action.bind(this),\n                        dialog: this.dialog.bind(this)\n                    };\n                    this.toolbars[name] = new kendo.spreadsheet.ToolBar(element, options);\n                }\n            }\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/dialogs', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.validator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var ObservableObject = kendo.data.ObservableObject;\n        var MESSAGES = kendo.spreadsheet.messages.dialogs = {\n            apply: 'Apply',\n            save: 'Save',\n            cancel: 'Cancel',\n            remove: 'Remove',\n            retry: 'Retry',\n            revert: 'Revert',\n            okText: 'OK',\n            formatCellsDialog: {\n                title: 'Format',\n                categories: {\n                    number: 'Number',\n                    currency: 'Currency',\n                    date: 'Date'\n                }\n            },\n            fontFamilyDialog: { title: 'Font' },\n            fontSizeDialog: { title: 'Font size' },\n            bordersDialog: { title: 'Borders' },\n            alignmentDialog: {\n                title: 'Alignment',\n                buttons: {\n                    justtifyLeft: 'Align left',\n                    justifyCenter: 'Center',\n                    justifyRight: 'Align right',\n                    justifyFull: 'Justify',\n                    alignTop: 'Align top',\n                    alignMiddle: 'Align middle',\n                    alignBottom: 'Align bottom'\n                }\n            },\n            mergeDialog: {\n                title: 'Merge cells',\n                buttons: {\n                    mergeCells: 'Merge all',\n                    mergeHorizontally: 'Merge horizontally',\n                    mergeVertically: 'Merge vertically',\n                    unmerge: 'Unmerge'\n                }\n            },\n            freezeDialog: {\n                title: 'Freeze panes',\n                buttons: {\n                    freezePanes: 'Freeze panes',\n                    freezeRows: 'Freeze rows',\n                    freezeColumns: 'Freeze columns',\n                    unfreeze: 'Unfreeze panes'\n                }\n            },\n            validationDialog: {\n                title: 'Data Validation',\n                hintMessage: 'Please enter a valid {0} value {1}.',\n                hintTitle: 'Validation {0}',\n                criteria: {\n                    any: 'Any value',\n                    number: 'Number',\n                    text: 'Text',\n                    date: 'Date',\n                    custom: 'Custom Formula',\n                    list: 'List'\n                },\n                comparers: {\n                    greaterThan: 'greater than',\n                    lessThan: 'less than',\n                    between: 'between',\n                    notBetween: 'not between',\n                    equalTo: 'equal to',\n                    notEqualTo: 'not equal to',\n                    greaterThanOrEqualTo: 'greater than or equal to',\n                    lessThanOrEqualTo: 'less than or equal to'\n                },\n                comparerMessages: {\n                    greaterThan: 'greater than {0}',\n                    lessThan: 'less than {0}',\n                    between: 'between {0} and {1}',\n                    notBetween: 'not between {0} and {1}',\n                    equalTo: 'equal to {0}',\n                    notEqualTo: 'not equal to {0}',\n                    greaterThanOrEqualTo: 'greater than or equal to {0}',\n                    lessThanOrEqualTo: 'less than or equal to {0}',\n                    custom: 'that satisfies the formula: {0}'\n                },\n                labels: {\n                    criteria: 'Criteria',\n                    comparer: 'Comparer',\n                    min: 'Min',\n                    max: 'Max',\n                    value: 'Value',\n                    start: 'Start',\n                    end: 'End',\n                    onInvalidData: 'On invalid data',\n                    rejectInput: 'Reject input',\n                    showWarning: 'Show warning',\n                    showHint: 'Show hint',\n                    hintTitle: 'Hint title',\n                    hintMessage: 'Hint message',\n                    ignoreBlank: 'Ignore blank',\n                    showListButton: 'Display button to show list',\n                    showCalendarButton: 'Display button to show calendar'\n                },\n                placeholders: {\n                    typeTitle: 'Type title',\n                    typeMessage: 'Type message'\n                }\n            },\n            exportAsDialog: {\n                title: 'Export...',\n                labels: {\n                    scale: 'Scale',\n                    fit: 'Fit to page',\n                    fileName: 'File name',\n                    saveAsType: 'Save as type',\n                    exportArea: 'Export',\n                    paperSize: 'Paper size',\n                    margins: 'Margins',\n                    orientation: 'Orientation',\n                    print: 'Print',\n                    guidelines: 'Guidelines',\n                    center: 'Center',\n                    horizontally: 'Horizontally',\n                    vertically: 'Vertically'\n                }\n            },\n            modifyMergedDialog: { errorMessage: 'Cannot change part of a merged cell.' },\n            rangeDisabledDialog: { errorMessage: 'Destination range contains disabled cells.' },\n            incompatibleRangesDialog: { errorMessage: 'Incompatible ranges' },\n            noFillDirectionDialog: { errorMessage: 'Cannot determine fill direction' },\n            duplicateSheetNameDialog: { errorMessage: 'Duplicate sheet name' },\n            overflowDialog: { errorMessage: 'Cannot paste, because the copy area and the paste area are not the same size and shape.' },\n            useKeyboardDialog: {\n                title: 'Copying and pasting',\n                errorMessage: 'These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:',\n                labels: {\n                    forCopy: 'for copy',\n                    forCut: 'for cut',\n                    forPaste: 'for paste'\n                }\n            },\n            unsupportedSelectionDialog: { errorMessage: 'That action cannot be performed on multiple selection.' },\n            linkDialog: {\n                title: 'Hyperlink',\n                labels: {\n                    text: 'Text',\n                    url: 'Address',\n                    removeLink: 'Remove link'\n                }\n            }\n        };\n        var registry = {};\n        kendo.spreadsheet.dialogs = {\n            register: function (name, dialogClass) {\n                registry[name] = dialogClass;\n            },\n            registered: function (name) {\n                return !!registry[name];\n            },\n            create: function (name, options) {\n                var dialogClass = registry[name];\n                if (dialogClass) {\n                    return new dialogClass(options);\n                }\n            }\n        };\n        var SpreadsheetDialog = kendo.spreadsheet.SpreadsheetDialog = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.options = $.extend(true, {}, this.options, options);\n                this.bind(this.events, options);\n            },\n            events: [\n                'close',\n                'activate'\n            ],\n            options: { autoFocus: true },\n            dialog: function () {\n                if (!this._dialog) {\n                    this._dialog = $('<div class=\\'k-spreadsheet-window k-action-window\\' />').addClass(this.options.className || '').append(kendo.template(this.options.template)({ messages: kendo.spreadsheet.messages.dialogs || MESSAGES })).appendTo(document.body).kendoWindow({\n                        autoFocus: this.options.autoFocus,\n                        scrollable: false,\n                        resizable: false,\n                        modal: true,\n                        visible: false,\n                        width: this.options.width || 320,\n                        title: this.options.title,\n                        open: function () {\n                            this.center();\n                        },\n                        close: this._onDialogClose.bind(this),\n                        activate: this._onDialogActivate.bind(this),\n                        deactivate: this._onDialogDeactivate.bind(this)\n                    }).data('kendoWindow');\n                }\n                return this._dialog;\n            },\n            _onDialogClose: function () {\n                this.trigger('close', { action: this._action });\n            },\n            _onDialogActivate: function () {\n                this.trigger('activate');\n            },\n            _onDialogDeactivate: function () {\n                this.trigger('deactivate');\n                this.destroy();\n            },\n            destroy: function () {\n                if (this._dialog) {\n                    this._dialog.destroy();\n                    this._dialog = null;\n                }\n            },\n            open: function () {\n                this.dialog().open();\n            },\n            apply: function () {\n                this.close();\n            },\n            close: function () {\n                this._action = 'close';\n                this.dialog().close();\n            }\n        });\n        function formattedValue(value, format) {\n            return kendo.spreadsheet.formatting.text(value, format);\n        }\n        var FormatCellsViewModel = kendo.spreadsheet.FormatCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.useCategory(this.category);\n            },\n            useCategory: function (category) {\n                var type = category && category.type || 'number';\n                var formatCurrency = type == 'currency';\n                this.category = category;\n                this.set('showCurrencyFilter', formatCurrency && this.currencies.length > 1);\n                if (!formatCurrency) {\n                    this.set('formats', this.allFormats[type + 'Formats']);\n                } else {\n                    this.currency(this.currencies[0]);\n                }\n                this.useFirstFormat();\n            },\n            useFirstFormat: function () {\n                if (this.formats.length) {\n                    this.set('format', this.formats[0].value);\n                }\n            },\n            currency: function (currency) {\n                if (currency !== undefined) {\n                    this._currency = currency;\n                    var info = currency.value;\n                    var formats = [\n                        {\n                            currency: info,\n                            decimals: true\n                        },\n                        {\n                            currency: info,\n                            decimals: true,\n                            iso: true\n                        },\n                        {\n                            currency: info,\n                            decimals: false\n                        }\n                    ];\n                    formats = formats.map(function (format) {\n                        format = FormatCellsViewModel.convert.currency(format);\n                        return {\n                            value: format,\n                            name: formattedValue(1000, format)\n                        };\n                    });\n                    this.set('formats', formats);\n                    this.useFirstFormat();\n                }\n                return this._currency || this.currencies[0];\n            },\n            categoryFilter: function (category) {\n                if (category !== undefined) {\n                    this.useCategory(category);\n                }\n                return this.category;\n            },\n            preview: function () {\n                var format = this.get('format');\n                var value = this.value || 0;\n                if (format && format.length) {\n                    return formattedValue(value, format);\n                } else {\n                    return value;\n                }\n            }\n        });\n        FormatCellsViewModel.convert = {\n            currency: function (options) {\n                function repeat(token, n) {\n                    return new Array(n + 1).join(token);\n                }\n                var info = options.currency;\n                var format = info.pattern[1];\n                if (options.decimals) {\n                    format = format.replace(/n/g, 'n' + info['.'] + repeat('0', info.decimals));\n                }\n                if (options.iso) {\n                    format = '\"' + info.abbr + '\" ' + format.replace(/\\s*\\$\\s*/g, '');\n                } else {\n                    format = format.replace(/\\$/g, info.symbol);\n                }\n                format = format.replace(/n/g, '?');\n                return format;\n            },\n            date: function (format) {\n                if (/T|Z/.test(format)) {\n                    return '';\n                }\n                return format.toLowerCase().replace(/tt/g, 'AM/PM').replace(/'/g, '\"');\n            }\n        };\n        function uniqueBy(field, array) {\n            var result = [];\n            var values = [];\n            for (var i = 0; i < array.length; i++) {\n                if ($.inArray(array[i][field], values) == -1) {\n                    result.push(array[i]);\n                    values.push(array[i][field]);\n                }\n            }\n            return result;\n        }\n        var FormatCellsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.formatCellsDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    categories: [\n                        {\n                            type: 'number',\n                            name: messages.categories.number\n                        },\n                        {\n                            type: 'currency',\n                            name: messages.categories.currency\n                        },\n                        {\n                            type: 'date',\n                            name: messages.categories.date\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._generateFormats();\n            },\n            options: {\n                className: 'k-spreadsheet-format-cells',\n                template: '<div class=\\'k-root-tabs\\' data-role=\\'tabstrip\\' ' + 'data-text-field=\\'name\\' ' + 'data-bind=\\'source: categories, value: categoryFilter\\' ' + 'data-animation=\\'false\\' />' + '<div class=\\'k-spreadsheet-preview\\' data-bind=\\'text: preview\\' />' + '<script type=\\'text/x-kendo-template\\' id=\\'format-item-template\\'>' + '\\\\#: data.name \\\\#' + '</script>' + '<select data-role=\\'dropdownlist\\' class=\\'k-format-filter\\' ' + 'data-text-field=\\'description\\' ' + 'data-value-field=\\'value.name\\' ' + 'data-bind=\\'visible: showCurrencyFilter, value: currency, source: currencies\\' />' + '<ul data-role=\\'staticlist\\' tabindex=\\'0\\' ' + 'class=\\'k-list k-reset\\' ' + 'data-template=\\'format-item-template\\' ' + 'data-value-primitive=\\'true\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'source: formats, value: format\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>'\n            },\n            _generateFormats: function () {\n                var options = this.options;\n                if (!options.currencies) {\n                    options.currencies = FormatCellsDialog.currenciesFrom(kendo.cultures);\n                }\n                if (!options.numberFormats) {\n                    options.numberFormats = [\n                        {\n                            value: '#.00%',\n                            name: '100.00%'\n                        },\n                        {\n                            value: '#%',\n                            name: '100%'\n                        },\n                        {\n                            value: '#.00',\n                            name: '1024.00'\n                        },\n                        {\n                            value: '#,###.00',\n                            name: '1,024.00'\n                        }\n                    ];\n                }\n                if (!options.dateFormats) {\n                    var calendarPatterns = kendo.cultures.current.calendars.standard.patterns;\n                    options.dateFormats = uniqueBy('value', $.map(calendarPatterns, function (format) {\n                        format = FormatCellsViewModel.convert.date(format);\n                        if (!format) {\n                            return;\n                        }\n                        return {\n                            value: format,\n                            name: formattedValue(34567.7678, format)\n                        };\n                    }));\n                }\n            },\n            open: function (range) {\n                var options = this.options;\n                var value = range.value();\n                var categories = options.categories.slice(0);\n                var element;\n                this.viewModel = new FormatCellsViewModel({\n                    currencies: options.currencies.slice(0),\n                    allFormats: {\n                        numberFormats: options.numberFormats.slice(0),\n                        dateFormats: options.dateFormats.slice(0)\n                    },\n                    categories: categories,\n                    format: range.format(),\n                    category: value instanceof Date ? categories[2] : categories[0],\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    value: value\n                });\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                kendo.bind(element, this.viewModel);\n                var currencyFilter = element.find('select.k-format-filter').data('kendoDropDownList');\n                if (options.currencies.length > 10) {\n                    currencyFilter.setOptions({ filter: 'contains' });\n                }\n                element.find(kendo.roleSelector('staticlist')).parent().addClass('k-list-wrapper');\n            },\n            apply: function () {\n                var format = this.viewModel.format;\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'format',\n                        value: format\n                    }\n                });\n            }\n        });\n        FormatCellsDialog.currenciesFrom = function (cultures) {\n            return uniqueBy('description', $.map(cultures, function (culture, name) {\n                if (!/-/.test(name)) {\n                    return;\n                }\n                var currency = culture.numberFormat.currency;\n                var description = kendo.format('{0} ({1}, {2})', currency.name, currency.abbr, currency.symbol);\n                return {\n                    description: description,\n                    value: currency\n                };\n            }));\n        };\n        kendo.spreadsheet.dialogs.register('formatCells', FormatCellsDialog);\n        kendo.spreadsheet.dialogs.FormatCellsDialog = FormatCellsDialog;\n        var MessageDialog = SpreadsheetDialog.extend({\n            options: {\n                className: 'k-spreadsheet-message',\n                title: '',\n                messageId: '',\n                text: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-bind=\\'text: text\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close\\'>' + '#= messages.okText #' + '</button>' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                var options = this.options;\n                var text = options.text;\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    close: this.close.bind(this)\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('message', MessageDialog);\n        var ValidationErrorDialog = SpreadsheetDialog.extend({\n            options: {\n                className: 'k-spreadsheet-message',\n                title: '',\n                messageId: '',\n                text: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-bind=\\'text: text\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close\\'>' + '#= messages.retry #' + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: revert\\'>' + '#= messages.revert #' + '</button>' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                var options = this.options;\n                var text = options.text;\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    close: this.close.bind(this),\n                    revert: this.revert.bind(this)\n                });\n            },\n            activate: function (e) {\n                e.sender.dialog().element.find('.k-button').focus();\n            },\n            revert: function () {\n                this._action = 'revert';\n                this.dialog().close();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('validationError', ValidationErrorDialog);\n        var FontFamilyDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontFamilyDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var fonts = this.options.fonts;\n                var defaultFont = this.options.defaultFont;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: fonts }),\n                    template: '#: data #',\n                    value: defaultFont,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontFamily',\n                        value: e.sender.value()[0]\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontFamily', FontFamilyDialog);\n        var FontSizeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontSizeDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var sizes = this.options.sizes;\n                var defaultSize = this.options.defaultSize;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: sizes }),\n                    template: '#: data #',\n                    value: defaultSize,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontSize',\n                        value: kendo.parseInt(e.sender.value()[0])\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontSize', FontSizeDialog);\n        var BordersDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.bordersDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this.element = this.dialog().element;\n                this._borderPalette();\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: {\n                width: 177,\n                template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                var state = this.value();\n                this.trigger('action', {\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: state.type,\n                        style: {\n                            size: 1,\n                            color: state.color\n                        }\n                    }\n                });\n            },\n            _borderPalette: function () {\n                var element = this.dialog().element.find('div:first');\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this.value.bind(this) });\n            },\n            value: function (state) {\n                if (state === undefined) {\n                    return this._state;\n                } else {\n                    this._state = state;\n                }\n            }\n        });\n        kendo.spreadsheet.dialogs.register('borders', BordersDialog);\n        var ColorChooser = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this.element = this.dialog().element;\n                this.property = options.property;\n                this.options.title = options.title;\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: { template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>' },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.property,\n                        value: this.value()\n                    }\n                });\n            },\n            value: function (e) {\n                if (e === undefined) {\n                    return this._value;\n                } else {\n                    this._value = e.value;\n                }\n            }\n        });\n        var ColorPickerDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 177;\n                ColorChooser.fn.init.call(this, options);\n                this._colorPalette();\n            },\n            _colorPalette: function () {\n                var element = this.dialog().element.find('div:first');\n                this.colorPalette = element.kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    change: this.value.bind(this)\n                }).data('kendoColorPalette');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('colorPicker', ColorPickerDialog);\n        var CustomColorDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 268;\n                ColorChooser.fn.init.call(this, options);\n                this.dialog().setOptions({ animation: false });\n                this.dialog().one('activate', this._colorPicker.bind(this));\n            },\n            _colorPicker: function () {\n                var element = this.dialog().element.find('div:first');\n                this.colorPicker = element.kendoFlatColorPicker({ change: this.value.bind(this) }).data('kendoFlatColorPicker');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('customColor', CustomColorDialog);\n        var AlignmentDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.alignmentDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            property: 'textAlign',\n                            value: 'left',\n                            iconClass: 'justify-left',\n                            text: messages.buttons.justtifyLeft\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'center',\n                            iconClass: 'justify-center',\n                            text: messages.buttons.justifyCenter\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'right',\n                            iconClass: 'justify-right',\n                            text: messages.buttons.justifyRight\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'justify',\n                            iconClass: 'justify-full',\n                            text: messages.buttons.justifyFull\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'top',\n                            iconClass: 'align-top',\n                            text: messages.buttons.alignTop\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'center',\n                            iconClass: 'align-middle',\n                            text: messages.buttons.alignMiddle\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'bottom',\n                            iconClass: 'align-bottom',\n                            text: messages.buttons.alignBottom\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-property=\\'#=property#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>' + '#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: dataItem.property,\n                        value: dataItem.value\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('alignment', AlignmentDialog);\n        var MergeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.mergeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            value: 'cells',\n                            iconClass: 'merge-cells',\n                            text: messages.buttons.mergeCells\n                        },\n                        {\n                            value: 'horizontally',\n                            iconClass: 'merge-horizontally',\n                            text: messages.buttons.mergeHorizontally\n                        },\n                        {\n                            value: 'vertically',\n                            iconClass: 'merge-vertically',\n                            text: messages.buttons.mergeVertically\n                        },\n                        {\n                            value: 'unmerge',\n                            iconClass: 'normal-layout',\n                            text: messages.buttons.unmerge\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'MergeCellCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('merge', MergeDialog);\n        var FreezeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.freezeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            value: 'panes',\n                            iconClass: 'freeze-panes',\n                            text: messages.buttons.freezePanes\n                        },\n                        {\n                            value: 'rows',\n                            iconClass: 'freeze-row',\n                            text: messages.buttons.freezeRows\n                        },\n                        {\n                            value: 'columns',\n                            iconClass: 'freeze-col',\n                            text: messages.buttons.freezeColumns\n                        },\n                        {\n                            value: 'unfreeze',\n                            iconClass: 'normal-layout',\n                            text: messages.buttons.unfreeze\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'FreezePanesCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('freeze', FreezeDialog);\n        var ValidationViewModel = kendo.spreadsheet.ValidationCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.bind('change', function (e) {\n                    if (e.field === 'criterion') {\n                        this.reset();\n                        if (this.criterion === 'custom' || this.criterion === 'list') {\n                            this.setHintMessageTemplate();\n                        }\n                    }\n                    if (e.field === 'comparer') {\n                        this.setHintMessageTemplate();\n                    }\n                    if ((e.field == 'hintMessage' || e.field == 'hintTitle') && !this._mute) {\n                        this.shouldBuild = false;\n                    }\n                    if ((e.field == 'from' || e.field == 'to' || e.field == 'hintMessageTemplate' || e.field == 'type') && this.shouldBuild) {\n                        this.buildMessages();\n                    }\n                }.bind(this));\n                this.reset();\n            },\n            buildMessages: function () {\n                this._mute = true;\n                this.set('hintTitle', this.hintTitleTemplate ? kendo.format(this.hintTitleTemplate, this.type) : '');\n                this.set('hintMessage', this.hintMessageTemplate ? kendo.format(this.hintMessageTemplate, this.from, this.to) : '');\n                this._mute = false;\n            },\n            reset: function () {\n                this.setComparers();\n                this.set('comparer', this.comparers[0].type);\n                this.set('from', null);\n                this.set('to', null);\n                this.set('useCustomMessages', false);\n                this.shouldBuild = true;\n                this.hintTitleTemplate = this.defaultHintTitle;\n                this.buildMessages();\n            },\n            setComparers: function () {\n                var all = this.defaultComparers;\n                var comparers = [];\n                if (this.criterion === 'text') {\n                    var text_comparers = [\n                        'equalTo',\n                        'notEqualTo'\n                    ];\n                    for (var idx = 0; idx < all.length; idx++) {\n                        if (text_comparers[0] == all[idx].type) {\n                            comparers.push(all[idx]);\n                            text_comparers.shift();\n                        }\n                    }\n                } else {\n                    comparers = all.slice();\n                }\n                this.set('comparers', comparers);\n            },\n            setHintMessageTemplate: function () {\n                if (this.criterion !== 'custom' && this.criterion !== 'list') {\n                    this.set('hintMessageTemplate', kendo.format(this.defaultHintMessage, this.criterion, this.comparerMessages[this.comparer]));\n                } else {\n                    this.set('hintMessageTemplate', '');\n                    this.set('hintMessage', '');\n                }\n            },\n            isAny: function () {\n                return this.get('criterion') === 'any';\n            },\n            isNumber: function () {\n                return this.get('criterion') === 'number';\n            },\n            showToForNumber: function () {\n                return this.showTo() && this.isNumber();\n            },\n            showToForDate: function () {\n                return this.showTo() && this.isDate();\n            },\n            isText: function () {\n                return this.get('criterion') === 'text';\n            },\n            isDate: function () {\n                return this.get('criterion') === 'date';\n            },\n            isList: function () {\n                return this.get('criterion') === 'list';\n            },\n            isCustom: function () {\n                return this.get('criterion') === 'custom';\n            },\n            showRemove: function () {\n                return this.get('hasValidation');\n            },\n            showTo: function () {\n                return this.get('comparer') == 'between' || this.get('comparer') == 'notBetween';\n            },\n            update: function (validation) {\n                this.set('hasValidation', !!validation);\n                if (validation) {\n                    this.fromValidationObject(validation);\n                }\n            },\n            fromValidationObject: function (validation) {\n                this.set('criterion', validation.dataType);\n                this.set('comparer', validation.comparerType);\n                this.set('from', validation.from);\n                this.set('to', validation.to);\n                this.set('type', validation.type);\n                this.set('ignoreBlank', validation.allowNulls);\n                this.set('showButton', validation.showButton);\n                if (validation.messageTemplate || validation.titleTemplate) {\n                    this.hintMessageTemplate = validation.messageTemplate;\n                    this.hintMessage = validation.messageTemplate;\n                    this.hintTitleTemplate = validation.titleTemplate;\n                    this.hintTitle = validation.titleTemplate;\n                    this.useCustomMessages = true;\n                    this.buildMessages();\n                } else {\n                    this.useCustomMessages = false;\n                }\n            },\n            toValidationObject: function () {\n                if (this.criterion === 'any') {\n                    return null;\n                }\n                var options = {\n                    type: this.type,\n                    dataType: this.criterion,\n                    comparerType: this.comparer,\n                    from: this.from,\n                    to: this.to,\n                    allowNulls: this.ignoreBlank,\n                    showButton: this.showButton\n                };\n                if (this.useCustomMessages) {\n                    options.messageTemplate = this.shouldBuild ? this.hintMessageTemplate : this.hintMessage;\n                    options.titleTemplate = this.hintTitle;\n                }\n                return options;\n            }\n        });\n        var ValidationDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.validationDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    hintMessage: messages.hintMessage,\n                    hintTitle: messages.hintTitle,\n                    criteria: [\n                        {\n                            type: 'any',\n                            name: messages.criteria.any\n                        },\n                        {\n                            type: 'number',\n                            name: messages.criteria.number\n                        },\n                        {\n                            type: 'text',\n                            name: messages.criteria.text\n                        },\n                        {\n                            type: 'date',\n                            name: messages.criteria.date\n                        },\n                        {\n                            type: 'custom',\n                            name: messages.criteria.custom\n                        },\n                        {\n                            type: 'list',\n                            name: messages.criteria.list\n                        }\n                    ],\n                    comparers: [\n                        {\n                            type: 'greaterThan',\n                            name: messages.comparers.greaterThan\n                        },\n                        {\n                            type: 'lessThan',\n                            name: messages.comparers.lessThan\n                        },\n                        {\n                            type: 'between',\n                            name: messages.comparers.between\n                        },\n                        {\n                            type: 'notBetween',\n                            name: messages.comparers.notBetween\n                        },\n                        {\n                            type: 'equalTo',\n                            name: messages.comparers.equalTo\n                        },\n                        {\n                            type: 'notEqualTo',\n                            name: messages.comparers.notEqualTo\n                        },\n                        {\n                            type: 'greaterThanOrEqualTo',\n                            name: messages.comparers.greaterThanOrEqualTo\n                        },\n                        {\n                            type: 'lessThanOrEqualTo',\n                            name: messages.comparers.lessThanOrEqualTo\n                        }\n                    ],\n                    comparerMessages: messages.comparerMessages\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n            },\n            options: {\n                width: 450,\n                criterion: 'any',\n                type: 'reject',\n                ignoreBlank: true,\n                showButton: true,\n                useCustomMessages: false,\n                errorTemplate: '<div class=\"k-widget k-tooltip k-tooltip-validation\" style=\"margin:0.5em\"><span class=\"k-icon k-i-warning\"> </span>' + '#= message #<div class=\"k-callout k-callout-n\"></div></div>',\n                template: '<div class=\"k-edit-form-container\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.criteria #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: criterion, source: criteria\" />' + '</div>' + '<div data-bind=\"visible: isNumber\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.min #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.min #\" placeholder=\"e.g. 10\" class=\"k-textbox\" data-bind=\"value: from, enabled: isNumber\" required=\"required\" />' + '</div>' + '<div data-bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.max #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.max #\" placeholder=\"e.g. 100\" class=\"k-textbox\" data-bind=\"value: to, enabled: showToForNumber\" required=\"required\" />' + '</div>' + '</div>' + '</div>' + '<div data-bind=\"visible: isText\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isText\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isDate\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.start #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.start #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isDate\" required=\"required\" />' + '</div>' + '<div data-bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.end #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.end #\" class=\"k-textbox\" data-bind=\"value: to, enabled: showToForDate\" required=\"required\" />' + '</div>' + '</div>' + '</div>' + '<div data-bind=\"visible: isCustom\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isCustom\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isList\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isList\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isList\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"showButton\" id=\"showButton\" class=\"k-checkbox\" data-bind=\"checked: showButton\"/>' + '<label for=\"showButton\" class=\"k-checkbox-label\">' + ' #: messages.validationDialog.labels.showListButton #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"visible: isDate\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"showButton\" id=\"showButton\" class=\"k-checkbox\" data-bind=\"checked: showButton\"/>' + '<label for=\"showButton\" class=\"k-checkbox-label\">' + ' #: messages.validationDialog.labels.showCalendarButton #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"ignoreBlank\" id=\"ignoreBlank\" class=\"k-checkbox\" data-bind=\"checked: ignoreBlank\"/>' + '<label for=\"ignoreBlank\" class=\"k-checkbox-label\">' + ' #: messages.validationDialog.labels.ignoreBlank #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-action-buttons\"></div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.onInvalidData #:</label></div>' + '<div class=\"k-edit-field\">' + '<input type=\"radio\" id=\"validationTypeReject\" name=\"validationType\" value=\"reject\" data-bind=\"checked: type\" class=\"k-radio\" />' + '<label for=\"validationTypeReject\" class=\"k-radio-label\">' + '#: messages.validationDialog.labels.rejectInput #' + '</label> ' + '<input type=\"radio\" id=\"validationTypeWarning\" name=\"validationType\" value=\"warning\" data-bind=\"checked: type\" class=\"k-radio\" />' + '<label for=\"validationTypeWarning\" class=\"k-radio-label\">' + '#: messages.validationDialog.labels.showWarning #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\" class=\"hint-wrapper\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"useCustomMessages\" id=\"useCustomMessages\" class=\"k-checkbox\" data-bind=\"checked: useCustomMessages\" />' + '<label class=\"k-checkbox-label\" for=\"useCustomMessages\">' + ' #: messages.validationDialog.labels.showHint #' + '</label>' + '</div>' + '<div data-bind=\"visible: useCustomMessages\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.hintTitle #:</label></div>' + '<div class=\"k-edit-field\">' + '<input class=\"k-textbox\" placeholder=\"#: messages.validationDialog.placeholders.typeTitle #\" data-bind=\"value: hintTitle\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.hintMessage #:</label></div>' + '<div class=\"k-edit-field\">' + '<input class=\"k-textbox\" placeholder=\"#: messages.validationDialog.placeholders.typeMessage #\" data-bind=\"value: hintMessage\" />' + '</div>' + '</div>' + '</div>' + '<div class=\"k-action-buttons\">' + '<button class=\"k-button\" data-bind=\"visible: showRemove, click: remove\">#: messages.remove #</button>' + '<button class=\"k-button k-primary\" data-bind=\"click: apply\">#: messages.apply #</button>' + '<button class=\"k-button\" data-bind=\"click: close\">#: messages.cancel #</button>' + '</div>' + '</div>'\n            },\n            open: function (range) {\n                var options = this.options;\n                var element;\n                this.viewModel = new ValidationViewModel({\n                    type: options.type,\n                    defaultHintMessage: options.hintMessage,\n                    defaultHintTitle: options.hintTitle,\n                    defaultComparers: options.comparers.slice(0),\n                    comparerMessages: options.comparerMessages,\n                    criteria: options.criteria.slice(0),\n                    criterion: options.criterion,\n                    ignoreBlank: options.ignoreBlank,\n                    showButton: options.showButton,\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    remove: this.remove.bind(this)\n                });\n                this.viewModel.update(range.validation());\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                if (this.validatable) {\n                    this.validatable.destroy();\n                }\n                kendo.bind(element, this.viewModel);\n                this.validatable = new kendo.ui.Validator(element.find('.k-edit-form-container'), {\n                    validateOnBlur: false,\n                    errorTemplate: this.options.errorTemplate || undefined\n                });\n            },\n            apply: function () {\n                if (this.validatable.validate()) {\n                    SpreadsheetDialog.fn.apply.call(this);\n                    this.trigger('action', {\n                        command: 'EditValidationCommand',\n                        options: { value: this.viewModel.toValidationObject() }\n                    });\n                }\n            },\n            remove: function () {\n                this.viewModel.set('criterion', 'any');\n                this.apply();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('validation', ValidationDialog);\n        kendo.spreadsheet.dialogs.ValidationDialog = ValidationDialog;\n        var ExportAsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.exportAsDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this.viewModel = kendo.observable({\n                    title: this.options.title,\n                    name: this.options.name,\n                    extension: this.options.extension,\n                    fileFormats: this.options.fileFormats,\n                    excel: options.excelExport,\n                    pdf: {\n                        proxyURL: options.pdfExport.proxyURL,\n                        forceProxy: options.pdfExport.forceProxy,\n                        title: options.pdfExport.title,\n                        author: options.pdfExport.author,\n                        subject: options.pdfExport.subject,\n                        keywords: options.pdfExport.keywords,\n                        creator: options.pdfExport.creator,\n                        date: options.pdfExport.date,\n                        fitWidth: this.options.pdf.fitWidth,\n                        area: this.options.pdf.area,\n                        areas: this.options.pdf.areas,\n                        paperSize: this.options.pdf.paperSize,\n                        paperSizes: this.options.pdf.paperSizes,\n                        margin: this.options.pdf.margin,\n                        margins: this.options.pdf.margins,\n                        landscape: this.options.pdf.landscape,\n                        guidelines: this.options.pdf.guidelines,\n                        hCenter: this.options.pdf.hCenter,\n                        vCenter: this.options.pdf.vCenter\n                    },\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                var dialog = this.dialog();\n                this.viewModel.bind('change', function (e) {\n                    if (e.field === 'extension') {\n                        this.set('showPdfOptions', this.extension === '.pdf' ? true : false);\n                        dialog.center();\n                    }\n                });\n                kendo.bind(dialog.element, this.viewModel);\n            },\n            options: {\n                name: 'Workbook',\n                extension: '.xlsx',\n                fileFormats: [\n                    {\n                        description: 'Excel Workbook (.xlsx)',\n                        extension: '.xlsx'\n                    },\n                    {\n                        description: 'Portable Document Format(.pdf)',\n                        extension: '.pdf'\n                    }\n                ],\n                pdf: {\n                    fitWidth: true,\n                    area: 'workbook',\n                    areas: [\n                        {\n                            area: 'workbook',\n                            text: 'Entire Workbook'\n                        },\n                        {\n                            area: 'sheet',\n                            text: 'Active Sheet'\n                        },\n                        {\n                            area: 'selection',\n                            text: 'Selection'\n                        }\n                    ],\n                    paperSize: 'a4',\n                    paperSizes: [\n                        {\n                            value: 'a2',\n                            text: 'A2 (420 mm \\xD7 594 mm)     '\n                        },\n                        {\n                            value: 'a3',\n                            text: 'A3 (297 mm x 420 mm)     '\n                        },\n                        {\n                            value: 'a4',\n                            text: 'A4 (210 mm x 297 mm)     '\n                        },\n                        {\n                            value: 'a5',\n                            text: 'A5 (148 mm x 210 mm)     '\n                        },\n                        {\n                            value: 'b3',\n                            text: 'B3 (353 mm \\xD7 500 mm)     '\n                        },\n                        {\n                            value: 'b4',\n                            text: 'B4 (250 mm x 353 mm)     '\n                        },\n                        {\n                            value: 'b5',\n                            text: 'B5 (176 mm x 250 mm)     '\n                        },\n                        {\n                            value: 'folio',\n                            text: 'Folio (8.5\" x 13\")       '\n                        },\n                        {\n                            value: 'legal',\n                            text: 'Legal (8.5\" x 14\")       '\n                        },\n                        {\n                            value: 'letter',\n                            text: 'Letter (8.5\" x 11\")      '\n                        },\n                        {\n                            value: 'tabloid',\n                            text: 'Tabloid (11\" x 17\")      '\n                        },\n                        {\n                            value: 'executive',\n                            text: 'Executive (7.25\" x 10.5\")'\n                        }\n                    ],\n                    margin: {\n                        bottom: '0.75in',\n                        left: '0.7in',\n                        right: '0.7in',\n                        top: '0.75in'\n                    },\n                    margins: [\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.7in',\n                                right: '0.7in',\n                                top: '0.75in'\n                            },\n                            text: 'Normal'\n                        },\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.25in',\n                                right: '0.25in',\n                                top: '0.75in'\n                            },\n                            text: 'Narrow'\n                        },\n                        {\n                            value: {\n                                bottom: '1in',\n                                left: '1in',\n                                right: '1in',\n                                top: '1in'\n                            },\n                            text: 'Wide'\n                        }\n                    ],\n                    landscape: true,\n                    guidelines: true,\n                    hCenter: true,\n                    vCenter: true\n                },\n                width: 520,\n                template: '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.fileName #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-textbox\\' data-bind=\\'value: name\\' />' + '</div>' + '<div >' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.saveAsType #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'description\\' ' + 'data-value-field=\\'extension\\' ' + 'data-bind=\\'value: extension, source: fileFormats\\' />' + '</div>' + '</div>' + '<div class=\\'export-config\\' data-bind=\\'visible: showPdfOptions\\'>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.exportArea #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'area\\' ' + 'data-bind=\\'value: pdf.area, source: pdf.areas\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.paperSize#:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'value: pdf.paperSize, source: pdf.paperSizes\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.margins #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-value-primitive=\\'true\\'' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'value: pdf.margin, source: pdf.margins\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.orientation #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input type=\\'radio\\' id=\\'k-orientation-portrait\\' name=\\'orientation\\' data-type=\\'boolean\\' data-bind=\\'checked: pdf.landscape\\' value=\\'false\\' /><label class=\\'k-orientation-label k-orientation-portrait-label\\' for=\\'k-orientation-portrait\\'></label>' + '<input type=\\'radio\\' id=\\'k-orientation-landscape\\' name=\\'orientation\\' data-type=\\'boolean\\' data-bind=\\'checked: pdf.landscape\\' value=\\'true\\' /><label class=\\'k-orientation-label k-orientation-landscape-label\\' for=\\'k-orientation-landscape\\'></label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.print #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'guidelines\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.guidelines\\'/><label class=\\'k-checkbox-label\\' for=\\'guidelines\\'>#: messages.exportAsDialog.labels.guidelines#</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.scale #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'fitWidth\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.fitWidth\\'/><label class=\\'k-checkbox-label\\' for=\\'fitWidth\\'>#: messages.exportAsDialog.labels.fit #</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.center #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'hCenter\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.hCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'hCenter\\'>#: messages.exportAsDialog.labels.horizontally #</label>' + '<input class=\\'k-checkbox\\' id=\\'vCenter\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.vCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'vCenter\\'>#: messages.exportAsDialog.labels.vertically #</label>' + '</div>' + '<div class=\\'k-page-orientation\\' data-bind=\\'css: {k-page-landscape: pdf.landscape}\\'>' + '<div class=\\'k-margins-horizontal\\'></div>' + '<div class=\\'k-margins-vertical\\'></div>' + '</div>' + '</div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.save #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'SaveAsCommand',\n                    options: this.viewModel\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('exportAs', ExportAsDialog);\n        function basicErrorDialog(id, msg) {\n            kendo.spreadsheet.dialogs.register(id, MessageDialog.extend({ options: { messageId: msg } }));\n        }\n        basicErrorDialog('modifyMerged', 'modifyMergedDialog.errorMessage');\n        basicErrorDialog('rangeDisabled', 'rangeDisabledDialog.errorMessage');\n        basicErrorDialog('overflow', 'overflowDialog.errorMessage');\n        basicErrorDialog('unsupportedSelection', 'unsupportedSelectionDialog.errorMessage');\n        basicErrorDialog('incompatibleRanges', 'incompatibleRangesDialog.errorMessage');\n        basicErrorDialog('noFillDirection', 'noFillDirectionDialog.errorMessage');\n        basicErrorDialog('duplicateSheetName', 'duplicateSheetNameDialog.errorMessage');\n        var UseKeyboardDialog = MessageDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.useKeyboardDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n            },\n            options: { template: '#: messages.useKeyboardDialog.errorMessage #' + '<div>Ctrl+C #: messages.useKeyboardDialog.labels.forCopy #</div>' + '<div>Ctrl+X #: messages.useKeyboardDialog.labels.forCut #</div>' + '<div>Ctrl+V #: messages.useKeyboardDialog.labels.forPaste #</div>' + '<div class=\"k-action-buttons\">' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close\\'>' + '#= messages.okText #' + '</button>' + '</div>' }\n        });\n        kendo.spreadsheet.dialogs.register('useKeyboard', UseKeyboardDialog);\n        var HyperlinkDialog = SpreadsheetDialog.extend({\n            options: {\n                template: '<div class=\\'k-edit-label\\'><label>#: messages.linkDialog.labels.url #:</label></div>' + '<div class=\\'k-edit-field\\'><input class=\\'k-textbox\\' data-bind=\\'value: url\\' /></div>' + '<div class=\\'k-action-buttons\\'>' + ('<button style=\\'float: left\\' class=\\'k-button\\' data-bind=\\'click: remove\\'>#= messages.linkDialog.labels.removeLink #</button>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#= messages.okText #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: cancel\\'>#= messages.cancel #</button>') + '</div>',\n                title: MESSAGES.linkDialog.title,\n                autoFocus: false\n            },\n            open: function (range) {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    url: range.link(),\n                    apply: function () {\n                        if (!/\\S/.test(model.url)) {\n                            model.url = null;\n                        }\n                        self.trigger('action', {\n                            command: 'HyperlinkCommand',\n                            options: { link: model.url }\n                        });\n                        self.close();\n                    },\n                    remove: function () {\n                        model.url = null;\n                        model.apply();\n                    },\n                    cancel: self.close.bind(self)\n                });\n                kendo.bind(element, model);\n                element.find('input').focus().on('keydown', function (ev) {\n                    if (ev.keyCode == 13) {\n                        model.url = $(this).val();\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.apply();\n                    } else if (ev.keyCode == 27) {\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.cancel();\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('hyperlink', HyperlinkDialog);\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetbinder', [\n        'kendo.core',\n        'kendo.data',\n        'spreadsheet/sheet'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var identity = function (o) {\n            return o;\n        };\n        var SheetDataSourceBinder = kendo.Class.extend({\n            init: function (options) {\n                this.options = $.extend({}, this.options, options);\n                this.columns = this._normalizeColumns(this.options.columns);\n                this._sheet();\n                this._dataSource();\n                this._header();\n                this._boundRowsCount = 0;\n                this.dataSource.fetch();\n            },\n            _sheet: function () {\n                this.sheet = this.options.sheet;\n                this._sheetChangeHandler = this._sheetChange.bind(this);\n                this._sheetDeleteRowHandler = this._sheetDeleteRow.bind(this);\n                this._sheetInsertRowHandler = this._sheetInsertRow.bind(this);\n                this.sheet.bind('change', this._sheetChangeHandler).bind('deleteRow', this._sheetDeleteRowHandler).bind('insertRow', this._sheetInsertRowHandler);\n            },\n            _sheetInsertRow: function (e) {\n                if (e.index !== undefined) {\n                    this.dataSource.insert(Math.max(e.index - 1, 0), {});\n                }\n            },\n            _sheetDeleteRow: function (e) {\n                if (e.index !== undefined) {\n                    var dataSource = this.dataSource;\n                    var model = dataSource.view()[e.index - 1];\n                    if (model) {\n                        dataSource.remove(model);\n                    }\n                }\n            },\n            _header: function () {\n                this.sheet.batch(function () {\n                    this.columns.forEach(function (column, index) {\n                        this.sheet.range(0, index).value(column.title);\n                    }.bind(this));\n                }.bind(this));\n            },\n            _sheetChange: function (e) {\n                if (e.insertRow || e.deleteRow) {\n                    return;\n                }\n                if (e.recalc && e.ref) {\n                    var dataSource = this.dataSource;\n                    var data = dataSource.view();\n                    var columns = this.columns;\n                    var fields;\n                    if (dataSource.reader.model) {\n                        fields = dataSource.reader.model.fields;\n                    }\n                    if (!columns.length && data.length) {\n                        columns = Object.keys(data[0].toJSON());\n                    }\n                    var getters = columns.map(function (column) {\n                        var field = column.field;\n                        if (field && fields && fields[field] && fields[field].type == 'date') {\n                            return kendo.spreadsheet.numberToDate;\n                        }\n                        return identity;\n                    });\n                    this._skipRebind = true;\n                    var values = this.sheet.range(e.ref).values();\n                    e.ref.forEach(function (ref) {\n                        ref = ref.toRangeRef();\n                        var record;\n                        var valueIndex = 0;\n                        for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                            record = data[ri - 1];\n                            if (!record) {\n                                record = dataSource.insert(ri - 1, {});\n                                data = dataSource.view();\n                            }\n                            var colValueIndex = 0;\n                            for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col && ci < columns.length; ci++) {\n                                record.set(columns[ci].field, getters[ci](values[valueIndex][colValueIndex++]));\n                            }\n                            valueIndex++;\n                        }\n                    });\n                    this._boundRowsCount = dataSource.view().length;\n                    this._skipRebind = false;\n                }\n            },\n            _normalizeColumns: function (columns) {\n                return columns.map(function (column) {\n                    var field = column.field || column;\n                    return {\n                        field: field,\n                        title: column.title || field\n                    };\n                });\n            },\n            _dataSource: function () {\n                var options = this.options;\n                var dataSource = options.dataSource;\n                dataSource = Array.isArray(dataSource) ? { data: dataSource } : dataSource;\n                if (this.dataSource && this._changeHandler) {\n                    this.dataSource.unbind('change', this._changeHandler);\n                } else {\n                    this._changeHandler = this._change.bind(this);\n                }\n                this.dataSource = kendo.data.DataSource.create(dataSource).bind('change', this._changeHandler);\n            },\n            _change: function () {\n                if (this._skipRebind) {\n                    return;\n                }\n                var data = this.dataSource.view();\n                var columns = this.columns;\n                if (!columns.length && data.length) {\n                    this.columns = columns = this._normalizeColumns(Object.keys(data[0].toJSON()));\n                    this._header();\n                }\n                var getters = columns.map(function (column) {\n                    return kendo.getter(column.field);\n                });\n                this.sheet.batch(function () {\n                    var length = Math.max(data.length, this._boundRowsCount);\n                    for (var idx = 0; idx < length; idx++) {\n                        for (var getterIdx = 0; getterIdx < getters.length; getterIdx++) {\n                            var value = data[idx] ? getters[getterIdx](data[idx]) : null;\n                            this.sheet.range(idx + 1, getterIdx).value(value);\n                        }\n                    }\n                }.bind(this));\n                this._boundRowsCount = data.length;\n            },\n            destroy: function () {\n                this.dataSource.unbind('change', this._changeHandler);\n                this.sheet.unbind('change', this._sheetChangeHandler).unbind('deleteRow', this._sheetDeleteRowHandler).unbind('insertRow', this._sheetInsertRowHandler);\n            },\n            options: { columns: [] }\n        });\n        kendo.spreadsheet.SheetDataSourceBinder = SheetDataSourceBinder;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filtermenu', [\n        'kendo.core',\n        'kendo.popup',\n        'kendo.treeview',\n        'kendo.numerictextbox',\n        'kendo.datepicker',\n        'kendo.datetimepicker'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var classNames = {\n            details: 'k-details',\n            button: 'k-button',\n            detailsSummary: 'k-details-summary',\n            detailsContent: 'k-details-content',\n            icon: 'k-icon k-font-icon',\n            iconCollapse: 'k-i-collapse-se',\n            iconExpand: 'k-i-expand-e',\n            iconSearch: 'k-i-search',\n            textbox: 'k-textbox',\n            wrapper: 'k-spreadsheet-filter-menu',\n            filterByCondition: 'k-spreadsheet-condition-filter',\n            filterByValue: 'k-spreadsheet-value-filter',\n            valuesTreeViewWrapper: 'k-spreadsheet-value-treeview-wrapper',\n            actionButtons: 'k-action-buttons'\n        };\n        var Details = Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.details);\n                this._summary = this.element.find('.' + FilterMenu.classNames.detailsSummary).on('click', this._toggle.bind(this));\n                var iconClass = options.expanded ? FilterMenu.classNames.iconCollapse : FilterMenu.classNames.iconExpand;\n                this._icon = $('<span />', { 'class': FilterMenu.classNames.icon + ' ' + iconClass }).prependTo(this._summary);\n                this._container = kendo.wrap(this._summary.next(), true);\n                if (!options.expanded) {\n                    this._container.hide();\n                }\n            },\n            options: { name: 'Details' },\n            events: ['toggle'],\n            visible: function () {\n                return this.options.expanded;\n            },\n            toggle: function (show) {\n                var animation = kendo.fx(this._container).expand('vertical');\n                animation.stop()[show ? 'reverse' : 'play']();\n                this._icon.toggleClass(FilterMenu.classNames.iconExpand, show).toggleClass(FilterMenu.classNames.iconCollapse, !show);\n                this.options.expanded = !show;\n            },\n            _toggle: function () {\n                var show = this.visible();\n                this.toggle(show);\n                this.trigger('toggle', { show: show });\n            }\n        });\n        var FILTERMENU_MESSAGES = kendo.spreadsheet.messages.filterMenu = {\n            sortAscending: 'Sort range A to Z',\n            sortDescending: 'Sort range Z to A',\n            filterByValue: 'Filter by value',\n            filterByCondition: 'Filter by condition',\n            apply: 'Apply',\n            search: 'Search',\n            addToCurrent: 'Add to current selection',\n            clear: 'Clear',\n            blanks: '(Blanks)',\n            operatorNone: 'None',\n            and: 'AND',\n            or: 'OR',\n            operators: {\n                string: {\n                    contains: 'Text contains',\n                    doesnotcontain: 'Text does not contain',\n                    startswith: 'Text starts with',\n                    endswith: 'Text ends with'\n                },\n                date: {\n                    eq: 'Date is',\n                    neq: 'Date is not',\n                    lt: 'Date is before',\n                    gt: 'Date is after'\n                },\n                number: {\n                    eq: 'Is equal to',\n                    neq: 'Is not equal to',\n                    gte: 'Is greater than or equal to',\n                    gt: 'Is greater than',\n                    lte: 'Is less than or equal to',\n                    lt: 'Is less than'\n                }\n            }\n        };\n        kendo.data.binders.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (element, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, element, bindings, options);\n                this._change = $.proxy(this.change, this);\n                $(this.element).on('change', this._change);\n            },\n            refresh: function () {\n                var that = this, value = that.bindings.spreadsheetFilterValue.get();\n                $(that.element).val(value instanceof Date ? '' : value);\n            },\n            change: function () {\n                var value = this.element.value;\n                this.bindings.spreadsheetFilterValue.set(value);\n            }\n        });\n        kendo.data.binders.widget.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (widget, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, widget.element[0], bindings, options);\n                this.widget = widget;\n                this._change = $.proxy(this.change, this);\n                this.widget.first('change', this._change);\n            },\n            refresh: function () {\n                var binding = this.bindings.spreadsheetFilterValue, value = binding.get(), type = $(this.widget.element).data('filterType');\n                if (type === 'date' && value instanceof Date || type === 'number' && !isNaN(value)) {\n                    this.widget.value(value);\n                } else {\n                    this.widget.value(null);\n                }\n            },\n            change: function () {\n                var value = this.widget.value(), binding = this.bindings.spreadsheetFilterValue;\n                binding.set(value);\n            }\n        });\n        var templates = {\n            filterByValue: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByValue #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div class=\\'k-textbox k-space-right\\'>' + '<input placeholder=\\'#= messages.search #\\' data-#=ns#bind=\\'events: { input: filterValues }\\' />' + '<span class=\\'k-icon k-font-icon k-i-search\\' />' + '</div>' + '<div data-#=ns#bind=\\'visible: hasActiveSearch\\'><input class=\\'k-checkbox\\' type=\\'checkbox\\' data-#=ns#bind=\\'checked: appendToSearch\\' id=\\'_#=guid#\\' /><label class=\\'k-checkbox-label\\' for=\\'_#=guid#\\'>#= messages.addToCurrent #</label></div>' + '<div class=\\'' + classNames.valuesTreeViewWrapper + '\\'>' + '<div data-#=ns#role=\\'treeview\\' ' + 'data-#=ns#checkboxes=\\'{ checkChildren: true }\\' ' + 'data-#=ns#bind=\\'source: valuesDataSource, events: { check: valuesChange, select: valueSelect }\\' ' + '/>' + '</div>' + '</div>',\n            filterByCondition: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByCondition #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div>' + '<select ' + 'data-#=ns#role=\"dropdownlist\"' + 'data-#=ns#bind=\"value: operator, source: operators, events: { change: operatorChange } \"' + 'data-value-primitive=\"false\"' + 'data-option-label=\"#=messages.operatorNone#\"' + 'data-height=\"auto\"' + 'data-text-field=\"text\"' + 'data-value-field=\"unique\">' + '</select>' + '</div>' + '<div data-#=ns#bind=\"visible: isString\">' + '<input data-filter-type=\"string\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" class=\"k-textbox\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isNumber\">' + '<input data-filter-type=\"number\" data-#=ns#role=\"numerictextbox\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isDate\">' + '<input data-filter-type=\"date\" data-#=ns#role=\"datepicker\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '</div>',\n            menuItem: '<li data-command=\\'#=command#\\' data-dir=\\'#=dir#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>#=text#' + '</li>',\n            actionButtons: '<button data-#=ns#bind=\\'click: apply\\' class=\\'k-button k-primary\\'>#=messages.apply#</button>' + '<button data-#=ns#bind=\\'click: clear\\' class=\\'k-button\\'>#=messages.clear#</button>'\n        };\n        function distinctValues(values) {\n            var hash = {};\n            var result = [];\n            for (var i = 0; i < values.length; i++) {\n                if (!hash[values[i].value]) {\n                    hash[values[i].value] = values[i];\n                    result.push(values[i]);\n                } else if (!hash[values[i].value].checked && values[i].checked) {\n                    hash[values[i].value].checked = true;\n                }\n            }\n            return result;\n        }\n        function filter(dataSource, query) {\n            var hasVisibleChildren = false;\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                var text = item.text.toString().toLowerCase();\n                var itemVisible = query === true || query === '' || text.indexOf(query) >= 0;\n                var anyVisibleChildren = filter(item.children, itemVisible || query);\n                hasVisibleChildren = hasVisibleChildren || anyVisibleChildren || itemVisible;\n                item.hidden = !itemVisible && !anyVisibleChildren;\n                item.checked = !item.hidden;\n            }\n            if (data) {\n                dataSource.filter({\n                    field: 'hidden',\n                    operator: 'neq',\n                    value: true\n                });\n            }\n            return hasVisibleChildren;\n        }\n        function uncheckAll(dataSource) {\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                item.checked = false;\n                if (item.hasChildren) {\n                    uncheckAll(item.children);\n                }\n            }\n        }\n        var FilterMenuViewModel = kendo.spreadsheet.FilterMenuViewModel = kendo.data.ObservableObject.extend({\n            valuesChange: function (e) {\n                var dataSource = e ? e.sender.dataSource : this.valuesDataSource;\n                var checked = function (item) {\n                    return item.checked;\n                };\n                var value = function (item) {\n                    return item.dataType === 'date' ? kendo.spreadsheet.dateToNumber(item.value) : item.value;\n                };\n                var unique = function (value, index, array) {\n                    return array.lastIndexOf(value) === index;\n                };\n                var data = dataSource.data();\n                var values = data[0].children.data().toJSON();\n                var blanks = values.filter(function (item) {\n                    return item.dataType === 'blank';\n                });\n                blanks = blanks.length ? blanks[0].checked : false;\n                values = values.filter(checked).map(value);\n                if (this.appendToSearch && this.valueFilter && this.valueFilter.values.length) {\n                    values = values.concat(this.valueFilter.values.toJSON()).sort().filter(unique);\n                }\n                this.set('valueFilter', {\n                    values: values,\n                    blanks: blanks\n                });\n            },\n            valueSelect: function (e) {\n                e.preventDefault();\n                var node = e.sender.dataItem(e.node);\n                node.set('checked', !node.checked);\n            },\n            hasActiveSearch: false,\n            appendToSearch: false,\n            filterValues: function (e) {\n                var query = typeof e == 'string' ? e : $(e.target).val().toLowerCase();\n                var dataSource = this.valuesDataSource;\n                this.set('hasActiveSearch', !!query);\n                uncheckAll(dataSource);\n                filter(dataSource, query);\n            },\n            reset: function () {\n                this.set('customFilter', {\n                    logic: 'and',\n                    criteria: [{\n                            operator: null,\n                            value: null\n                        }]\n                });\n                this.set('valueFilter', { values: [] });\n            },\n            operatorChange: function (e) {\n                var dataItem = e.sender.dataItem();\n                this.set('operatorType', dataItem.type);\n                this.set('customFilter.criteria[0].operator', dataItem.value);\n            },\n            isNone: function () {\n                return this.get('operatorType') === undefined;\n            },\n            isString: function () {\n                return this.get('operatorType') === 'string';\n            },\n            isNumber: function () {\n                return this.get('operatorType') === 'number';\n            },\n            isDate: function () {\n                return this.get('operatorType') === 'date';\n            }\n        });\n        function flattenOperators(operators) {\n            var messages = FILTERMENU_MESSAGES.operators;\n            var result = [];\n            for (var type in operators) {\n                if (!operators.hasOwnProperty(type)) {\n                    continue;\n                }\n                for (var operator in operators[type]) {\n                    if (!operators[type].hasOwnProperty(operator)) {\n                        continue;\n                    }\n                    result.push({\n                        text: messages[type][operator],\n                        value: operator,\n                        unique: type + '_' + operator,\n                        type: type\n                    });\n                }\n            }\n            return result;\n        }\n        var FilterMenuController = kendo.spreadsheet.FilterMenuController = {\n            valuesTree: function (range, column) {\n                return [{\n                        text: 'All',\n                        expanded: true,\n                        checked: true,\n                        items: this.values(range.resize({ top: 1 }), column)\n                    }];\n            },\n            values: function (range, column) {\n                var values = [];\n                var messages = FILTERMENU_MESSAGES;\n                var columnRange = range.column(column);\n                var sheet = range.sheet();\n                columnRange.forEachCell(function (row, col, cell) {\n                    if (sheet.isHiddenRow(row)) {\n                        return;\n                    }\n                    var value = cell.value;\n                    var dataType = cell.dataType;\n                    var text = cell.text;\n                    if (value === undefined) {\n                        dataType = 'blank';\n                    } else if (cell.format) {\n                        dataType = kendo.spreadsheet.formatting.type(value, cell.format);\n                    } else {\n                        dataType = typeof value;\n                    }\n                    if (value !== null && cell.format) {\n                        text = kendo.spreadsheet.formatting.text(value, cell.format);\n                    } else {\n                        text = dataType == 'blank' ? messages.blanks : value;\n                    }\n                    if (dataType === 'percent') {\n                        dataType = 'number';\n                    }\n                    if (dataType === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                    values.push({\n                        dataType: dataType,\n                        value: value,\n                        text: text,\n                        checked: true\n                    });\n                });\n                values = distinctValues(values);\n                values.sort(function (a, b) {\n                    if (a.dataType === b.dataType) {\n                        return 0;\n                    }\n                    if (a.dataType === 'blank' || b.dataType === 'blank') {\n                        return a.dataType === 'blank' ? -1 : 1;\n                    }\n                    if (a.dataType === 'number' || b.dataType === 'number') {\n                        return a.dataType === 'number' ? -1 : 1;\n                    }\n                    if (a.dataType === 'date' || b.dataType === 'date') {\n                        return a.dataType === 'date' ? -1 : 1;\n                    }\n                    return 0;\n                });\n                return values;\n            },\n            filterType: function (range, column) {\n                var sheet = range.sheet();\n                var filter = this.filterForColumn(column, sheet);\n                var type;\n                filter = filter && filter.filter.toJSON();\n                if (filter && filter.filter == 'custom') {\n                    var value = filter.criteria[0].value;\n                    if (value instanceof Date) {\n                        type = 'date';\n                    } else if (typeof value == 'string') {\n                        type = 'string';\n                    } else if (typeof value == 'number') {\n                        type = 'number';\n                    }\n                }\n                if (!type) {\n                    var topValue = this.values(range.row(1), column)[0];\n                    type = topValue && topValue.dataType;\n                    if (type == 'blank') {\n                        type = null;\n                    }\n                }\n                return type;\n            },\n            filterForColumn: function (column, sheet) {\n                var allFilters = sheet.filter();\n                var filters;\n                if (allFilters) {\n                    filters = allFilters.columns.filter(function (item) {\n                        return item.index === column;\n                    })[0];\n                }\n                return filters;\n            },\n            filter: function (column, sheet) {\n                var columnFilters = this.filterForColumn(column, sheet);\n                if (!columnFilters) {\n                    return;\n                }\n                var options = columnFilters.filter.toJSON();\n                var type = options.filter;\n                delete options.filter;\n                var result = {\n                    type: type,\n                    options: options\n                };\n                var criteria = options.criteria;\n                if (criteria && criteria.length) {\n                    result.operator = criteria[0].operator;\n                }\n                return result;\n            }\n        };\n        var FilterMenu = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.wrapper);\n                this.viewModel = new FilterMenuViewModel({\n                    active: 'value',\n                    operator: null,\n                    operators: flattenOperators(this.options.operators),\n                    clear: this.clear.bind(this),\n                    apply: this.apply.bind(this)\n                });\n                this._filterInit();\n                this._popup();\n                this._sort();\n                this._filterByCondition();\n                this._filterByValue();\n                this._actionButtons();\n            },\n            options: {\n                name: 'FilterMenu',\n                column: 0,\n                range: null,\n                operators: {\n                    string: {\n                        contains: 'Text contains',\n                        doesnotcontain: 'Text does not contain',\n                        startswith: 'Text starts with',\n                        endswith: 'Text ends with'\n                    },\n                    date: {\n                        eq: 'Date is',\n                        neq: 'Date is not',\n                        lt: 'Date is before',\n                        gt: 'Date is after'\n                    },\n                    number: {\n                        eq: 'Is equal to',\n                        neq: 'Is not equal to',\n                        gte: 'Is greater than or equal to',\n                        gt: 'Is greater than',\n                        lte: 'Is less than or equal to',\n                        lt: 'Is less than'\n                    }\n                }\n            },\n            events: ['action'],\n            destroy: function () {\n                Widget.fn.destroy.call(this);\n                this.menu.destroy();\n                this.valuesTreeView.destroy();\n                this.popup.destroy();\n            },\n            openFor: function (anchor) {\n                this.popup.setOptions({ anchor: anchor });\n                this.popup.open();\n            },\n            close: function () {\n                this.popup.close();\n            },\n            clear: function () {\n                this.action({\n                    command: 'ClearFilterCommand',\n                    options: { column: this.options.column }\n                });\n                this.viewModel.reset();\n                this.close();\n            },\n            apply: function () {\n                this._active();\n                var options = {\n                    operatingRange: this.options.range,\n                    column: this.options.column\n                };\n                var valueFilter;\n                var customFilter;\n                if (this.viewModel.active === 'value') {\n                    this.viewModel.valuesChange({ sender: this.valuesTreeView });\n                    valueFilter = this.viewModel.valueFilter.toJSON();\n                    if (valueFilter.blanks || valueFilter.values && valueFilter.values.length) {\n                        options.valueFilter = valueFilter;\n                    }\n                } else if (this.viewModel.active === 'custom') {\n                    customFilter = this.viewModel.customFilter.toJSON();\n                    if (customFilter.criteria.length && customFilter.criteria[0].value !== null) {\n                        options.customFilter = customFilter;\n                    }\n                }\n                if (options.valueFilter || options.customFilter) {\n                    this.action({\n                        command: 'ApplyFilterCommand',\n                        options: options\n                    });\n                }\n            },\n            action: function (options) {\n                this.trigger('action', $.extend({}, options));\n            },\n            _filterInit: function () {\n                var column = this.options.column;\n                var range = this.options.range;\n                var sheet = range.sheet();\n                var activeFilter = FilterMenuController.filter(column, sheet);\n                if (activeFilter) {\n                    var filterType = FilterMenuController.filterType(range, column);\n                    this.viewModel.set('active', activeFilter.type);\n                    this.viewModel.set(activeFilter.type + 'Filter', activeFilter.options);\n                    if (activeFilter.type == 'custom') {\n                        this.viewModel.set('operator', filterType + '_' + activeFilter.operator);\n                        this.viewModel.set('operatorType', filterType);\n                    }\n                } else {\n                    this.viewModel.reset();\n                }\n            },\n            _popup: function () {\n                this.popup = this.element.kendoPopup({ copyAnchorStyles: false }).data('kendoPopup');\n            },\n            _sort: function () {\n                var template = kendo.template(FilterMenu.templates.menuItem);\n                var messages = FILTERMENU_MESSAGES;\n                var items = [\n                    {\n                        command: 'sort',\n                        dir: 'asc',\n                        text: messages.sortAscending,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        command: 'sort',\n                        dir: 'desc',\n                        text: messages.sortDescending,\n                        iconClass: 'sort-desc'\n                    }\n                ];\n                var ul = $('<ul />', { 'html': kendo.render(template, items) }).appendTo(this.element);\n                this.menu = ul.kendoMenu({\n                    orientation: 'vertical',\n                    select: function (e) {\n                        var dir = $(e.item).data('dir');\n                        var range = this.options.range.resize({ top: 1 });\n                        var options = {\n                            value: dir,\n                            sheet: false,\n                            operatingRange: range,\n                            column: this.options.column\n                        };\n                        if (range.isSortable()) {\n                            this.action({\n                                command: 'SortCommand',\n                                options: options\n                            });\n                        } else {\n                            this.close();\n                        }\n                    }.bind(this)\n                }).data('kendoMenu');\n            },\n            _appendTemplate: function (template, className, details, expanded) {\n                var compiledTemplate = kendo.template(template);\n                var wrapper = $('<div class=\\'' + className + '\\'/>').html(compiledTemplate({\n                    messages: FILTERMENU_MESSAGES,\n                    guid: kendo.guid(),\n                    ns: kendo.ns\n                }));\n                this.element.append(wrapper);\n                if (details) {\n                    details = new Details(wrapper, {\n                        expanded: expanded,\n                        toggle: this._detailToggle.bind(this)\n                    });\n                }\n                kendo.bind(wrapper, this.viewModel);\n                return wrapper;\n            },\n            _detailToggle: function (e) {\n                this.element.find('[data-role=details]').not(e.sender.element).data('kendoDetails').toggle(!e.show);\n            },\n            _filterByCondition: function () {\n                var isExpanded = this.viewModel.active === 'custom';\n                this._appendTemplate(FilterMenu.templates.filterByCondition, FilterMenu.classNames.filterByCondition, true, isExpanded);\n            },\n            _filterByValue: function () {\n                var isExpanded = this.viewModel.active === 'value';\n                var wrapper = this._appendTemplate(FilterMenu.templates.filterByValue, FilterMenu.classNames.filterByValue, true, isExpanded);\n                this.valuesTreeView = wrapper.find('[data-role=treeview]').data('kendoTreeView');\n                var values = FilterMenuController.valuesTree(this.options.range, this.options.column);\n                this.viewModel.set('valuesDataSource', new kendo.data.HierarchicalDataSource({ data: values }));\n            },\n            _actionButtons: function () {\n                this._appendTemplate(FilterMenu.templates.actionButtons, FilterMenu.classNames.actionButtons, false);\n            },\n            _active: function () {\n                var activeContainer = this.element.find('[data-role=details]').filter(function (index, element) {\n                    return $(element).data('kendoDetails').visible();\n                });\n                if (activeContainer.hasClass(FilterMenu.classNames.filterByValue)) {\n                    this.viewModel.set('active', 'value');\n                } else if (activeContainer.hasClass(FilterMenu.classNames.filterByCondition)) {\n                    this.viewModel.set('active', 'custom');\n                }\n            }\n        });\n        kendo.spreadsheet.FilterMenu = FilterMenu;\n        $.extend(true, FilterMenu, {\n            classNames: classNames,\n            templates: templates\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/editor', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var SheetEditor = kendo.Observable.extend({\n            init: function (view) {\n                kendo.Observable.fn.init.call(this);\n                this.view = view;\n                this.formulaBar = view.formulaBar;\n                this._active = false;\n                this.barInput = view.formulaBar.formulaInput;\n                this.cellInput = view.formulaInput;\n                this.barInput.syncWith(this.cellInput);\n                this.cellInput.syncWith(this.barInput);\n                this.barInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.cellInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.barInput.bind('focus', this._focus.bind(this));\n                this.cellInput.bind('focus', this._focus.bind(this));\n                this.barInput.bind('blur', this._blur.bind(this));\n                this.cellInput.bind('blur', this._blur.bind(this));\n            },\n            events: [\n                'activate',\n                'deactivate',\n                'change',\n                'update'\n            ],\n            _focus: function (e) {\n                this.lastActive = e.sender == this.barInput ? 'bar' : 'cell';\n            },\n            _blur: function () {\n            },\n            _triggerUpdate: function () {\n                this.trigger('update', { value: this.value() });\n            },\n            activeEditor: function () {\n                var editor = null;\n                var activeElement = kendo._activeElement();\n                if (this.barElement()[0] === activeElement) {\n                    editor = this.barInput;\n                } else if (this.cellElement()[0] === activeElement) {\n                    editor = this.cellInput;\n                }\n                return editor;\n            },\n            activate: function (options) {\n                this._active = true;\n                this._rect = options.rect;\n                this.cellInput.position(options.rect);\n                this.cellInput.resize(options.rect);\n                this.cellInput.tooltip(options.tooltip);\n                this.cellInput.activeCell = this.barInput.activeCell = options.range.topLeft;\n                this.trigger('activate');\n                return this;\n            },\n            deactivate: function () {\n                var cellInput = this.cellInput;\n                if (!this._active) {\n                    return;\n                }\n                if (cellInput.value() != this._value) {\n                    if (this.trigger('change', { value: cellInput.value() })) {\n                        return;\n                    }\n                }\n                this._active = false;\n                this._rect = null;\n                cellInput.hide();\n                this.trigger('deactivate');\n            },\n            enable: function (enable) {\n                this.barInput.enable(enable);\n                this.cellInput.enable(enable);\n            },\n            enableEditing: function (enable) {\n                this.barInput.enableEditing(enable);\n                this.cellInput.enableEditing(enable);\n            },\n            barElement: function () {\n                return this.barInput.element;\n            },\n            cellElement: function () {\n                return this.cellInput.element;\n            },\n            focusLastActive: function () {\n                this.focus(this.lastActive);\n            },\n            focus: function (inputType) {\n                inputType = inputType || 'cell';\n                if (inputType === 'cell') {\n                    this.cellInput.element.focus();\n                    this.cellInput.end();\n                } else {\n                    this.barInput.element.focus();\n                }\n            },\n            isActive: function () {\n                return this._active;\n            },\n            isFiltered: function () {\n                return this.barInput.popup.visible() || this.cellInput.popup.visible();\n            },\n            canInsertRef: function (isKeyboardAction) {\n                var editor = this.activeEditor();\n                return editor && editor.canInsertRef(isKeyboardAction);\n            },\n            highlightedRefs: function () {\n                var editor = this.activeEditor();\n                var refs = [];\n                if (editor) {\n                    refs = editor.highlightedRefs();\n                }\n                return refs;\n            },\n            scale: function () {\n                this.cellInput.scale();\n            },\n            toggleTooltip: function (rect) {\n                this.cellInput.toggleTooltip(notEqual(this._rect, rect));\n            },\n            value: function (value) {\n                if (value === undefined) {\n                    return this.barInput.value();\n                }\n                if (value === null) {\n                    value = '';\n                }\n                this._value = value;\n                this.barInput.value(value);\n                this.cellInput.value(value);\n            },\n            insertNewline: function () {\n                this.activeEditor().insertNewline();\n                this.scale();\n            }\n        });\n        function notEqual(oldRect, newRect) {\n            return oldRect && (oldRect.top !== newRect.top || oldRect.left !== newRect.left);\n        }\n        kendo.spreadsheet.SheetEditor = SheetEditor;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofill', [\n        'spreadsheet/runtime',\n        'spreadsheet/range'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var Range = spreadsheet.Range;\n    var runtime = spreadsheet.calc.runtime;\n    var Formula = runtime.Formula;\n    var ERR_INCOMPATIBLE = 'incompatibleRanges';\n    var ERR_NO_DIRECTION = 'noFillDirection';\n    var FillError = Range.FillError = function (msg) {\n        this.code = msg;\n    };\n    Range.prototype._previewFillFrom = function (srcRange, direction) {\n        var destRange = this, sheet = destRange._sheet;\n        if (typeof srcRange == 'string') {\n            srcRange = sheet.range(srcRange);\n        }\n        var src = srcRange._ref.toRangeRef();\n        var dest = destRange._ref.toRangeRef();\n        if (src.intersects(dest)) {\n            if (src.eq(dest)) {\n                return null;\n            }\n            dest = dest.clone();\n            if (src.topLeft.eq(dest.topLeft)) {\n                if (src.width() == dest.width()) {\n                    dest.topLeft.row += src.height();\n                    direction = 0;\n                } else if (src.height() == dest.height()) {\n                    dest.topLeft.col += src.width();\n                    direction = 1;\n                } else {\n                    throw new FillError(ERR_INCOMPATIBLE);\n                }\n            } else if (src.bottomRight.eq(dest.bottomRight)) {\n                if (src.width() == dest.width()) {\n                    dest.bottomRight.row -= src.height();\n                    direction = 2;\n                } else if (src.height() == dest.height()) {\n                    dest.bottomRight.col -= src.width();\n                    direction = 3;\n                } else {\n                    throw new FillError(ERR_INCOMPATIBLE);\n                }\n            } else {\n                throw new FillError(ERR_INCOMPATIBLE);\n            }\n            return sheet.range(dest)._previewFillFrom(srcRange, direction);\n        }\n        if (direction == null) {\n            if (src.topLeft.col == dest.topLeft.col) {\n                direction = src.topLeft.row < dest.topLeft.row ? 0 : 2;\n            } else if (src.topLeft.row == dest.topLeft.row) {\n                direction = src.topLeft.col < dest.topLeft.col ? 1 : 3;\n            } else {\n                throw new FillError(ERR_NO_DIRECTION);\n            }\n        }\n        var horizontal = direction & 1;\n        var descending = direction & 2;\n        if (horizontal && src.height() != dest.height() || !horizontal && src.width() != dest.width()) {\n            throw new FillError(ERR_INCOMPATIBLE);\n        }\n        var data = srcRange._properties(), n;\n        if (!horizontal) {\n            data = transpose(data);\n            n = dest.height();\n        } else {\n            n = dest.width();\n        }\n        var fill = new Array(data.length);\n        for (var i = 0; i < data.length; ++i) {\n            var s = data[i];\n            var f = findSeries(s);\n            var a = fill[i] = new Array(n);\n            for (var j = 0; j < n; ++j) {\n                var idx = descending ? -j - 1 : s.length + j;\n                var srcIdx = descending ? s.length - j % s.length - 1 : j % s.length;\n                a[descending ? n - j - 1 : j] = f(idx, srcIdx);\n            }\n        }\n        if (!horizontal) {\n            fill = transpose(fill);\n        }\n        return {\n            props: fill,\n            direction: direction,\n            dest: destRange\n        };\n    };\n    Range.prototype.fillFrom = function (srcRange, direction) {\n        var x = this._previewFillFrom(srcRange, direction);\n        x.dest._properties(x.props);\n        return x.dest;\n    };\n    function linearRegression(data) {\n        var N = data.length;\n        var mx = (N + 1) / 2, my = data.reduce(function (a, b) {\n                return a + b;\n            }, 0) / N;\n        var s1 = 0, s2 = 0;\n        for (var i = 0; i < N; i++) {\n            var t1 = i + 1 - mx, t2 = data[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (!s2) {\n            return function (N) {\n                return data[N % data.length];\n            };\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return function (N) {\n            return a + b * (N + 1);\n        };\n    }\n    function findSeries(properties) {\n        function findStep(a) {\n            var diff = a[1] - a[0];\n            for (var i = 2; i < a.length; ++i) {\n                if (a[i] - a[i - 1] != diff) {\n                    return null;\n                }\n            }\n            return diff;\n        }\n        function getData(a) {\n            return a.map(function (v) {\n                return v.number;\n            });\n        }\n        var series = [];\n        var data = properties.map(function (x) {\n            return x.formula || x.value;\n        });\n        forEachSeries(data, function (begin, end, type, a) {\n            var f, values;\n            if (type == 'number') {\n                values = getData(a);\n                if (values.length == 1 && (begin > 0 || end < data.length || formatType(values[0], properties[begin].format) == 'date')) {\n                    values.push(values[0] + 1);\n                }\n                f = linearRegression(values);\n            } else if (type == 'string' || type == 'formula' || type == 'boolean') {\n                f = function (N, i) {\n                    return data[i];\n                };\n            } else if (Array.isArray(type)) {\n                if (a.length == 1) {\n                    f = function (N) {\n                        return type[(a[0].number + N) % type.length];\n                    };\n                } else {\n                    var diff = findStep(getData(a));\n                    if (diff == null) {\n                        f = function (N) {\n                            return a[N % a.length].value;\n                        };\n                    } else {\n                        f = function (N) {\n                            var idx = a[0].number + diff * N;\n                            return type[idx % type.length];\n                        };\n                    }\n                }\n            } else if (type != 'null') {\n                values = getData(a);\n                if (values.length == 1) {\n                    values.push(values[0] + 1);\n                }\n                values = linearRegression(values);\n                f = function (N, i) {\n                    return data[i].replace(/^(.*\\D)\\d+/, '$1' + values(N, i));\n                };\n            } else {\n                f = function () {\n                    return null;\n                };\n            }\n            var s = {\n                f: f,\n                begin: begin,\n                end: end,\n                len: end - begin\n            };\n            for (var i = begin; i < end; ++i) {\n                series[i] = s;\n            }\n        });\n        return function (N, i) {\n            var s = series[i];\n            var q = N / data.length | 0;\n            var r = N % data.length;\n            var n = q * s.len + r - s.begin;\n            var value = s.f(n, i);\n            var props = clone(properties[i]);\n            delete props.enable;\n            if (value instanceof Formula) {\n                props.formula = value;\n            } else {\n                props.value = value;\n            }\n            return props;\n        };\n    }\n    function formatType(value, format) {\n        if (format != null) {\n            return spreadsheet.formatting.type(value, format);\n        }\n    }\n    function clone(obj) {\n        var copy = {};\n        Object.keys(obj || {}).forEach(function (key) {\n            copy[key] = obj[key];\n        });\n        return copy;\n    }\n    function forEachSeries(data, f) {\n        var prev = null, start = 0, a = [], type;\n        for (var i = 0; i < data.length; ++i) {\n            type = getType(data[i]);\n            a.push(type);\n            if (prev != null && type.type !== prev.type) {\n                f(start, i, prev.type, a.slice(start, i));\n                start = i;\n            }\n            prev = type;\n        }\n        f(start, i, prev.type, a.slice(start, i));\n    }\n    function getType(el) {\n        if (typeof el == 'number') {\n            return {\n                type: 'number',\n                number: el\n            };\n        }\n        if (typeof el == 'string') {\n            var lst = findStringList(el);\n            if (lst) {\n                return lst;\n            }\n            var m = /^(.*\\D)(\\d+)/.exec(el);\n            if (m) {\n                el = el.replace(/^(.*\\D)\\d+/, '$1-######');\n                return {\n                    type: el,\n                    match: m,\n                    number: parseFloat(m[2])\n                };\n            }\n            return { type: 'string' };\n        }\n        if (typeof el == 'boolean') {\n            return { type: 'boolean' };\n        }\n        if (el == null) {\n            return { type: 'null' };\n        }\n        if (el instanceof Formula) {\n            return { type: 'formula' };\n        }\n        window.console.error(el);\n        throw new Error('Cannot fill data');\n    }\n    function stringLists() {\n        var culture = kendo.culture();\n        return [\n            culture.calendars.standard.days.namesAbbr,\n            culture.calendars.standard.days.names,\n            culture.calendars.standard.months.namesAbbr,\n            culture.calendars.standard.months.names\n        ];\n    }\n    function findStringList(str) {\n        var strl = str.toLowerCase();\n        var lists = stringLists();\n        for (var i = 0; i < lists.length; ++i) {\n            var a = lists[i];\n            for (var j = a.length; --j >= 0;) {\n                var el = a[j].toLowerCase();\n                if (el == strl) {\n                    return {\n                        type: a,\n                        number: j,\n                        value: str\n                    };\n                }\n            }\n        }\n    }\n    function transpose(a) {\n        var height = a.length, width = a[0].length;\n        var t = [];\n        for (var i = 0; i < width; ++i) {\n            t[i] = [];\n            for (var j = 0; j < height; ++j) {\n                t[i][j] = a[j][i];\n            }\n        }\n        return t;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/nameeditor', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CLASS_NAMES = {\n            input: 'k-spreadsheet-name-editor',\n            list: 'k-spreadsheet-name-list'\n        };\n        var NameEditor = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                element.addClass(CLASS_NAMES.input);\n                var dataSource = new kendo.data.DataSource({\n                    transport: {\n                        read: function (options) {\n                            var data = [];\n                            this._workbook.forEachName(function (def) {\n                                if (!def.hidden && def.value instanceof kendo.spreadsheet.Ref) {\n                                    data.push({ name: def.name });\n                                }\n                            });\n                            options.success(data);\n                        }.bind(this),\n                        cache: false\n                    }\n                });\n                this.combo = $('<input />').appendTo(element).kendoComboBox({\n                    clearButton: false,\n                    dataTextField: 'name',\n                    dataValueField: 'name',\n                    template: '#:data.name#<a class=\\'k-button-delete\\' href=\\'\\\\#\\'><span class=\\'k-icon k-i-close\\'></span></a>',\n                    dataSource: dataSource,\n                    autoBind: false,\n                    ignoreCase: true,\n                    change: this._on_listChange.bind(this),\n                    noDataTemplate: '<div></div>',\n                    open: function () {\n                        dataSource.read();\n                    }\n                }).getKendoComboBox();\n                this.combo.input.on('keydown', this._on_keyDown.bind(this)).on('focus', this._on_focus.bind(this));\n                this.combo.popup.element.addClass('k-spreadsheet-names-popup').on('mousemove', function (ev) {\n                    ev.stopPropagation();\n                }).on('click', '.k-button-delete', function (ev) {\n                    ev.preventDefault();\n                    ev.stopPropagation();\n                    var item = $(ev.target).closest('.k-item');\n                    item = this.combo.dataItem(item);\n                    this._deleteItem(item.name);\n                }.bind(this));\n            },\n            value: function (val) {\n                if (val === undefined) {\n                    return this.combo.value();\n                } else {\n                    this.combo.value(val);\n                }\n            },\n            _deleteItem: function (name) {\n                this.trigger('delete', { name: name });\n            },\n            _on_keyDown: function (ev) {\n                switch (ev.keyCode) {\n                case 27:\n                    this.combo.value(this._prevValue);\n                    this.trigger('cancel');\n                    break;\n                case 13:\n                    this.trigger('enter');\n                    break;\n                }\n            },\n            _on_focus: function () {\n                this._prevValue = this.combo.value();\n            },\n            _on_listChange: function () {\n                var name = this.combo.value();\n                if (name) {\n                    this.trigger('select', { name: name });\n                }\n            }\n        });\n        kendo.spreadsheet.NameEditor = NameEditor;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/print', [\n        'kendo.pdf',\n        'spreadsheet/sheet',\n        'spreadsheet/range',\n        'spreadsheet/references',\n        'spreadsheet/numformat',\n        'util/text-metrics'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var drawing = kendo.drawing;\n    var formatting = spreadsheet.formatting;\n    var geo = kendo.geometry;\n    var GUIDELINE_WIDTH = 0.8;\n    function distributeCoords(heights, pageHeight) {\n        var curr = 0;\n        var out = [];\n        var threshold = 0.2 * pageHeight;\n        var bottom = pageHeight;\n        heights.forEach(function (h) {\n            if (pageHeight && curr + h > bottom) {\n                if (bottom - curr < threshold) {\n                    curr = pageHeight * Math.ceil(curr / pageHeight);\n                }\n                bottom += pageHeight * Math.ceil(h / pageHeight);\n            }\n            out.push(curr);\n            curr += h;\n        });\n        out.push(curr);\n        return out;\n    }\n    function getMergedCells(sheet, range) {\n        var grid = sheet._grid;\n        var primary = {};\n        var secondary = {};\n        sheet.forEachMergedCell(range, function (ref) {\n            var topLeft = ref.topLeft;\n            grid.forEach(ref, function (cellRef) {\n                if (topLeft.eq(cellRef)) {\n                    primary[cellRef.print()] = ref;\n                } else if (range.contains(cellRef)) {\n                    secondary[cellRef.print()] = topLeft;\n                }\n            });\n        });\n        return {\n            primary: primary,\n            secondary: secondary\n        };\n    }\n    function doLayout(sheet, range, options) {\n        var cells = [];\n        var rowHeights = [];\n        var colWidths = [];\n        var mergedCells = getMergedCells(sheet, range);\n        var maxRow = -1, maxCol = -1;\n        sheet.forEach(range, function (row, col, cell) {\n            var relrow = row - range.topLeft.row;\n            var relcol = col - range.topLeft.col;\n            var rh = sheet.rowHeight(row);\n            var cw = sheet.columnWidth(col);\n            if (!relcol) {\n                rowHeights.push(rh);\n            }\n            if (!relrow) {\n                colWidths.push(cw);\n            }\n            if (sheet.isHiddenColumn(col) || sheet.isHiddenRow(row) || !rh || !cw) {\n                return;\n            }\n            var nonEmpty = options.forScreen || shouldDrawCell(cell);\n            if (!(options.emptyCells || nonEmpty)) {\n                return;\n            }\n            var id = new CellRef(row, col).print();\n            if (mergedCells.secondary[id]) {\n                return;\n            }\n            if (nonEmpty) {\n                maxRow = Math.max(maxRow, relrow);\n                maxCol = Math.max(maxCol, relcol);\n            } else {\n                cell.empty = true;\n            }\n            var m = mergedCells.primary[id];\n            if (m) {\n                delete mergedCells.primary[id];\n                cell.merged = true;\n                cell.rowspan = m.height();\n                cell.colspan = m.width();\n                if (options.forScreen) {\n                    cell.width = sheet._columns.sum(m.topLeft.col, m.bottomRight.col);\n                    cell.height = sheet._rows.sum(m.topLeft.row, m.bottomRight.row);\n                }\n            } else {\n                cell.rowspan = 1;\n                cell.colspan = 1;\n            }\n            cell.row = relrow;\n            cell.col = relcol;\n            cells.push(cell);\n        });\n        rowHeights = rowHeights.slice(0, maxRow + 1);\n        colWidths = colWidths.slice(0, maxCol + 1);\n        var pageWidth = options.pageWidth;\n        var pageHeight = options.pageHeight;\n        var scaleFactor = 1;\n        if (options.fitWidth) {\n            var width = colWidths.reduce(sum, 0);\n            if (width > pageWidth) {\n                scaleFactor = pageWidth / width;\n                pageWidth /= scaleFactor;\n                pageHeight /= scaleFactor;\n            }\n        }\n        var yCoords = distributeCoords(rowHeights, pageHeight || 0);\n        var xCoords = distributeCoords(colWidths, pageWidth || 0);\n        var boxWidth = 0;\n        var boxHeight = 0;\n        cells = cells.filter(function (cell) {\n            if (cell.empty && (cell.row > maxRow || cell.col > maxCol)) {\n                return false;\n            }\n            cell.left = xCoords[cell.col];\n            cell.top = yCoords[cell.row];\n            if (cell.merged) {\n                if (!options.forScreen) {\n                    cell.right = orlast(xCoords, cell.col + cell.colspan);\n                    cell.bottom = orlast(yCoords, cell.row + cell.rowspan);\n                    cell.width = cell.right - cell.left;\n                    cell.height = cell.bottom - cell.top;\n                } else {\n                    cell.right = cell.left + cell.width;\n                    cell.bottom = cell.top + cell.height;\n                }\n            } else {\n                cell.width = colWidths[cell.col];\n                cell.height = rowHeights[cell.row];\n                cell.bottom = cell.top + cell.height;\n                cell.right = cell.left + cell.width;\n            }\n            boxWidth = Math.max(boxWidth, cell.right);\n            boxHeight = Math.max(boxHeight, cell.bottom);\n            return true;\n        });\n        Object.keys(mergedCells.primary).forEach(function (id) {\n            var ref = mergedCells.primary[id];\n            sheet.forEach(ref.topLeft.toRangeRef(), function (row, col, cell) {\n                var relrow = row - range.topLeft.row;\n                var relcol = col - range.topLeft.col;\n                cell.merged = true;\n                cell.colspan = ref.height();\n                cell.rowspan = ref.width();\n                if (relrow < 0) {\n                    cell.top = -sheet._rows.sum(row, row - relrow - 1);\n                } else {\n                    cell.top = yCoords[relrow];\n                }\n                if (relcol < 0) {\n                    cell.left = -sheet._columns.sum(col, col - relcol - 1);\n                } else {\n                    cell.left = xCoords[relcol];\n                }\n                cell.height = sheet._rows.sum(ref.topLeft.row, ref.bottomRight.row);\n                cell.width = sheet._columns.sum(ref.topLeft.col, ref.bottomRight.col);\n                if (cell.height > 0 && cell.width > 0) {\n                    cell.right = cell.left + cell.width;\n                    cell.bottom = cell.top + cell.height;\n                    cells.push(cell);\n                }\n            });\n        });\n        return {\n            width: boxWidth,\n            height: boxHeight,\n            cells: cells.sort(normalOrder),\n            scale: scaleFactor,\n            xCoords: xCoords,\n            yCoords: yCoords\n        };\n    }\n    function sum(a, b) {\n        return a + b;\n    }\n    function orlast(a, i) {\n        return i < a.length ? a[i] : a[a.length - 1];\n    }\n    function shouldDrawCell(cell) {\n        return cell.value != null || cell.merged || cell.background != null || cell.borderTop != null || cell.borderRight != null || cell.borderBottom != null || cell.borderLeft != null || cell.validation != null && !cell.validation.value;\n    }\n    function normalOrder(a, b) {\n        if (a.top < b.top) {\n            return -1;\n        } else if (a.top == b.top) {\n            if (a.left < b.left) {\n                return -1;\n            } else if (a.left == b.left) {\n                return 0;\n            } else {\n                return 1;\n            }\n        } else {\n            return 1;\n        }\n    }\n    function drawLayout(layout, group, options) {\n        var ncols = Math.ceil(layout.width / options.pageWidth);\n        var nrows = Math.ceil(layout.height / options.pageHeight);\n        var pageWidth = options.pageWidth / layout.scale;\n        var pageHeight = options.pageHeight / layout.scale;\n        for (var i = 0; i < ncols; ++i) {\n            for (var j = 0; j < nrows; ++j) {\n                addPage(j, i);\n            }\n        }\n        function addPage(row, col) {\n            var left = col * pageWidth;\n            var right = left + pageWidth;\n            var top = row * pageHeight;\n            var bottom = top + pageHeight;\n            var endbottom = 0, endright = 0;\n            var cells = layout.cells.filter(function (cell) {\n                if (cell.right <= left || cell.left >= right || cell.bottom <= top || cell.top >= bottom) {\n                    return false;\n                }\n                endbottom = Math.max(cell.bottom, endbottom);\n                endright = Math.max(cell.right, endright);\n                return true;\n            });\n            if (cells.length > 0) {\n                var page = new drawing.Group();\n                group.append(page);\n                page.clip(drawing.Path.fromRect(new geo.Rect([\n                    0,\n                    0\n                ], [\n                    options.pageWidth,\n                    options.pageHeight\n                ])));\n                var content = new drawing.Group();\n                page.append(content);\n                var matrix = geo.Matrix.scale(layout.scale, layout.scale).multiplyCopy(geo.Matrix.translate(-left, -top));\n                if (options.hCenter || options.vCenter) {\n                    matrix = matrix.multiplyCopy(geo.Matrix.translate(options.hCenter ? (right - endright) / 2 : 0, options.vCenter ? (bottom - endbottom) / 2 : 0));\n                }\n                content.transform(matrix);\n                if (options.guidelines) {\n                    var prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        x = Math.min(x, endright);\n                        if (x !== prev && x >= left && x <= right) {\n                            prev = x;\n                            content.append(new drawing.Path().moveTo(x, top).lineTo(x, endbottom).close().stroke('#999', GUIDELINE_WIDTH));\n                        }\n                    });\n                    var prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        y = Math.min(y, endbottom);\n                        if (y !== prev && y >= top && y <= bottom) {\n                            prev = y;\n                            content.append(new drawing.Path().moveTo(left, y).lineTo(endright, y).close().stroke('#999', GUIDELINE_WIDTH));\n                        }\n                    });\n                }\n                var borders = new drawing.Group();\n                cells.forEach(function (cell) {\n                    drawCell(cell, content, borders, options);\n                });\n                content.append(borders);\n            }\n        }\n    }\n    function drawCell(cell, content, borders, options) {\n        var g = new drawing.Group();\n        content.append(g);\n        var rect = new geo.Rect([\n            cell.left,\n            cell.top\n        ], [\n            cell.width,\n            cell.height\n        ]);\n        if (cell.background || cell.merged) {\n            var r2d2 = rect;\n            if (options.guidelines) {\n                r2d2 = rect.clone();\n                r2d2.origin.x += GUIDELINE_WIDTH / 2;\n                r2d2.origin.y += GUIDELINE_WIDTH / 2;\n                r2d2.size.width -= GUIDELINE_WIDTH;\n                r2d2.size.height -= GUIDELINE_WIDTH;\n            }\n            g.append(new drawing.Rect(r2d2).fill(cell.background || '#fff').stroke(null));\n        }\n        if (cell.borderLeft) {\n            borders.append(new drawing.Path().moveTo(cell.left, cell.top).lineTo(cell.left, cell.bottom).close().stroke(cell.borderLeft.color, cell.borderLeft.size));\n        }\n        if (cell.borderTop) {\n            borders.append(new drawing.Path().moveTo(cell.left, cell.top).lineTo(cell.right, cell.top).close().stroke(cell.borderTop.color, cell.borderTop.size));\n        }\n        if (cell.borderRight) {\n            borders.append(new drawing.Path().moveTo(cell.right, cell.top).lineTo(cell.right, cell.bottom).close().stroke(cell.borderRight.color, cell.borderRight.size));\n        }\n        if (cell.borderBottom) {\n            borders.append(new drawing.Path().moveTo(cell.left, cell.bottom).lineTo(cell.right, cell.bottom).close().stroke(cell.borderBottom.color, cell.borderBottom.size));\n        }\n        var val = cell.value;\n        if (val != null) {\n            var type = typeof val == 'number' ? 'number' : null;\n            var clip = new drawing.Group();\n            clip.clip(drawing.Path.fromRect(rect));\n            g.append(clip);\n            var f;\n            if (cell.format) {\n                f = formatting.textAndColor(val, cell.format);\n                val = f.text;\n                if (f.type) {\n                    type = f.type;\n                }\n            } else {\n                val += '';\n            }\n            if (!cell.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                    cell.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    cell.textAlign = 'center';\n                    break;\n                }\n            }\n            drawText(val, f && f.color || cell.color || '#000', cell, clip);\n        }\n    }\n    function drawText(text, color, cell, group) {\n        var rect_left = cell.left + 2;\n        var rect_top = cell.top + 2;\n        var rect_width = cell.width - 4;\n        var rect_height = cell.height - 4;\n        var font = makeFontDef(cell);\n        var style = {\n            font: font,\n            whiteSpace: 'pre'\n        };\n        var props = {\n            font: font,\n            fill: { color: color }\n        };\n        var lines = [], text_height = 0, top = rect_top;\n        if (cell.wrap) {\n            paraBreak(text, style, rect_width).forEach(function (line) {\n                var tmp = new drawing.Text(line.text, [\n                    rect_left,\n                    top\n                ], props);\n                top += line.box.height;\n                lines.push({\n                    el: tmp,\n                    box: line.box\n                });\n            });\n            text_height = top - rect_top;\n        } else {\n            var tmp = new drawing.Text(text, [\n                rect_left,\n                top\n            ], props);\n            var box = kendo.util.measureText(text, style);\n            lines.push({\n                el: tmp,\n                box: box\n            });\n            text_height = box.height;\n        }\n        var cont = new drawing.Group();\n        group.append(cont);\n        var vtrans = 0;\n        switch (cell.verticalAlign) {\n        case 'center':\n            vtrans = rect_height - text_height >> 1;\n            break;\n        case undefined:\n        case null:\n        case 'bottom':\n            vtrans = rect_height - text_height;\n            break;\n        }\n        if (vtrans < 0) {\n            vtrans = 0;\n        }\n        lines.forEach(function (line) {\n            cont.append(line.el);\n            var htrans = 0;\n            var text_width = line.box.width;\n            switch (cell.textAlign) {\n            case 'center':\n                htrans = (rect_width - text_width) / 2;\n                break;\n            case 'right':\n                htrans = rect_width - text_width;\n                break;\n            }\n            if (htrans < 0) {\n                htrans = 0;\n            }\n            if (htrans || vtrans) {\n                line.el.transform(geo.Matrix.translate(htrans, vtrans));\n            }\n            if (cell.underline) {\n                var height = cell.fontSize || 12;\n                var width = height / 12;\n                var path = new drawing.Path({\n                    stroke: {\n                        width: width,\n                        color: color\n                    }\n                });\n                var pos = line.el.position();\n                var bottom = pos.y + height + vtrans + 2 * width;\n                path.moveTo(pos.x + htrans, bottom).lineTo(pos.x + htrans + text_width, bottom);\n                cont.append(path);\n            }\n        });\n    }\n    function lineBreak(text, style, width, lines) {\n        var len = text.length;\n        var start = 0;\n        while (start < len) {\n            split(start, len, len);\n        }\n        function split(min, eol, max) {\n            var sub = text.substring(start, eol).trim();\n            var box = kendo.util.measureText(sub, style);\n            if (box.width <= width) {\n                if (eol < max - 1) {\n                    split(eol, eol + max >> 1, max);\n                } else {\n                    lines.push({\n                        text: sub,\n                        box: box\n                    });\n                    start = eol;\n                }\n            } else if (min < eol) {\n                split(min, min + eol >> 1, eol);\n            }\n        }\n    }\n    function paraBreak(text, style, width) {\n        var a = text.split(/\\r?\\n/);\n        var lines = [];\n        a.forEach(function (text) {\n            lineBreak(text, style, width, lines);\n        });\n        return lines;\n    }\n    function makeFontDef(cell) {\n        var font = [];\n        if (cell.italic) {\n            font.push('italic');\n        }\n        if (cell.bold) {\n            font.push('bold');\n        }\n        font.push((cell.fontSize || 12) + 'px');\n        font.push(cell.fontFamily || 'Arial');\n        return font.join(' ');\n    }\n    function draw(sheet, range, options, callback) {\n        if (options == null && callback == null) {\n            callback = range;\n            options = {};\n            range = spreadsheet.SHEETREF;\n        }\n        if (callback == null) {\n            callback = options;\n            if (range instanceof spreadsheet.Range || range instanceof spreadsheet.Ref || typeof range == 'string') {\n                options = {};\n            } else {\n                options = range;\n                range = spreadsheet.SHEETREF;\n            }\n        }\n        options = kendo.jQuery.extend({\n            paperSize: 'A4',\n            landscape: true,\n            margin: '1cm',\n            guidelines: true,\n            emptyCells: true,\n            fitWidth: false,\n            center: false\n        }, options);\n        var group = new drawing.Group();\n        var paper = kendo.pdf.getPaperOptions(options);\n        group.options.set('pdf', {\n            author: options.author,\n            creator: options.creator,\n            date: options.date,\n            keywords: options.keywords,\n            margin: paper.margin,\n            multiPage: true,\n            paperSize: paper.paperSize,\n            subject: options.subject,\n            title: options.title\n        });\n        var pageWidth = paper.paperSize[0];\n        var pageHeight = paper.paperSize[1];\n        if (paper.margin) {\n            pageWidth -= paper.margin.left + paper.margin.right;\n            pageHeight -= paper.margin.top + paper.margin.bottom;\n        }\n        options.pageWidth = pageWidth;\n        options.pageHeight = pageHeight;\n        var layout = doLayout(sheet, sheet._ref(range), options);\n        drawLayout(layout, group, options);\n        callback(group);\n    }\n    spreadsheet.Sheet.prototype.draw = function (range, options, callback) {\n        var sheet = this;\n        if (sheet._workbook) {\n            sheet.recalc(sheet._workbook._context, function () {\n                draw(sheet, range, options, callback);\n            });\n        } else {\n            draw(sheet, range, options, callback);\n        }\n    };\n    spreadsheet.draw = {\n        doLayout: doLayout,\n        drawLayout: drawLayout,\n        shouldDrawCell: shouldDrawCell\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('kendo.spreadsheet', [\n        'util/undoredostack',\n        'util/text-metrics',\n        'util/parse-xml',\n        'kendo.excel',\n        'kendo.progressbar',\n        'kendo.pdf',\n        'spreadsheet/commands',\n        'spreadsheet/formulabar',\n        'spreadsheet/formulainput',\n        'spreadsheet/eventlistener',\n        'spreadsheet/rangelist',\n        'spreadsheet/propertybag',\n        'spreadsheet/references',\n        'spreadsheet/navigator',\n        'spreadsheet/axismanager',\n        'spreadsheet/clipboard',\n        'spreadsheet/range',\n        'spreadsheet/sheet',\n        'spreadsheet/sheetsbar',\n        'spreadsheet/excel-reader',\n        'spreadsheet/workbook',\n        'spreadsheet/formulacontext',\n        'spreadsheet/controller',\n        'spreadsheet/view',\n        'spreadsheet/customeditors',\n        'spreadsheet/grid',\n        'spreadsheet/axis',\n        'spreadsheet/filter',\n        'spreadsheet/sorter',\n        'spreadsheet/runtime',\n        'spreadsheet/calc',\n        'spreadsheet/numformat',\n        'spreadsheet/runtime.functions',\n        'spreadsheet/runtime.functions.2',\n        'spreadsheet/toolbar',\n        'spreadsheet/dialogs',\n        'spreadsheet/sheetbinder',\n        'spreadsheet/filtermenu',\n        'spreadsheet/editor',\n        'spreadsheet/autofill',\n        'spreadsheet/nameeditor',\n        'spreadsheet/print'\n    ], f);\n}(function () {\n    var __meta__ = {\n        id: 'spreadsheet',\n        name: 'Spreadsheet',\n        category: 'web',\n        description: 'Spreadsheet component',\n        depends: [\n            'core',\n            'binder',\n            'colorpicker',\n            'combobox',\n            'data',\n            'dom',\n            'dropdownlist',\n            'menu',\n            'ooxml',\n            'popup',\n            'sortable',\n            'tabstrip',\n            'toolbar',\n            'treeview',\n            'window',\n            'validator',\n            'excel',\n            'pdf',\n            'drawing'\n        ]\n    };\n    (function (kendo, undefined) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var Workbook = kendo.spreadsheet.Workbook;\n        var Controller = kendo.spreadsheet.Controller;\n        var View = kendo.spreadsheet.View;\n        var NS = '.kendoSpreadsheet';\n        var ALL_REASONS = {\n            recalc: true,\n            selection: true,\n            activeCell: true,\n            layout: true,\n            sheetSelection: true,\n            resize: true,\n            editorChange: false,\n            editorClose: false\n        };\n        var classNames = { wrapper: 'k-widget k-spreadsheet' };\n        var Spreadsheet = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(Spreadsheet.classNames.wrapper);\n                this._view = new View(this.element, {\n                    messages: this.options.messages.view,\n                    toolbar: this.options.toolbar,\n                    sheetsbar: this.options.sheetsbar\n                });\n                this._workbook = new Workbook(this.options, this._view);\n                this._controller = new Controller(this._view, this._workbook);\n                this._autoRefresh = true;\n                this._bindWorkbookEvents();\n                this._view.workbook(this._workbook);\n                this.refresh();\n                this._resizeHandler = function () {\n                    this.resize();\n                }.bind(this);\n                $(window).on('resize' + NS, this._resizeHandler);\n            },\n            _resize: function () {\n                this.refresh({ layout: true });\n            },\n            _workbookChange: function (e) {\n                if (this._autoRefresh) {\n                    this.refresh(e);\n                }\n                if (e.recalc && e.ref) {\n                    var range = e.range || new kendo.spreadsheet.Range(e.ref, this.activeSheet());\n                    this.trigger('change', { range: range });\n                }\n            },\n            _workbookCut: function (e) {\n                this.trigger('cut', e);\n            },\n            _workbookCopy: function (e) {\n                this.trigger('copy', e);\n            },\n            _workbookPaste: function (e) {\n                this.trigger('paste', e);\n            },\n            activeSheet: function (sheet) {\n                return this._workbook.activeSheet(sheet);\n            },\n            moveSheetToIndex: function (sheet, index) {\n                return this._workbook.moveSheetToIndex(sheet, index);\n            },\n            insertSheet: function (options) {\n                return this._workbook.insertSheet(options);\n            },\n            sheets: function () {\n                return this._workbook.sheets();\n            },\n            removeSheet: function (sheet) {\n                return this._workbook.removeSheet(sheet);\n            },\n            sheetByName: function (sheetName) {\n                return this._workbook.sheetByName(sheetName);\n            },\n            sheetIndex: function (sheet) {\n                return this._workbook.sheetIndex(sheet);\n            },\n            sheetByIndex: function (index) {\n                return this._workbook.sheetByIndex(index);\n            },\n            renameSheet: function (sheet, newSheetName) {\n                return this._workbook.renameSheet(sheet, newSheetName);\n            },\n            refresh: function (reason) {\n                if (!reason) {\n                    reason = ALL_REASONS;\n                }\n                if (!reason.editorClose) {\n                    this._view.sheet(this._workbook.activeSheet());\n                    this._controller.sheet(this._workbook.activeSheet());\n                    this._workbook.refresh(reason);\n                }\n                if (!reason.editorChange) {\n                    this._view.refresh(reason);\n                    this._controller.refresh();\n                    this._view.render();\n                    this.trigger('render');\n                }\n                return this;\n            },\n            openDialog: function (name, options) {\n                return this._view.openDialog(name, options);\n            },\n            autoRefresh: function (value) {\n                if (value !== undefined) {\n                    this._autoRefresh = value;\n                    if (value === true) {\n                        this.refresh();\n                    }\n                    return this;\n                }\n                return this._autoRefresh;\n            },\n            toJSON: function () {\n                return this._workbook.toJSON();\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    this._workbook.destroy();\n                    this._workbook = new Workbook($.extend({}, this.options, json));\n                    this._bindWorkbookEvents();\n                    this._view.workbook(this._workbook);\n                    this._controller.workbook(this._workbook);\n                    this.activeSheet(this.activeSheet());\n                } else {\n                    this.refresh();\n                }\n            },\n            fromFile: function (blob, name) {\n                return this._workbook.fromFile(blob, name);\n            },\n            saveAsPDF: function (options) {\n                this._workbook.saveAsPDF($.extend({}, this.options.pdf, options, { workbook: this._workbook }));\n            },\n            saveAsExcel: function (options) {\n                this._workbook.saveAsExcel(options);\n            },\n            draw: function (options, callback) {\n                this._workbook.draw(options, callback);\n            },\n            _workbookExcelExport: function (e) {\n                if (this.trigger('excelExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookExcelImport: function (e) {\n                if (this.trigger('excelImport', e)) {\n                    e.preventDefault();\n                } else {\n                    this._initProgress(e.promise);\n                }\n            },\n            _initProgress: function (deferred) {\n                var loading = $('<div class=\\'k-loading-mask\\' ' + 'style=\\'width: 100%; height: 100%; top: 0;\\'>' + '<div class=\\'k-loading-color\\'/>' + '</div>').appendTo(this.element);\n                var pb = $('<div class=\\'k-loading-progress\\'>').appendTo(loading).kendoProgressBar({\n                    type: 'chunk',\n                    chunkCount: 10,\n                    min: 0,\n                    max: 1,\n                    value: 0\n                }).data('kendoProgressBar');\n                deferred.progress(function (e) {\n                    pb.value(e.progress);\n                }).always(function () {\n                    kendo.destroy(loading);\n                    loading.remove();\n                });\n            },\n            _workbookPdfExport: function (e) {\n                if (this.trigger('pdfExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _bindWorkbookEvents: function () {\n                this._workbook.bind('cut', this._workbookCut.bind(this));\n                this._workbook.bind('copy', this._workbookCopy.bind(this));\n                this._workbook.bind('paste', this._workbookPaste.bind(this));\n                this._workbook.bind('change', this._workbookChange.bind(this));\n                this._workbook.bind('excelExport', this._workbookExcelExport.bind(this));\n                this._workbook.bind('excelImport', this._workbookExcelImport.bind(this));\n                this._workbook.bind('pdfExport', this._workbookPdfExport.bind(this));\n            },\n            destroy: function () {\n                kendo.ui.Widget.fn.destroy.call(this);\n                this._workbook.destroy();\n                this._controller.destroy();\n                this._view.destroy();\n                if (this._resizeHandler) {\n                    $(window).off('resize' + NS, this._resizeHandler);\n                }\n            },\n            options: {\n                name: 'Spreadsheet',\n                toolbar: true,\n                sheetsbar: true,\n                rows: 200,\n                columns: 50,\n                rowHeight: 20,\n                columnWidth: 64,\n                headerHeight: 20,\n                headerWidth: 32,\n                excel: {\n                    proxyURL: '',\n                    fileName: 'Workbook.xlsx'\n                },\n                messages: {},\n                pdf: {\n                    area: 'workbook',\n                    fileName: 'Workbook.pdf',\n                    proxyURL: '',\n                    paperSize: 'a4',\n                    landscape: true,\n                    margin: null,\n                    title: null,\n                    author: null,\n                    subject: null,\n                    keywords: null,\n                    creator: 'Kendo UI PDF Generator v.' + kendo.version,\n                    date: null\n                }\n            },\n            defineName: function (name, value, hidden) {\n                return this._workbook.defineName(name, value, hidden);\n            },\n            undefineName: function (name) {\n                return this._workbook.undefineName(name);\n            },\n            nameValue: function (name) {\n                return this._workbook.nameValue(name);\n            },\n            forEachName: function (func) {\n                return this._workbook.forEachName(func);\n            },\n            events: [\n                'cut',\n                'copy',\n                'paste',\n                'pdfExport',\n                'excelExport',\n                'excelImport',\n                'change',\n                'render'\n            ]\n        });\n        kendo.spreadsheet.ALL_REASONS = ALL_REASONS;\n        kendo.ui.plugin(Spreadsheet);\n        $.extend(true, Spreadsheet, { classNames: classNames });\n    }(window.kendo));\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));"],"sourceRoot":"/source/"}